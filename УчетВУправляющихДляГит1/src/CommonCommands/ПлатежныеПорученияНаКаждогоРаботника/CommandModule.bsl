
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	Отказ = Ложь;
	ПроверитьВозможностьФормированияПлатежныхПоручений(ПараметрКоманды, Отказ);
	
	Если НЕ Отказ Тогда
		ОткрытьФорму("Обработка.ВыплатаЗарплатыПлатежнымиПоручениями.Форма", Новый Структура("ПлатежнаяВедомость", ПараметрКоманды), ПараметрыВыполненияКоманды.Источник, ПараметрыВыполненияКоманды.Уникальность, ПараметрыВыполненияКоманды.Окно, ПараметрыВыполненияКоманды.НавигационнаяСсылка);
	КонецЕсли;
	
КонецПроцедуры

&НаСервере
Процедура ПроверитьВозможностьФормированияПлатежныхПоручений(ПараметрКоманды, Отказ)
	
	Если ТипЗнч(ПараметрКоманды) = Тип("ДокументСсылка.ВедомостьНаВыплатуЗарплаты") Тогда
		ВидМестаВыплаты = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(ПараметрКоманды, "ВидМестаВыплаты");
		Если ВидМестаВыплаты <> Перечисления.ВидыМестВыплатыЗарплаты.БанковскийСчет Тогда
			ТекстСообщения = НСтр("ru = 'Для формирования платежных поручений укажите место выплаты ""Перечислением на счет в банке""!'");
			ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстСообщения, , , , Отказ);
		КонецЕсли;
	Иначе
		ЗарплатныйПроект = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(ПараметрКоманды, "ЗарплатныйПроект");
		Если ЗначениеЗаполнено(ЗарплатныйПроект) Тогда
			ТекстСообщения = НСтр("ru = 'Платежные поручения на каждого работника не формируются для перечисления по зарплатному проекту!'");
			ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстСообщения, , , , Отказ);
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры