
#Область ПрограммныйИнтерфейс

// Функция определяет содержат ли параметры перетаскивания файлы.
//
// Параметры:
// ПараметрыПеретаскивания - ПараметрыПеретаскивания.
//
// Возвращаемое значение:
// Булево - Истина - переданные параметры содержат файлы.
//
Функция ПараметрыПеретаскиванияСодержатФайлы(ПараметрыПеретаскивания) Экспорт
	
	ПараметрыПеретаскиванияСодержатФайлы = Ложь;
	
	Если ТипЗнч(ПараметрыПеретаскивания.Значение) = Тип("Файл") И ПараметрыПеретаскивания.Значение.ЭтоФайл() Тогда
		
		ПараметрыПеретаскиванияСодержатФайлы = Истина;
		
	ИначеЕсли ТипЗнч(ПараметрыПеретаскивания.Значение) = Тип("Массив") Тогда
		
		Если ПараметрыПеретаскивания.Значение.Количество() > 0 Тогда
			
			ПараметрыПеретаскиванияСодержатФайлы = Истина;
			
			Для Каждого ЭлементДанных Из ПараметрыПеретаскивания.Значение Цикл
				Если ТипЗнч(ЭлементДанных) <> Тип("Файл") Тогда
					ПараметрыПеретаскиванияСодержатФайлы = Ложь;
					Прервать;
				КонецЕсли;
			КонецЦикла;
			
		КонецЕсли;
		
	КонецЕсли;
	
	Возврат ПараметрыПеретаскиванияСодержатФайлы;
	
КонецФункции

// Добавляет файлы перетаскиванием в список присоединенных файлов.
//
// Параметры:
//  ПараметрыПеретаскивания - ПараметрыПеретаскивания.
//  Ссылка                  - Ссылка - владелец файла.
//  ИдентификаторФормы      - УникальныйИдентификатор формы.
//
Процедура ДобавитьФайлыПеретаскиванием(ПараметрыПеретаскивания, Ссылка, УникальныйИдентификатор) Экспорт
	
	МассивИменФайлов = Новый Массив;
	
	Если ТипЗнч(ПараметрыПеретаскивания.Значение) = Тип("Файл") Тогда
		
		МассивИменФайлов.Добавить(ПараметрыПеретаскивания.Значение.ПолноеИмя);
		
	ИначеЕсли ТипЗнч(ПараметрыПеретаскивания.Значение) = Тип("Массив") Тогда
		
		Для Каждого Значение Из ПараметрыПеретаскивания.Значение Цикл
			МассивИменФайлов.Добавить(Значение.ПолноеИмя);
		КонецЦикла;
		
	КонецЕсли;
	
	Если МассивИменФайлов.Количество() > 0 Тогда
		РаботаСФайламиСлужебныйКлиент.ДобавитьФайлыПеретаскиванием(
			Ссылка, УникальныйИдентификатор, МассивИменФайлов);
	КонецЕсли;
	
	ОповеститьОбИзменении(Ссылка);
	
КонецПроцедуры

#Область СлужебныйПрограммныйИнтерфейс

Процедура ОбновитьСписокПослеДобавленияФайла(ЭтотОбъект, Знач ИмяСобытия, Знач Параметр, Источник) Экспорт
	
	Если ИмяСобытия = "Запись_Файл" Тогда
		
		ЭтотОбъект.Элементы.Список.Обновить();
		
	КонецЕсли;
	
КонецПроцедуры

Процедура ПеретаскиваниеФайловОтветПолучен(ОтветПользователя, ДополнительныеПараметры) Экспорт
	
	Если ОтветПользователя = КодВозвратаДиалога.Да Тогда
		ПрисоединенныеФайлыБПКлиент.ДобавитьФайлыПеретаскиванием(
			ДополнительныеПараметры.ПараметрыПеретаскивания,
			ДополнительныеПараметры.Ссылка,
			ДополнительныеПараметры.УникальныйИдентификатор);
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#КонецОбласти

