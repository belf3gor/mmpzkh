
#Область ОбщиеПроцедурыИФункции

// Процедура дополняет адрес интернет ресурса служебным параметром.
Процедура ДополнитьИнтернетАдресСлужебнымПараметром(ИнтернетАдрес, СлужебныйПараметр) Экспорт
	
	// Добавим параметр к интернет адресу.
	ИнтернетАдрес = ИнтернетАдрес
	+ ПолучитьРазделительСледующегоПараметраИнтернетАдреса(ИнтернетАдрес) // разделитель
	+ СлужебныйПараметр; // параметр
	
КонецПроцедуры // ДополнитьИнтернетАдресСлужебнымПараметром()

// Функция возвращает символ-разделитель следующего параметра интернет-адреса.
//   Возвращаемое значение:
//     "?" - если параметров в адресной строке еще нет;
//     "&" - если параметры в адресной строке уже есть.
//
Функция ПолучитьРазделительСледующегоПараметраИнтернетАдреса(ИнтернетАдрес)
	
	РазделительПараметра = "?";
	
	ПараметрыАдресаОпределен = (СтрНайти(ИнтернетАдрес, "?") > 0);
	Если ПараметрыАдресаОпределен Тогда
		РазделительПараметра = "&";
	КонецЕсли;
	
	Возврат РазделительПараметра;
	
КонецФункции

// Формирует и выводит сообщение, которое может быть связано с элементом 
// управления формы. Используется для диалоговых сообщений пользователю.
//
Процедура СообщитьПользователю(Знач ТекстСообщенияПользователю,
		Знач КлючДанных = Неопределено,
		Знач Поле = "",
		Знач ПутьКДанным = "",
		Отказ = Ложь) Экспорт
	
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = ТекстСообщенияПользователю;
	Сообщение.Поле = Поле;
	
	ЭтоОбъект = Ложь;
	
	#Если НЕ ТонкийКлиент И НЕ ВебКлиент И НЕ МобильныйКлиент Тогда
		Если КлючДанных <> Неопределено
			И XMLТипЗнч(КлючДанных) <> Неопределено Тогда
			ТипЗначенияСтрокой = XMLТипЗнч(КлючДанных).ИмяТипа;
			ЭтоОбъект = СтрНайти(ТипЗначенияСтрокой, "Object.") > 0;
		КонецЕсли;
	#КонецЕсли
	
	Если ЭтоОбъект Тогда
		Сообщение.УстановитьДанные(КлючДанных);
	Иначе
		Сообщение.КлючДанных = КлючДанных;
	КонецЕсли;
	
	Если НЕ ПустаяСтрока(ПутьКДанным) Тогда
		Сообщение.ПутьКДанным = ПутьКДанным;
	КонецЕсли;
	
	Сообщение.Сообщить();
	
	Отказ = Истина;

КонецПроцедуры

#КонецОбласти