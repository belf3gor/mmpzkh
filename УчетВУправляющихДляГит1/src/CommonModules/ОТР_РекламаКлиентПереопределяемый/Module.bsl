
// Модуль предназначен для внесения изменений в логику обработки событий при нажатии на баннер
// и нажатие на картинку закрытия баннера, описанные в общем модуле "ОТР_РекламаКлиент".

// Здесь приведен пример обработчиков для ЖКХ 3.0.

#Область ПрограммныйИнтерфейс

// Скрывает баннер на форме.
//
// Параметры:
//  Форма	 - УправляемаяФорма - форма.
//
Процедура ЗакрытьБаннер(Форма) Экспорт
	
	Попытка
		
		ГруппаБаннера = Форма.Элементы.Найти("ОТР_ГруппаРеклама");
		
		Если НЕ ГруппаБаннера = Неопределено Тогда
			ГруппаБаннера.Видимость = Ложь;
			
			ОТР_РекламаСерверПереопределяемый.СохранитьНастройкиПользователяПоРекламеСервисов(Форма.ИмяФормы, Форма.Элементы.ОТР_Баннер.Заголовок);
		КонецЕсли;
		
	Исключение
		
	КонецПопытки;
	
КонецПроцедуры // ЗакрытьБаннер()

// Процедура - обработчик события "ПриСозданииНаСервере" формы.
//
// Параметры:
//  Форма	 - УправляемаяФорма - форма.
//
Процедура ОткрытьСтраницуСайта(Форма) Экспорт
	
	Попытка
		
		НачатьЗапускПриложения(Новый ОписаниеОповещения("ОповещениеПослеОткрытияСтраницыСайта", ОТР_РекламаКлиентПереопределяемый),
							   ПолучитьТекстГиперссылкиСсылкиИзСвойстваБаннера(Форма));
		
	Исключение
		
	КонецПопытки;
	
КонецПроцедуры // ПриСозданииНаСервере()

// Получает текст гиперссылки для баннера.
//
// Параметры:
//  Форма	 - УправляемаяФорма - форма.
// 
// Возвращаемое значение:
//  Строка.
//
Функция ПолучитьТекстГиперссылкиСсылкиИзСвойстваБаннера(Форма)
	
	ТекстГиперссылки = ОТР_РекламаКлиентСерверПереопределяемый.ГиперссылкаОсновнойСтраницыСайта();
	
	Если НЕ Форма.Элементы.Найти("ОТР_ГруппаРеклама") = Неопределено
	   И ЗначениеЗаполнено(Форма.Элементы.ОТР_Баннер.ТекстНевыбраннойКартинки) Тогда
		ТекстГиперссылки = Форма.Элементы.ОТР_Баннер.ТекстНевыбраннойКартинки;
	КонецЕсли;
	
	Возврат ТекстГиперссылки;
	
КонецФункции // ПолучитьТекстГиперссылкиСсылкиИзСвойстваБаннера()

// Процедура-обработчик оповещения.
//
Процедура ОповещениеПослеОткрытияСтраницыСайта(КодВозврата, ДополнительныеПараметры) Экспорт
	
	// Пустой обязательный обработчик оповещения "НачатьЗапускПриложения()".
	Возврат;
	
КонецПроцедуры // ОповещениеПослеОткрытияСтраницыСайта()

#КонецОбласти // ПрограммныйИнтерфейс