
#Область ОбработчикиСобытийФормы

&НаСервере
// Обработчик события "ПриСозданииНаСервере" формы.
//
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Элементы.ГруппаВариантыВыводаОшибки.ТекущаяСтраница = Элементы.ГруппаОшибкаЛицензииСтандартная;
	Если Параметры.Свойство("ПоказатьОшибкуПриЗапуске") Тогда
		
		Элементы.ГруппаОшибкаЛицензииПриЗапуске.Видимость = Истина;
		Элементы.ГруппаВариантыВыводаОшибки.ТекущаяСтраница = Элементы.ГруппаОшибкаЛицензииПриЗапуске;
		
		Элементы.Продолжить.Видимость = Ложь;
		Элементы.ЗавершитьРаботу.Заголовок = "Закрыть";
		
	КонецЕсли;
	
	// Сбрасываем ошибку проверки лицензии, чтобы форма параметров
	// лицензирования не открывалась из обработчика мониторинга.
	СЗК_ТиповыеМетоды.СброситьПоследнийРезультатПроверкиЛицензии();
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

&НаКлиенте
// Обработчик команды "ЗавершитьРаботу".
Процедура ЗавершитьРаботу(Команда)
	
	// После закрытия формы программа будет закрыта.
	Закрыть(Ложь);
	
КонецПроцедуры

&НаКлиенте
// Обработчик команды "ПродолжитьОбновление".
Процедура ПродолжитьОбновление(Команда)
	
	// Проверка наличия и корректности лицензионного ключа.
	// Если введенный ключ корректен, форма будет закрыта, и продолжится обновление подсистемы ЖКХ.
	Если СЗК_МодульЗащиты.ЛицензионныйКлючКорректен(, Ложь, Истина) Тогда
		Закрыть(Истина);
	Иначе
		// Сбрасываем ошибку проверки лицензии, чтобы форма параметров
		// лицензирования не открывалась из обработчика мониторинга.
		СЗК_ТиповыеМетоды.СброситьПоследнийРезультатПроверкиЛицензии();
		ПоказатьПредупреждение(, "Возникла ошибка получения лицензии или ключ защиты не обнаружен!");
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
// Обработчик команды "ОткрытьПараметрыСистемыЛицензирования".
//
Процедура ОткрытьПараметрыСистемыЛицензирования(Команда)
	
	ОткрытьФорму("ОбщаяФорма.СЗК_НастройкаПараметровСистемыЛицензирования");
	
КонецПроцедуры

#КонецОбласти
