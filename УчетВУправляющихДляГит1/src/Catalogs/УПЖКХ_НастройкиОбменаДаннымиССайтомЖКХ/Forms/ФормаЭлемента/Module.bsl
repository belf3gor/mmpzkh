
////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

#Область ОбработчикиСобытийФормы

&НаКлиенте
// Обработчик события "ПриОткрытии" формы.
//
Процедура ПриОткрытии(Отказ)
	
	ДобавитьСтрокиПоУмолчаниюВТаблицу();
	
КонецПроцедуры

&НаКлиенте
// Обработчик события "ПослеЗаписи" формы.
//
Процедура ПослеЗаписи(ПараметрыЗаписи)
	
	Оповестить("ОбновитьИнтерфейс");
	
КонецПроцедуры

#КонецОбласти

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ ИНИЦИАЛИЗАЦИИ

#Область ПроцедурыИнициализацииНастроек

&НаСервере
// Процедура добавляет строку по умолчанию в таблицу настроек выгрузки услуг.
//
Процедура ДобавитьСтрокиПоУмолчаниюВТаблицу()
	
	МассивДляПоискаСтрокиПоУмолчанию = Объект.ТаблицаНастроекВыгрузкиУслуг.НайтиСтроки(Новый Структура("Услуга", "<По умолчанию>"));
	
	Если МассивДляПоискаСтрокиПоУмолчанию.Количество() = 0 Тогда
		
		НоваяСтрока = Объект.ТаблицаНастроекВыгрузкиУслуг.Добавить();
		НоваяСтрока.Услуга              = "<По умолчанию>";
		НоваяСтрока.ВыгружатьНачисления = Истина;
		НоваяСтрока.ВыгружатьПоказания  = Истина;
		
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

////////////////////////////////////////////////////////////////////////////////
// ВСПОМОГАТЕЛЬНЫЕ ПРОЦЕДУРЫ

#Область ВспомогательныеПроцедуры

&НаКлиенте
// Перехватывает и обрабатывает действия с таблицей настроек выгрузки.
// Это нужно для отсеивания попыток изменения строки по умолчанию.
//
Процедура ОбработатьДействиеСТаблицей(Элемент, Отказ, ДопУсловие = Истина)
	
	Если ДопУсловие И Элемент.ТекущиеДанные.Услуга = "<По умолчанию>" Тогда
		
		Отказ = Истина;
		
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ЭЛЕМЕНТОВ ФОРМЫ

#Область ОбработчикиСобытийЭлементовФормы

&НаКлиенте
// Обработчик "ПередНачаломИзменения" таблицы настроек выгрузки услуг.
//
Процедура ТаблицаНастроекВыгрузкиПередНачаломИзменения(Элемент, Отказ)
	
	Если Элемент.ТекущийЭлемент.Имя = "ТаблицаНастроекВыгрузкиУслуга" Тогда
		
		ОбработатьДействиеСТаблицей(Элемент, Отказ);
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
// Обработчик "ПередУдалением" таблицы настроек выгрузки услуг.
//
Процедура ТаблицаНастроекВыгрузкиПередУдалением(Элемент, Отказ)
	
	ОбработатьДействиеСТаблицей(Элемент, Отказ);
	
КонецПроцедуры

&НаКлиенте
// Обработчик "ПередНачаломДобавления" таблицы настроек выгрузки услуг.
//
Процедура ТаблицаНастроекВыгрузкиПередНачаломДобавления(Элемент, Отказ, Копирование, Родитель, Группа, Параметр)
	
	ОбработатьДействиеСТаблицей(Элемент, Отказ, Копирование);
	
КонецПроцедуры

&НаКлиенте
// Обработчик "НачалоВыбора" таблицы настроек выгрузки услуг.
//
Процедура ТаблицаНастроекВыгрузкиУслугаНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	СтруктураПараметров = Новый Структура;
	ОткрытьФорму("Справочник.КВП_Услуги.Форма.ФормаВыбора", , Элемент);
	
КонецПроцедуры

#КонецОбласти
