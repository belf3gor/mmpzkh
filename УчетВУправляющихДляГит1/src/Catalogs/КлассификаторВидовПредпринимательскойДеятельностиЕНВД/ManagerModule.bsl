#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Возвращает реквизиты справочника, которые образуют естественный ключ
//  для элементов справочника.
//
// Возвращаемое значение: Массив(Строка) - массив имен реквизитов, образующих
//  естественный ключ.
//
Функция ПоляЕстественногоКлюча() Экспорт
	
	Результат = Новый Массив();
	
	Результат.Добавить("Код");
	
	Возврат Результат;
	
КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

// Обработчик обновления
//
Процедура Обновить() Экспорт
	
	Если ПланыОбмена.ГлавныйУзел() <> Неопределено Тогда // В подчиненных узлах РИБ не выполняется
		Возврат;
	КонецЕсли;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	КлассификаторВидовПредпринимательскойДеятельностиЕНВД.Ссылка,
	|	КлассификаторВидовПредпринимательскойДеятельностиЕНВД.Код
	|ИЗ
	|	Справочник.КлассификаторВидовПредпринимательскойДеятельностиЕНВД КАК КлассификаторВидовПредпринимательскойДеятельностиЕНВД";
	
	ТаблицаСправочника = Запрос.Выполнить().Выгрузить();
	ТаблицаСправочника.Индексы.Добавить("Код");
	
	Макет = Справочники.КлассификаторВидовПредпринимательскойДеятельностиЕНВД.ПолучитьМакет("КлассификаторВидовПредпринимательскойДеятельностиЕНВД");
	
	ТаблицаКлассификатора = ОбщегоНазначения.ЗначениеИзСтрокиXML(Макет.ПолучитьТекст());
	
	Для Каждого СтрокаКлассификатора Из ТаблицаКлассификатора Цикл
		
		НайденнаяСтрока = ТаблицаСправочника.Найти(СтрокаКлассификатора.Код, "Код");
		Если НайденнаяСтрока = Неопределено Тогда
			Объект = Справочники.КлассификаторВидовПредпринимательскойДеятельностиЕНВД.СоздатьЭлемент();
		Иначе
			Объект = НайденнаяСтрока.Ссылка.ПолучитьОбъект();
		КонецЕсли;
		
		ЗаполнитьЗначенияСвойств(Объект, СтрокаКлассификатора);
		ОбновлениеИнформационнойБазы.ЗаписатьОбъект(Объект, Истина);
		
	КонецЦикла;
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли