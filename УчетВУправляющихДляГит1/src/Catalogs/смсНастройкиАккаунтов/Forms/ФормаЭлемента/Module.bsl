
#Область СлужебныеПроцедурыИФункции

&НаКлиенте
Процедура ПередЗаписью(Отказ, ПараметрыЗаписи)
	
	// Проверим заполнение настроек прокси-сервера.
	Если Объект.ИспользоватьПроксиСервер Тогда
		
		Если НЕ ЗначениеЗаполнено(Объект.ПроксиСервер) Тогда 
			смсОбщегоНазначения.СообщитьПользователю("Не указан прокси-сервер!");
			Отказ = Истина;
		КонецЕсли;
		
		Если НЕ ЗначениеЗаполнено(Объект.ПроксиПорт) Тогда 
			смсОбщегоНазначения.СообщитьПользователю("Не указан порт прокси-сервера!");
			Отказ = Истина;
		КонецЕсли;
		
		Если НЕ ЗначениеЗаполнено(Объект.ПроксиПользователь) Тогда 
			смсОбщегоНазначения.СообщитьПользователю("Не указан пользователь прокси-сервера!");
			Отказ = Истина;
		КонецЕсли;
		
		Если НЕ ЗначениеЗаполнено(Объект.ПроксиПароль) Тогда 
			смсОбщегоНазначения.СообщитьПользователю("Не указан пароль для доступа к прокси-серверу!");
			Отказ = Истина;
		КонецЕсли;
		
	КонецЕсли;
	
	// Проверим правильность заполнения периода запрета.
	КонецПериодаЗапрета  = Объект.КонецПериодаЗапрета;
	НачалоПериодаЗапрета = Объект.НачалоПериодаЗапрета;
	
	Если НЕ ЗначениеЗаполнено(НачалоПериодаЗапрета)
		И НЕ ЗначениеЗаполнено(КонецПериодаЗапрета) Тогда
		Возврат;
	КонецЕсли;
	
	Если КонецПериодаЗапрета > НачалоПериодаЗапрета Тогда
		ДлинаПериодаЗапрета = КонецПериодаЗапрета - НачалоПериодаЗапрета;
	Иначе	
		ДлинаПериодаЗапрета = КонецПериодаЗапрета - НачалоПериодаЗапрета + 86400;
	КонецЕсли;
	
	Если (КонецПериодаЗапрета = НачалоПериодаЗапрета) ИЛИ (ДлинаПериодаЗапрета = 86399) Тогда
		смсОбщегоНазначения.СообщитьПользователю("Период запрета отправки составляет полные сутки!");
		Отказ = Истина;
	КонецЕсли;
	
	Если (НЕ ЗначениеЗаполнено(НачалоПериодаЗапрета)
		И ЗначениеЗаполнено(КонецПериодаЗапрета))
		ИЛИ (ЗначениеЗаполнено(НачалоПериодаЗапрета)
		И НЕ ЗначениеЗаполнено(КонецПериодаЗапрета)) Тогда
		смсОбщегоНазначения.СообщитьПользователю("Период запрета задан не полностью!");
		Отказ = Истина;
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ИспользоватьПроксиПриИзменении(Элемент)
	
	УстановитьДоступностьЭлементовФормы();
	
КонецПроцедуры

&НаКлиенте
Процедура УстановитьДоступностьЭлементовФормы()
	
	Если Объект.ИспользоватьПроксиСервер Тогда
		Элементы.ПроксиСервер.Доступность       = Истина;
		Элементы.ПроксиПорт.Доступность         = Истина;
		Элементы.ПроксиПользователь.Доступность = Истина;
		Элементы.ПроксиПароль.Доступность       = Истина;
	Иначе
		Элементы.ПроксиСервер.Доступность       = Ложь;
		Элементы.ПроксиПорт.Доступность         = Ложь;
		Элементы.ПроксиПользователь.Доступность = Ложь;
		Элементы.ПроксиПароль.Доступность       = Ложь;
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	УстановитьДоступностьЭлементовФормы();
	
КонецПроцедуры

#КонецОбласти

