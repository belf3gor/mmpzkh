#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

Функция ТаблицаКонвертацииОКВЭД_ОКВЭД2() Экспорт
	
	ТекстКонвертации = Справочники.КлассификаторОКВЭД2.ПолучитьМакет("КонвертацияОКВЭД_ОКВЭД2").ПолучитьТекст();
	
	ЧтениеXML = Новый ЧтениеXML;
	ЧтениеXML.УстановитьСтроку(ТекстКонвертации);
	
	Если Не ЧтениеXML.Прочитать() Тогда
		ВызватьИсключение НСтр("ru = 'Пустой XML'");
	ИначеЕсли ЧтениеXML.Имя <> "КонвертацияОКВЭД_ОКВЭД2" Тогда
		ВызватьИсключение НСтр("ru = 'Ошибка в структуре XML'");
	КонецЕсли;
	
	ТаблицаКонвертацииОКВЭД_ОКВЭД2 = Новый ТаблицаЗначений;
	ТаблицаКонвертацииОКВЭД_ОКВЭД2.Колонки.Добавить("КодОКВЭД",   Новый ОписаниеТипов("Строка", , Новый КвалификаторыСтроки(8)));
	ТаблицаКонвертацииОКВЭД_ОКВЭД2.Колонки.Добавить("КодОКВЭД2",  Новый ОписаниеТипов("Строка", , Новый КвалификаторыСтроки(8)));
	
	Пока ЧтениеXML.Прочитать() Цикл
		
		ИмяУзла = ЧтениеXML.Имя;
		
		Если ЧтениеXML.ТипУзла = ТипУзлаXML.КонецЭлемента Тогда
			Если ИмяУзла = "КонвертацияОКВЭД_ОКВЭД2" Тогда
				Прервать;
			КонецЕсли;
		КонецЕсли;
		
		Если ЧтениеXML.ТипУзла = ТипУзлаXML.НачалоЭлемента Тогда
			
			Если ИмяУзла = "Элемент" Тогда
				
				ТекущаяСтрока = ТаблицаКонвертацииОКВЭД_ОКВЭД2.Добавить();
				ТекущаяСтрока.КодОКВЭД   = ЧтениеXML.ПолучитьАтрибут("КодОКВЭД");
				ТекущаяСтрока.КодОКВЭД2  = ЧтениеXML.ПолучитьАтрибут("КодОКВЭД2");
				
			КонецЕсли;
			
		КонецЕсли;
		
	КонецЦикла;
	
	ЧтениеXML.Закрыть();
	
	Возврат ТаблицаКонвертацииОКВЭД_ОКВЭД2;
	
КонецФункции

#КонецОбласти

#КонецЕсли