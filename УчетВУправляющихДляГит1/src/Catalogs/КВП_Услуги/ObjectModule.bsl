
#Область СлужебныеПроцедурыИФункции

// Функция возвращает таблицу настроек по макету.
//
Функция ПолучитьТаблицуНастроекИзМакета() Экспорт
	
	ТаблицаХарактеристикИзМакета = Новый ТаблицаЗначений;
	ТаблицаХарактеристикИзМакета.Колонки.Добавить("Постановление");
	ТаблицаХарактеристикИзМакета.Колонки.Добавить("Настройка");
	
	Макет = ПолучитьМакет("Настройки");
	
	ОбластьХарактеристик = Макет.ПолучитьОбласть("ОписаниеНастроекПостановления");
	Для НомерСтроки = 1 По ОбластьХарактеристик.ВысотаТаблицы Цикл
		Постановление = ОбластьХарактеристик.Область(НомерСтроки, 1, НомерСтроки, 1).Текст;
		Настройка     = ОбластьХарактеристик.Область(НомерСтроки, 2, НомерСтроки, 2).Текст;
		
		Если Не ПустаяСтрока(Постановление) И Не ПустаяСтрока(Настройка) Тогда
			НоваяСтрока = ТаблицаХарактеристикИзМакета.Добавить();
			НоваяСтрока.Постановление = Постановление;
			НоваяСтрока.Настройка     = Настройка;
		КонецЕсли;
		
	КонецЦикла;
	
	Возврат ТаблицаХарактеристикИзМакета;
	
КонецФункции // ПолучитьТаблицуНастроекИзМакета()

// Функция возвращает таблицу реквизитов по макету.
//
Функция ПолучитьТаблицуРеквизитовИзМакета() Экспорт
	
	ТаблицаХарактеристикИзМакета = Новый ТаблицаЗначений;
	ТаблицаХарактеристикИзМакета.Колонки.Добавить("Настройка");
	ТаблицаХарактеристикИзМакета.Колонки.Добавить("ИмяРеквизита");
	ТаблицаХарактеристикИзМакета.Колонки.Добавить("Признак");
	
	Макет = ПолучитьМакет("Настройки");
	
	ОбластьХарактеристик = Макет.ПолучитьОбласть("ОписаниеРеквизитовНастроек");
	Для НомерСтроки = 1 По ОбластьХарактеристик.ВысотаТаблицы Цикл
		Настройка    = ОбластьХарактеристик.Область(НомерСтроки, 1, НомерСтроки, 1).Текст;
		ИмяРеквизита = ОбластьХарактеристик.Область(НомерСтроки, 2, НомерСтроки, 2).Текст;
		Признак      = ОбластьХарактеристик.Область(НомерСтроки, 3, НомерСтроки, 3).Текст;
		
		Если Не ПустаяСтрока(ИмяРеквизита) И Не ПустаяСтрока(Настройка) Тогда
			НоваяСтрока = ТаблицаХарактеристикИзМакета.Добавить();
			НоваяСтрока.Настройка    = Настройка;
			НоваяСтрока.ИмяРеквизита = ИмяРеквизита;
			НоваяСтрока.Признак      = Признак;
		КонецЕсли;
		
	КонецЦикла;
	
	Возврат ТаблицаХарактеристикИзМакета;
	
КонецФункции // ПолучитьТаблицуРеквизитовИзМакета()

#КонецОбласти