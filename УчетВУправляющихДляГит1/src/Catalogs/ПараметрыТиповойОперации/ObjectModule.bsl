#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

Процедура ПередЗаписью(Отказ)
	
	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;
	
	Если ПорядокПараметра = 0 Тогда
		ПорядокПараметра = ПолучитьМаксимальныйПорядок()+1;
	КонецЕсли;
	
КонецПроцедуры

Функция ПолучитьМаксимальныйПорядок()

	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ ПЕРВЫЕ 1
		|	ПараметрыТиповойОперации.ПорядокПараметра КАК ПорядокПараметра
		|ИЗ
		|	Справочник.ПараметрыТиповойОперации КАК ПараметрыТиповойОперации
		|ГДЕ
		|	ПараметрыТиповойОперации.Владелец = &Владелец
		|
		|УПОРЯДОЧИТЬ ПО
		|	ПорядокПараметра УБЫВ";
	Запрос.УстановитьПараметр("Владелец", Владелец);
	Выборка = Запрос.Выполнить().Выбрать();
	Если Выборка.Следующий() Тогда
		Возврат Выборка.ПорядокПараметра;
	Иначе
		Возврат 0;
	КонецЕсли;

КонецФункции

#КонецЕсли