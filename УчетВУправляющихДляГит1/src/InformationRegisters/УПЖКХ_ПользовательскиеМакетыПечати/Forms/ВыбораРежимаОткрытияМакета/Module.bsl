
////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ЭЛЕМЕНТОВ ФОРМЫ

#Область ОбработчикиСобытийЭлементовФормы

// Обработчик события "ПрСоздании" при условии создания на стороне сервера.
//
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Значение = ХранилищеОбщихНастроек.Загрузить("НастройкаОткрытияМакетов", 
												"СпрашиватьРежимОткрытияМакета");
	
	Если Значение = Неопределено Тогда
		БольшеНеСпрашивать = Ложь;
	Иначе
		БольшеНеСпрашивать = НЕ Значение;
	КонецЕсли;
	
	Значение = ХранилищеОбщихНастроек.Загрузить("НастройкаОткрытияМакетов", 
												"РежимОткрытияМакетаПросмотр");
	
	Если Значение = Неопределено Тогда
		КакОткрывать = 0;
	Иначе
		Если Значение Тогда
			КакОткрывать = 0;
		Иначе
			КакОткрывать = 1;
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

// Обработчик команды "Ок".
// 
&НаКлиенте
Процедура ОК(Команда)
	
	СпрашиватьРежимОткрытияМакета = НЕ БольшеНеСпрашивать;
	РежимОткрытияМакетаПросмотр = ?(КакОткрывать = 0, Истина, Ложь);
	
	СохранитьНастройкиРежимаОткрытияМакета(СпрашиватьРежимОткрытияМакета, 
										   РежимОткрытияМакетаПросмотр);
	
	Закрыть(Новый Структура("БольшеНеСпрашивать, РежимОткрытияПросмотр",
							БольшеНеСпрашивать,
							РежимОткрытияМакетаПросмотр) );
	
КонецПроцедуры

// Процедура сохраняет насторйки режима открытия макета.
//
&НаСервереБезКонтекста
Процедура СохранитьНастройкиРежимаОткрытияМакета(СпрашиватьРежимОткрытияМакета, РежимОткрытияМакетаПросмотр)
	
	ХранилищеОбщихНастроек.Сохранить("НастройкаОткрытияМакетов", 
									 "СпрашиватьРежимОткрытияМакета",
									 СпрашиватьРежимОткрытияМакета);
	ХранилищеОбщихНастроек.Сохранить("НастройкаОткрытияМакетов", 
									 "РежимОткрытияМакетаПросмотр", 
									 РежимОткрытияМакетаПросмотр);
	
КонецПроцедуры

#КонецОбласти