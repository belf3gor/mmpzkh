
/////////////////////////////////////////////////////////////////////////
// ПОЛУЧЕНИЕ СВЕДЕНИЙ О ФАЙЛЕ

#Область ПолучениеСведенийОФайле

&НаСервере
// Формирует сведения о файле обмена.
//
Функция ПолучитьСведенияОФайлеОбмена(СтруктураОтбора) Экспорт
	
	// Формируем итоговую структуру сведений о файле.
	СтруктураСведенийОФайле = Новый Структура("СохраненныйФайл, РасширениеФайла");
	
	// Заполняем структуру для отбора записи из регистра.
	СтруктураОтбораТекущая = Новый Структура("ДатаОбмена, ВидОбмена");
	ЗаполнитьЗначенияСвойств(СтруктураОтбораТекущая, СтруктураОтбора);
	
	// Получаем искомую запись регистра.
	НайденнаяЗапись = РегистрыСведений.УПЖКХ_ЖурналОбменаСГолосовымиСервисами.Получить(СтруктураОтбораТекущая);
	
	// Заполняем итоговую структуру сведений о файле.
	Если НЕ НайденнаяЗапись = Неопределено Тогда
		
		СохраненныйФайл = НайденнаяЗапись.ФайлОбмена.Получить();
		Расширение      = ПолучитьРасширениеФайлаОбмена(СохраненныйФайл);
		
		СтруктураСведенийОФайле.СохраненныйФайл = СохраненныйФайл;
		СтруктураСведенийОФайле.РасширениеФайла = Расширение;
		
	КонецЕсли;
	
	Возврат СтруктураСведенийОФайле;
	
КонецФункции

&НаСервере
// Определяет расширение сохраненного файла обмена.
//
Функция ПолучитьРасширениеФайлаОбмена(СохраненныйФайл)
	
	ПервыеСимволы = Лев(Base64Строка(СохраненныйФайл), 3);
	
	Расширение = "";
	
	// zip.
	Если ПервыеСимволы = "UEs" Тогда
		Расширение = "zip";
	КонецЕсли;
	
	Возврат Расширение;
	
КонецФункции

#КонецОбласти