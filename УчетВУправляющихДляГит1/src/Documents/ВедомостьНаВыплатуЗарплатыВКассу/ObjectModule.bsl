#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ОбработчикиСобытий

Процедура ОбработкаЗаполнения(ДанныеЗаполнения, СтандартнаяОбработка)
	ВедомостьНаВыплатуЗарплаты.ОбработкаЗаполнения(ЭтотОбъект, ДанныеЗаполнения, СтандартнаяОбработка);
КонецПроцедуры

Процедура ОбработкаПроверкиЗаполнения(Отказ, ПроверяемыеРеквизиты)
	ВедомостьНаВыплатуЗарплаты.ОбработкаПроверкиЗаполнения(ЭтотОбъект, Отказ, ПроверяемыеРеквизиты)	
КонецПроцедуры

Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
	
	Если ЗарплатаКадры.ОтключитьБизнесЛогикуПриЗаписи(ЭтотОбъект) Тогда
		Возврат;
	КонецЕсли;
	
	ВедомостьНаВыплатуЗарплаты.ПередЗаписью(ЭтотОбъект, Отказ, РежимЗаписи); 
	
КонецПроцедуры

Процедура ОбработкаПроведения(Отказ, РежимПроведения)
	ВедомостьНаВыплатуЗарплаты.ОбработкаПроведения(ЭтотОбъект, Отказ);
КонецПроцедуры

Процедура ПриЗаписи(Отказ)
	
	Если ЗарплатаКадры.ОтключитьБизнесЛогикуПриЗаписи(ЭтотОбъект) Тогда
		Возврат;
	КонецЕсли;
	
	ВзаиморасчетыССотрудникамиПереопределяемый.ОбработкаДокументовВыплаты(ЭтотОбъект, Отказ);
	
КонецПроцедуры

Процедура ПриКопировании(ОбъектКопирования)
	
	Руководитель          = "";
	ДолжностьРуководителя = "";
	ГлавныйБухгалтер      = "";
	Бухгалтер             = "";
	Кассир                = "";
	ДолжностьКассира      = "";
	
	НДФЛ.Очистить();
	Для Каждого СтрокаТаблицы ИЗ Зарплата Цикл
		СтрокаТаблицы.ДокументОснование             = "";
		СтрокаТаблицы.КВыплате                      = 0;
		СтрокаТаблицы.КомпенсацияЗаЗадержкуЗарплаты = 0;
		СтрокаТаблицы.ПериодВзаиморасчетов          = ПериодРегистрации
	КонецЦикла;
	
	СвернутьТаблицу = Ложь;
	Для Каждого СтрокаСостава ИЗ Состав Цикл
		МассивСтрок = Зарплата.НайтиСтроки(Новый Структура("ИдентификаторСтроки", СтрокаСостава.ИдентификаторСтроки));
		Если МассивСтрок.Количество() > 1 Тогда
			СвернутьТаблицу = Истина;
			ЗаполнениеПодразделение        = Неопределено;
			ЗаполнениеСтатьяФинансирования = Неопределено;
			ЗаполнениеСтатьяРасходов       = Неопределено;
			Для Каждого СтрокаМассива ИЗ МассивСтрок Цикл
				Если ЗаполнениеПодразделение = Неопределено Тогда
					ЗаполнениеПодразделение = СтрокаМассива.Подразделение;
				КонецЕсли;
				Если ЗаполнениеСтатьяФинансирования = Неопределено Тогда
					ЗаполнениеСтатьяФинансирования = СтрокаМассива.СтатьяФинансирования;
				КонецЕсли;
				Если ЗаполнениеСтатьяРасходов = Неопределено Тогда
					ЗаполнениеСтатьяРасходов = СтрокаМассива.СтатьяРасходов;
				КонецЕсли;
			КонецЦикла;
			Для Каждого СтрокаМассива ИЗ МассивСтрок Цикл
				СтрокаМассива.Подразделение        = ЗаполнениеПодразделение;
				СтрокаМассива.СтатьяФинансирования = ЗаполнениеСтатьяФинансирования;
				СтрокаМассива.СтатьяРасходов       = ЗаполнениеСтатьяРасходов;
			КонецЦикла;
		КонецЕсли;
	КонецЦикла;
	
	Если СвернутьТаблицу Тогда
		ЗарплатаВременная = Зарплата.Выгрузить();
		ЗарплатаВременная.Свернуть("ИдентификаторСтроки, Сотрудник, ФизическоеЛицо, Подразделение,
										|ПериодВзаиморасчетов, СтатьяФинансирования, СтатьяРасходов, ДокументОснование",
									"КВыплате, КомпенсацияЗаЗадержкуЗарплаты");
		Зарплата.Загрузить(ЗарплатаВременная);
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

#Область СценарииЗаполненияДокумента

Функция МожноЗаполнитьЗарплату() Экспорт
	Возврат ВедомостьНаВыплатуЗарплаты.МожноЗаполнитьЗарплату(ЭтотОбъект)
КонецФункции

#КонецОбласти

#Область МестоВыплаты

Функция МестоВыплаты() Экспорт
	Возврат ВедомостьНаВыплатуЗарплаты.МестоВыплатыКасса(ЭтотОбъект);
КонецФункции

Процедура УстановитьМестоВыплаты(Значение) Экспорт
	ВедомостьНаВыплатуЗарплаты.УстановитьМестоВыплатыКасса(ЭтотОбъект, Значение)
КонецПроцедуры

#КонецОбласти

#Область ЗаполнениеДокумента

Процедура ОчиститьВыплаты() Экспорт
	ВедомостьНаВыплатуЗарплаты.ОчиститьВыплаты(ЭтотОбъект);
КонецПроцедуры	

Процедура ЗагрузитьВыплаты(Зарплата, НДФЛ) Экспорт
	ВедомостьНаВыплатуЗарплаты.ЗагрузитьВыплаты(ЭтотОбъект, Зарплата, НДФЛ);
КонецПроцедуры

Процедура ДобавитьВыплаты(Зарплата, НДФЛ) Экспорт
	ВедомостьНаВыплатуЗарплаты.ДобавитьВыплаты(ЭтотОбъект, Зарплата, НДФЛ)
КонецПроцедуры

Процедура УстановитьНДФЛ(НДФЛ, Знач ФизическиеЛица = Неопределено) Экспорт
	ВедомостьНаВыплатуЗарплаты.УстановитьНДФЛ(ЭтотОбъект, НДФЛ, ФизическиеЛица)
КонецПроцедуры

#КонецОбласти

#КонецОбласти

#Область СлужебныйПрограммныйИнтерфейс

#КонецОбласти

#КонецЕсли

#Область ПроцедурыИФункцииЗаполненияДокумента

#КонецОбласти
