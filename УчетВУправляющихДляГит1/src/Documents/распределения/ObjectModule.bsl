
Процедура ОбработкаПроведения(Отказ, Режим)
	Если ТипЗнч(ЭтотОбъект.ХранилищеТЗ.Получить())=тип("ТаблицаЗначений") Тогда
		ТЗ=ЭтотОбъект.ХранилищеТЗ.Получить();
	КонецЕсли;
	
	
	Движения.ПослеРаспределения.Записывать = Истина;
	Для Каждого ТекСтрокаНаборЗаписей Из ТЗ Цикл
		Движение = Движения.ПослеРаспределения.Добавить();
		Движение.ВидДвижения = ВидДвиженияНакопления.Приход;
		Если ЗначениеЗаполнено(ТекСтрокаНаборЗаписей.Дата) тогда 
			Движение.Период = ТекСтрокаНаборЗаписей.Дата;
		Иначе
			Движение.Период = НачДата;
		КонецЕсли;
		Движение.Дата = ТекСтрокаНаборЗаписей.Дата;
		Движение.ОбъектУчета = ТекСтрокаНаборЗаписей.ОбъектУчета;
		Движение.ВидРабот = ВидРабот;
		Движение.КатегорияРабот = ТекСтрокаНаборЗаписей.КатегорияРабот;
		Движение.Организация = ТекСтрокаНаборЗаписей.Организация;
		Движение.НомерНаряда = ТекСтрокаНаборЗаписей.НомерНаряда;
		Движение.МестоПроведенияРабот = ТекСтрокаНаборЗаписей.МестоПроведенияРабот;
		Движение.ЕдИзмерения = ТекСтрокаНаборЗаписей.ЕдИзмерения;
		Движение.ФИО = ТекСтрокаНаборЗаписей.ФИО;
		если ТекСтрокаНаборЗаписей.СтЗатрат = "Оплата труда" Тогда
			Движение.Часы = ТекСтрокаНаборЗаписей.Количество;
		Иначе
			Движение.Количество = ТекСтрокаНаборЗаписей.Количество;
		КонецЕсли;
		
		Движение.Цена = ТекСтрокаНаборЗаписей.Цена;
		Движение.Сумма = ТекСтрокаНаборЗаписей.Сумма;
		Движение.СуммаПослеРаспределения = ТекСтрокаНаборЗаписей.ПослеРаспределения;
		Движение.ЗатратыНа  = ТекСтрокаНаборЗаписей.ЗатратыНа;
		Движение.СтЗатрат  = ТекСтрокаНаборЗаписей.СтЗатрат;
	КонецЦикла;

	КонецПроцедуры
