
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныеПроцедурыИФункции

////////////////////////////////////////////////////////////////////////////////
// Проведение

// Функция возвращает параметры проведения.
Функция ПодготовитьПараметрыПроведения(ДокументСсылка, Отказ) Экспорт

	ПараметрыПроведения = Новый Структура;
	
	Запрос = Новый Запрос;
	
	Запрос.УстановитьПараметр("Ссылка", ДокументСсылка);
	Запрос.Текст =
	"ВЫБРАТЬ
	|	Реквизиты.Ссылка,
	|	Реквизиты.Номер,
	|	Реквизиты.Дата,
	|	Реквизиты.Организация,
	|	Реквизиты.Услуга,
	|	Реквизиты.Объект,
	|	Реквизиты.ВидОперации,
	|	Реквизиты.Комментарий,
	|	Реквизиты.КоличествоДнейНачисления,
	|	Реквизиты.Ответственный,
	|	Реквизиты.СуммаДокумента,
	|	Реквизиты.СтарыйДокумент,
	|	Реквизиты.Период
	|ИЗ
	|	Документ.КВП_РасчетЛьгот КАК Реквизиты
	|ГДЕ
	|	Реквизиты.Ссылка = &Ссылка";
	
	Выборка = Запрос.Выполнить().Выбрать();
	Выборка.Следующий();
	
	Реквизиты = Новый Структура("Ссылка,Номер,Дата,Организация,Услуга,Объект,ВидОперации,
								|Комментарий,КоличествоДнейНачисления,Ответственный,
								|СуммаДокумента,СтарыйДокумент,Период");
	
	ЗаполнитьЗначенияСвойств(Реквизиты, Выборка);
	
	ПараметрыПроведения.Вставить("Реквизиты", Реквизиты);
	
	Если ДокументСсылка.СтарыйДокумент Тогда
		
		Запрос.Текст =
		"ВЫБРАТЬ
		|	РасшифровкаЛьгот.Ссылка,
		|	РасшифровкаЛьгот.НомерСтроки,
		|	РасшифровкаЛьгот.ЛицевыеСчета,
		|	РасшифровкаЛьгот.Услуга,
		|	РасшифровкаЛьгот.Начислено,
		|	РасшифровкаЛьгот.ЛьготнаяКатегория,
		|	РасшифровкаЛьгот.Количество
		|ИЗ
		|	Документ.КВП_РасчетЛьгот.РасшифровкаЛьгот КАК РасшифровкаЛьгот
		|ГДЕ
		|	РасшифровкаЛьгот.Ссылка = &Ссылка";
		
		ТаблицаЛьгот = Запрос.Выполнить().Выгрузить();
	
	Иначе
		
		Запрос.Текст =
		"ВЫБРАТЬ
		|	РасчетЛьгот.Ссылка,
		|	РасчетЛьгот.НомерСтроки,
		|	РасчетЛьгот.ЛицевыеСчета,
		|	РасчетЛьгот.Услуга,
		|	РасчетЛьгот.СоставнаяУслуга,
		|	РасчетЛьгот.ЛьготнаяКатегория,
		|	РасчетЛьгот.Льготник,
		|	РасчетЛьгот.НачалоПериода,
		|	РасчетЛьгот.КонецПериода,
		|	РасчетЛьгот.Тариф,
		|	РасчетЛьгот.ВидТарифа,
		|	РасчетЛьгот.Количество,
		|	РасчетЛьгот.СуммаУслуги,
		|	РасчетЛьгот.Начислено,
		|	РасчетЛьгот.Договор,
		|	РасчетЛьгот.ТарифЛьгота,
		|	РасчетЛьгот.ВидТарифаЛьгота,
		|	РасчетЛьгот.КоличествоЛьгота,
		|	РасчетЛьгот.РазмерСкидки,
		|	РасчетЛьгот.ЛьготнаяПлощадь
		|ИЗ
		|	Документ.КВП_РасчетЛьгот.РасчетЛьгот КАК РасчетЛьгот
		|ГДЕ
		|	РасчетЛьгот.Ссылка = &Ссылка";
		
		ТаблицаЛьгот = Запрос.Выполнить().Выгрузить();
		
	КонецЕсли;
	
	ПараметрыПроведения.Вставить("ТаблицаЛьгот", ТаблицаЛьгот);
	
	Возврат ПараметрыПроведения;
	
КонецФункции

#КонецОбласти

#Область ПроцедурыИФункцииПечати

// Заполняет список команд печати.
// 
// Параметры:
//   КомандыПечати - ТаблицаЗначений - состав полей см. в функции УправлениеПечатью.СоздатьКоллекциюКомандПечати.
//
Процедура ДобавитьКомандыПечати(КомандыПечати) Экспорт
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли