
#Область СлужебныеПроцедурыИФункции

&НаКлиентеНаСервереБезКонтекста
// Процедура обновления итогов.
Процедура ОбновитьИтоги(Форма)
	
	Форма.ИтогоСуммаСтарая    = Форма.ТаблицаРасшифровки.Итог("СуммаСтарая");
	Форма.ИтогоСуммаОтражения = Форма.ТаблицаРасшифровки.Итог("СуммаОтражения");
	//Позолотина++
	Форма.СуммаКоличество = Форма.ТаблицаРасшифровки.Итог("Количество");

КонецПроцедуры

&НаСервере
// Помещает таблицу расшифровки в хранилище.
Функция ПоместитьТаблицуРасшифровкиВХранилище()
	
	Возврат ПоместитьВоВременноеХранилище(ТаблицаРасшифровки.Выгрузить(), Новый УникальныйИдентификатор);
	
КонецФункции

#КонецОбласти

#Область ОбработчикиСобытийФормы

&НаСервере
// Обработчик события "ПриСозданииНаСервере" формы.
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если Параметры.Свойство("АдресВХранилище") Тогда
		ТаблицаИзХранилища = ПолучитьИзВременногоХранилища(Параметры.АдресВХранилище);
		ТаблицаРасшифровки.Загрузить(ТаблицаИзХранилища);
		
		ОбновитьИтоги(ЭтаФорма);
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовФормы

&НаКлиенте
// Обработчик события "ПриОкончанииРедактирования" поля "ТаблицаРасшифровки".
Процедура ТаблицаРасшифровкиПриОкончанииРедактирования(Элемент, НоваяСтрока, ОтменаРедактирования)
	
	ОбновитьИтоги(ЭтаФорма);
	
КонецПроцедуры

&НаКлиенте
// Обработчик события "ПослеУдаления" поля "ТаблицаРасшифровки".
Процедура ТаблицаРасшифровкиПослеУдаления(Элемент)
	
	ОбновитьИтоги(ЭтаФорма);
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

&НаКлиенте
// Обработчик команды "КомандаСохранить".
Процедура КомандаСохранить(Команда)
	
	Закрыть(ПоместитьТаблицуРасшифровкиВХранилище());
	
КонецПроцедуры

#КонецОбласти
