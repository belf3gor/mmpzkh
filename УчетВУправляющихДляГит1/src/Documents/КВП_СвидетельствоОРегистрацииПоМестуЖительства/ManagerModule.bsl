
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПроцедурыИФункцииПечати

////////////////////////////////////////////////////////////////////////////////
// Печать

// Функция возвращает табличный документ на основе форм.
//
Функция ПечатьФорм(МассивОбъектов, ОбъектыПечати, НомерФормы)
	
	РезДокумент = Новый ТабличныйДокумент;
	
	Для Каждого Объект Из МассивОбъектов Цикл
	
		ТабДокумент = Новый ТабличныйДокумент;
		
		Отчет = Отчеты.КВП_ФормыРегистрационногоУчета.Создать();
		
		Отчет.Организация  = Объект.Организация;
		Отчет.Дата         = Объект.Дата;
		Отчет.РазмерБумаги = Перечисления.КВП_РазмерБумаги.А4;
		
		СтрокаТч = Отчет.ТаблицаДляПечати.Добавить();
		
		СтрокаТч.НомерФормы  = НомерФормы;
				
		СтрокаТч.Проживающий = Объект.Проживающий;
		
		ДополнительныеПараметры = Новый Структура;
		
		ДополнительныеПараметры.Вставить("НомерСвидетельства", Объект.Номер);
		
		СтрокаТч.ДопПараметрыПечати = ЗначениеВСтрокуВнутр(ДополнительныеПараметры);
		
		Отчет.ОбновитьОтчет(ТабДокумент);
		
		РезДокумент.Вывести(ТабДокумент);
		
	КонецЦикла;
	
	Возврат РезДокумент;
	
КонецФункции

// Сформировать печатные формы объектов.
//
// ВХОДЯЩИЕ:
//   ИменаМакетов    - Строка    - Имена макетов, перечисленные через запятую.
//   МассивОбъектов  - Массив    - Массив ссылок на объекты которые нужно распечатать.
//   ПараметрыПечати - Структура - Структура дополнительных параметров печати.
//
// ИСХОДЯЩИЕ:
//   КоллекцияПечатныхФорм - Таблица значений - Сформированные табличные документы.
//   ПараметрыВывода       - Структура        - Параметры сформированных табличных документов.
//
Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт
	
	ПараметрыВывода.ДоступнаПечатьПоКомплектно = Истина;
	
	Если УПЖКХ_ТиповыеМетодыСервер.НужноПечататьМакет(КоллекцияПечатныхФорм, "Ф8") Тогда
		УПЖКХ_ТиповыеМетодыСервер.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "Ф8", "Свидетельство о регистрации по месту жительства", ПечатьФорм(МассивОбъектов, ОбъектыПечати, "Ф8"));
	КонецЕсли;
	
	Если УПЖКХ_ТиповыеМетодыСервер.НужноПечататьМакет(КоллекцияПечатныхФорм, "С_Р") Тогда
		УПЖКХ_ТиповыеМетодыСервер.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "С_Р", "Справка о регистрации по месту жительства", ПечатьФорм(МассивОбъектов, ОбъектыПечати, "С_Р"));
	КонецЕсли;
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ПЕЧАТИ

// Заполняет список команд печати.
// 
// Параметры:
//   КомандыПечати - ТаблицаЗначений - состав полей см. в функции УправлениеПечатью.СоздатьКоллекциюКомандПечати.
//
Процедура ДобавитьКомандыПечати(КомандыПечати) Экспорт
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли