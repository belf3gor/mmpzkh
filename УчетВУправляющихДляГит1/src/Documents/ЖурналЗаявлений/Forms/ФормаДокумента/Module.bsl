
&НаКлиенте
Процедура КвартиросъемшикПриИзменении(Элемент)
	физЛицо = Объект.Квартиросъемшик;	
	Объект.АдрессЗаявителя = "";
	Объект.НомТелефона = "";
	найтиТел(физЛицо);
КонецПроцедуры

&НаСервереБезКонтекста
Процедура КвартиросъемшикПриИзмененииНаСервере()
	
КонецПроцедуры

Функция найтиТел(физЛицо)
		Спр = Справочники.ФизическиеЛица;
	КвСьем = Спр.НайтиПоНаименованию(физЛицо);
	Код = КвСьем.Код;
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	               |	ФизическиеЛица.Наименование КАК Наименование,
	               |	ФизическиеЛицаКонтактнаяИнформация.НомерТелефона КАК НомерТел,
	               |	ФизическиеЛицаКонтактнаяИнформация.НомерТелефонаБезКодов,
	               |	ФизическиеЛицаКонтактнаяИнформация.ЗначенияПолей,
	               |	ФизическиеЛицаКонтактнаяИнформация.Представление,
	               |	ФизическиеЛицаКонтактнаяИнформация.Город
	               |ИЗ
	               |	Справочник.ФизическиеЛица.КонтактнаяИнформация КАК ФизическиеЛицаКонтактнаяИнформация
	               |		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ФизическиеЛица КАК ФизическиеЛица
	               |		ПО ФизическиеЛицаКонтактнаяИнформация.Ссылка = ФизическиеЛица.Ссылка
	               |ГДЕ
	               |	ФизическиеЛица.Код = &Код";

		
	Запрос.УстановитьПараметр("Код", Код);
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Если  не ЗначениеЗаполнено(Объект.НомТелефона)тогда
			Объект.НомТелефона = Выборка.Представление; 
		иначе
			Объект.АдрессЗаявителя = Объект.АдрессЗаявителя + Выборка.Представление  +", ";
		КонецЕсли;
		 
	КонецЦикла;

КонецФункции

&НаКлиенте
Процедура АдрессОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)
	Объект.Улица  = "";
	Объект.НомДом = "";
	Объект.НомерКв = "";
	ОбВыбора(ВыбранноеЗначение);
КонецПроцедуры

Функция ОбВыбора(ВыбранноеЗначение)
	Объект.Улица =ВыбранноеЗначение.Родитель; 
	Объект.НомДом =ВыбранноеЗначение.НомерДома;
КонецФункции

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если объект.Дата='00010101'  тогда
		объект.СтатусВыполнения = 2;
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура ПередЗаписью(Отказ, ПараметрыЗаписи)
	Объект.Исп.Очистить();
	объект.СписокИсп = Неопределено; 
	объект.СписокРабот = Неопределено; 
	наСервере();
КонецПроцедуры

процедура наСервере()
	
	
	Для Каждого стр Из исполнитель Цикл
				новаяСтрока = Объект.Исп.Добавить();
        новаяСтрока.Исполнители = стр.Значение;
		объект.СписокИсп = объект.СписокИсп +  стр.Значение + ", ";
	КонецЦикла;
	
	для Каждого стр из объект.ВидыРабот Цикл
		объект.СписокРабот = объект.СписокРабот + стр.Работы + ", ";	
	КонецЦикла;
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	Если ЗначениеЗаполнено(объект.СписокИсп) тогда 
		исполнитель.Очистить();
		для каждого стр из Объект.Исп цикл
			исполнитель.Добавить(стр.Исполнители);
		КонецЦикла;
	КонецЕсли;
КонецПроцедуры
