
//////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

#Область Форма

&НаСервере
// Процедура - обработчик события "ПриСозданииНаСервере" формы.
//
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если Параметры.Свойство("АдресНастроекВХранилище") И Параметры.АдресНастроекВХранилище <> Неопределено Тогда
		
		СтруктураНастроек = ПолучитьИзВременногоХранилища(Параметры.АдресНастроекВХранилище);
		
		Если ТипЗнч(СтруктураНастроек) = Тип("Структура") Тогда
			
			// Восстановление настройки в котором хранится вид отапливаемой площади.
			врВидОтапливаемойПлощади = Неопределено;
			Если СтруктураНастроек.Свойство("ВидОтапливаемойПлощади", врВидОтапливаемойПлощади) Тогда
				ВидОтапливаемойПлощади = врВидОтапливаемойПлощади;
			КонецЕсли;
			
			// Восстановление настройки в котором хранится тип выгружаемого наименования организации.
			врТипВыгружаемогоНаименованияОрганизации = Неопределено;
			Если СтруктураНастроек.Свойство("ТипВыгружаемогоНаименованияОрганизации", врТипВыгружаемогоНаименованияОрганизации) Тогда
				ТипВыгружаемогоНаименованияОрганизации = врТипВыгружаемогоНаименованияОрганизации;
			КонецЕсли;
			
			// Восстановление настройки в котором хранится признак учета пени при формировании файла выгрузки.
			врУчитыватьПени = Неопределено;
			Если СтруктураНастроек.Свойство("УчитыватьПени", врУчитыватьПени) Тогда
				УчитыватьПени = врУчитыватьПени;
			КонецЕсли;
			
			// Восстановление настройки в котором хранится признак учета перерасчетов за текущий месяц начисления при формировании файла выгрузки.
			врУчитыватьПерерасчетыЗаТекущийМесяцНачисления = Неопределено;
			Если СтруктураНастроек.Свойство("УчитыватьПерерасчетыЗаТекущийМесяцНачисления", врУчитыватьПерерасчетыЗаТекущийМесяцНачисления) Тогда
				УчитыватьПерерасчетыЗаТекущийМесяцНачисления = врУчитыватьПерерасчетыЗаТекущийМесяцНачисления;
			КонецЕсли;
			
			// Восстановление настройки, в которой хранится способ получения площадей МОП.
			врСпособПолученияПлощадейМОП = Неопределено;
			Если СтруктураНастроек.Свойство("СпособПолученияПлощадейМОП", врСпособПолученияПлощадейМОП) Тогда
				СпособПолученияПлощадейМОП = врСпособПолученияПлощадейМОП;
			КонецЕсли;
			
			// Восстановление настройки, в которой хранится признак учета задолженностей за месяцы начисления, которые были неоплачены более 36 месяцев.
			врУчитыватьЗадолженностиЗаМесяцыНачисленияСПросрочкойБолее36Месяцев = Неопределено;
			Если СтруктураНастроек.Свойство("УчитыватьЗадолженностиЗаМесяцыНачисленияСПросрочкойБолее36Месяцев", врУчитыватьЗадолженностиЗаМесяцыНачисленияСПросрочкойБолее36Месяцев) Тогда
				УчитыватьЗадолженностиЗаМесяцыНачисленияСПросрочкойБолее36Месяцев = врУчитыватьЗадолженностиЗаМесяцыНачисленияСПросрочкойБолее36Месяцев;
			КонецЕсли;
			
			// Восстановление настройки, в которой хранится выгружаемый реквизит единицы измерения.
			врВКакомВидеВыгружатьСведенияОЕИ = Неопределено;
			Если СтруктураНастроек.Свойство("ВКакомВидеВыгружатьСведенияОЕИ", врВКакомВидеВыгружатьСведенияОЕИ) Тогда
				ВКакомВидеВыгружатьСведенияОЕИ = врВКакомВидеВыгружатьСведенияОЕИ;
			КонецЕсли;
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры // ПриСозданииНаСервере()

#КонецОбласти

//////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ КОМАНД ФОРМЫ

#Область КомандаСохранить

////////////////////
// Сохранить и закрыть

&НаКлиенте
// Обработчик команды "КомандаСохранить".
//
Процедура КомандаСохранить(Команда)
	
	АдресНастроекВХранилище = ПоместитьНастройкиВХранилище();
	Закрыть(АдресНастроекВХранилище);
	
КонецПроцедуры // КомандаСохранить()

////////////////////
// Работа с временным хранилищем

&НаСервере
// Помещает таблицу услуг во временное хранилище.
//
// Возвращаемое значение:
//  Строка - адрес настроек во временном хранилище.
//
Функция ПоместитьНастройкиВХранилище()
	
	СтруктураНастроек = Новый Структура;
	
	СтруктураНастроек.Вставить("УчитыватьПени",                                                     УчитыватьПени);
	СтруктураНастроек.Вставить("УчитыватьПерерасчетыЗаТекущийМесяцНачисления",                      УчитыватьПерерасчетыЗаТекущийМесяцНачисления);
	СтруктураНастроек.Вставить("ВидОтапливаемойПлощади",                                            ВидОтапливаемойПлощади);
	СтруктураНастроек.Вставить("ТипВыгружаемогоНаименованияОрганизации",                            ТипВыгружаемогоНаименованияОрганизации);
	СтруктураНастроек.Вставить("СпособПолученияПлощадейМОП",                                        СпособПолученияПлощадейМОП);
	СтруктураНастроек.Вставить("УчитыватьЗадолженностиЗаМесяцыНачисленияСПросрочкойБолее36Месяцев", УчитыватьЗадолженностиЗаМесяцыНачисленияСПросрочкойБолее36Месяцев);
	СтруктураНастроек.Вставить("ВКакомВидеВыгружатьСведенияОЕИ",                                    ВКакомВидеВыгружатьСведенияОЕИ);
	
	Возврат ПоместитьВоВременноеХранилище(СтруктураНастроек, Новый УникальныйИдентификатор);
	
КонецФункции // ПоместитьНастройкиВХранилище()

#КонецОбласти

