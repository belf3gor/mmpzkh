
#Область ОбработчикиСобытийФормы

&НаСервере
// Происходит востановление настроек, совершенных перед закрытием формы.
//
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	УправлениеФормой(ЭтаФорма);
	
КонецПроцедуры

&НаКлиентеНаСервереБезКонтекста
Процедура УправлениеФормой(Форма)
	
	Элементы = Форма.Элементы;
	
	ПараметрыАккаунта = ОТР_АккаунтыИнтернетСервисовСервер.ПолучитьПараметрыАккаунта();
	Если ПараметрыАккаунта.Свойство("Логин") И Не ПустаяСтрока(ПараметрыАккаунта.Логин) Тогда
		Элементы.Декорация2.Заголовок       = "Подключение выполнено к дополнительным сервисам 
		|для пользователя " + ПараметрыАккаунта.Логин + ".";
		Элементы.КнопкаПодключить.Заголовок = "Отключить";
		Форма.Элементы.Декорация3.Видимость       = Истина;
	Иначе
		Элементы.Декорация2.Заголовок       = "Подключение не выполнено.";
		Элементы.КнопкаПодключить.Заголовок = "Подключить";
		Элементы.Декорация3.Видимость       = Ложь;
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
// Обработчик "ОбработкаОповещения" формы.
//
Процедура ОбработкаОповещения(ИмяСобытия, Параметр, Источник)
	
	Если ИмяСобытия = "ПодключениеВыполнено" Тогда
		УправлениеФормой(ЭтаФорма);
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовФормы

&НаКлиенте
// Открывает форму регистрации.
//
Процедура Подключить(Команда)
	
	Если Элементы.КнопкаПодключить.Заголовок = "Подключить" Тогда
		ОТР_АккаунтыИнтернетСервисовИнтерфейсныеСитуации.ОткрытьФормуПодключенияАккаунтаСервисов();
	Иначе
		// Удаляем данные константы. В эту констану сохранялись данные регистрации.
		ОТР_АккаунтыИнтернетСервисовСервер.СохранитьПараметрыАккаунта("УдалитьДанные");
		Оповестить("ОключитьсяОтАккаунта");
		УправлениеФормой(ЭтаФорма);
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти
