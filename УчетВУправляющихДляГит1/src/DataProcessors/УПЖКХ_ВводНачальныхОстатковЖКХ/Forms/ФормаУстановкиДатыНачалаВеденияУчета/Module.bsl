
&НаКлиенте
// Записывает введенную пользователем дату в реквизит "ДатаВводаОстатков".
//
Процедура ЗаписатьДанные(Отказ = Ложь)
	
	ДанныеДляЗаписи = ДатаНачалаВеденияУчета;
	
	Если ДанныеДляЗаписи = '00010101' Тогда
		Отказ = Истина;
		ПоказатьПредупреждение(, Нстр("ru = 'Укажите дату начала ведения учета в программе!'"));
		Возврат;
	КонецЕсли;
	
	Попытка
		
		Объект.ДатаВводаОстатков = ДатаНачалаВеденияУчета;
		
	Исключение
		
		ПоказатьПредупреждение(, Нстр("ru = 'Операция не может быть выполнена!'"));
		
		Отказ = Истина;
		
		Возврат;
		
	КонецПопытки;
	
	ДатаНачалаВеденияУчета = Объект.ДатаВводаОстатков;
	
КонецПроцедуры // ЗаписатьДанные()

&НаСервере
// Помещает параметры во временное хранилище.
Функция ПоместитьПараметрыВХранилище()
	
	СтруктураПараметров = Новый Структура;
	СтруктураПараметров.Вставить("ДатаВводаОстатков", Объект.ДатаВводаОстатков);
	
	Возврат ПоместитьВоВременноеХранилище(СтруктураПараметров, Новый УникальныйИдентификатор);
	
КонецФункции

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

&НаСервере
// Обработчик события "ПриСозданииНаСервере" формы.
//
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	// Получаем параметры из хранилища.
	Если Параметры.Свойство("АдресНастроекВХранилище") И Не Параметры.АдресНастроекВХранилище = Неопределено Тогда
		
		СтруктураПараметров = ПолучитьИзВременногоХранилища(Параметры.АдресНастроекВХранилище);
		
		Если ТипЗнч(СтруктураПараметров) = Тип("Структура") Тогда
			
			СтруктураПараметров.Свойство("ДатаВводаОстатков", ДатаНачалаВеденияУчета);
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
// Обработчик события нажатия кнопки "Установить".
//
Процедура КомандаУстановитьДату(Команда)
	
	Отказ = Ложь;
	
	ЗаписатьДанные(Отказ);
	
	Если НЕ Отказ Тогда
		Закрыть(ПоместитьПараметрыВХранилище());
	КонецЕсли;
	
КонецПроцедуры
