
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПроцедурыПечати

// Формирует рекламные листовки для жильцов.
Процедура ПечатьРекламныхЛистовок(ПараметрыПечати, АдресРезультата) Экспорт
	
	Макет   = УПЖКХ_ТиповыеМетодыСервер.ПолучитьМакет(ПараметрыПечати.ИмяМакета);
	Область = Макет.ПолучитьОбласть(ПараметрыПечати.ИмяТекущейЛистовки);
	
	Для Каждого ТекущаяОбласть Из Область.Области Цикл
		Если ТипЗнч(ТекущаяОбласть) = Тип("РисунокТабличногоДокумента") Тогда
			ЧастиНаименования = СтрРазделить(ТекущаяОбласть.Имя, "_", Ложь);
			
			Для Каждого ТекущийПараметр Из ПараметрыПечати.ПараметрыЗаполнения Цикл
				Если ЧастиНаименования.Найти(ТекущийПараметр.Ключ) = Неопределено Тогда
					Продолжить;
				КонецЕсли;
				ТекущаяОбласть.Текст = ТекущийПараметр.Значение;
			КонецЦикла;
		КонецЕсли;
	КонецЦикла;
	
	АдресРезультата = ПоместитьВоВременноеХранилище(Область, АдресРезультата);
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли