
#Область ПроцедурыМодуляОбработки

// Возвращает текст запроса по размерам долей собственности л/с.
Функция ПолучитьТекстЗапроса(ТекстФильтра) Экспорт
	
	ТекстЗапроса = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	КВП_ЛицевыеСчета.ЛицевойСчет КАК ЛицевойСчет,
	|	КВП_ЛицевыеСчета.ЛицевойСчет.Адрес КАК Помещение,
	|	КВП_РазмерыДолейЛицевыхСчетов.ДоляЧислитель КАК ДоляЧислитель,
	|	КВП_РазмерыДолейЛицевыхСчетов.ДоляЗнаменатель КАК ДоляЗнаменатель
	|ИЗ
	|	РегистрСведений.КВП_ЛицевыеСчета.СрезПоследних(&Дата, &ТекстФильтра) КАК КВП_ЛицевыеСчета
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КВП_РазмерыДолейЛицевыхСчетов.СрезПоследних(&Дата, &ТекстФильтра)
	|   																	 КАК КВП_РазмерыДолейЛицевыхСчетов
	|	ПО КВП_ЛицевыеСчета.ЛицевойСчет = КВП_РазмерыДолейЛицевыхСчетов.ЛицевойСчет
	|ГДЕ
	|	КВП_ЛицевыеСчета.Действует";
	
	Возврат СтрЗаменить(ТекстЗапроса, "&ТекстФильтра", ТекстФильтра);
	
КонецФункции

// Возвращает выборку сумм площадей комнат по лицевым счетам.
Функция ПолучитьПлощадьКомнатЛС(СписокКомнат) Экспорт
	
	Запрос = Новый Запрос();
	Запрос.УстановитьПараметр("СписокКомнат", СписокКомнат);
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	*
	|ПОМЕСТИТЬ ТаблицаКомнат
	|ИЗ
	|	&СписокКомнат КАК ТаблицаКомнат
	|;
	|///////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ТаблицаКомнат.ЛицевойСчет,
	|	ТаблицаКомнат.Площадь
	|ИЗ
	|	ТаблицаКомнат КАК ТаблицаКомнат
	|ИТОГИ СУММА(Площадь)
	|ПО 
	|	ЛицевойСчет
	|";
	
	Возврат Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.Погруппировкам);
	
КонецФункции

#КонецОбласти