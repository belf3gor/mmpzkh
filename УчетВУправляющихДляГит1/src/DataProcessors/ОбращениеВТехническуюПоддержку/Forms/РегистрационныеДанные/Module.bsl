#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ЗаполнитьЗначенияСвойств(ЭтотОбъект, Параметры, 
		"РегистрационныйНомер, ОрганизацияНаКоторуюПрограммаЗарегистрирована, ИмяПользователя, АдресОтвета, Должность");
	
КонецПроцедуры

&НаСервере
Процедура ОбработкаПроверкиЗаполненияНаСервере(Отказ, ПроверяемыеРеквизиты)
	
	Если ЗначениеЗаполнено(АдресОтвета) И 
		НЕ ОбщегоНазначенияКлиентСервер.АдресЭлектроннойПочтыСоответствуетТребованиям(АдресОтвета) Тогда
		ТекстОшибки = НСтр("ru='Указан некорректный адрес электронной почты.'");
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстОшибки, , "АдресОтвета", , Отказ);
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовФормы

&НаКлиенте
Процедура ОрганизацияНаКоторуюПрограммаЗарегистрированаОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
	Если ТипЗнч(ВыбранноеЗначение) = Тип("СправочникСсылка.Организации") И ЗначениеЗаполнено(ВыбранноеЗначение) Тогда
		ОрганизацияНаКоторуюПрограммаЗарегистрирована = НаименованиеОрганизации(ВыбранноеЗначение);
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура ВыбратьОрганизацию(Команда)
	
	ОткрытьФорму("Справочник.Организации.ФормаВыбора", , Элементы.ОрганизацияНаКоторуюПрограммаЗарегистрирована);
	
КонецПроцедуры

&НаКлиенте
Процедура КомандаОК(Команда)
	
	Если НЕ ПроверитьЗаполнение() Тогда
		Возврат;
	КонецЕсли;
	
	РегистрационныеДанные = Новый Структура;
	РегистрационныеДанные.Вставить("РегистрационныйНомер",                          РегистрационныйНомер);
	РегистрационныеДанные.Вставить("ОрганизацияНаКоторуюПрограммаЗарегистрирована", ОрганизацияНаКоторуюПрограммаЗарегистрирована);
	РегистрационныеДанные.Вставить("ИмяПользователя",                               ИмяПользователя);
	РегистрационныеДанные.Вставить("Должность",                                     Должность);
	РегистрационныеДанные.Вставить("АдресОтвета",                                   АдресОтвета);
	
	Закрыть(РегистрационныеДанные);
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервереБезКонтекста
Функция НаименованиеОрганизации(Организация)
	
	Возврат ОбщегоНазначения.ЗначениеРеквизитаОбъекта(Организация, "НаименованиеСокращенное");
	
КонецФункции

#КонецОбласти