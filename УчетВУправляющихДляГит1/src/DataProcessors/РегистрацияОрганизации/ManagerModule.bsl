#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ОтправкаДанныхВЛичныйКабинет

Процедура ОтправитьДанныеРегистрацииВЛичныйКабинет()
	
	СтруктураДанных = СтруктураДанныхПомощникаДляЛичногоКабинета();
	Если СтруктураДанных = Неопределено Тогда
		Возврат;
	КонецЕсли;
	ОтправитьЗапросВЛичныйКабинет(СтруктураДанных, ИмяМетодаДанныеРегистрации());
	
КонецПроцедуры

Процедура ОтправитьЗапросНаПолучениеКонсультации() Экспорт
	
	ОтправитьЗапросВЛичныйКабинет(Неопределено, ИмяМетодаЗапросКонсультации());
	
КонецПроцедуры

Процедура ОтправитьОписаниеНавигацииВЛичныйКабинет(ОписаниеНавигацииДляЛичногоКабинета)
	
	СтруктураДанных = Новый Структура;
	СтруктураДанных.Вставить("Route", ОписаниеНавигацииДляЛичногоКабинета);
	ОтправитьЗапросВЛичныйКабинет(СтруктураДанных, ИмяМетодаДанныеОНавигации());
	
КонецПроцедуры

#Область ИменаМетодовЛичногоКабинета

Функция ИмяМетодаЗапросКонсультации()
	
	ИмяМетода = "reg_support_request";
	ДобавитьПараметрОбластьДанных(ИмяМетода);
	Возврат ИмяМетода;
	
КонецФункции

Функция ИмяМетодаДанныеОНавигации()
	
	ИмяМетода = "reg_route_update";
	ДобавитьПараметрОбластьДанных(ИмяМетода);
	Возврат ИмяМетода;
	
КонецФункции

Функция ИмяМетодаДанныеРегистрации()
	
	ИмяМетода = "registration";
	ДобавитьПараметрОбластьДанных(ИмяМетода);
	Возврат ИмяМетода;
	
КонецФункции

#КонецОбласти

#Область ИменаШаговДляЛичногоКабинета

Функция ИмяШагаНачалоДляЛичногоКабинета()

	Возврат "Start";

КонецФункции

Функция ИмяШагаФормаБизнесаДляЛичногоКабинета()

	Возврат "BusinessForm";

КонецФункции

Функция ИмяШагаОКВЭДДляЛичногоКабинета()

	Возврат "OKVED";

КонецФункции

Функция ИмяШагаНалогиДляЛичногоКабинета()

	Возврат "TaxSystem";

КонецФункции

Функция ИмяШагаЗаявлениеДляЛичногоКабинета()

	Возврат "Details";

КонецФункции

Функция ИмяШагаПатентДляЛичногоКабинета()

	Возврат "Patent";

КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункцииВзаимодействияСЛичнымКабинетом

Функция ОказываютсяУслугиКонсультации() Экспорт
	
	Возврат Не ПустаяСтрока(Константы.АдресСервисаРегистрации.Получить()) И ОбщегоНазначения.РазделениеВключено();
	
КонецФункции

Функция СтруктураДанныхПомощникаДляЛичногоКабинета()
	
	СтруктураНавигации = СтруктураНавигацииПомощникаРегистрации();
	Если СтруктураНавигации = Неопределено Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	ДанныеПомощникаРегистрации = ДанныеПомощникаРегистрации();
	СтруктураДанных = НовыйСтруктураДанныхРегистрацииДляЛичногоКабинета();
	
	// Считаем, что предыдущий шаг перед открытым - это выполненный этап.
	ПройденныйШаг = НомерШагаПомощника() - 1;
	Если ПройденныйШаг = 0 Тогда
		// Если это первый шаг, то отправляем в личный кабинет пустую структуру.
		СтруктураДанных.Stage = ИмяШагаНачалоДляЛичногоКабинета();
		Возврат СтруктураДанных;
	КонецЕсли;
	
	// Имя шага
	СтруктураШага = СтруктураНавигации[НавигацияПомощниковКлиентСервер.ИмяШага(ПройденныйШаг)];
	СтруктураДанных.Stage = СтруктураШага.ИмяШагаДляЛК;
	
	Для НомерШага = 1 По ПройденныйШаг Цикл
		СтруктураШага = СтруктураНавигации[НавигацияПомощниковКлиентСервер.ИмяШага(НомерШага)];
		Если СтруктураШага.ИмяШагаДляЛК = ИмяШагаФормаБизнесаДляЛичногоКабинета() Тогда
			
			// Форма бизнеса
			ЮридическоеФизическоеЛицо = ДанныеПомощникаРегистрации.ФормаБизнеса.ЮридическоеФизическоеЛицо;
			Если ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо Тогда
				СтруктураДанных.BusinessForm = "ООО";
			ИначеЕсли ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ФизическоеЛицо Тогда
				СтруктураДанных.BusinessForm = "ИП";
			КонецЕсли;
			
		ИначеЕсли СтруктураШага.ИмяШагаДляЛК = ИмяШагаОКВЭДДляЛичногоКабинета() Тогда
			
			// ОКВЭД
			ВидДеятельности = ДанныеПомощникаРегистрации.ВидДеятельности;
			СтруктураДанных.OKVED.Code = ВидДеятельности.ОсновнойКод;
			СтруктураДанных.OKVED.Description = ВидДеятельности.ОсновноеНаименование;
			
		ИначеЕсли СтруктураШага.ИмяШагаДляЛК = ИмяШагаНалогиДляЛичногоКабинета() Тогда
			
			// Система налогообложения
			НалоговыйРежим = ДанныеПомощникаРегистрации.Налоги.ВыбранныйРежим;
			// Очистим выбранный режим от формы собственности.
			НалоговыйРежим = СтрЗаменить(НалоговыйРежим, "ИП", "");
			НалоговыйРежим = СтрЗаменить(НалоговыйРежим, "ООО", "");
			// Приведем налоговый режим к согласованным наименованиям.
			Если НалоговыйРежим = "УСНДоходыРасходы" Тогда
				НалоговыйРежим = "УСНДоходыМинусРасходы";
			ИначеЕсли НалоговыйРежим = "ПСН" Тогда
				НалоговыйРежим = "Патент";
			КонецЕсли;
			СтруктураДанных.TaxSystem = НалоговыйРежим;
			
		ИначеЕсли СтруктураШага.ИмяШагаДляЛК = ИмяШагаЗаявлениеДляЛичногоКабинета() Тогда
			
			// Данные заявления
			Заявление = ДанныеПомощникаРегистрации.Заявление;
			
			Если Заявление.Свойство("СпособРегистрации") Тогда
				СтруктураДанных.RegistrationMethod = Заявление.СпособРегистрации;
			КонецЕсли;
			Если Заявление.Свойство("НаименованиеОрганизации") Тогда
				СтруктураДанных.ShortOrgName = Заявление.НаименованиеОрганизации;
			КонецЕсли;
			Если Заявление.Свойство("ПолноеНаименованиеОрганизации") Тогда
				СтруктураДанных.FullOrgName = Заявление.ПолноеНаименованиеОрганизации;
			КонецЕсли;
			Если Заявление.Свойство("АдресXML") Тогда
				СтруктураДанных.AddressFields = Заявление.АдресXML;
			КонецЕсли;
			// PersonDetail
			Если Заявление.Свойство("Фамилия") Тогда
				СтруктураДанных.PersonDetail.Surname = Заявление.Фамилия;
			КонецЕсли;
			Если Заявление.Свойство("Имя") Тогда
				СтруктураДанных.PersonDetail.Name = Заявление.Имя;
			КонецЕсли;
			Если Заявление.Свойство("Отчество") Тогда
				СтруктураДанных.PersonDetail.MiddleName = Заявление.Отчество;
			КонецЕсли;
			Если Заявление.Свойство("Пол") Тогда
				СтруктураДанных.PersonDetail.Sex = Заявление.Пол;
			КонецЕсли;
			Если Заявление.Свойство("ИНН") Тогда
				СтруктураДанных.PersonDetail.INN = Заявление.ИНН;
			КонецЕсли;
			// Contacts
			Если Заявление.Свойство("Телефон") Тогда
				СтруктураДанных.Contacts.Phone = Заявление.Телефон;
			КонецЕсли;
			Если Заявление.Свойство("Email") Тогда
				СтруктураДанных.Contacts.Email = Заявление.Email;
			КонецЕсли;
			
		КонецЕсли;
	КонецЦикла;
	
	Возврат СтруктураДанных;
	
КонецФункции

Функция НовыйСтруктураДанныхРегистрацииДляЛичногоКабинета()
	
	СтруктураДанных = Новый Структура;
	СтруктураДанных.Вставить("Stage",              "");
	СтруктураДанных.Вставить("BusinessForm",       "");
	СтруктураДанных.Вставить("TaxSystem",          "");
	СтруктураДанных.Вставить("RegistrationMethod", "");
	СтруктураДанных.Вставить("ShortOrgName",       "");
	СтруктураДанных.Вставить("FullOrgName",        "");
	СтруктураДанных.Вставить("AddressFields",      "");
	СтруктураДанных.Вставить("OKVED",              Новый Структура);
	СтруктураДанных.Вставить("PersonDetail",       Новый Структура);
	СтруктураДанных.Вставить("Contacts",           Новый Структура);
	СтруктураДанных.Вставить("Patent",             "");
	
	// OKVED
	СтруктураДанных.OKVED.Вставить("Code", "");
	СтруктураДанных.OKVED.Вставить("Description", "");
	
	// PersonDetail
	СтруктураДанных.PersonDetail.Вставить("Surname", "");
	СтруктураДанных.PersonDetail.Вставить("Name", "");
	СтруктураДанных.PersonDetail.Вставить("MiddleName", "");
	СтруктураДанных.PersonDetail.Вставить("Sex", "");
	СтруктураДанных.PersonDetail.Вставить("INN", "");
	
	// Contacts
	СтруктураДанных.Contacts.Вставить("Phone", "");
	СтруктураДанных.Contacts.Вставить("Email", "");
	Возврат СтруктураДанных;
	
КонецФункции

Процедура ОтправитьЗапросВЛичныйКабинет(СтруктураДанных, ИмяМетода)
	
	// Выполняем отправку данных в личный кабинет с помощью фонового задания.
	// Мы не ждем обратную связь от личного кабинета, поэтому никак не обрабатываем результат.
	// Вся необходимая информация будет записана в журнал регистрации.
	
	ПараметрыПроцедуры = Новый Структура;
	ПараметрыПроцедуры.Вставить("СтруктураДанных", СтруктураДанных);
	ПараметрыПроцедуры.Вставить("ИмяМетода", ИмяМетода);
	
	ПараметрыВыполненияВФоне = ДлительныеОперации.ПараметрыВыполненияВФоне(Новый УникальныйИдентификатор);
	ПараметрыВыполненияВФоне.ЗапуститьВФоне = Истина;
	
	ДлительныеОперации.ВыполнитьВФоне(
		"Обработки.РегистрацияОрганизации.ОтправитьЗапросВЛичныйКабинетВФоне",
		ПараметрыПроцедуры,
		ПараметрыВыполненияВФоне)
	
КонецПроцедуры

Процедура ОтправитьЗапросВЛичныйКабинетВФоне(Параметры, АдресРезультата) Экспорт
	
	ПараметрыСоединения = ПараметрыСоединения();
	Если ПараметрыСоединения = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	Соединение = СоединениеССерверомРегистрации(ПараметрыСоединения);
	Если Соединение = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	ПутьНаСервере = ПараметрыСоединения.ПутьНаСервере + ?(Прав(ПараметрыСоединения.ПутьНаСервере, 1) = "/", "", "/");
	Запрос = Новый HTTPЗапрос(ПутьНаСервере + Параметры.ИмяМетода);
	Если Параметры.СтруктураДанных <> Неопределено Тогда
		Запрос.УстановитьТелоИзСтроки(СтруктураВJSON(Параметры.СтруктураДанных));
	КонецЕсли;
	Ответ = Соединение.ВызватьHTTPМетод("POST", Запрос);
	
	ЗаписатьИнформациюВЖурналРегистрации(Ответ)
	
КонецПроцедуры

Процедура ЗаписатьИнформациюВЖурналРегистрации(Ответ)
	
	Если Ответ.КодСостояния = 200 Тогда
		ПараметрыОтвета = JSONВСтруктуру(Ответ.ПолучитьТелоКакСтроку());
		ЗаписьЖурналаРегистрации(
			ИмяСобытияЖурналаРегистрации(),
			УровеньЖурналаРегистрации.Информация,,,НСтр("ru='Успешная синхронизация с личным кабинетом.'"));
	ИначеЕсли Ответ.КодСостояния = 400 Тогда
		ПараметрыОтвета = JSONВСтруктуру(Ответ.ПолучитьТелоКакСтроку());
		Если ПараметрыОтвета.Свойство("error") Тогда
			ТекстОшибки = СтрШаблон(НСтр("ru='Код ошибки: %1. Описание ошибки: %2'"),ПараметрыОтвета.error.code, ПараметрыОтвета.error.text);
		Иначе
			ТекстОшибки = НСтр("ru='Неизвестная ошибка'");
		КонецЕсли;
		ЗаписьЖурналаРегистрации(
			ИмяСобытияЖурналаРегистрации(),
			УровеньЖурналаРегистрации.Информация,,,ТекстОшибки);
	Иначе
		ЗаписьЖурналаРегистрации(
			ИмяСобытияЖурналаРегистрации(),
			УровеньЖурналаРегистрации.Ошибка,,, Ответ.ПолучитьТелоКакСтроку());
	КонецЕсли;
	
КонецПроцедуры

Процедура ДобавитьПараметрОбластьДанных(ИмяМетода)
	
	РазделительСеанса = ОбщегоНазначения.ЗначениеРазделителяСеанса();
	ИмяМетода = ИмяМетода + СтрШаблон("?app=%1", Формат(РазделительСеанса, "ЧГ=0"));
	
КонецПроцедуры

Функция JSONВСтруктуру(СтрокаJSON)
	
	ЧтениеJSON = Новый ЧтениеJSON;
	ЧтениеJSON.УстановитьСтроку(СтрокаJSON);
	Структура = ПрочитатьJSON(ЧтениеJSON);
	ЧтениеJSON.Закрыть();
	
	Возврат Структура;
	
КонецФункции

Функция СтруктураВJSON(Структура)
	
	ЗаписьJSON = Новый ЗаписьJSON;
	ЗаписьJSON.УстановитьСтроку();
	ЗаписатьJSON(ЗаписьJSON, Структура);
	
	Возврат ЗаписьJSON.Закрыть();
	
КонецФункции

Функция ПараметрыСоединения()
	
	АдресСервиса = Константы.АдресСервисаРегистрации.Получить();
	Если НЕ ЗначениеЗаполнено(АдресСервиса) Тогда
		Возврат Неопределено;
	КонецЕсли;
	Логин = Константы.ИмяПользователяСервисаРегистрации.Получить();
	Если НЕ ЗначениеЗаполнено(Логин) Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	ПараметрыСоединения = ОбщегоНазначенияКлиентСервер.СтруктураURI(АдресСервиса);
	ПараметрыСоединения.Схема = ?(ЗначениеЗаполнено(ПараметрыСоединения.Схема), ПараметрыСоединения.Схема, "http");
	ПараметрыСоединения.Вставить("Прокси", ПолучениеФайловИзИнтернетаКлиентСервер.ПолучитьПрокси(ПараметрыСоединения.Схема));
	ПараметрыСоединения.Вставить("Таймаут", 20);
	ПараметрыСоединения.Вставить("Логин", Логин);
	
	УстановитьПривилегированныйРежим(Истина);
	ПараметрыСоединения.Вставить("Пароль", ОбщегоНазначения.ПрочитатьДанныеИзБезопасногоХранилища(
		Логин, "ПарольПользователяСервисаРегистрации", Истина));
	УстановитьПривилегированныйРежим(Ложь);
	
	Возврат ПараметрыСоединения;
	
КонецФункции

Функция СоединениеССерверомРегистрации(ПараметрыСоединения)
	
	Соединение = Неопределено;
	
	Попытка
		Соединение = Новый HTTPСоединение(
			ПараметрыСоединения.Хост,
			ПараметрыСоединения.Порт,
			ПараметрыСоединения.Логин,
			ПараметрыСоединения.Пароль, 
			ПараметрыСоединения.Прокси,
			ПараметрыСоединения.Таймаут,
			?(НРег(ПараметрыСоединения.Схема) = "http", Неопределено, Новый ЗащищенноеСоединениеOpenSSL));
	Исключение
		ИнформацияОбОшибке = ИнформацияОбОшибке();
		ЗаписьЖурналаРегистрации(
			ИмяСобытияЖурналаРегистрации(),
			УровеньЖурналаРегистрации.Ошибка,,,
			ПодробноеПредставлениеОшибки(ИнформацияОбОшибке));
		ВызватьИсключение;
	КонецПопытки;
	
	Возврат Соединение;
	
КонецФункции

Функция ИмяСобытияЖурналаРегистрации()

	Возврат НСтр("ru = 'Регистрация организации.Личный кабинет'", ОбщегоНазначения.КодОсновногоЯзыка());

КонецФункции

#КонецОбласти

#КонецОбласти

#Область ХранениеДанных

// Функция возвращает структуру с данными помощника регистрации.
// 
// Возвращаемое значение:
//    Структура - см. НовыйСтруктураДанныхПомощникаРегистрации().
//
Функция ДанныеПомощникаРегистрации() Экспорт
	
	Возврат ОбщегоНазначения.ХранилищеОбщихНастроекЗагрузить(
		ИмяКлючаНастроек(),
		ИмяКлючаДанныеПомощникаРегистрации(),
		НовыйСтруктураДанныхПомощникаРегистрации());
	
КонецФункции

Процедура УдалитьДанныеПомощникаРегистрации() Экспорт
	
	ОбщегоНазначения.ХранилищеОбщихНастроекУдалить(
		ИмяКлючаНастроек(),
		ИмяКлючаДанныеПомощникаРегистрации(),
		Неопределено);
	
КонецПроцедуры

// Функция возвращает структуру с данными заявления помощника регистрации.
// 
// Возвращаемое значение:
//    Структура.
//
Функция НовыйДанныеЗаявления() Экспорт

	ДанныеЗаявления = Новый Структура;
	ДанныеЗаявления.Вставить("СпособРегистрации",             "");
	ДанныеЗаявления.Вставить("Ссылка",                        Справочники.Организации.ПустаяСсылка());
	ДанныеЗаявления.Вставить("НаименованиеОрганизации",       "");
	ДанныеЗаявления.Вставить("ПолноеНаименованиеОрганизации", "");
	ДанныеЗаявления.Вставить("Фамилия",                       "");
	ДанныеЗаявления.Вставить("Имя",                           "");
	ДанныеЗаявления.Вставить("Отчество",                      "");
	ДанныеЗаявления.Вставить("Пол",                           "");
	ДанныеЗаявления.Вставить("ИНН",                           "");
	ДанныеЗаявления.Вставить("Телефон",                       "");
	ДанныеЗаявления.Вставить("Email",                         "");
	ДанныеЗаявления.Вставить("АдресXML"                       "");
	
	Возврат ДанныеЗаявления;
	
КонецФункции

// Функция возвращает название способа регистрации в виде строки:
// Параметры:
//    СпособРегистрации - Число
// Возвращаемое значение:
//    Строка - Одно из значений - "Почтой", "Представитель" или "Лично"
//
Функция НазваниеСпособаРегистрации(СпособРегистрации) Экспорт
	
	Если СпособРегистрации = 3 Тогда
		НазваниеСпособаРегистрации = "Почтой";
	ИначеЕсли СпособРегистрации = 2 Тогда
		НазваниеСпособаРегистрации = "Представитель";
	Иначе
		НазваниеСпособаРегистрации = "Лично";
	КонецЕсли;
	Возврат НазваниеСпособаРегистрации;
	
КонецФункции

Функция НовыйСтруктураДанныхПомощникаРегистрации()
	
	ДанныеПомощникаРегистрации = Новый Структура;
	ДанныеПомощникаРегистрации.Вставить("Модифицированность", Ложь);
	ДанныеПомощникаРегистрации.Вставить("ФормаБизнеса",       Новый Структура);
	ДанныеПомощникаРегистрации.Вставить("ВидДеятельности",    Новый Структура);
	ДанныеПомощникаРегистрации.Вставить("Налоги",             Новый Структура);
	ДанныеПомощникаРегистрации.Вставить("Заявление",          НовыйДанныеЗаявления());
	
	// Форма бизнеса
	ДанныеПомощникаРегистрации.ФормаБизнеса.Вставить("ЮридическоеФизическоеЛицо");
	
	// Вид деятельности
	ДанныеПомощникаРегистрации.ВидДеятельности.Вставить("ОсновнойКод",          "");
	ДанныеПомощникаРегистрации.ВидДеятельности.Вставить("ОсновноеНаименование", "");
	ДанныеПомощникаРегистрации.ВидДеятельности.Вставить("ДополнительныеКоды",   "");
	ДанныеПомощникаРегистрации.ВидДеятельности.Вставить("ВыбранныеКодыОКВЭД",   Новый СписокЗначений);
	// Налогообложение
	ДанныеПомощникаРегистрации.Налоги.Вставить("СтруктураУчетнойПолитики", Новый Структура);
	ДанныеПомощникаРегистрации.Налоги.Вставить("ВыбранныйРежим",           "");
	
	ДанныеПомощникаРегистрации.Налоги.Вставить("КодРегионаРегистрации", "");
	
	// Патент
	ДанныеПомощникаРегистрации.Вставить("Патент", Новый Структура);
	
	МетаданныеОбработки = Метаданные.Обработки.ПомощникЗаполненияЗаявленияНаПолучениеПатента;
	
	РеквизитыПатента = МетаданныеОбработки.Реквизиты;
	Для Каждого ТекРеквизит Из РеквизитыПатента Цикл
		ДанныеПомощникаРегистрации.Патент.Вставить(ТекРеквизит.Имя, ТекРеквизит.Тип.ПривестиЗначение());
	КонецЦикла;
	
	ТабличныеЧасти = МетаданныеОбработки.ТабличныеЧасти;
	Для Каждого ТекТабличнаяЧасть Из ТабличныеЧасти Цикл
		ДанныеПомощникаРегистрации.Патент.Вставить(ТекТабличнаяЧасть.Имя, Новый ТаблицаЗначений);
	КонецЦикла;
	
	ДанныеПомощникаРегистрации.Патент.Вставить("ПропуститьШаг", Истина);
	
	Возврат ДанныеПомощникаРегистрации;
	
КонецФункции

Процедура СохранитьДанныеПомощникаРегистрации(ДанныеПомощникаРегистрации)

	ОбщегоНазначения.ХранилищеОбщихНастроекСохранить(
		ИмяКлючаНастроек(),
		ИмяКлючаДанныеПомощникаРегистрации(),
		ДанныеПомощникаРегистрации);
	
КонецПроцедуры

// Сохраняет данные шага "Заявление".
// Параметры:
//    Заявление - Структура - см. НовыйДанныеЗаявления().
//
Процедура СохранитьДанныеЗаявления(Заявление) Экспорт
	
	ДанныеПомощникаРегистрации = ДанныеПомощникаРегистрации();
	
	Если НЕ ОбщегоНазначения.ДанныеСовпадают(ДанныеПомощникаРегистрации.Заявление, Заявление) Тогда
		ЗаполнитьЗначенияСвойств(ДанныеПомощникаРегистрации.Заявление, Заявление);
		СохранитьДанныеПомощникаРегистрации(ДанныеПомощникаРегистрации);
	КонецЕсли;
	
КонецПроцедуры

// Сохраняет данные шага "Налоги".
// Параметры:
//    Налоги - Структура - см. НовыйСтруктураДанныхПомощникаРегистрации().
//
Процедура СохранитьДанныеНалоги(Налоги) Экспорт
	
	ДанныеПомощникаРегистрации = ДанныеПомощникаРегистрации();
	Если НЕ ОбщегоНазначения.ДанныеСовпадают(ДанныеПомощникаРегистрации.Налоги, Налоги) Тогда
		ДанныеПомощникаРегистрации.Модифицированность = Истина;
		ЗаполнитьЗначенияСвойств(ДанныеПомощникаРегистрации.Налоги, Налоги);
		СохранитьДанныеПомощникаРегистрации(ДанныеПомощникаРегистрации);
	КонецЕсли;
	
КонецПроцедуры

// Сохраняет основной код ОКВЭД, если помощник начинается с шага "Налоги".
// 
// Параметры:
//    ОКВЭД - Структура - с ключами Код и наименование.
//
Процедура СохранитьОсновнойОКВЭД(ОКВЭД) Экспорт
	
	ДанныеПомощникаРегистрации = ДанныеПомощникаРегистрации();
	
	Если ДанныеПомощникаРегистрации.ВидДеятельности.ОсновнойКод <> ОКВЭД.Код 
		ИЛИ ДанныеПомощникаРегистрации.ВидДеятельности.ОсновнойКод <> ОКВЭД.Наименование Тогда
		
		ДанныеПомощникаРегистрации.Модифицированность = Истина;
		ДанныеПомощникаРегистрации.ВидДеятельности.ОсновнойКод = ОКВЭД.Код;
		ДанныеПомощникаРегистрации.ВидДеятельности.ОсновноеНаименование = ОКВЭД.Наименование;
		ДанныеПомощникаРегистрации.ВидДеятельности.ВыбранныеКодыОКВЭД.Добавить(ОКВЭД.Код);
		СохранитьДанныеПомощникаРегистрации(ДанныеПомощникаРегистрации);
	КонецЕсли;
КонецПроцедуры

// Сохраняет данные шага "ФормаБизнеса".
// 
// Параметры:
//    ЮридическоеФизическоеЛицо - Перечисление.ЮридическоеФизическоеЛицо.
//
Процедура СохранитьДанныеФормаБизнеса(ЮридическоеФизическоеЛицо) Экспорт
	
	ДанныеПомощникаРегистрации = ДанныеПомощникаРегистрации();
	Если ДанныеПомощникаРегистрации.ФормаБизнеса.ЮридическоеФизическоеЛицо <> ЮридическоеФизическоеЛицо Тогда
		ДанныеПомощникаРегистрации.Модифицированность = Истина;
		ДанныеПомощникаРегистрации.ФормаБизнеса.ЮридическоеФизическоеЛицо = ЮридическоеФизическоеЛицо;
		СохранитьДанныеПомощникаРегистрации(ДанныеПомощникаРегистрации);
	КонецЕсли;
	
КонецПроцедуры

// Сохраняет данные шага "Патент".
// Параметры:
//    Патент - Структура - см. НовыйСтруктураДанныхПомощникаРегистрации().
//
Процедура СохранитьДанныеПатент(Патент) Экспорт
	
	ДанныеПомощникаРегистрации = ДанныеПомощникаРегистрации();
	СтруктураПатент = Неопределено;
	
	Если Не ДанныеПомощникаРегистрации.Свойство("Патент", СтруктураПатент)
		Или СтруктураПатент = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	Если НЕ ОбщегоНазначения.ДанныеСовпадают(ДанныеПомощникаРегистрации.Патент, Патент) Тогда
		ДанныеПомощникаРегистрации.Модифицированность = Истина;
		ЗаполнитьЗначенияСвойств(ДанныеПомощникаРегистрации.Патент, Патент);
		СохранитьДанныеПомощникаРегистрации(ДанныеПомощникаРегистрации);
	КонецЕсли;
	
КонецПроцедуры

// Сохраняет данные шага "Вид деятельности".
//
// Параметры:
//    ДанныеОКВЭД - Структура - см. НовыйСтруктураДанныхПомощникаРегистрации().
//
Процедура СохранитьДанныеОКВЭД(ДанныеОКВЭД) Экспорт
	
	ДанныеПомощникаРегистрации = ДанныеПомощникаРегистрации();
	Если НЕ ОбщегоНазначения.ДанныеСовпадают(ДанныеПомощникаРегистрации.ВидДеятельности, ДанныеОКВЭД) Тогда
		ДанныеПомощникаРегистрации.Модифицированность = Истина;
		ЗаполнитьЗначенияСвойств(ДанныеПомощникаРегистрации.ВидДеятельности, ДанныеОКВЭД);
		СохранитьДанныеПомощникаРегистрации(ДанныеПомощникаРегистрации);
	КонецЕсли;
	
КонецПроцедуры

Процедура СохранитьНомерШага(НомерШага)
	
	ОбщегоНазначения.ХранилищеОбщихНастроекСохранить(
		ИмяКлючаНастроек(),
		ИмяКлючаНомерШагаПомощника(),
		НомерШага);
	
КонецПроцедуры 

Функция ИмяКлючаНомерШагаПомощника()
	
	Возврат "НомерШага";
	
КонецФункции

Функция ИмяКлючаДанныеПомощникаРегистрации()

	Возврат "ДанныеПомощникаРегистрации";

КонецФункции

Функция ИмяКлючаНастроек()
	
	Возврат "ПомощникРегистрации";
	
КонецФункции

#КонецОбласти

#Область Навигация

// Размещает на форме элементы навигации по помощнику регистрации.
// 
// Параметры:
//
// Форма - Управляемая форма.
// Параметры - Структура - Структура параметров формы.
//
Процедура РазместитьНавигацию(Форма, Параметры = Неопределено) Экспорт
	
	СтруктураНавигацииПомощника = СтруктураНавигацииПомощникаРегистрации();
	
	Если СтруктураНавигацииПомощника <> Неопределено Тогда
		НавигацияПомощников.РазместитьНавигацию(Форма, СтруктураНавигацииПомощника, Параметры);
		Если Форма.НавигацияНомерШага <> 0 Тогда
			СохранитьНомерШага(Форма.НавигацияНомерШага);
			ОтправитьДанныеРегистрацииВЛичныйКабинет();
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

// Процедура создает и сохраняет маршрут помощника регистрации
// в зависимости от переданного параметра. Обязательно должен быть передан один из двух параметров.
// 
// Параметры:
//  ПараметрЗапускаПомощника - Строка - Параметр запуска приложения, в зависимости от которого формируется маршрут.
//
Функция ПодготовитьСтруктуруНавигацииПомощникаРегистрации(ПараметрЗапускаПомощника = "") Экспорт
	
	Если ВРег(ПараметрЗапускаПомощника) = ВРег(ИмяВыборВидаДеятельности()) Тогда
		НавигацияПомощника = НавигацияПомощникаВыбораОКВЭД();
	ИначеЕсли ВРег(ПараметрЗапускаПомощника) = ВРег(ИмяВыборСистемыНалогообложения()) Тогда
		НавигацияПомощника = НавигацияПомощникаВыбораСистемыНалогообложения();
	ИначеЕсли ВРег(ПараметрЗапускаПомощника) = ВРег(ИмяТестИПИлиООО()) Тогда
		НавигацияПомощника = НавигацияПомощникаВыбораОрганизационноПравовойФормы();
	Иначе
		НавигацияПомощника = НавигацияПомощникаРегистрации();
	КонецЕсли;
	
	Если НавигацияПомощника <> Неопределено Тогда
		
		ОбщегоНазначения.ХранилищеОбщихНастроекСохранить(
			ИмяКлючаНастроек(),
			ИмяКлючаСтруктураНавигации(),
			НавигацияПомощника.Структура);
			
		Если Не ПустаяСтрока(НавигацияПомощника.Описание) Тогда
			ОтправитьОписаниеНавигацииВЛичныйКабинет(НавигацияПомощника.Описание);
		КонецЕсли;
		
	КонецЕсли;
	
	Возврат НавигацияПомощника;
	
КонецФункции

Функция НавигацияПомощникаРегистрации()
	
	СтруктураНавигации = НавигацияПомощников.НовыйСтруктураНавигации();
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(1), СтруктураШагаФормаБизнеса(1));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(2), СтруктураШагаОКВЭД(2));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(3), СтруктураШагаРежимНалогообложения(3));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(4), СтруктураШагаЗаявление(4));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(5), СтруктураШагаДокументы(5));
	
	ИменаШагов = Новый Массив;
	ИменаШагов.Добавить(ИмяШагаФормаБизнесаДляЛичногоКабинета());
	ИменаШагов.Добавить(ИмяШагаОКВЭДДляЛичногоКабинета());
	ИменаШагов.Добавить(ИмяШагаНалогиДляЛичногоКабинета());
	ИменаШагов.Добавить(ИмяШагаЗаявлениеДляЛичногоКабинета());
	СтруктураНавигации.Описание = СтрСоединить(ИменаШагов, ",");
	
	Возврат СтруктураНавигации;
	
КонецФункции

Функция НавигацияПомощникаВыбораОКВЭД()
	
	СтруктураНавигации = НавигацияПомощников.НовыйСтруктураНавигации();
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(1), СтруктураШагаОКВЭД(1));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(2), СтруктураШагаФормаБизнеса(2));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(3), СтруктураШагаРежимНалогообложения(3));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(4), СтруктураШагаЗаявление(4));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(5), СтруктураШагаДокументы(5));
	
	ИменаШагов = Новый Массив;
	ИменаШагов.Добавить(ИмяШагаОКВЭДДляЛичногоКабинета());
	ИменаШагов.Добавить(ИмяШагаФормаБизнесаДляЛичногоКабинета());
	ИменаШагов.Добавить(ИмяШагаНалогиДляЛичногоКабинета());
	ИменаШагов.Добавить(ИмяШагаЗаявлениеДляЛичногоКабинета());
	СтруктураНавигации.Описание = СтрСоединить(ИменаШагов, ",");
	
	Возврат СтруктураНавигации;
	
КонецФункции

Функция НавигацияПомощникаВыбораСистемыНалогообложения()
	
	СтруктураНавигации = НавигацияПомощников.НовыйСтруктураНавигации();
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(1), СтруктураШагаРежимНалогообложения(1, "РежимНалогообложенияИФормаБизнеса"));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(2), СтруктураШагаФормаБизнеса(2, "ПодтвердитьФормуБизнеса"));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(3), СтруктураШагаОКВЭД(3));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(4), СтруктураШагаЗаявление(4));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(5), СтруктураШагаДокументы(5));
	
	ИменаШагов = Новый Массив;
	ИменаШагов.Добавить(ИмяШагаНалогиДляЛичногоКабинета());
	ИменаШагов.Добавить(ИмяШагаФормаБизнесаДляЛичногоКабинета());
	ИменаШагов.Добавить(ИмяШагаОКВЭДДляЛичногоКабинета());
	ИменаШагов.Добавить(ИмяШагаЗаявлениеДляЛичногоКабинета());
	СтруктураНавигации.Описание = СтрСоединить(ИменаШагов, ",");
	
	Возврат СтруктураНавигации;
	
КонецФункции

Функция НавигацияПомощникаВыбораОрганизационноПравовойФормы()
	
	СтруктураНавигации = НавигацияПомощников.НовыйСтруктураНавигации();
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(1), СтруктураШагаФормаБизнеса(1, "ПройтиТест"));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(2), СтруктураШагаОКВЭД(2));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(3), СтруктураШагаРежимНалогообложения(3));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(4), СтруктураШагаЗаявление(4));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(5), СтруктураШагаДокументы(5));
	
	ИменаШагов = Новый Массив;
	ИменаШагов.Добавить(ИмяШагаФормаБизнесаДляЛичногоКабинета());
	ИменаШагов.Добавить(ИмяШагаОКВЭДДляЛичногоКабинета());
	ИменаШагов.Добавить(ИмяШагаНалогиДляЛичногоКабинета());
	ИменаШагов.Добавить(ИмяШагаЗаявлениеДляЛичногоКабинета());
	СтруктураНавигации.Описание = СтрСоединить(ИменаШагов, ",");
	
	Возврат СтруктураНавигации;
	
КонецФункции

Функция СтруктураНавигацииПомощникаИзмененийЕГР() Экспорт
	
	СтруктураНавигации = НавигацияПомощников.НовыйСтруктураНавигации();
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(1), СтруктураШагаСписокИзмененийЕГР(1));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(2), СтруктураШагаЗаявлениеДляИзмененияЕГР(2));
	СтруктураНавигации.Структура.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(3), СтруктураШагаДокументыДляИзмененияЕГР(3));
	
	Возврат СтруктураНавигации;
	
КонецФункции

// Функция возвращает сохраненную ранее структуру навигации.
//
Функция СтруктураНавигацииПомощникаРегистрации() Экспорт
	
	СтруктураНавигацииПомощника = ОбщегоНазначения.ХранилищеОбщихНастроекЗагрузить(
		ИмяКлючаНастроек(),
		ИмяКлючаСтруктураНавигации());
		
	Если СтруктураНавигацииПомощника <> Неопределено Тогда
		Для Каждого КлючИЗначение Из СтруктураНавигацииПомощника Цикл
			СтруктураШага = КлючИЗначение.Значение;
			Если СтруктураШага.ОпределятьИмяФормы Тогда
				ПараметрыФормы = СтруктураШага.СтруктураПараметровФормы;
				СтруктураШага.ИмяФормы = ИмяФормыШага(ПараметрыФормы.НавигацияПараметрФормы);
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
	
	Возврат СтруктураНавигацииПомощника;
	
КонецФункции

// Функция возвращает имя формы, которую нужно открыть для этого параметра.
// Используется в случае, если одному шагу может соответствовать несколько форм.
//
// Параметры:
//    НавигацияПараметрФормы - Строка - Параметр навигации шага для которого нужно определить форму.
//
// Возвращаемое значение:
//    ИмяФормы - Строка - Имя формы, которую нужно открыть.
//
Функция ИмяФормыШага(НавигацияПараметрФормы)
	
	ИмяФормыШага = "";
	ДанныеПомощникаРегистрации = ДанныеПомощникаРегистрации();
	Если НавигацияПараметрФормы = "Документы"
		ИЛИ НавигацияПараметрФормы = "Заявление" Тогда
		
		ЮридическоеФизическоеЛицо = ДанныеПомощникаРегистрации.ФормаБизнеса.ЮридическоеФизическоеЛицо;
		Если ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо Тогда
			ИмяФормыШага = ИмяФормыЗаявлениеООО();
		Иначе
			ИмяФормыШага = ИмяФормыЗаявлениеИП();
		КонецЕсли;
		
	КонецЕсли;
	
	Возврат ИмяФормыШага;
	
КонецФункции

// Функция возвращает номер последнего показанного шага.
// Используется для того, чтобы открыть тот же шаг при повторном запуске.
//
// Возвращаемое значение:
//    Число - Номер шага.
Функция НомерШагаПомощника() Экспорт
	
	НомерШага = ОбщегоНазначения.ХранилищеОбщихНастроекЗагрузить(
		ИмяКлючаНастроек(),
		ИмяКлючаНомерШагаПомощника());
	
	Если Не ЗначениеЗаполнено(НомерШага) Тогда
		НомерШага = 1;
	КонецЕсли;
	
	Возврат НомерШага;
	
КонецФункции

#Область ИменаФорм

Функция ИмяФормыЗаявлениеИП()
	
	Возврат "Обработка.РегистрацияОрганизации.Форма.РегистрацияИП";
	
КонецФункции

Функция ИмяФормыЗаявлениеООО()
	
	Возврат "Обработка.РегистрацияОрганизации.Форма.РегистрацияООО";
	
КонецФункции

#КонецОбласти

#Область ОписаниеШагов

Функция СтруктураШагаФормаБизнеса(НомерШага, НавигацияПараметрФормы = "ФормаБизнеса")
	
	СтруктураШага                = НавигацияПомощников.НовыйСтруктураШага();
	СтруктураШага.ИмяПомощника   = РегистрацияОрганизацииКлиентСервер.ИмяПомощникаРегистрации();
	СтруктураШага.НомерШага      = НомерШага;
	СтруктураШага.ИмяФормы       = "Обработка.РегистрацияОрганизации.Форма.ТестИПилиООО";
	СтруктураШага.ТекстНавигации = НСтр("ru='Форма бизнеса'");
	СтруктураШага.ИмяШагаДляЛК   = ИмяШагаФормаБизнесаДляЛичногоКабинета();
	СтруктураШага.СтруктураПараметровФормы.НавигацияПараметрФормы = НавигацияПараметрФормы;
	Возврат СтруктураШага;
	
КонецФункции

Функция СтруктураШагаОКВЭД(НомерШага)
	
	СтруктураШага                = НавигацияПомощников.НовыйСтруктураШага();
	СтруктураШага.ИмяПомощника   = РегистрацияОрганизацииКлиентСервер.ИмяПомощникаРегистрации();
	СтруктураШага.НомерШага      = НомерШага;
	СтруктураШага.ИмяФормы       = "Обработка.РегистрацияОрганизации.Форма.ФормаВыбораВидовДеятельности";
	СтруктураШага.ТекстНавигации = НСтр("ru='Вид деятельности'");
	СтруктураШага.ИмяШагаДляЛК   = ИмяШагаОКВЭДДляЛичногоКабинета();
	СтруктураШага.СтруктураПараметровФормы.НавигацияПараметрФормы = "ОКВЭД";
	
	Возврат СтруктураШага;
	
КонецФункции

Функция СтруктураШагаРежимНалогообложения(НомерШага, НавигацияПараметрФормы = "РежимНалогообложения")
	
	СтруктураШага                = НавигацияПомощников.НовыйСтруктураШага();
	СтруктураШага.ИмяПомощника   = РегистрацияОрганизацииКлиентСервер.ИмяПомощникаРегистрации();
	СтруктураШага.НомерШага      = НомерШага;
	СтруктураШага.ИмяФормы       = "Обработка.СравнениеРежимовНалогообложения.Форма.Форма";
	СтруктураШага.ТекстНавигации = НСтр("ru='Налоги'");
	СтруктураШага.ИмяШагаДляЛК   = ИмяШагаНалогиДляЛичногоКабинета();
	СтруктураШага.СтруктураПараметровФормы.НавигацияПараметрФормы = НавигацияПараметрФормы;
	СтруктураШага.СтруктураПараметровФормы.Вставить("КлючНазначенияИспользования", НРег("Регистрация"));
	
	Возврат СтруктураШага;
	
КонецФункции

Функция СтруктураШагаЗаявление(НомерШага)
	
	СтруктураШага                    = НавигацияПомощников.НовыйСтруктураШага();
	СтруктураШага.ИмяПомощника       = РегистрацияОрганизацииКлиентСервер.ИмяПомощникаРегистрации();
	СтруктураШага.НомерШага          = НомерШага;
	СтруктураШага.ОпределятьИмяФормы = Истина; // см. ИмяФормыШага()
	СтруктураШага.ТекстНавигации     = НСтр("ru='Заявление'");
	СтруктураШага.ИмяШагаДляЛК       = ИмяШагаЗаявлениеДляЛичногоКабинета();
	СтруктураШага.СтруктураПараметровФормы.НавигацияПараметрФормы = "Заявление";
	
	Возврат СтруктураШага;
	
КонецФункции

Функция СтруктураШагаДокументы(НомерШага)
	
	СтруктураШага                    = НавигацияПомощников.НовыйСтруктураШага();
	СтруктураШага.ИмяПомощника       = РегистрацияОрганизацииКлиентСервер.ИмяПомощникаРегистрации();
	СтруктураШага.НомерШага          = НомерШага;
	СтруктураШага.ОпределятьИмяФормы = Истина; // см. ИмяФормыШага()
	СтруктураШага.ТекстНавигации     = НСтр("ru='Документы'");
	СтруктураШага.ИмяШагаДляЛК       = ИмяШагаЗаявлениеДляЛичногоКабинета();
	СтруктураШага.СтруктураПараметровФормы.НавигацияПараметрФормы = "Документы";
	
	Возврат СтруктураШага;
	
КонецФункции

Функция СтруктураШагаСписокИзмененийЕГР(НомерШага)
	
	СтруктураШага                = НавигацияПомощников.НовыйСтруктураШага();
	СтруктураШага.ИмяПомощника   = РегистрацияОрганизацииКлиентСервер.ИмяПомощникаВнесенияИзменений();
	СтруктураШага.НомерШага      = НомерШага;
	СтруктураШага.ИмяФормы       = "Обработка.РегистрацияОрганизации.Форма.ВнесениеИзмененийЕГР";
	СтруктураШага.ТекстНавигации = НСтр("ru = 'Изменения'");
	СтруктураШага.СтруктураПараметровФормы.НавигацияПараметрФормы = "ВнесениеИзмененийЕГР_СписокИзменений";
	
	ДобавитьКлючевыеПараметрыПомощникаВнесенияИзмененийЕГР(СтруктураШага);
	
	Возврат СтруктураШага;
	
КонецФункции

Функция СтруктураШагаЗаявлениеДляИзмененияЕГР(НомерШага)
	
	СтруктураШага                = НавигацияПомощников.НовыйСтруктураШага();
	СтруктураШага.ИмяПомощника   = РегистрацияОрганизацииКлиентСервер.ИмяПомощникаВнесенияИзменений();
	СтруктураШага.НомерШага      = НомерШага;
	СтруктураШага.ИмяФормы       = "Обработка.РегистрацияОрганизации.Форма.ВнесениеИзмененийЕГР";
	СтруктураШага.ТекстНавигации = НСтр("ru = 'Заявление'");
	СтруктураШага.СтруктураПараметровФормы.НавигацияПараметрФормы = "ВнесениеИзмененийЕГР_Заявление";
	
	ДобавитьКлючевыеПараметрыПомощникаВнесенияИзмененийЕГР(СтруктураШага);
	
	Возврат СтруктураШага;
	
КонецФункции

Функция СтруктураШагаДокументыДляИзмененияЕГР(НомерШага)
	
	СтруктураШага                = НавигацияПомощников.НовыйСтруктураШага();
	СтруктураШага.ИмяПомощника   = РегистрацияОрганизацииКлиентСервер.ИмяПомощникаВнесенияИзменений();
	СтруктураШага.НомерШага      = НомерШага;
	СтруктураШага.ИмяФормы       = "Обработка.РегистрацияОрганизации.Форма.ВнесениеИзмененийЕГР";
	СтруктураШага.ЗаголовокФормы = НСтр("ru = 'Внесение изменений в ЕГРЮЛ (ЕГРИП)'");
	СтруктураШага.ТекстНавигации = НСтр("ru = 'Регистрация'");
	СтруктураШага.СтруктураПараметровФормы.НавигацияПараметрФормы = "ВнесениеИзмененийЕГР_Документы";
	
	ДобавитьКлючевыеПараметрыПомощникаВнесенияИзмененийЕГР(СтруктураШага);
	
	Возврат СтруктураШага;
	
КонецФункции

Процедура ДобавитьКлючевыеПараметрыПомощникаВнесенияИзмененийЕГР(СтруктураШага)
	
	СтруктураШага.СтруктураПараметровФормы.Вставить("Организация", Справочники.Организации.ПустаяСсылка());
	
КонецПроцедуры

Функция СтруктураШагаПатент(НомерШага, НавигацияПараметрФормы = "Патент")
	
	СтруктураШага                = НавигацияПомощников.НовыйСтруктураШага();
	СтруктураШага.ИмяПомощника   = РегистрацияОрганизацииКлиентСервер.ИмяПомощникаРегистрации();
	СтруктураШага.НомерШага      = НомерШага;
	СтруктураШага.ИмяФормы       = "Обработка.ПомощникЗаполненияЗаявленияНаПолучениеПатента.Форма.Форма";
	СтруктураШага.ТекстНавигации = НСтр("ru='Патент'");
	СтруктураШага.ИмяШагаДляЛК   = ИмяШагаПатентДляЛичногоКабинета();
	СтруктураШага.СтруктураПараметровФормы.НавигацияПараметрФормы = НавигацияПараметрФормы;
	
	Возврат СтруктураШага;
	
КонецФункции

#КонецОбласти

#Область Имена

Функция ИмяКлючаСтруктураНавигации()
	
	Возврат НСтр("ru='СтруктураНавигации'");
	
КонецФункции 

Функция ИмяВыборВидаДеятельности()
	
	Возврат ВРег("OKVED");
	
КонецФункции

Функция ИмяВыборСистемыНалогообложения()
	
	Возврат ВРег("TaxSystem");
	
КонецФункции

Функция ИмяТестИПИлиООО()
	
	Возврат ВРег("businessform");
	
КонецФункции

Функция ИмяНачалоРаботы()
	
	Возврат ВРег("start");
	
КонецФункции

Функция ИмяИзменениеЕГР()
	
	Возврат ВРег("register_changes");
	
КонецФункции

// Функция возвращает массив запуска ключей помощника.
// Используется для определения структуры навигации помощника.
//
Функция МассивКлючейЗапуска() Экспорт

	МассивКлючейЗапуска = Новый Массив;
	МассивКлючейЗапуска.Добавить(ИмяНачалоРаботы());
	МассивКлючейЗапуска.Добавить(ИмяВыборВидаДеятельности());
	МассивКлючейЗапуска.Добавить(ИмяТестИПИлиООО());
	МассивКлючейЗапуска.Добавить(ИмяВыборСистемыНалогообложения());
	МассивКлючейЗапуска.Добавить(ИмяВыборПатент());
	МассивКлючейЗапуска.Добавить(ИмяИзменениеЕГР());
	Возврат МассивКлючейЗапуска;

КонецФункции

Функция ИмяВыборПатент()
	
	Возврат ВРег("Patent");
	
КонецФункции 

#КонецОбласти

// Функция возвращает структуру навигации по шагам: 
// - Форма бизнеса
// - Вид деятельности
// - Налоги
// - Патент (шаг может отсутствовать)
// - Заявление
// - Документы
// 
// Параметры:
//   НуженШагПатент - булево. Определяет видимость шага "Патент"
//   ПараметрФормаБизнеса - строка. Параметр инициализации шага "Форма бизнеса"
//
Функция СтруктураНавигацииРегистрацияИП(НуженШагПатент = Ложь, ПараметрФормаБизнеса = "ФормаБизнеса")
	
	СтруктураТекущая = СтруктураНавигацииПомощникаРегистрации();
	
	Если СтруктураТекущая = Неопределено Тогда
		Возврат СтруктураТекущая;
	КонецЕсли;
	
	ИмяШагаПатент = ИмяШагаПатентДляЛичногоКабинета();
	ШагПатентИмеется = Ложь;
	
	Для Каждого ТекущийШаг Из СтруктураТекущая Цикл
		Если ТекущийШаг.Значение.ИмяШагаДляЛК = ИмяШагаПатент Тогда
			ШагПатентИмеется = Истина;
			Прервать;
		КонецЕсли;
	КонецЦикла;
	
	Если Не (НуженШагПатент Или ШагПатентИмеется)
		Или НуженШагПатент И ШагПатентИмеется Тогда
		
		Возврат СтруктураТекущая;
		
	КонецЕсли;
	
	СтруктураНавигации = Новый Структура;
	ИмяШагаНалоги = ИмяШагаНалогиДляЛичногоКабинета();
	НомерШага = 1;
	
	Для Каждого ТекущийШаг Из СтруктураТекущая Цикл
		
		Если Не НуженШагПатент И ТекущийШаг.Значение.ИмяШагаДляЛК = ИмяШагаПатент Тогда
			Продолжить;
		КонецЕсли;
		
		СтруктураШага = ТекущийШаг.Значение;
		СтруктураШага.Вставить("НомерШага", НомерШага);
		СтруктураНавигации.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(НомерШага), СтруктураШага);
		
		НомерШага = НомерШага + 1;
		
		Если НуженШагПатент И ТекущийШаг.Значение.ИмяШагаДляЛК = ИмяШагаНалоги Тогда
			СтруктураНавигации.Вставить(НавигацияПомощниковКлиентСервер.ИмяШага(НомерШага), СтруктураШагаПатент(НомерШага));
			НомерШага = НомерШага + 1;
		КонецЕсли;
		
	КонецЦикла;
	
	Возврат СтруктураНавигации;
	
КонецФункции

// Функция обновляет навигацию формы
// 
// Параметры:
//   Форма - Управляемая форма
//   НуженШагПатента - булево. Определяет видимость шага "Патент"
//
Процедура ОбновитьНавигациюФормы(Форма, НуженШагПатент) Экспорт
	
	СтруктураНавигацииПомощника = СтруктураНавигацииРегистрацияИП(НуженШагПатент);
	
	ОбщегоНазначения.ХранилищеОбщихНастроекСохранить(
		ИмяКлючаНастроек(),
		ИмяКлючаСтруктураНавигации(),
		СтруктураНавигацииПомощника);
	
	Обработки.РегистрацияОрганизации.РазместитьНавигацию(Форма);
	
КонецПроцедуры

#КонецОбласти

#Область ФормированиеДереваОКВЭД

Процедура ЗаполнитьКлассификаторВФормеВыбораОКВЭД(Параметры, АдресХранилища) Экспорт
	
	ТаблицаОКВЭД = Справочники.Организации.КлассификаторОКВЭД2();
	
	КлассификаторДляПоиска = Справочники.Организации.НовыйТаблицаДляПоискаОКВЭД();
	
	НомерТекущейСтроки = 0;
	
	ЗаполнитьДеревоПоТаблице(ТаблицаОКВЭД, НомерТекущейСтроки, Параметры.Классификатор.Строки, 0,
		Параметры.Выбранные, КлассификаторДляПоиска);
	
	РезультатВыполнения = Новый Структура();
	РезультатВыполнения.Вставить("КлассификаторДляПоиска", КлассификаторДляПоиска);
	РезультатВыполнения.Вставить("Классификатор",          Параметры.Классификатор);
	
	ПоместитьВоВременноеХранилище(РезультатВыполнения, АдресХранилища);
	
КонецПроцедуры

Процедура ЗаполнитьДеревоПоТаблице(Таблица,
		НомерТекущейСтроки, ИсходныйУзел, ТекущийУровеньДерева, Выбранные, КлассификаторДляПоиска)
	
	Пока Таблица.Количество() > НомерТекущейСтроки Цикл
		
		СтрокаТаблицы = Таблица[НомерТекущейСтроки];
		
		КоличествоЦифрВКоде = СтрДлина(СтрЗаменить(СтрокаТаблицы.Код, ".", ""));
		
		УровеньУзла = КоличествоЦифрВКоде - 2; // Две цифры это нулевой уровень
		
		Если УровеньУзла > ТекущийУровеньДерева Тогда // Новый уровень вниз
			
			ЗаполнитьДеревоПоТаблице(
				Таблица, НомерТекущейСтроки,
				ИсходныйУзел[ИсходныйУзел.Количество()-1].Строки, ТекущийУровеньДерева + 1,
				Выбранные, КлассификаторДляПоиска);
			
		ИначеЕсли УровеньУзла < ТекущийУровеньДерева Тогда // На уровень вверх
			
			ТекущийУровеньДерева = ТекущийУровеньДерева - 1;
			Возврат;
			
		Иначе
			
			НовыйУзел = ИсходныйУзел.Добавить();
			
			ЗаполнитьЗначенияСвойств(НовыйУзел, СтрокаТаблицы);
			
			НовыйУзел.Выбран = Выбранные.Найти(НовыйУзел.Код, "Код") <> Неопределено;
			
			Если НовыйУзел.ДоступенДляВыбора Тогда
				ЗаполнитьЗначенияСвойств(КлассификаторДляПоиска.Добавить(), СтрокаТаблицы);
			КонецЕсли;
			
			НомерТекущейСтроки = НомерТекущейСтроки + 1;
			
		КонецЕсли;
		
	КонецЦикла;
	
КонецПроцедуры

#КонецОбласти

#Область ФормированиеДокументовВФоне

Процедура СформироватьДокументыОООВФоне(ПараметрыФормированияДокументов, АдресРезультата = Неопределено) Экспорт
	
	РезультатФормированияДокументов = Новый Структура();
	
	НачатьТранзакцию();
	Попытка
		
		// Организация
		ДанныеОрганизации = ПараметрыФормированияДокументов.ДанныеОрганизации;
		ЗаписатьНовоеЮридическоеЛицо(РезультатФормированияДокументов, ДанныеОрганизации);
		
		// Учетная политика
		ДанныеУчетнойПолитики = ДанныеОрганизации.УчетнаяПолитика;
		ДанныеУчетнойПолитики.Вставить("Организация", РезультатФормированияДокументов.Организация);
		НастройкиУчета.ОчисткаНастроекУчетнойПолитики(РезультатФормированияДокументов.Организация);
		НастройкиУчета.УстановкаПараметровУчетнойПолитикиПоУмолчанию(ДанныеУчетнойПолитики, Истина);
		
		// Руководитель
		ДанныеРуководителя           = ПараметрыФормированияДокументов.ДанныеРуководителя;
		ДанныеОДолжностиРуководителя = ПараметрыФормированияДокументов.ДанныеОДолжностиРуководителя;
		ЗаписатьРуководителя(РезультатФормированияДокументов, ДанныеРуководителя, ДанныеОДолжностиРуководителя);
		
		ЗафиксироватьТранзакцию();
		
	Исключение
		ОтменитьТранзакцию();
		ЗаписьЖурналаРегистрации(СобытиеЖурналаРегистрации(),
				УровеньЖурналаРегистрации.Ошибка, Метаданные.Справочники.Организации, ,
				ПодробноеПредставлениеОшибки(ИнформацияОбОшибке()));
		ВызватьИсключение;
	КонецПопытки;
	
	Попытка
		//Уставный капитал
		ДанныеУставногоКапитала = ПараметрыФормированияДокументов.ДанныеУставногоКапитала;
		ЗаписатьФормированиеУставногоКапитала(РезультатФормированияДокументов, ДанныеУставногоКапитала);
		
		Если СервисКвитанцияНаОплатуГоспошлиныДоступен() Тогда
			// Квитанция на оплату госпошлины из веб-сервиса
			АдресКвитанцииНаОплатуГоспошлины = ДанныеСервисаРегистрации.КвитанцияНаОплатуГоспошлины(
					"РегистрацияЮрлица",
					ДанныеРуководителя,
					ДанныеОрганизации.ЮридическийАдресЗначениеJSON,
					КБКНалогаПоСпособуПодачиДокументов(ПараметрыФормированияДокументов.СпособПодачиДокументов),
					СуммаПошлиныРегистрацияЮЛ());
		Иначе
			АдресКвитанцииНаОплатуГоспошлины = Неопределено;
		КонецЕсли;
		Если АдресКвитанцииНаОплатуГоспошлины <> Неопределено Тогда
			ПрисоединитьКвитанциюНаОплатуГоспошлиныКОрганизации(
					РезультатФормированияДокументов.Организация, АдресКвитанцииНаОплатуГоспошлины);
		Иначе
			ПометитьНаУдалениеКвитанциюНаОплатуГоспошлины(
					РезультатФормированияДокументов.Организация);
		КонецЕсли;
		
		// Заявление о регистрации индивидуального предпринимателя
		ПараметрыЗаявленияОРегистрацииООО = ПараметрыЗаявленияОРегистрации(
			РезультатФормированияДокументов.Организация,
			ПараметрыФормированияДокументов.СпособРегистрации);
		
		ЗаявлениеОРегистрацииООО = НайтиЗаявлениеОРегистрации(РезультатФормированияДокументов.Организация, "Р11001");
		
		Отчеты.РегламентированноеУведомлениеФормаР11001.СоздатьЗаполненноеУведомление(
			ПараметрыЗаявленияОРегистрацииООО, ЗаявлениеОРегистрацииООО);
		
		// Заявление о переходе на УСН
		Если ПодаетсяУведомлениеОПереходеНаУСН(ДанныеУчетнойПолитики) Тогда
			
			ЗаписатьДанныеУведомленияОПереходеНаУСН(
				РезультатФормированияДокументов.Организация,
				ДанныеОрганизации.КодНалоговогоОргана,
				ДанныеРуководителя,
				ПараметрыФормированияДокументов.СпособРегистрации);
			
		КонецЕсли;
	
	Исключение
		ЗаписьЖурналаРегистрации(СобытиеЖурналаРегистрации(),
				УровеньЖурналаРегистрации.Ошибка, Метаданные.Справочники.Организации, ,
				ПодробноеПредставлениеОшибки(ИнформацияОбОшибке()));
		ВызватьИсключение;
	КонецПопытки;
	
	ПоместитьВоВременноеХранилище(РезультатФормированияДокументов, АдресРезультата);
	
КонецПроцедуры

Процедура СформироватьДокументыИПВФоне(ПараметрыФормированияДокументов, АдресРезультата = Неопределено) Экспорт
	
	РезультатФормированияДокументов = Новый Структура();
	
	НачатьТранзакцию();
	Попытка
		
		// Организация
		ДанныеОрганизации = ПараметрыФормированияДокументов.ДанныеОрганизации;
		ЗаписатьНовогоИндивидуальногоПредпринимателя(РезультатФормированияДокументов, ДанныеОрганизации);
		
		// Учетная политика
		ДанныеУчетнойПолитики = ДанныеОрганизации.УчетнаяПолитика;
		ДанныеУчетнойПолитики.Вставить("Организация", РезультатФормированияДокументов.Организация);
		НастройкиУчета.ОчисткаНастроекУчетнойПолитики(РезультатФормированияДокументов.Организация);
		НастройкиУчета.УстановкаПараметровУчетнойПолитикиПоУмолчанию(ДанныеУчетнойПолитики, Истина);
		
		ЗафиксироватьТранзакцию();
		
	Исключение
		ОтменитьТранзакцию();
		ЗаписьЖурналаРегистрации(СобытиеЖурналаРегистрации(),
			УровеньЖурналаРегистрации.Ошибка, Метаданные.Справочники.Организации, ,
			ПодробноеПредставлениеОшибки(ИнформацияОбОшибке()));
		ВызватьИсключение;
	КонецПопытки;
	
	Попытка
		
		Если СервисКвитанцияНаОплатуГоспошлиныДоступен() Тогда
			// Квитанция на оплату госпошлины из веб-сервиса
			АдресКвитанцииНаОплатуГоспошлины = ДанныеСервисаРегистрации.КвитанцияНаОплатуГоспошлины(
				"РегистрацияИП",
				ДанныеОрганизации.ИндивидуальныйПредприниматель,
				ДанныеОрганизации.ИндивидуальныйПредприниматель.АдресПропискиЗначениеJSON,
				КБКНалогаПоСпособуПодачиДокументов(ПараметрыФормированияДокументов.СпособПодачиДокументов),
				СуммаПошлиныРегистрацияИП());
		Иначе
			АдресКвитанцииНаОплатуГоспошлины = Неопределено;
		КонецЕсли;
		Если АдресКвитанцииНаОплатуГоспошлины <> Неопределено Тогда
			ПрисоединитьКвитанциюНаОплатуГоспошлиныКОрганизации(
				РезультатФормированияДокументов.Организация, АдресКвитанцииНаОплатуГоспошлины);
		Иначе
			ПометитьНаУдалениеКвитанциюНаОплатуГоспошлины(
				РезультатФормированияДокументов.Организация);
		КонецЕсли;
		
		// Заявление о регистрации индивидуального предпринимателя
		ПараметрыЗаявленияОРегистрацииИП = ПараметрыЗаявленияОРегистрации(
			РезультатФормированияДокументов.Организация,
			ПараметрыФормированияДокументов.СпособРегистрации);
		
		ЗаявлениеОРегистрацииИП = НайтиЗаявлениеОРегистрации(РезультатФормированияДокументов.Организация, "Р21001");
		
		Отчеты.РегламентированноеУведомлениеФормаР21001.СоздатьЗаполненноеУведомление(
			ПараметрыЗаявленияОРегистрацииИП, ЗаявлениеОРегистрацииИП);
		
		// Заявление о переходе на УСН
		Если ПодаетсяУведомлениеОПереходеНаУСН(ДанныеУчетнойПолитики) Тогда
			
			ЗаписатьДанныеУведомленияОПереходеНаУСН(
				РезультатФормированияДокументов.Организация,
				ДанныеОрганизации.ДанныеРегистрацииВНалоговомОргане.КодНалоговогоОргана,
				ДанныеОрганизации.ИндивидуальныйПредприниматель,
				ПараметрыФормированияДокументов.СпособРегистрации);
			
		КонецЕсли;
		
		ПараметрыПатент = ПараметрыЗаявлениеНаПолучениеПатента(
			ПараметрыФормированияДокументов,
			РезультатФормированияДокументов.Организация);
		
		Если ПараметрыПатент <> Неопределено Тогда
			Обработки.ПомощникЗаполненияЗаявленияНаПолучениеПатента.СформироватьЗаявлениеНаПолучениеПатента(ПараметрыПатент);
		КонецЕсли;
		
	Исключение
		ЗаписьЖурналаРегистрации(СобытиеЖурналаРегистрации(),
				УровеньЖурналаРегистрации.Ошибка, Метаданные.Справочники.Организации, ,
				ПодробноеПредставлениеОшибки(ИнформацияОбОшибке()));
		ВызватьИсключение;
	КонецПопытки;
	
	ПоместитьВоВременноеХранилище(РезультатФормированияДокументов, АдресРезультата);
	
КонецПроцедуры

Функция ЗаписатьФизическоеЛицо(ДанныеФизическогоЛица) Экспорт
	Перем ПаспортныеДанные;
	
	Если ЗначениеЗаполнено(ДанныеФизическогоЛица.Ссылка) Тогда
		ФизическоеЛицоОбъект = ДанныеФизическогоЛица.Ссылка.ПолучитьОбъект();
	Иначе
		ФизическоеЛицоОбъект = Справочники.ФизическиеЛица.СоздатьЭлемент();
		ФизическоеЛицоОбъект.Заполнить(Неопределено);
	КонецЕсли;
	
	ЗаполнитьЗначенияСвойств(ФизическоеЛицоОбъект, ДанныеФизическогоЛица, "Фамилия,Имя,Отчество,Пол,ИНН");
	
	Если ДанныеФизическогоЛица.Свойство("ДатаРождения") Тогда
		ФизическоеЛицоОбъект.ДатаРождения = ДанныеФизическогоЛица.ДатаРождения;
	КонецЕсли;
	Если ДанныеФизическогоЛица.Свойство("МестоРожденияПредставление") Тогда
		ФизическоеЛицоОбъект.МестоРожденияПредставление = ДанныеФизическогоЛица.МестоРожденияПредставление;
	КонецЕсли;
	
	ФизическоеЛицоОбъект.ФИО = СокрП(ФизическоеЛицоОбъект.Фамилия + " " + ФизическоеЛицоОбъект.Имя + " " + ФизическоеЛицоОбъект.Отчество);
	ФизическоеЛицоОбъект.Наименование = КадровыйУчетКлиентСервер.ПолноеНаименованиеСотрудника(
		ФизическоеЛицоОбъект.Фамилия, ФизическоеЛицоОбъект.Имя, ФизическоеЛицоОбъект.Отчество, "");
	ФизическоеЛицоОбъект.ДополнительныеСвойства.Вставить("ФИОУстановлены");
	
	Если ДанныеФизическогоЛица.Свойство("АдресПропискиЗначениеJSON")
		И ЗначениеЗаполнено(ДанныеФизическогоЛица.АдресПропискиЗначениеJSON) Тогда
		УправлениеКонтактнойИнформацией.ДобавитьКонтактнуюИнформацию(ФизическоеЛицоОбъект,
			ДанныеФизическогоЛица.АдресПропискиЗначениеJSON, Справочники.ВидыКонтактнойИнформации.АдресПоПропискеФизическиеЛица);
	КонецЕсли;
	Если ДанныеФизическогоЛица.Свойство("ТелефонРабочийЗначениеJSON")
		И ЗначениеЗаполнено(ДанныеФизическогоЛица.ТелефонРабочийЗначениеJSON) Тогда
		УправлениеКонтактнойИнформацией.ДобавитьКонтактнуюИнформацию(ФизическоеЛицоОбъект,
			ДанныеФизическогоЛица.ТелефонРабочийЗначениеJSON, Справочники.ВидыКонтактнойИнформации.ТелефонРабочийФизическиеЛица);
	КонецЕсли;
	Если ДанныеФизическогоЛица.Свойство("EMailЗначениеJSON")
		И ЗначениеЗаполнено(ДанныеФизическогоЛица.EMailЗначениеJSON) Тогда
		УправлениеКонтактнойИнформацией.ДобавитьКонтактнуюИнформацию(ФизическоеЛицоОбъект,
			ДанныеФизическогоЛица.EMailЗначениеJSON, Справочники.ВидыКонтактнойИнформации.EMailФизическиеЛица);
	КонецЕсли;
	
	ФизическоеЛицоОбъект.Записать();
	
	Набор = РегистрыСведений.ФИОФизическихЛиц.СоздатьНаборЗаписей();
	Набор.Отбор.ФизическоеЛицо.Установить(ФизическоеЛицоОбъект.Ссылка);
	Запись = Набор.Добавить();
	Запись.Фамилия  = ФизическоеЛицоОбъект.Фамилия;
	Запись.Имя      = ФизическоеЛицоОбъект.Имя;
	Запись.Отчество = ФизическоеЛицоОбъект.Отчество;
	Запись.ФизическоеЛицо = ФизическоеЛицоОбъект.Ссылка;
	Запись.Период   = ЗарплатаКадрыКлиентСервер.ДатаОтсчетаПериодическихСведений();
	Набор.Записать();
	
	Если ДанныеФизическогоЛица.Свойство("ПаспортныеДанные") Тогда
		// Паспортные данные
		
		ПаспортРФ = Справочники.ВидыДокументовФизическихЛиц.ПаспортРФ;
		
		ПаспортныеДанные = РегистрыСведений.ДокументыФизическихЛиц.СоздатьНаборЗаписей();
		ПаспортныеДанные.Отбор.Физлицо.Установить(ФизическоеЛицоОбъект.Ссылка);
		ПаспортныеДанные.Отбор.ВидДокумента.Установить(ПаспортРФ);
		
		ЗаписьПаспортныхДанных = ПаспортныеДанные.Добавить();
		ЗаписьПаспортныхДанных.Физлицо      = ФизическоеЛицоОбъект.Ссылка;
		ЗаписьПаспортныхДанных.ВидДокумента = ПаспортРФ;
		ЗаписьПаспортныхДанных.ЯвляетсяДокументомУдостоверяющимЛичность = Истина;
		ЗаполнитьЗначенияСвойств(ЗаписьПаспортныхДанных, ДанныеФизическогоЛица.ПаспортныеДанные);
		ЗаписьПаспортныхДанных.Период = ?(ЗначениеЗаполнено(ДанныеФизическогоЛица.ПаспортныеДанные.ДатаВыдачи),
			ДанныеФизическогоЛица.ПаспортныеДанные.ДатаВыдачи, ТекущаяДатаСеанса());
		ПаспортныеДанные.Записать();
	КонецЕсли;
	
	Возврат ФизическоеЛицоОбъект.Ссылка;
	
КонецФункции

Функция НовыеДанныеРуководителя() Экспорт
	
	ДанныеРуководителя = Новый Структура();
	ДанныеРуководителя.Вставить("Ссылка", Справочники.ФизическиеЛица.ПустаяСсылка()); // Ссылка на справочник ФизическиеЛица
	ДанныеРуководителя.Вставить("Фамилия", "");
	ДанныеРуководителя.Вставить("Имя", "");
	ДанныеРуководителя.Вставить("Отчество", "");
	ДанныеРуководителя.Вставить("Пол", Перечисления.ПолФизическогоЛица.ПустаяСсылка());
	ДанныеРуководителя.Вставить("ИНН", "");
	
	Возврат ДанныеРуководителя;
	
КонецФункции

Функция НовыеДанныеФизическогоЛица() Экспорт
	
	ДанныеФизическогоЛица = Новый Структура();
	ДанныеФизическогоЛица.Вставить("Ссылка",                     Справочники.ФизическиеЛица.ПустаяСсылка()); // Ссылка на справочник ФизическиеЛица
	ДанныеФизическогоЛица.Вставить("Фамилия",                    "");
	ДанныеФизическогоЛица.Вставить("Имя",                        "");
	ДанныеФизическогоЛица.Вставить("Отчество",                   "");
	ДанныеФизическогоЛица.Вставить("Пол",                        Перечисления.ПолФизическогоЛица.ПустаяСсылка());
	ДанныеФизическогоЛица.Вставить("ИНН",                        "");
	ДанныеФизическогоЛица.Вставить("ДатаРождения",               '00010101');
	ДанныеФизическогоЛица.Вставить("МестоРожденияПредставление", "");
	
	ДанныеФизическогоЛица.Вставить("ПаспортныеДанные", Новый Структура());
	ДанныеФизическогоЛица.ПаспортныеДанные.Вставить("Серия",             "");
	ДанныеФизическогоЛица.ПаспортныеДанные.Вставить("Номер",             "");
	ДанныеФизическогоЛица.ПаспортныеДанные.Вставить("КемВыдан",          "");
	ДанныеФизическогоЛица.ПаспортныеДанные.Вставить("ДатаВыдачи",        '00010101');
	ДанныеФизическогоЛица.ПаспортныеДанные.Вставить("КодПодразделения",  "");
	
	ДанныеФизическогоЛица.Вставить("АдресПрописки", "");
	ДанныеФизическогоЛица.Вставить("АдресПропискиЗначениеJSON", ""); // JSON-строка - значение полей для КИ вида Справочники.ВидыКонтактнойИнформации.АдресПоПропискеФизическиеЛица
	ДанныеФизическогоЛица.Вставить("ТелефонРабочий", "");
	ДанныеФизическогоЛица.Вставить("ТелефонРабочийЗначениеJSON", ""); // JSON-строка - значение полей для КИ вида Справочники.ВидыКонтактнойИнформации.ТелефонРабочийФизическиеЛица
	ДанныеФизическогоЛица.Вставить("EMail", "");
	ДанныеФизическогоЛица.Вставить("EMailЗначениеJSON", ""); // JSON-строка - значение полей для КИ вида Справочники.ВидыКонтактнойИнформации.EMailФизическиеЛица
	
	Возврат ДанныеФизическогоЛица;
	
КонецФункции

Функция НовыеДанныеДолжности() Экспорт
	
	ДанныеДолжности = Новый Структура();
	ДанныеДолжности.Вставить("Должность",      Справочники.Должности.ПустаяСсылка());
	ДанныеДолжности.Вставить("ДатаНазначения", '00010101');
	ДанныеДолжности.Вставить("СрокПолномочий", 0); // Число лет
	
	Возврат ДанныеДолжности;
	
КонецФункции

Функция НовыеДанныеРегистрацииВНалоговомОргане() Экспорт
	
	ДанныеРегистрации = Новый Структура();
	ДанныеРегистрации.Вставить("КодНалоговогоОргана", "");
	ДанныеРегистрации.Вставить("КодПоОКТМО", "");
	ДанныеРегистрации.Вставить("КодПоОКАТО", "");
	
	Возврат ДанныеРегистрации;
	
КонецФункции

// Находит актуальные заявления по выбранной организации и возвращает в структуре
//
// Параметры:
//  Организация - СправочникСсылка.Организации
// 
// Возвращаемое значение:
//  Структура - содержит ссылки на документы и состояние их отправки
//
Функция НайтиАктуальныеЗаявленияОВнесенииИзмененийЕГР(Организация) Экспорт
	
	АктуальныеЗаявления = Новый Структура;
	АктуальныеЗаявления.Вставить("ЗаявлениеОВнесенииИзмененийЕГР", Документы.УведомлениеОСпецрежимахНалогообложения.ПустаяСсылка());
	АктуальныеЗаявления.Вставить("ЗаявлениеОВнесенииИзмененийЕГРСостояниеОтправки", Неопределено);
	АктуальныеЗаявления.Вставить("ЗаявлениеОВнесенииИзмененийУчредительныеДокументы", Документы.УведомлениеОСпецрежимахНалогообложения.ПустаяСсылка());
	АктуальныеЗаявления.Вставить("ЗаявлениеОВнесенииИзмененийУчредительныеДокументыСостояниеОтправки", Неопределено);
	
	Если ЗначениеЗаполнено(Организация) Тогда
		КодыФорм = КодыФормЗаявлений();
		Если ОбщегоНазначенияБПВызовСервераПовтИсп.ЭтоЮрЛицо(Организация) Тогда
			РеквизитыЗаявления = НайтиАктуальноеЗаявлениеОВнесенииИзмененийЕГР(Организация, КодыФорм.ЗаявлениеРегистрацииИзмененийЕГРЮЛ);
			АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийЕГР = РеквизитыЗаявления.Заявление;
			АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийЕГРСостояниеОтправки = РеквизитыЗаявления.Состояние;
			
			РеквизитыЗаявления = НайтиАктуальноеЗаявлениеОВнесенииИзмененийЕГР(Организация, КодыФорм.ЗаявлениеРегистрацииИзмененийУчредительныхДокументов);
			АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийУчредительныеДокументы = РеквизитыЗаявления.Заявление;
			АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийУчредительныеДокументыСостояниеОтправки = РеквизитыЗаявления.Состояние;
		Иначе
			РеквизитыЗаявления = НайтиАктуальноеЗаявлениеОВнесенииИзмененийЕГР(Организация, КодыФорм.ЗаявлениеРегистрацииИзмененийЕГРИП);
			АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийЕГР = РеквизитыЗаявления.Заявление;
			АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийЕГРСостояниеОтправки = РеквизитыЗаявления.Состояние;
		КонецЕсли;
	КонецЕсли;
	
	Возврат АктуальныеЗаявления;
	
КонецФункции

// Вспомогательная функция для НайтиАктуальныеЗаявленияОВнесенииИзмененийЕГР()
// Ищет заявление по определенной форме, по которому не завершено внесение изменений в ЕГР.
//
Функция НайтиАктуальноеЗаявлениеОВнесенииИзмененийЕГР(Организация, КодФормы)
	
	Результат = Новый Структура;
	Результат.Вставить("Заявление", Документы.УведомлениеОСпецрежимахНалогообложения.ПустаяСсылка());
	Результат.Вставить("Состояние", Неопределено);
	
	РеквизитыЗаявления = НайтиЗаявлениеОРегистрации(Организация, КодФормы, Истина);
	Если РеквизитыЗаявления = Неопределено Тогда
		Возврат Результат;
	КонецЕсли;
	
	СостояниеОтправки = ИнтерфейсыВзаимодействияБРО.СостояниеДокумента(РеквизитыЗаявления.Ссылка);
	Если СостояниеОтправки.Статус = РегистрацияОрганизацииКлиентСервер.ФинальныйСтатусЗаявленияОВнесенииИзмененийЕГР() Тогда
		Возврат Результат;
	КонецЕсли;
	
	Результат.Заявление = РеквизитыЗаявления.Ссылка;
	Результат.Состояние = СостояниеОтправки;
	
	Возврат Результат;
	
КонецФункции

// Возвращает реквизиты последнего уведомления заданной формы
//
Функция НайтиЗаявлениеОРегистрации(Организация, КодФормы, СодержитДанныеПомощникаЗаполнения = Ложь) Экспорт
	
	Если Не ЗначениеЗаполнено(Организация) Или ПустаяСтрока(КодФормы) Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	Отбор = Новый Структура;
	Отбор.Вставить("Организация", Организация);
	Отбор.Вставить("ВидУведомления", Перечисления.ВидыУведомленийОСпецрежимахНалогообложения["Форма" + КодФормы]);
	Уведомления = УведомлениеОСпецрежимахНалогообложения.НайтиУведомления(Отбор);
	Уведомления.Сортировать("Дата Убыв, Ссылка Убыв", Новый СравнениеЗначений);
	
	ЗаявлениеОРегистрации = Новый Структура;
	ЗаявлениеОРегистрации.Вставить("Ссылка", Документы.УведомлениеОСпецрежимахНалогообложения.ПустаяСсылка());
	ЗаявлениеОРегистрации.Вставить("Дата", Дата(1, 1, 1));
	ЗаявлениеОРегистрации.Вставить("ИмяФормы", "");
	
	ИмяФормыПоУмолчанию = Отчеты["РегламентированноеУведомлениеФорма" + КодФормы].ПолучитьФормуПоУмолчанию();
	Для Каждого НайденноеЗаявление Из Уведомления Цикл
		Если СодержитДанныеПомощникаЗаполнения Тогда
			Если Не ЗначениеЗаполнено(ДанныеПомощникаВнесенияИзмененийЕГР(НайденноеЗаявление.Ссылка)) Тогда
				// Найденное заявление создано вручную
				Продолжить;
			КонецЕсли;
		КонецЕсли;
		ЗаполнитьЗначенияСвойств(ЗаявлениеОРегистрации, НайденноеЗаявление);
		ПозицияПоследнейТочки =  СтрНайти(ИмяФормыПоУмолчанию, ".", НаправлениеПоиска.СКонца);
		ИмяФормы = Лев(ИмяФормыПоУмолчанию, ПозицияПоследнейТочки) + НайденноеЗаявление.ИмяФормы;
		ЗаявлениеОРегистрации.Вставить("ИмяФормы", ИмяФормы);
		Прервать;
	КонецЦикла;
	
	Если ПустаяСтрока(ЗаявлениеОРегистрации.ИмяФормы) Тогда
		ЗаявлениеОРегистрации.Вставить("ИмяФормы", ИмяФормыПоУмолчанию);
	КонецЕсли;
	
	Возврат ЗаявлениеОРегистрации;
	
КонецФункции

Функция НайтиУведомлениеОСпецРежимеНалогообложения(Организация, ВидУведомления, ИмяФормыПоУмолчанию) Экспорт
	
	Если Не ЗначениеЗаполнено(Организация) Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	УведомлениеОСпецРежимеНалогообложения = Новый Структура;
	УведомлениеОСпецРежимеНалогообложения.Вставить("Ссылка", Документы.УведомлениеОСпецрежимахНалогообложения.ПустаяСсылка());
	УведомлениеОСпецРежимеНалогообложения.Вставить("Дата", Дата(1, 1, 1));
	
	Отбор = Новый Структура;
	Отбор.Вставить("Организация", Организация);
	Отбор.Вставить("ВидУведомления", ВидУведомления);
	
	Уведомления = УведомлениеОСпецрежимахНалогообложения.НайтиУведомления(Отбор);
	Если Уведомления.Количество() > 0 Тогда
		ЗаполнитьЗначенияСвойств(УведомлениеОСпецРежимеНалогообложения, Уведомления[0]);
		ПозицияПоследнейТочки =  СтрНайти(ИмяФормыПоУмолчанию, ".", НаправлениеПоиска.СКонца);
		ИмяФормы = Лев(ИмяФормыПоУмолчанию, ПозицияПоследнейТочки) + Уведомления[0].ИмяФормы;
		УведомлениеОСпецРежимеНалогообложения.Вставить("ИмяФормы", ИмяФормы);
	Иначе
		УведомлениеОСпецРежимеНалогообложения.Вставить("ИмяФормы", ИмяФормыПоУмолчанию);
	КонецЕсли;
	
	Возврат УведомлениеОСпецРежимеНалогообложения;
	
КонецФункции

Функция ПодаетсяУведомлениеОПереходеНаУСН(СтруктураУчетнойПолитики) Экспорт
	
	Если СтруктураУчетнойПолитики <> Неопределено
		И СтруктураУчетнойПолитики.Свойство("СистемаНалогообложения")
		И СтруктураУчетнойПолитики.СистемаНалогообложения = Перечисления.СистемыНалогообложения.Упрощенная Тогда
		Возврат Истина;
	Иначе
		Возврат Ложь;
	КонецЕсли
	
КонецФункции

Процедура ЗаписатьНовоеЮридическоеЛицо(РезультатФормированияДокументов, ДанныеОрганизации)
	
	Если ЗначениеЗаполнено(ДанныеОрганизации.Ссылка) Тогда
		ОрганизацияОбъект = ДанныеОрганизации.Ссылка.ПолучитьОбъект();
	Иначе
		ОрганизацияОбъект = Справочники.Организации.СоздатьЭлемент();
	КонецЕсли;
	
	ЗаполнитьЗначенияСвойств(ОрганизацияОбъект, ДанныеОрганизации,
		"Наименование, НаименованиеСокращенное, НаименованиеПолное, ЮридическоеФизическоеЛицо,
		|КодОКВЭД2, НаименованиеОКВЭД2, ДополнительныеКодыОКВЭД2");
	ОрганизацияОбъект.ИНН = "";
	ОрганизацияОбъект.КПП = "";
	ОрганизацияОбъект.Наименование =ОрганизацииФормыКлиентСервер.НаименованиеПоСокращенномуНаименованию(
										ОрганизацияОбъект.НаименованиеСокращенное);
	
	ЗаписатьАдресОрганизации(ОрганизацияОбъект, ДанныеОрганизации.ЮридическийАдресЗначениеJSON);
	
	ОрганизацияОбъект.ВариантНаименованияДляПечатныхФорм = Перечисления.ВариантыНаименованияДляПечатныхФорм.СокращенноеНаименование;
	
	// Очищаем регистрацию в НО. Она будет заполнена позже, после ввода данных об организации
	ОрганизацияОбъект.РегистрацияВНалоговомОргане = Справочники.РегистрацииВНалоговомОргане.ПустаяСсылка();
	ОрганизацияОбъект.КодНалоговогоОргана = "";
	
	ОрганизацияОбъект.ДополнительныеСвойства.Вставить("ОрганизацияЗарегистрирована", Ложь);
	ОрганизацияОбъект.Записать();
	
	РезультатФормированияДокументов.Вставить("Организация", ОрганизацияОбъект.Ссылка);
	
КонецПроцедуры

Процедура ЗаписатьНовогоИндивидуальногоПредпринимателя(РезультатФормированияДокументов, ДанныеОрганизации)
	
	ДанныеПредпринимателя = ДанныеОрганизации.ИндивидуальныйПредприниматель;
	
	ИндивидуальныйПредприниматель = ЗаписатьФизическоеЛицо(ДанныеПредпринимателя);
	
	Если ЗначениеЗаполнено(ДанныеОрганизации.Ссылка) Тогда
		ОрганизацияОбъект = ДанныеОрганизации.Ссылка.ПолучитьОбъект();
	Иначе
		ОрганизацияОбъект = Справочники.Организации.СоздатьЭлемент();
	КонецЕсли;
	
	ЗаполнитьЗначенияСвойств(ОрганизацияОбъект, ДанныеОрганизации,
		"ЮридическоеФизическоеЛицо, КодОКВЭД2, НаименованиеОКВЭД2, ДополнительныеКодыОКВЭД2");
	
	ОрганизацияОбъект.ИндивидуальныйПредприниматель = ИндивидуальныйПредприниматель;
	ОрганизацияОбъект.ФамилияИП  = ДанныеПредпринимателя.Фамилия;
	ОрганизацияОбъект.ИмяИП      = ДанныеПредпринимателя.Имя;
	ОрганизацияОбъект.ОтчествоИП = ДанныеПредпринимателя.Отчество;
	ОрганизацияОбъект.ИНН        = ДанныеПредпринимателя.ИНН;
	ОрганизацияОбъект.КПП        = "";
	
	
	ОрганизацияОбъект.НаименованиеСокращенное = ОрганизацииФормыКлиентСервер.СокращенноеНаименованиеИндивидульногоПредпринимателя(
								ОрганизацияОбъект.ФамилияИП, ОрганизацияОбъект.ИмяИП, ОрганизацияОбъект.ОтчествоИП);
	ОрганизацияОбъект.НаименованиеПолное = ОрганизацииФормыКлиентСервер.ПолноеНаименованиеИндивидульногоПредпринимателя(
								ОрганизацияОбъект.ФамилияИП, ОрганизацияОбъект.ИмяИП, ОрганизацияОбъект.ОтчествоИП);
	ОрганизацияОбъект.Наименование = ОрганизацииФормыКлиентСервер.НаименованиеПоСокращенномуНаименованию(
										ОрганизацияОбъект.НаименованиеСокращенное);
	
	ОрганизацияОбъект.ВариантНаименованияДляПечатныхФорм = Перечисления.ВариантыНаименованияДляПечатныхФорм.СокращенноеНаименование;
	
	ОрганизацияОбъект.КодНалоговогоОргана = ДанныеОрганизации.ДанныеРегистрацииВНалоговомОргане.КодНалоговогоОргана;
	
	Если ЗначениеЗаполнено(ОрганизацияОбъект.КодНалоговогоОргана) Тогда
		
		СуществующаяРегистрация = Справочники.РегистрацииВНалоговомОргане.ПустаяСсылка();
		Если ЗначениеЗаполнено(ОрганизацияОбъект.Ссылка) Тогда
			СуществующаяРегистрация = Справочники.РегистрацииВНалоговомОргане.РегистрацияВНалоговомОргане(
										ОрганизацияОбъект.Ссылка, 
										"",
										ОрганизацияОбъект.КодНалоговогоОргана);
		КонецЕсли;
		Если ЗначениеЗаполнено(СуществующаяРегистрация) Тогда
			ОрганизацияОбъект.РегистрацияВНалоговомОргане = СуществующаяРегистрация;
		Иначе
			ОрганизацияОбъект.РегистрацияВНалоговомОргане = Справочники.РегистрацииВНалоговомОргане.ПолучитьСсылку(Новый УникальныйИдентификатор);
		КонецЕсли;
		
	КонецЕсли;
	
	ЗаписатьАдресОрганизации(ОрганизацияОбъект, ДанныеПредпринимателя.АдресПропискиЗначениеJSON);
	
	Если ЗначениеЗаполнено(ДанныеПредпринимателя.ТелефонРабочийЗначениеJSON) Тогда
		УправлениеКонтактнойИнформацией.ДобавитьКонтактнуюИнформацию(ОрганизацияОбъект,
				ДанныеПредпринимателя.ТелефонРабочийЗначениеJSON, Справочники.ВидыКонтактнойИнформации.ТелефонОрганизации);
	КонецЕсли;
	
	Если ЗначениеЗаполнено(ДанныеПредпринимателя.EMailЗначениеJSON) Тогда
		УправлениеКонтактнойИнформацией.ДобавитьКонтактнуюИнформацию(ОрганизацияОбъект,
				ДанныеПредпринимателя.EMailЗначениеJSON, Справочники.ВидыКонтактнойИнформации.EmailОрганизации);
	КонецЕсли;
	
	ОрганизацияОбъект.ДополнительныеСвойства.Вставить("ОрганизацияЗарегистрирована", Ложь);
	ОрганизацияОбъект.Записать();
	
	ЗаписатьРегистрациюВНалоговомОргане(ОрганизацияОбъект.Ссылка, ОрганизацияОбъект.КПП, ДанныеОрганизации.ДанныеРегистрацииВНалоговомОргане);
	
	РезультатФормированияДокументов.Вставить("Организация", ОрганизацияОбъект.Ссылка);
	
КонецПроцедуры

Процедура ЗаписатьРегистрациюВНалоговомОргане(ОрганизацияСсылка, КПП, ДанныеРегистрацииВНалоговомОргане, РегистрацияВНалоговомОргане = Неопределено)
	
	Если ЗначениеЗаполнено(ДанныеРегистрацииВНалоговомОргане.КодНалоговогоОргана) Тогда
		
		РеквизитыНалоговогоОргана = ДанныеГосударственныхОрганов.РеквизитыНалоговогоОрганаПоКоду(
			ДанныеРегистрацииВНалоговомОргане.КодНалоговогоОргана);
		
		Если НЕ ЗначениеЗаполнено(РеквизитыНалоговогоОргана.ОписаниеОшибки) Тогда
			ДанныеГосударственныхОрганов.ОбновитьДанныеГосударственногоОргана(РеквизитыНалоговогоОргана);
		КонецЕсли;
		
		Если РегистрацияВНалоговомОргане = Неопределено Тогда
			РегистрацияВНалоговомОргане = ОрганизацияСсылка.РегистрацияВНалоговомОргане;
		КонецЕсли;
		Если ОбщегоНазначения.СсылкаСуществует(РегистрацияВНалоговомОргане) Тогда
			РегистрацияОбъект = РегистрацияВНалоговомОргане.ПолучитьОбъект();
		Иначе
			РегистрацияОбъект = Справочники.РегистрацииВНалоговомОргане.СоздатьЭлемент();
			РегистрацияОбъект.УстановитьСсылкуНового(РегистрацияВНалоговомОргане);
			РегистрацияОбъект.Заполнить(Неопределено);
		КонецЕсли;
		
		РегистрацияОбъект.Владелец         = ОрганизацияСсылка;
		РегистрацияОбъект.Код              = ДанныеРегистрацииВНалоговомОргане.КодНалоговогоОргана;
		РегистрацияОбъект.КодРегиона       = ДанныеГосударственныхОрганов.КодРегионаПоКодуНалоговогоОргана(ДанныеРегистрацииВНалоговомОргане.КодНалоговогоОргана);
		РегистрацияОбъект.Наименование     = РеквизитыНалоговогоОргана.Наименование;
		РегистрацияОбъект.НаименованиеИФНС = РеквизитыНалоговогоОргана.ПолноеНаименование;
		ЗаполнитьЗначенияСвойств(РегистрацияОбъект, ДанныеРегистрацииВНалоговомОргане);
		РегистрацияОбъект.КПП              = КПП;
		РегистрацияОбъект.Записать();
		
	КонецЕсли;
	
КонецПроцедуры

Процедура ЗаписатьРуководителя(РезультатФормированияДокументов, ДанныеРуководителя, ДанныеДолжности)
	
	Организация = РезультатФормированияДокументов.Организация;
	
	Руководитель = ЗаписатьФизическоеЛицо(ДанныеРуководителя);
	
	// Запись руководителя в ответственные лица
	ОтветственныеЛица = РегистрыСведений.ОтветственныеЛицаОрганизаций.СоздатьНаборЗаписей();
	ОтветственныеЛица.Отбор.СтруктурнаяЕдиница.Установить(Организация);
	ОтветственныеЛица.Отбор.ОтветственноеЛицо.Установить(Перечисления.ОтветственныеЛицаОрганизаций.Руководитель);
	
	ОтветственноеЛицо = ОтветственныеЛица.Добавить();
	ОтветственноеЛицо.Период = ?(ЗначениеЗаполнено(ДанныеДолжности.ДатаНазначения), 
									ДанныеДолжности.ДатаНазначения, ТекущаяДатаСеанса());
	ОтветственноеЛицо.СтруктурнаяЕдиница = Организация;
	ОтветственноеЛицо.ФизическоеЛицо     = Руководитель;
	ОтветственноеЛицо.ОтветственноеЛицо  = Перечисления.ОтветственныеЛицаОрганизаций.Руководитель;
	ОтветственноеЛицо.Должность          = ДанныеДолжности.Должность;
	ОтветственноеЛицо.СрокПолномочий     = ДанныеДолжности.СрокПолномочий;
	
	ОтветственныеЛица.Записать();
	
	РезультатФормированияДокументов.Вставить("Руководитель", Руководитель);
	
КонецПроцедуры

Процедура ЗаписатьФормированиеУставногоКапитала(РезультатФормированияДокументов, ДанныеУставногоКапитала, ДатаРегистрации = Неопределено)
	
	Организация  = РезультатФормированияДокументов.Организация;
	Руководитель = РезультатФормированияДокументов.Руководитель;
	
	Если ЗначениеЗаполнено(ДанныеУставногоКапитала.Ссылка) Тогда
		УставныйКапиталОбъект = ДанныеУставногоКапитала.Ссылка.ПолучитьОбъект();
	Иначе
		УставныйКапиталОбъект = Документы.ФормированиеУставногоКапитала.СоздатьДокумент();
		ЗаполнениеДокументов.Заполнить(УставныйКапиталОбъект);
	КонецЕсли;
	
	Если ЗначениеЗаполнено(ДатаРегистрации) Тогда
		УставныйКапиталОбъект.Дата = ДатаРегистрации;
	Иначе
		УставныйКапиталОбъект.Дата = ТекущаяДатаСеанса();
	КонецЕсли;
	ЗаполнитьЗначенияСвойств(УставныйКапиталОбъект, ДанныеУставногоКапитала, "УставныйКапитал, СпособРегистрации");
	УставныйКапиталОбъект.Организация = Организация;
	УставныйКапиталОбъект.СформированПомощникомРегистрации = Истина;
	УставныйКапиталОбъект.Учредители.Очистить();
	Если ДанныеУставногоКапитала.ЕдинственныйУчредительРуководитель Тогда
		НоваяСтрока = УставныйКапиталОбъект.Учредители.Добавить();
		НоваяСтрока.ТипУчредителя = Перечисления.ЮридическоеФизическоеЛицо.ФизическоеЛицо;
		НоваяСтрока.Учредитель    = Руководитель;
		НоваяСтрока.СуммаВзноса   = УставныйКапиталОбъект.УставныйКапитал;
	Иначе
		УставныйКапиталОбъект.Учредители.Загрузить(ДанныеУставногоКапитала.Учредители);
	КонецЕсли;
	
	УставныйКапиталОбъект.Комментарий =  НСтр("ru='#Сформирован помощником регистрации'");
	
	Если УставныйКапиталОбъект.Проведен Тогда
		УставныйКапиталОбъект.Записать(РежимЗаписиДокумента.Проведение);
	Иначе
		УставныйКапиталОбъект.Записать(РежимЗаписиДокумента.Запись);
	КонецЕсли;
	
	РезультатФормированияДокументов.Вставить("УставныйКапитал", УставныйКапиталОбъект.Ссылка);
	
КонецПроцедуры

Процедура ЗаписатьДанныеУведомленияОПереходеНаУСН(Организация, КодНалоговогоОргана, Подписант, СпособРегистрации)
	
	ПараметрыУведомленияОПереходеНаУСН = ПараметрыУведомленияОПереходеНаУСН(Организация, КодНалоговогоОргана, Подписант, СпособРегистрации);
	
	ВидУведомления = Перечисления.ВидыУведомленийОСпецрежимахНалогообложения.УведомлениеОПереходеНаУСН;
	ИмяФормыПоУмолчанию = Отчеты.РегламентированноеУведомлениеПереходНаУСН.ПолучитьФормуПоУмолчанию();
	
	ЗаявлениеОПереходеНаУСН = НайтиУведомлениеОСпецРежимеНалогообложения(Организация, ВидУведомления, ИмяФормыПоУмолчанию);
	
	Отчеты.РегламентированноеУведомлениеПереходНаУСН.СоздатьЗаполненноеУведомление(
				ПараметрыУведомленияОПереходеНаУСН, ЗаявлениеОПереходеНаУСН);
	
КонецПроцедуры

Процедура ЗаписатьАдресОрганизации(ОрганизацияОбъект, АдресЗначениеJSON)
	
	Если Не ЗначениеЗаполнено(АдресЗначениеJSON) Тогда
		Возврат;
	КонецЕсли;
	
	УправлениеКонтактнойИнформацией.ДобавитьКонтактнуюИнформацию(ОрганизацияОбъект, АдресЗначениеJSON,
			Справочники.ВидыКонтактнойИнформации.ЮрАдресОрганизации);
	
	УправлениеКонтактнойИнформацией.ДобавитьКонтактнуюИнформацию(ОрганизацияОбъект, АдресЗначениеJSON,
			Справочники.ВидыКонтактнойИнформации.ПочтовыйАдресОрганизации);
	
	УправлениеКонтактнойИнформацией.ДобавитьКонтактнуюИнформацию(ОрганизацияОбъект, АдресЗначениеJSON,
			Справочники.ВидыКонтактнойИнформации.ФактАдресОрганизации);
	
КонецПроцедуры

Процедура ПрисоединитьКвитанциюНаОплатуГоспошлиныКОрганизации(Организация, АдресКвитанцииНаОплатуГоспошлины)
	
	СуществующаяКвитанция = ПрисоединенныйФайлКвитанцииНаОплатуГоспошлиныОрганизации(Организация);
	Если СуществующаяКвитанция = Неопределено Тогда
		ПараметрыФайла = Новый Структура();
		ПараметрыФайла.Вставить("ВремяИзмененияУниверсальное", Неопределено);
		ПараметрыФайла.Вставить("Автор", Пользователи.ТекущийПользователь());
		ПараметрыФайла.Вставить("ВладелецФайлов", Организация);
		ПараметрыФайла.Вставить("ИмяБезРасширения", ИменаФайлов().КвитанцияНаОплатуГоспошлины);
		ПараметрыФайла.Вставить("РасширениеБезТочки", "pdf");
		РаботаСФайлами.ДобавитьФайл(ПараметрыФайла, АдресКвитанцииНаОплатуГоспошлины);
	Иначе
		
		ПараметрыФайла = Новый Структура();
		ПараметрыФайла.Вставить("АдресФайлаВоВременномХранилище", АдресКвитанцииНаОплатуГоспошлины);
		ПараметрыФайла.Вставить("АдресВременногоХранилищаТекста", "");
		РаботаСФайлами.ОбновитьФайл(СуществующаяКвитанция, ПараметрыФайла);
		Если ОбщегоНазначения.ЗначениеРеквизитаОбъекта(СуществующаяКвитанция, "ПометкаУдаления") Тогда
			СуществующаяКвитанцияОбъект = СуществующаяКвитанция.ПолучитьОбъект();
			СуществующаяКвитанцияОбъект.УстановитьПометкуУдаления(Ложь, Истина);
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры

Процедура ПометитьНаУдалениеКвитанциюНаОплатуГоспошлины(Организация)
	
	СуществующаяКвитанция = ПрисоединенныйФайлКвитанцииНаОплатуГоспошлиныОрганизации(Организация);
	Если СуществующаяКвитанция <> Неопределено Тогда
		СуществующаяКвитанцияОбъект = СуществующаяКвитанция.ПолучитьОбъект();
		СуществующаяКвитанцияОбъект.УстановитьПометкуУдаления(Истина, Истина);
	КонецЕсли;
	
КонецПроцедуры

Функция ПрисоединенныйФайлКвитанцииНаОплатуГоспошлиныОрганизации(Организация) Экспорт
	
	Возврат Справочники.Организации.ПрикрепленныйФайлПоИмени(Организация, ИменаФайлов().КвитанцияНаОплатуГоспошлины)
	
КонецФункции

Функция ПараметрыЗаявленияОРегистрации(Организация, СпособРегистрации)
	
	ПараметрыЗаполнения = Новый Структура;
	ПараметрыЗаполнения.Вставить("Организация", Организация);
	ПараметрыЗаполнения.Вставить("СпособРегистрации", СпособРегистрации);
	
	ПараметрыЗаявления = Новый Структура;
	ПараметрыЗаявления.Вставить("Организация", Организация);
	ПараметрыЗаявления.Вставить("ДополнительныеПараметры", ПараметрыЗаполнения);
	
	Возврат ПараметрыЗаявления;
	
КонецФункции

Функция ПараметрыУведомленияОПереходеНаУСН(Организация, КодНалоговогоОргана, Подписант, СпособРегистрации)
	
	ПараметрыЗаполнения = Новый Структура;
	ПараметрыЗаполнения.Вставить("Организация",       Организация);
	ПараметрыЗаполнения.Вставить("СпособРегистрации", СпособРегистрации);
	ПараметрыЗаполнения.Вставить("КОД_НО",            КодНалоговогоОргана);
	Если СпособРегистрации = 2 Тогда
		
		ПараметрыЗаполнения.Вставить("ПризнакПодписанта", "2");
		
	Иначе
		ПараметрыЗаполнения.Вставить("ПризнакПодписанта", "1");
		
		ПредставлениеТелефона = УправлениеКонтактнойИнформацией.ПредставлениеКонтактнойИнформации(
			Подписант.ТелефонРабочийЗначениеJSON,
			Справочники.ВидыКонтактнойИнформации.ТелефонРабочийФизическиеЛица);
		ПараметрыЗаполнения.Вставить("НомерТелефонаПодписанта", ПредставлениеТелефона);
		Если ОбщегоНазначения.ЗначениеРеквизитаОбъекта(Организация, "ЮридическоеФизическоеЛицо") =
				Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо Тогда
			ПараметрыЗаполнения.Вставить("ФамилияПодписанта",       Подписант.Фамилия);
			ПараметрыЗаполнения.Вставить("ИмяПодписанта",           Подписант.Имя);
			ПараметрыЗаполнения.Вставить("ОтчествоПодписанта",      Подписант.Отчество);
		КонецЕсли;
	КонецЕсли;
	
	ПараметрыЗаявления = Новый Структура;
	ПараметрыЗаявления.Вставить("Организация", Организация);
	ПараметрыЗаявления.Вставить("ДополнительныеПараметры", ПараметрыЗаполнения);
	
	Возврат ПараметрыЗаявления;
	
КонецФункции

#КонецОбласти

#Область РегистрацияОрганизации

// Заполнение уведомления о постановке ИП на учет в качестве налогоплательщика.
//
Процедура ЗаполнитьУведомлениеОПостановкеНаУчетИП(ПараметрыОтчета, Контейнер) Экспорт
	
	ПараметрыЗаполнения = ПараметрыОтчета.ПараметрыЗаполнения;
	
	СписокПоказателей = Новый Массив;
	СписокПоказателей.Добавить("ФамилияИП");
	СписокПоказателей.Добавить("ИмяИП");
	СписокПоказателей.Добавить("ОтчествоИП");
	СписокПоказателей.Добавить("ИННФЛ");
	СписокПоказателей.Добавить("Пол");
	СписокПоказателей.Добавить("ДатаРожд");
	СписокПоказателей.Добавить("МестоРождИП");
	СписокПоказателей.Добавить("Гражд");
	СписокПоказателей.Добавить("КодУдЛичн");
	СписокПоказателей.Добавить("СерияУдЛичн");
	СписокПоказателей.Добавить("НомерУдЛичн");
	СписокПоказателей.Добавить("ДатаУдЛичн");
	СписокПоказателей.Добавить("ОрганВыданУдЛичн");
	СписокПоказателей.Добавить("КодПодрУдЛичн");
	СписокПоказателей.Добавить("ТелСлуж");
	СписокПоказателей.Добавить("АдресЭлектроннойПочтыОрганизации");
	СписокПоказателей.Добавить("ОКВЭД2");
	СписокПоказателей.Добавить("ДополнительныеКодыОКВЭД2");
	
	СведенияОбОрганизации = РегламентированнаяОтчетностьПереопределяемый.ПолучитьСведенияОбОрганизации(ПараметрыОтчета.Организация, ТекущаяДатаСеанса(), СписокПоказателей);
	
	СпособРегистрации = 0;
	ПараметрыЗаполнения.Свойство("СпособРегистрации", СпособРегистрации);
	
	#Область Стр001
	
	ДанныеЛиста = Новый Структура;
	ДанныеЛиста.Вставить("П01010101", СведенияОбОрганизации.ФамилияИП);
	ДанныеЛиста.Вставить("П01010102", СведенияОбОрганизации.ИмяИП);
	ДанныеЛиста.Вставить("П01010103", СведенияОбОрганизации.ОтчествоИП);
	ДанныеЛиста.Вставить("П01020000", СведенияОбОрганизации.ИННФЛ);
	ДанныеЛиста.Вставить("П01030000", СведенияОбОрганизации.Пол);
	ДанныеЛиста.Вставить("П01040100", Формат(СведенияОбОрганизации.ДатаРожд, "Л=ru; ДФ=dd.MM.yyyy"));
	ДанныеЛиста.Вставить("П01040200", СведенияОбОрганизации.МестоРождИП);
	Если СведенияОбОрганизации.Гражд = "643" Тогда
		// Гражданин РФ
		ДанныеЛиста.Вставить("П01050000", 1);
		ДанныеЛиста.Вставить("П01050100", "");
	ИначеЕсли ЗначениеЗаполнено(СведенияОбОрганизации.Гражд) Тогда
		// Иностранец
		ДанныеЛиста.Вставить("П01010201", СтроковыеФункцииКлиентСервер.СтрокаЛатиницей(СведенияОбОрганизации.ФамилияИП));
		ДанныеЛиста.Вставить("П01010202", СтроковыеФункцииКлиентСервер.СтрокаЛатиницей(СведенияОбОрганизации.ИмяИП));
		ДанныеЛиста.Вставить("П01010203", СтроковыеФункцииКлиентСервер.СтрокаЛатиницей(СведенияОбОрганизации.ОтчествоИП));
		ДанныеЛиста.Вставить("П01050000", 2);
		ДанныеЛиста.Вставить("П01050100", СведенияОбОрганизации.Гражд);
	Иначе 
		//Лицо без гражданства
		ДанныеЛиста.Вставить("П01010201", СтроковыеФункцииКлиентСервер.СтрокаЛатиницей(СведенияОбОрганизации.ФамилияИП));
		ДанныеЛиста.Вставить("П01010202", СтроковыеФункцииКлиентСервер.СтрокаЛатиницей(СведенияОбОрганизации.ИмяИП));
		ДанныеЛиста.Вставить("П01010203", СтроковыеФункцииКлиентСервер.СтрокаЛатиницей(СведенияОбОрганизации.ОтчествоИП));
		ДанныеЛиста.Вставить("П01050000", 3);
		ДанныеЛиста.Вставить("П01050100", "");
	КонецЕсли;
	
	Контейнер.Вставить("Лист001", ДанныеЛиста);
	
	#КонецОбласти
	
	#Область Стр002
	
	ДанныеЛиста = Новый Структура;
	// Адрес
	АдресСтруктурой = УправлениеКонтактнойИнформациейБП.АдресСтруктурой(ПараметрыОтчета.Организация,
		Справочники.ВидыКонтактнойИнформации.ЮрАдресОрганизации, , Ложь);
	
	ДанныеЛиста.Вставить("Индекс",                    АдресСтруктурой.Индекс);
	ДанныеЛиста.Вставить("КодРегиона",                АдресСтруктурой.КодРегиона);
	ДанныеЛиста.Вставить("РайонСокращение",           АдресСтруктурой.РайонСокращение);
	ДанныеЛиста.Вставить("Район",                     АдресСтруктурой.Район);
	ДанныеЛиста.Вставить("ГородСокращение",           АдресСтруктурой.ГородСокращение);
	ДанныеЛиста.Вставить("Город",                     АдресСтруктурой.Город);
	ДанныеЛиста.Вставить("НаселенныйПунктСокращение", АдресСтруктурой.НаселенныйПунктСокращение);
	ДанныеЛиста.Вставить("НаселенныйПункт",           АдресСтруктурой.НаселенныйПункт);
	ДанныеЛиста.Вставить("УлицаСокращение",           АдресСтруктурой.УлицаСокращение);
	ДанныеЛиста.Вставить("Улица",                     АдресСтруктурой.Улица);
	ДанныеЛиста.Вставить("ТипДома",                   АдресСтруктурой.ТипДома);
	ДанныеЛиста.Вставить("Дом",                       АдресСтруктурой.Дом);
	ДанныеЛиста.Вставить("ТипКорпуса",                АдресСтруктурой.ТипКорпуса);
	ДанныеЛиста.Вставить("Корпус",                    АдресСтруктурой.Корпус);
	ДанныеЛиста.Вставить("ТипКвартиры",               АдресСтруктурой.ТипКвартиры);
	ДанныеЛиста.Вставить("Квартира",                  АдресСтруктурой.Квартира);
	
	// Удостоверение личности
	ДанныеЛиста.Вставить("П01070100", СведенияОбОрганизации.КодУдЛичн);
	ДанныеЛиста.Вставить("П01070200", СведенияОбОрганизации.СерияУдЛичн + " " + СведенияОбОрганизации.НомерУдЛичн);
	ДанныеЛиста.Вставить("П01070300", Формат(СведенияОбОрганизации.ДатаУдЛичн, "Л=ru; ДФ=dd.MM.yyyy"));
	ДанныеЛиста.Вставить("П01070400", СведенияОбОрганизации.ОрганВыданУдЛичн);
	
	ПозицияРазделителя = СтрНайти(СведенияОбОрганизации.КодПодрУдЛичн, "-");
	
	ДанныеЛиста.Вставить("П01070501", Сред(СведенияОбОрганизации.КодПодрУдЛичн, 1, ПозицияРазделителя-1));
	ДанныеЛиста.Вставить("П01070502", Сред(СведенияОбОрганизации.КодПодрУдЛичн,ПозицияРазделителя + 1));
	
	Контейнер.Вставить("Лист002", ДанныеЛиста);
	
	#КонецОбласти
	
	#Область Стр003
	// Документы иностранцев или лиц без гражданства
	
	Если СведенияОбОрганизации.КодУдЛичн = "12" Тогда
		// Вид на жительство
		КодРазрешения = "1";
	ИначеЕсли СведенияОбОрганизации.КодУдЛичн = "15" Тогда
		// Разрешение на временное проживание
		КодРазрешения = "2";
	Иначе
		КодРазрешения = "";
	КонецЕсли;
	
	Если КодРазрешения <> "" Тогда
		
		ДанныеЛиста = Новый Структура;
		ДанныеЛиста.Вставить("П01080100", КодРазрешения);
		ДанныеЛиста.Вставить("П01080200", СведенияОбОрганизации.СерияУдЛичн + " " + СведенияОбОрганизации.НомерУдЛичн);
		ДанныеЛиста.Вставить("П01080300", Формат(СведенияОбОрганизации.ДатаУдЛичн, "Л=ru; ДФ=dd.MM.yyyy"));
		ДанныеЛиста.Вставить("П01080400", СведенияОбОрганизации.ОрганВыданУдЛичн);
		ДанныеЛиста.Вставить("П01080500", "");
		
		Контейнер.Вставить("Лист003", ДанныеЛиста);
	КонецЕсли;
	
	#КонецОбласти
	
	#Область ЛистА
	
	// Сведения о кодах по Общероссийскому классификатору видов экономической деятельности. 
	
	// Основной код
	Контейнер.Лист004.А01010000 = СведенияОбОрганизации.ОКВЭД2;
	// Дополнительные коды
	ДополнительныеКоды = СтрРазделить(СведенияОбОрганизации.ДополнительныеКодыОКВЭД2, ";", Ложь);
	Если ДополнительныеКоды.Количество() > 0 Тогда
		Контейнер.МногострочнаяЧасть1.Очистить();
		Для каждого ДополнительныйКод Из ДополнительныеКоды Цикл
			НоваяСтрока = Контейнер.МногострочнаяЧасть1.Добавить();
			НоваяСтрока.А01020000 = ДополнительныйКод;
		КонецЦикла;
	КонецЕсли;
	
	#КонецОбласти
	
	#Область ЛистБ
	
	ДанныеЛиста = Новый Структура;
	ДанныеЛиста.Вставить("Б01010000", СпособРегистрации);
	ДанныеЛиста.Вставить("Б01020000", СведенияОбОрганизации.ТелСлуж);
	ДанныеЛиста.Вставить("Б01030000", СведенияОбОрганизации.АдресЭлектроннойПочтыОрганизации);
	ДанныеЛиста.Вставить("Б03010000", "");
	ДанныеЛиста.Вставить("Б03020000", "");
	
	Контейнер.Вставить("Лист005", ДанныеЛиста);
	
	#КонецОбласти

КонецПроцедуры

// Заполнение уведомления о постановке ООО на учет в качестве налогоплательщика.
//
Процедура ЗаполнитьУведомлениеОПостановкеНаУчетООО(ПараметрыОтчета, Контейнер) Экспорт
	
	ДанныеУчредителей = ДанныеУчредителейОрганизации(ПараметрыОтчета.Организация, ТекущаяДатаСеанса(), Истина);
	Если ДанныеУчредителей = Неопределено Тогда
		Возврат;
	КонецЕсли;
	ДанныеРуководителя = ДанныеРуководителяОрганизации(ПараметрыОтчета.Организация, ТекущаяДатаСеанса(), Истина);
	Если ДанныеРуководителя = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	ПараметрыЗаполнения = ПараметрыОтчета.ПараметрыЗаполнения;
	
	СведенияОбОрганизации = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(ПараметрыОтчета.Организация,
		"НаименованиеПолное,НаименованиеСокращенное,КодОКВЭД2,ДополнительныеКодыОКВЭД2");
	
	#Область Лист001
	
	// Полное наименование
	Контейнер.Лист001.П01010100 = СведенияОбОрганизации.НаименованиеПолное;
	// Сокращенное наименование
	Контейнер.Лист001.П01010200 = СведенияОбОрганизации.НаименованиеСокращенное;
	// Уставный капитал
	Контейнер.Лист001.П01030100 = ДанныеУчредителей.УставныйКапитал;
	// Адрес
	АдресСтруктурой = УправлениеКонтактнойИнформациейБП.АдресСтруктурой(ПараметрыОтчета.Организация, 
		Справочники.ВидыКонтактнойИнформации.ЮрАдресОрганизации, , Ложь);
	ЗаполнитьЗначенияСвойств(Контейнер.Лист001, АдресСтруктурой);
	// Вид капитала
	Контейнер.Лист001.П01030000 = 1; // Уставный капитал
	
	#КонецОбласти
	
	#Область ЛистА
	
	// Сведения об учредителе - российском юридическом лице.

	ШаблонЛиста = СкопироватьКлючиСтруктуры(Контейнер.ЛистА[0].Значение);
	Контейнер.ЛистА.Очистить();
	УчредителиЮридическиеЛица = ДанныеУчредителей.Учредители.Скопировать(Новый Структура("ЭтоЮридическоеЛицо", Истина));
	Если УчредителиЮридическиеЛица.Количество() > 0 Тогда
		Для каждого СтрокаТаблицы Из УчредителиЮридическиеЛица Цикл
			НовыйЛист = СкопироватьКлючиСтруктуры(ШаблонЛиста);
			// Реквизиты
			НовыйЛист.А01010000 = СтрокаТаблицы.СведенияОЮридическомЛице.ОГРН;
			НовыйЛист.А01020000 = СтрокаТаблицы.СведенияОЮридическомЛице.ИНН;
			НовыйЛист.А01030000 = СтрокаТаблицы.СведенияОЮридическомЛице.ПолноеНаименование;
			// Доля в уставном капитале
			НовыйЛист.А01040100 = СтрокаТаблицы.СуммаВзноса;
			НовыйЛист.А01040201 = СтрокаТаблицы.ДоляУставногоКапитала;
			
			Контейнер.ЛистА.Добавить(НовыйЛист);
		КонецЦикла;
	Иначе
		Контейнер.ЛистА.Добавить(ШаблонЛиста);
	КонецЕсли;
	
	#КонецОбласти
	
	#Область ЛистБ
		
	// Сведения об учредителе - иностранном юридическом лице. 
	// Не заполняется.

	#КонецОбласти
	
	#Область ЛистВ
	
	// Сведения об учредителе - физическом лице.

	ШаблонЛиста = СкопироватьКлючиСтруктуры(Контейнер.ЛистВ[0].Значение);
	Контейнер.ЛистВ.Очистить();
	УчредителиФизическиеЛица = ДанныеУчредителей.Учредители.Скопировать(Новый Структура("ЭтоЮридическоеЛицо", Ложь));
	Если УчредителиФизическиеЛица.Количество() > 0 Тогда
		Для каждого СтрокаТаблицы Из УчредителиФизическиеЛица Цикл
			НовыйЛист = СкопироватьКлючиСтруктуры(ШаблонЛиста);
			СведенияОФизическомЛице = СтрокаТаблицы.СведенияОФизическомЛице;
			// ФИО
			НовыйЛист.В01010100 = СведенияОФизическомЛице.Фамилия;
			НовыйЛист.В01010200 = СведенияОФизическомЛице.Имя;
			НовыйЛист.В01010300 = СведенияОФизическомЛице.Отчество;
			// ИНН
			НовыйЛист.В01020000 = СведенияОФизическомЛице.ИНН;
			// Дата и место рождения
			НовыйЛист.В01030100 = Формат(СведенияОФизическомЛице.ДатаРождения, "Л=ru; ДФ=dd.MM.yyyy");
			НовыйЛист.В01030200 = СведенияОФизическомЛице.МестоРожденияПредставление;
			// Паспортные данные
			НовыйЛист.В01050100 = СведенияОФизическомЛице.ДокументКодМВД;
			НовыйЛист.В01050200 = "" + СведенияОФизическомЛице.ДокументСерия + " " + СведенияОФизическомЛице.ДокументНомер;
			НовыйЛист.В01050300 = Формат(СведенияОФизическомЛице.ДокументДатаВыдачи, "Л=ru; ДФ=dd.MM.yyyy");
			НовыйЛист.В01050400 = СведенияОФизическомЛице.ДокументКемВыдан;
			ЧастиКодаПодразделения = СтрРазделить("" + СведенияОФизическомЛице.ДокументКодПодразделения, "-", Ложь);
			Если ЧастиКодаПодразделения.Количество() = 2 Тогда
				НовыйЛист.В01050501 = ЧастиКодаПодразделения[0];
				НовыйЛист.В01050502 = ЧастиКодаПодразделения[1];
			КонецЕсли;
			// Доля в уставном капитале
			НовыйЛист.В01070100 = СтрокаТаблицы.СуммаВзноса;
			НовыйЛист.В01070201 = СтрокаТаблицы.ДоляУставногоКапитала;
			// Адрес
			ЗаполнитьЗначенияСвойств(НовыйЛист, СведенияОФизическомЛице.АдресСтруктурой);
			
			Контейнер.ЛистВ.Добавить(НовыйЛист);
		КонецЦикла;
	Иначе
		Контейнер.ЛистВ.Добавить(ШаблонЛиста);
	КонецЕсли;
	
	#КонецОбласти
	
	#Область ЛистГ
		
	// Сведения об учредителе - Российской Федерации, субъекте Российской Федерации, муниципальном образовании. 
	// Не заполняется.

	#КонецОбласти
	
	#Область ЛистД
		
	// Сведения о паевом инвестиционном фонде, в состав имущества которого включается доля в уставном капитале 
	// создаваемого юридического лица. 
	// Не заполняется.

	#КонецОбласти
	
	#Область ЛистЕ
		
	// Сведения о физическом лице, имеющем право без доверенности действовать от имени юридического лица. 
	
	ШаблонЛиста = СкопироватьКлючиСтруктуры(Контейнер.ЛистЕ[0].Значение);
	Контейнер.ЛистЕ.Очистить();
	
	НовыйЛист = СкопироватьКлючиСтруктуры(ШаблонЛиста);
	СведенияОФизическомЛице = ДанныеРуководителя.СведенияОФизическомЛице;
	// ФИО
	НовыйЛист.Е01010000 = СведенияОФизическомЛице.Фамилия;
	НовыйЛист.Е01020000 = СведенияОФизическомЛице.Имя;
	НовыйЛист.Е01030000 = СведенияОФизическомЛице.Отчество;
	// ИНН
	НовыйЛист.Е02000000 = СведенияОФизическомЛице.ИНН;
	// Дата и место рождения
	НовыйЛист.Е03010000 = Формат(СведенияОФизическомЛице.ДатаРождения, "Л=ru; ДФ=dd.MM.yyyy");
	НовыйЛист.Е03020000 = СведенияОФизическомЛице.МестоРожденияПредставление;
	// Должность
	НовыйЛист.Е04000000 = ДанныеРуководителя.ДолжностьПредставление;
	// Паспортные данные
	НовыйЛист.Е05010000 = СведенияОФизическомЛице.ДокументКодМВД;
	НовыйЛист.Е05020000 = "" + СведенияОФизическомЛице.ДокументСерия + " " + СведенияОФизическомЛице.ДокументНомер;
	НовыйЛист.Е05030000 = Формат(СведенияОФизическомЛице.ДокументДатаВыдачи, "Л=ru; ДФ=dd.MM.yyyy");
	НовыйЛист.Е05040000 = СведенияОФизическомЛице.ДокументКемВыдан;
	ЧастиКодаПодразделения = СтрРазделить("" + СведенияОФизическомЛице.ДокументКодПодразделения, "-", Ложь);
	Если ЧастиКодаПодразделения.Количество() = 2 Тогда
		НовыйЛист.Е05050100 = ЧастиКодаПодразделения[0];
		НовыйЛист.Е05050200 = ЧастиКодаПодразделения[1];
	КонецЕсли;
	// Адрес
	ЗаполнитьЗначенияСвойств(НовыйЛист, СведенияОФизическомЛице.АдресСтруктурой);
	// Телефон
	НовыйЛист.Е07000000 = СведенияОФизическомЛице.Телефон;
	
	Контейнер.ЛистЕ.Добавить(НовыйЛист);

	#КонецОбласти
	
	#Область ЛистЖ
		
	// Сведения об управляющей организации. 
	// Не заполняется.

	#КонецОбласти
	
	#Область ЛистЗ
		
	// Сведения об управляющем. 
	// Не заполняется.

	#КонецОбласти
	
	#Область ЛистИ
		
	// Сведения о кодах по Общероссийскому классификатору видов экономической деятельности. 
	
	// Основной код
	Контейнер.ЛистИ.А01010000 = СведенияОбОрганизации.КодОКВЭД2;
	// Дополнительные коды
	ДополнительныеКоды = СтрРазделить(СведенияОбОрганизации.ДополнительныеКодыОКВЭД2, ";", Ложь);
	Если ДополнительныеКоды.Количество() > 0 Тогда
		Контейнер.МногострочнаяЧасть1.Очистить();
		Для каждого ДополнительныйКод Из ДополнительныеКоды Цикл
			НоваяСтрока = Контейнер.МногострочнаяЧасть1.Добавить();
			НоваяСтрока.А01020000 = ДополнительныйКод;
		КонецЦикла;
	КонецЕсли;
	
	#КонецОбласти
	
	#Область ЛистК
		
	// Сведения о держателе реестра акционеров акционерного общества - регистраторе.
	// Не заполняется.

	#КонецОбласти
	
	#Область ЛистЛ
		
	// Сведения о крестьянском (фермерском) хозяйстве, на базе которого создается производственный кооператив
	// или хозяйственное товарищество.
	// Не заполняется.

	#КонецОбласти
	
	#Область ЛистМ
		
	// Сведения о согласовании создания юридического лица с иностранными инвестициями 
	// на территории закрытого административно-территориального образования (ЗАТО).
	// Не заполняется.

	#КонецОбласти
	
	#Область ЛистН
	
	// Сведения о заявителе.

	ШаблонЛиста = СкопироватьКлючиСтруктуры(Контейнер.ЛистН[0].Значение);
	Контейнер.ЛистН.Очистить();
	
	КоличествоУчредителей = ДанныеУчредителей.Учредители.Количество();
	
	НомерЛиста = 0;
	Для каждого СтрокаТаблицы Из ДанныеУчредителей.Учредители Цикл
		
		НомерЛиста = НомерЛиста + 1;
		
		НовыйЛист = СкопироватьКлючиСтруктуры(ШаблонЛиста);
		// Вид заявителя
		// Если проставлено значение 1, заполняются разделы 4, 5.
		// Если проставлено значение 2, заполняются разделы 2, 4, 5.
		НовыйЛист.Н01000000 = ?(СтрокаТаблицы.ЭтоЮридическоеЛицо, 2, 1);
		
		// Реквизиты юридического лица
		Если СтрокаТаблицы.ЭтоЮридическоеЛицо И КоличествоУчредителей > 1 Тогда
			// В случае если лист Н заявления заполняется в отношении единственного учредителя - юридического лица
			// (в разделе 1 проставлено значение 2), раздел 2 не заполняется.
			НовыйЛист.Н02010000 = СтрокаТаблицы.СведенияОЮридическомЛице.ОГРН;
			НовыйЛист.Н02020000 = СтрокаТаблицы.СведенияОЮридическомЛице.ИНН;
			НовыйЛист.Н02030000 = СтрокаТаблицы.СведенияОЮридическомЛице.ПолноеНаименование;
		КонецЕсли;
		
		// Заявитель
		СведенияОЗаявителе = ?(СтрокаТаблицы.ЭтоЮридическоеЛицо,
			СтрокаТаблицы.СведенияОЮридическомЛице.Представитель,
			СтрокаТаблицы.СведенияОФизическомЛице);
		
		// Телефон заявителя
		НовыйЛист.Н04060100 = СведенияОЗаявителе.Телефон;
		// Email заявителя
		НовыйЛист.Н04060200 = СведенияОЗаявителе.Email;
		
		Если СтрокаТаблицы.ЭтоЮридическоеЛицо Или КоличествоУчредителей > 1 Тогда
			// В случае если лист Н заявления заполняется в отношении единственного учредителя - физического лица
			// (в разделе 1 проставлено значение 1), раздел 4 не заполняется.
			
			// ФИО
			НовыйЛист.Н04010100 = СведенияОЗаявителе.Фамилия;
			НовыйЛист.Н04010200 = СведенияОЗаявителе.Имя;
			НовыйЛист.Н04010300 = СведенияОЗаявителе.Отчество;
			// ИНН
			НовыйЛист.Н04020000 = СведенияОЗаявителе.ИНН;
			// Дата и место рождения
			НовыйЛист.Н04030100 = Формат(СведенияОЗаявителе.ДатаРождения, "Л=ru; ДФ=dd.MM.yyyy");
			НовыйЛист.Н04030200 = СведенияОЗаявителе.МестоРожденияПредставление;
			// Паспортные данные
			НовыйЛист.Н04040100 = СведенияОЗаявителе.ДокументКодМВД;
			НовыйЛист.Н04040200 = "" + СведенияОЗаявителе.ДокументСерия + " " + СведенияОЗаявителе.ДокументНомер;
			НовыйЛист.Н04040300 = Формат(СведенияОЗаявителе.ДокументДатаВыдачи, "Л=ru; ДФ=dd.MM.yyyy");
			НовыйЛист.Н04040400 = СведенияОЗаявителе.ДокументКемВыдан;
			ЧастиКодаПодразделения = СтрРазделить("" + СведенияОЗаявителе.ДокументКодПодразделения, "-", Ложь);
			Если ЧастиКодаПодразделения.Количество() = 2 Тогда
				НовыйЛист.Н04040501 = ЧастиКодаПодразделения[0];
				НовыйЛист.Н04040502 = ЧастиКодаПодразделения[1];
			КонецЕсли;
			// Адрес
			ЗаполнитьЗначенияСвойств(НовыйЛист, СведенияОЗаявителе.АдресСтруктурой);
			
		КонецЕсли;
		
		// Получение документов
		Если НомерЛиста = 1 Тогда
			// В случае если лист Н заявления оформляется в отношении двух и более лиц, поле, состоящее из одного знакоместа,
			// заполняется только на первом из оформляемых листов Н заявления.
			
			// Пока поддерживается только регистрация руководителем по доверенности.
			НовыйЛист.Н05000000 = ?(ДанныеУчредителей.СпособРегистрации = 1, 2, ДанныеУчредителей.СпособРегистрации);
			
		КонецЕсли;
		
		Контейнер.ЛистН.Добавить(НовыйЛист);
		
	КонецЦикла;
	
	#КонецОбласти
	
КонецПроцедуры

// Возвращает табличный документ с инструкцией по регистрации ИП.
//
// Параметры:
//  СпособРегистрации - Число - Значения: "1" - лично, "2" - через преставителя, "3" - по почте
//  ВыборСпецрежимаНалогообложения - Структура - Ключи:
//                                    *УСН    - Булево - Выбран усн
//                                    *Патент - Булево - Выбран патент
//  ДанныеРегистрирующегоОргана - Структура - Ключи:
//                                *Наименование - Строка
//                                *Адрес - Строка
//                                *Телефон - Строка
// Возвращаемое значение:
//  Результат - Табличный документ
//
Функция ИнструкцияРегистрацияИП(СпособПодачиДокументов, ВыборСпецрежимаНалогообложения, ДанныеРегистрирующегоОргана, ДанныеНалоговойИнспекции) Экспорт
	
	СпособыПодачиДокументов = РегистрацияОрганизацииКлиентСервер.СпособыПодачиДокументов();
	
	Результат = Новый ТабличныйДокумент;
	
	ШаблонИнструкции = ПолучитьМакет("ИнструкцияРегистрацияИП");
	
	Параметры = Новый Структура;
	Параметры.Вставить("ДокументСпецрежимНалогообложения1",           "");
	Параметры.Вставить("ДокументСпецрежимНалогообложения1Примечание", "");
	Параметры.Вставить("ПолучениеДокументовСпецрежим1",               "");
	Параметры.Вставить("ДокументСпецрежимНалогообложения2",           "");
	Параметры.Вставить("ДокументСпецрежимНалогообложения2Примечание", "");
	Параметры.Вставить("ПолучениеДокументовСпецрежим2",               "");
	Параметры.Вставить("ДокументСпецрежимНалогообложенияВТексте",     "");
	Параметры.Вставить("НомерШага",                                   "");
	
	НомерСпецрежима = 0;
	
	Если ВыборСпецрежимаНалогообложения.УСН Тогда
		
		НомерСпецрежима = НомерСпецрежима + 1;
		
		ВДвухЭкземплярахТекст = ?(СпособПодачиДокументов = СпособыПодачиДокументов.Почта, "", " (2 экземпляра)");
		
		Параметры["ДокументСпецрежимНалогообложения" + НомерСпецрежима] = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
			НСтр("ru = 'Уведомление о переходе на УСН%1'"), ВДвухЭкземплярахТекст);
		Параметры["ДокументСпецрежимНалогообложения" + НомерСпецрежима + "Примечание"] = "Дата уведомления – дата подачи документа в ИФНС";
		
		Параметры["ПолучениеДокументовСпецрежим" + НомерСпецрежима] = "Получить один экземпляр уведомления о применении УСН с датой,
												 |печатью и подписью сотрудника налоговой";
		
		Параметры.ДокументСпецрежимНалогообложенияВТексте = НСтр("ru = 'уведомление о переходе на УСН'");
	КонецЕсли;
	
	Если ВыборСпецрежимаНалогообложения.Патент Тогда
		
		НомерСпецрежима = НомерСпецрежима + 1;
		
		Параметры["ДокументСпецрежимНалогообложения" + НомерСпецрежима]           = "Заявление на получение патента";
		Параметры["ДокументСпецрежимНалогообложения" + НомерСпецрежима + "Примечание"] = "Дата заявления – дата подачи документа в ИФНС";
		
	КонецЕсли;
	
	СпецРежим1 = (НомерСпецрежима > 0);
	СпецРежим2 = (НомерСпецрежима > 1);
	
	ОбщегоНазначенияКлиентСервер.ДополнитьСтруктуру(Параметры, ДанныеРегистрирующегоОргана);
	
	Область = ШаблонИнструкции.ПолучитьОбласть("Заголовок");
	
	Если СпособПодачиДокументов = СпособыПодачиДокументов.ИФНСлично
		Или СпособПодачиДокументов = СпособыПодачиДокументов.МФЦлично Тогда
		Область.Параметры.Заголовок = "Инструкция по регистрации ИП";
	ИначеЕсли СпособПодачиДокументов = СпособыПодачиДокументов.ИФНСпредставитель Тогда
		Область.Параметры.Заголовок = "Инструкция регистрации ИП через представителя";
	ИначеЕсли СпособПодачиДокументов = СпособыПодачиДокументов.Почта Тогда
		Область.Параметры.Заголовок = "Инструкция регистрации ИП по почте";
	КонецЕсли;
	
	Область.НижнийКолонтитул.Выводить              = Истина;
	Область.НижнийКолонтитул.ТекстСлева            = ОбщегоНазначенияБП.ДомашняяСтраницаСервиса();
	Область.НижнийКолонтитул.ТекстВЦентре          = ИмяПрограммы();
	Область.НижнийКолонтитул.НачальнаяСтраница     = 1;
	Область.НижнийКолонтитул.ВертикальноеПоложение = ВертикальноеПоложение.Центр;
	
	Результат.Вывести(Область);
	
	НомерШага = 0;
	
	ПараметрыИнструкции = НовыеПараметрыИнструкцииРегистрации();
	ПараметрыИнструкции.СпособПодачиДокументов = СпособПодачиДокументов;
	ПараметрыИнструкции.ЕстьАдресИнспекции     = ЗначениеЗаполнено(Параметры.НаименованиеФНС);
	ПараметрыИнструкции.СпецРежим1             = СпецРежим1;
	ПараметрыИнструкции.СпецРежим2             = СпецРежим2;
	ПараметрыИнструкции.РегистрацияЧерезМФЦ    = (СпособПодачиДокументов = СпособыПодачиДокументов.МФЦлично);
	
	Если СпособПодачиДокументов = СпособыПодачиДокументов.ИФНСпредставитель
		Или СпособПодачиДокументов = СпособыПодачиДокументов.Почта Тогда
		
		Область = ПолучитьОбластьИнструкцииРегистрация("ЗаверениеКопийУНотариуса", ШаблонИнструкции, ПараметрыИнструкции);
		Параметры.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
		Область.Параметры.Заполнить(Параметры);
		
		Результат.Вывести(Область);
		
	КонецЕсли;
	
	Область = ПолучитьОбластьИнструкцииРегистрация("ПодготовкаДокументов", ШаблонИнструкции, ПараметрыИнструкции);
	Параметры.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Область.Параметры.Заполнить(Параметры);
	Результат.Вывести(Область);
	
	Область = ПолучитьОбластьИнструкцииРегистрация("ПодачаДокументов", ШаблонИнструкции, ПараметрыИнструкции);
	Параметры.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Область.Параметры.Заполнить(Параметры);
	Результат.Вывести(Область);
	
	Результат.ВывестиГоризонтальныйРазделительСтраниц();
	
	Область = ПолучитьОбластьИнструкцииРегистрация("ПолучениеДокументов", ШаблонИнструкции, ПараметрыИнструкции);
	Параметры.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Область.Параметры.Заполнить(Параметры);
	Результат.Вывести(Область);
	
	Если СпособПодачиДокументов = СпособыПодачиДокументов.МФЦлично И СпецРежим1 Тогда
		// Документы спецрежима подаются в территориальную ИНФС
		ПараметрыИнструкции.РегистрацияЧерезМФЦ = Ложь;
		ПараметрыИнструкции.ЕстьАдресИнспекции = ЗначениеЗаполнено(ДанныеНалоговойИнспекции.НаименованиеФНС);
		
		Область = ПолучитьОбластьИнструкцииРегистрация("ПодачаДокументовСпецрежим", ШаблонИнструкции, ПараметрыИнструкции);
		Параметры.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
		Параметры.Вставить("НаименованиеФНС", ДанныеНалоговойИнспекции.НаименованиеФНС);
		Параметры.Вставить("АдресФНС",        ДанныеНалоговойИнспекции.АдресФНС);
		Параметры.Вставить("ТелефонФНС",      ДанныеНалоговойИнспекции.ТелефонФНС);
		Область.Параметры.Заполнить(Параметры);
		Результат.Вывести(Область);
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции

Функция ИнструкцияРегистрацииООО(КоличествоУчредителей, ОдинУчредительЮридическоеЛицо, СпособПодачиДокументов, ВыборСпецрежимаНалогообложения, ДанныеРегистрирующегоОргана, ДанныеНалоговойИнспекции, УникальныйИдентификатор) Экспорт
	
	ОдинУчредитель = КоличествоУчредителей = 1;
	ИмяМакетаИнструкция = ?(ОдинУчредитель, "ИнструкцияРегистрацииОООДляОдногоУчредителя",
		"ИнструкцияРегистрацииОООДляНесколькихУчредителей");
	ШаблонИнструкции = ПолучитьМакет(ИмяМакетаИнструкция);
	
	СпособыПодачиДокументов = РегистрацияОрганизацииКлиентСервер.СпособыПодачиДокументов();
	
	Результат = Новый ТабличныйДокумент;
	Результат.ПолеСверху = 5;
	Результат.ПолеСлева  = 10;
	Результат.ПолеСправа = 10;
	
	ОбластьЗаголовка = ШаблонИнструкции.ПолучитьОбласть("Заголовок");
	Если СпособПодачиДокументов = СпособыПодачиДокументов.ИФНСлично
		Или СпособПодачиДокументов = СпособыПодачиДокументов.МФЦлично Тогда
		ОбластьЗаголовка.Параметры.Заголовок = "Инструкция по регистрации ООО";
	ИначеЕсли СпособПодачиДокументов = СпособыПодачиДокументов.ИФНСпредставитель Тогда
		ОбластьЗаголовка.Параметры.Заголовок = "Инструкция регистрации ООО через представителя";
	ИначеЕсли СпособПодачиДокументов = СпособыПодачиДокументов.Почта Тогда
		ОбластьЗаголовка.Параметры.Заголовок = "Инструкция регистрации ООО по почте";
	КонецЕсли;
	
	ОбластьЗаголовка.НижнийКолонтитул.Выводить              = Истина;
	ОбластьЗаголовка.НижнийКолонтитул.ТекстСлева            = ОбщегоНазначенияБП.ДомашняяСтраницаСервиса();
	ОбластьЗаголовка.НижнийКолонтитул.ТекстВЦентре          = ИмяПрограммы();
	ОбластьЗаголовка.НижнийКолонтитул.НачальнаяСтраница     = 1;
	ОбластьЗаголовка.НижнийКолонтитул.ВертикальноеПоложение = ВертикальноеПоложение.Центр;
	
	Результат.Вывести(ОбластьЗаголовка);
	
	НомерШага = 0;
	
	ПараметрыИнструкции = НовыеПараметрыИнструкцииРегистрации();
	ПараметрыИнструкции.СпособПодачиДокументов  = СпособПодачиДокументов;
	ПараметрыИнструкции.ЕстьАдресИнспекции = ЗначениеЗаполнено(ДанныеРегистрирующегоОргана.НаименованиеФНС);
	ПараметрыИнструкции.СпецРежим1         = ВыборСпецрежимаНалогообложения.УСН;
	ПараметрыИнструкции.ОдинУчредительЮридическоеЛицо = ОдинУчредительЮридическоеЛицо;
	ПараметрыИнструкции.РегистрацияЧерезМФЦ = (СпособПодачиДокументов = СпособыПодачиДокументов.МФЦлично);
	
	Если Не ОдинУчредитель Тогда
		
		Область = ПолучитьОбластьИнструкцииРегистрация("ПроведениеСобранияУчредителей", ШаблонИнструкции, ПараметрыИнструкции);
		Параметры = Новый Структура();
		Параметры.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
		Параметры.Вставить("КоличествоЭкземпляров", КоличествоУчредителей + 1);
		Область.Параметры.Заполнить(Параметры);
		
		Результат.Вывести(Область);
		
	КонецЕсли;
	
	Если СпособПодачиДокументов <> СпособыПодачиДокументов.ИФНСлично Или Не ОдинУчредитель Тогда
		
		Область = ПолучитьОбластьИнструкцииРегистрация("ЗаверениеКопийУНотариуса", ШаблонИнструкции, ПараметрыИнструкции);
		Параметры = Новый Структура("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
		Область.Параметры.Заполнить(Параметры);
		
		Результат.Вывести(Область);
		
	КонецЕсли;
	
	// Выводим область "Подготовка документов".
	
	Область = ПолучитьОбластьИнструкцииРегистрация("ПодготовкаДокументов", ШаблонИнструкции, ПараметрыИнструкции);
	Параметры = Новый Структура();
	Параметры.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Если ВыборСпецрежимаНалогообложения.УСН Тогда
		Параметры.Вставить("ДокументСпецрежимНалогообложения",
			НСтр("ru='Уведомление о переходе на УСН (2 экземпляра)'"));
		Параметры.Вставить("ДокументСпецрежимНалогообложенияПримечание", 
			НСтр("ru='Дата уведомления – дата подачи документа в налоговую инспекцию'"));
	КонецЕсли;
	
	Если ОдинУчредитель Тогда
		// Номер пункта определяет количество пунктов в списке документов до пункта с уставом.
		НомерПункта = ?(СпособПодачиДокументов = СпособыПодачиДокументов.Почта, 2, 3);
	Иначе
		НомерПункта = ?(СпособПодачиДокументов = СпособыПодачиДокументов.ИФНСпредставитель, 4, 3);
	КонецЕсли;
	Параметры.Вставить("НомерПунктаУстава", УвеличитьЗначениеНаЕдиницу(НомерПункта));
	Параметры.Вставить("НомерПунктаПротокол", УвеличитьЗначениеНаЕдиницу(НомерПункта));
	Если ВыборСпецрежимаНалогообложения.УСН Тогда
		Параметры.Вставить("НомерПунктаСпецРежим", УвеличитьЗначениеНаЕдиницу(НомерПункта));
	КонецЕсли;
	Параметры.Вставить("НомерПунктаПисьмо", УвеличитьЗначениеНаЕдиницу(НомерПункта));
	Область.Параметры.Заполнить(Параметры);
	
	Результат.Вывести(Область);
	
	Если НЕ ОдинУчредитель 
		И СпособПодачиДокументов <> СпособыПодачиДокументов.ИФНСпредставитель Тогда
		Результат.ВывестиГоризонтальныйРазделительСтраниц();
	КонецЕсли;
	
	// Выводим область "Подача документов".
	Область = ПолучитьОбластьИнструкцииРегистрация("ПодачаДокументов", ШаблонИнструкции, ПараметрыИнструкции);
	Параметры = Новый Структура();
	Параметры.Вставить("НомерШага",       УвеличитьЗначениеНаЕдиницу(НомерШага));
	Параметры.Вставить("НаименованиеФНС", ДанныеРегистрирующегоОргана.НаименованиеФНС);
	Параметры.Вставить("АдресФНС",        ДанныеРегистрирующегоОргана.АдресФНС);
	Параметры.Вставить("ТелефонФНС",      ДанныеРегистрирующегоОргана.ТелефонФНС);
	Область.Параметры.Заполнить(Параметры);
	Результат.Вывести(Область);
	
	Если ОдинУчредитель И СпособПодачиДокументов <> СпособыПодачиДокументов.ИФНСпредставитель Тогда
		Результат.ВывестиГоризонтальныйРазделительСтраниц();
	КонецЕсли;
	
	// Выводим область "Получение документов"
	Область = ПолучитьОбластьИнструкцииРегистрация("ПолучениеДокументов", ШаблонИнструкции, ПараметрыИнструкции);
	Параметры = Новый Структура();
	Параметры.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Область.Параметры.Заполнить(Параметры);
	Результат.Вывести(Область);
	
	Если СпособПодачиДокументов = СпособыПодачиДокументов.МФЦлично И ВыборСпецрежимаНалогообложения.УСН Тогда
		// Документы спецрежима подаются в территориальную ИФНС
		ПараметрыИнструкции.РегистрацияЧерезМФЦ = Ложь;
		ПараметрыИнструкции.ЕстьАдресИнспекции = ЗначениеЗаполнено(ДанныеНалоговойИнспекции.НаименованиеФНС);
		
		Область = ПолучитьОбластьИнструкцииРегистрация("ПодачаДокументовСпецрежим", ШаблонИнструкции, ПараметрыИнструкции);
		Параметры.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
		Параметры.Вставить("ДокументСпецрежимНалогообложенияВТексте", НСтр("ru='уведомление о переходе на УСН'"));
		Параметры.Вставить("НаименованиеФНС", ДанныеНалоговойИнспекции.НаименованиеФНС);
		Параметры.Вставить("АдресФНС",        ДанныеНалоговойИнспекции.АдресФНС);
		Параметры.Вставить("ТелефонФНС",      ДанныеНалоговойИнспекции.ТелефонФНС);
		Область.Параметры.Заполнить(Параметры);
		Результат.Вывести(Область);
	КонецЕсли;
	
	ИмяФайла = ПолучитьИмяВременногоФайла("pdf");
	Результат.Записать(ИмяФайла, ТипФайлаТабличногоДокумента.PDF);
	ДвоичныеДанные = Новый ДвоичныеДанные(ИмяФайла);
	Адрес = ПоместитьВоВременноеХранилище(ДвоичныеДанные, УникальныйИдентификатор);
	УдалитьФайлы(ИмяФайла);
	
	Возврат Адрес;
	
КонецФункции

// Формирует печатную форму решения физического лица - единственного учредителя нового ООО.
//
// Параметры:
//  Организация - СправочникСсылка.Организации - создаваемая организация.
//
// Возвращаемое значение:
//  Строка - адрес во временном хранилище, которое содержит двоичные данные сформированного документа в формате RTF.
//
Функция РешениеЕдинственногоУчредителяООО(Организация) Экспорт
	
	ДанныеУчредителей = ДанныеУчредителейОрганизации(Организация, ТекущаяДатаСеанса(), Истина);
	Если ДанныеУчредителей = Неопределено Тогда
		ТекстСообщения = НСтр("ru='Нет данных об учредителях организации.'");
		ВызватьИсключение ТекстСообщения;
	КонецЕсли;
	Если ДанныеУчредителей.Учредители[0].ЭтоЮридическоеЛицо Тогда
		ТекстСообщения = НСтр("ru='Единственный учредитель должен быть физическим лицом.'");
		ВызватьИсключение ТекстСообщения;
	КонецЕсли;
	ДанныеРуководителя = ДанныеРуководителяОрганизации(Организация, ТекущаяДатаСеанса(), Истина);
	Если ДанныеРуководителя = Неопределено Тогда
		ТекстСообщения = НСтр("ru='Нет данных о руководителе организации.'");
		ВызватьИсключение ТекстСообщения;
	КонецЕсли;
	
	ПараметрыТекста = Новый Структура();
	ПараметрыТекста.Вставить("Город", "");
	ПараметрыТекста.Вставить("Дата", "");
	ПараметрыТекста.Вставить("НаименованиеОрганизации", "");
	ПараметрыТекста.Вставить("ФИОПолные", "");
	ПараметрыТекста.Вставить("ДокументПредставление", "");
	ПараметрыТекста.Вставить("АдресПоПропискеПредставление", "");
	ПараметрыТекста.Вставить("УставныйКапитал", "");
	ПараметрыТекста.Вставить("УставныйКапиталПрописью", "");
	ПараметрыТекста.Вставить("ДолжностьДиректора", "");
	ПараметрыТекста.Вставить("ФИОДиректора", "");
	ПараметрыТекста.Вставить("СрокПолномочийДиректора", "");
	ПараметрыТекста.Вставить("АдресОрганизации", "");
	
	ДанныеУчредителя = ДанныеУчредителей.Учредители[0];
	
	НаименованиеПолное = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(Организация, "НаименованиеПолное");
	ПараметрыТекста.Вставить("НаименованиеПолное", НаименованиеПолное);
	НаименованиеПолноеВРодительномПадеже = НаименованиеПолноеВРодительномПадеже(СокрЛ(НаименованиеПолное));
	ПараметрыТекста.Вставить("НаименованиеПолноеВРодительномПадеже", НаименованиеПолноеВРодительномПадеже);
	
	ПараметрыТекста.Вставить("ДокументПредставление", ТекстСоСтрочнойБуквы(ДанныеУчредителя.СведенияОФизическомЛице.ДокументПредставление)); 
	ПараметрыТекста.Вставить("ФИОПолные", ДанныеУчредителя.СведенияОФизическомЛице.ФИОПолные);
	ПараметрыТекста.Вставить("АдресПоПропискеПредставление", ДанныеУчредителя.СведенияОФизическомЛице.АдресПрописки);
	ПараметрыТекста.Вставить("УставныйКапитал", Формат(ДанныеУчредителей.УставныйКапитал, "ЧДЦ=2; ЧГ=0"));
	Валюта = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьВалютуРегламентированногоУчета();
	УставныйКапиталПрописью = ЧислоПрописью(ДанныеУчредителей.УставныйКапитал, "Л=ru", Валюта.ПараметрыПрописи);
	ПараметрыТекста.Вставить("УставныйКапиталПрописью", НРег(УставныйКапиталПрописью));
	
	ПараметрыТекста.Вставить("ДолжностьДиректора", ТекстСоСтрочнойБуквы(ДанныеРуководителя.ДолжностьПредставление));
	ПараметрыТекста.Вставить("ФИОДиректора",       ДанныеРуководителя.СведенияОФизическомЛице.ФИОПолные);
	ПараметрыТекста.Вставить("ДокументДиректораПредставление", ТекстСоСтрочнойБуквы(ДанныеРуководителя.СведенияОФизическомЛице.ДокументПредставление));
	ПараметрыТекста.Вставить("АдресДиректораПредставление", ДанныеРуководителя.СведенияОФизическомЛице.АдресПрописки);
	
	Адрес = УправлениеКонтактнойИнформациейБП.АдресСтруктурой(Организация, 
		Справочники.ВидыКонтактнойИнформации.ЮрАдресОрганизации);
	ПараметрыТекста.Вставить("АдресОрганизации", Адрес.Представление);
	
	Если Адрес.Количество() > 0 Тогда
		Если Адрес.Свойство("Город") И ЗначениеЗаполнено(Адрес.Город) Тогда
			СловаАдреса = СтрРазделить(Адрес.Город, " ");
			СокращениеНаселенногоПункта = СловаАдреса[СловаАдреса.ВГраница()];
			СловаАдреса.Удалить(СловаАдреса.ВГраница());
			НаселенныйПункт = СтрСоединить(СловаАдреса, " ");
			ПараметрыТекста.Вставить("Город", Стршаблон("%1. %2", СокращениеНаселенногоПункта, НаселенныйПункт));
		ИначеЕсли Адрес.Свойство("НаселенныйПункт") И ЗначениеЗаполнено(Адрес.НаселенныйПункт) Тогда
			СловаАдреса = СтрРазделить(Адрес.НаселенныйПункт, " ");
			СокращениеНаселенногоПункта = СловаАдреса[СловаАдреса.ВГраница()];
			СловаАдреса.Удалить(СловаАдреса.ВГраница());
			НаселенныйПункт = СтрСоединить(СловаАдреса, " ");
			ПараметрыТекста.Вставить("Город", Стршаблон("%1. %2", СокращениеНаселенногоПункта, НаселенныйПункт));
		ИначеЕсли Адрес.Свойство("Регион") И ЗначениеЗаполнено(Адрес.Регион) Тогда
			СловаАдреса = СтрРазделить(Адрес.Регион, " ");
			СокращениеНаселенногоПункта = СловаАдреса[СловаАдреса.ВГраница()];
			СловаАдреса.Удалить(СловаАдреса.ВГраница());
			НаселенныйПункт = СтрСоединить(СловаАдреса, " ");
			ПараметрыТекста.Вставить("Город", Стршаблон("%1. %2", СокращениеНаселенногоПункта, НаселенныйПункт));
		КонецЕсли;
	КонецЕсли;
	
	ПараметрыТекста.Вставить("Дата", Формат(ТекущаяДата(),"Л=ru; ДФ='dd MMMM yyyy ''г.'''"));
	
	Макет = ПолучитьМакет("РешениеЕдинственногоУчредителя");
	Текст = СтроковыеФункцииКлиентСервер.ВставитьПараметрыВСтроку(Макет.ПолучитьТекст(), ПараметрыТекста);
	
	ДокументРезультат = Новый ФорматированныйДокумент;
	ДокументРезультат.УстановитьHTML(Текст, Новый Структура());
	
	Для Каждого Параграф Из ДокументРезультат.Элементы Цикл
		Параграф.Отступ = 10;
		Если Параграф.ГоризонтальноеПоложение = ГоризонтальноеПоложение.ПоШирине И Параграф.Элементы.Количество() > 0 Тогда
			Параграф.Элементы[0].Текст = СтрШаблон("	%1", Параграф.Элементы[0].Текст);
		КонецЕсли;
	КонецЦикла;
	
	ИмяФайла = ПолучитьИмяВременногоФайла("rtf");
	ЭлектронноеВзаимодействиеБП.КонвертироватьВФорматRTF(ДокументРезультат, ИмяФайла);
	ДвоичныеДанные = Новый ДвоичныеДанные(ИмяФайла);
	Адрес = ПоместитьВоВременноеХранилище(ДвоичныеДанные);
	УдалитьФайлы(ИмяФайла);
	
	Возврат Адрес;
	
КонецФункции

// Формирует печатную форму протокола собрания учредителей организации - единственного учредителя нового ООО.
//
// Параметры:
//  Организация - СправочникСсылка.Организации - создаваемая организация.
//
// Возвращаемое значение:
//  Строка - адрес во временном хранилище, которое содержит двоичные данные сформированного документа в формате RTF.
//
Функция ПротоколСобранияУчредителейЕдинственногоУчредителяООО(Организация) Экспорт
	
	ДанныеУчредителей = ДанныеУчредителейОрганизации(Организация, ТекущаяДатаСеанса(), Истина);
	Если ДанныеУчредителей = Неопределено Тогда
		ТекстСообщения = НСтр("ru='Нет данных об учредителях организации.'");
		ВызватьИсключение ТекстСообщения;
	КонецЕсли;
	Если НЕ ДанныеУчредителей.Учредители[0].ЭтоЮридическоеЛицо Тогда
		ТекстСообщения = НСтр("ru='Единственный учредитель должен быть юридическим лицом.'");
		ВызватьИсключение ТекстСообщения;
	КонецЕсли;
	ДанныеРуководителя = ДанныеРуководителяОрганизации(Организация, ТекущаяДатаСеанса(), Истина);
	Если ДанныеРуководителя = Неопределено Тогда
		ТекстСообщения = НСтр("ru='Нет данных о руководителе организации.'");
		ВызватьИсключение ТекстСообщения;
	КонецЕсли;
	
	ПараметрыТекста = Новый Структура;
	ПараметрыТекста.Вставить("НаименованиеПолное");
	ПараметрыТекста.Вставить("НаименованиеПолноеВРодительномПадеже");
	ПараметрыТекста.Вставить("НаименованиеСокращенное");
	ПараметрыТекста.Вставить("НаименованиеУчредителяПолноеВРодительномПадеже");
	ПараметрыТекста.Вставить("УставныйКапитал");
	ПараметрыТекста.Вставить("УставныйКапиталПрописью");
	ПараметрыТекста.Вставить("НаименованиеОрганизации");
	ПараметрыТекста.Вставить("ДолжностьДиректора");
	ПараметрыТекста.Вставить("ФИОДиректора");
	ПараметрыТекста.Вставить("СрокПолномочийДиректораПрописью");
	ПараметрыТекста.Вставить("АдресДиректораПредставление");
	ПараметрыТекста.Вставить("ДокументДиректораПредставление");
	ПараметрыТекста.Вставить("АдресОрганизации");
	ПараметрыТекста.Вставить("Город");
	ПараметрыТекста.Вставить("Дата");
	
	ДанныеУчредителя = ДанныеУчредителей.Учредители[0];
	
	РеквизитыОрганизации = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(Организация, 
		"НаименованиеПолное,НаименованиеСокращенное");
	ПараметрыТекста.НаименованиеПолное = РеквизитыОрганизации.НаименованиеПолное;
	ПараметрыТекста.НаименованиеПолноеВРодительномПадеже = 
		НаименованиеПолноеВРодительномПадеже(СокрЛП(РеквизитыОрганизации.НаименованиеПолное));
		
	ПараметрыТекста.НаименованиеУчредителяПолноеВРодительномПадеже =
		НаименованиеПолноеВРодительномПадеже(СокрЛП(ДанныеУчредителя.СведенияОЮридическомЛице.ПолноеНаименование));
	
	ПараметрыТекста.УставныйКапитал = Формат(ДанныеУчредителей.УставныйКапитал, "ЧДЦ=2; ЧГ=0");
	Валюта = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьВалютуРегламентированногоУчета();
	УставныйКапиталПрописью = ЧислоПрописью(ДанныеУчредителей.УставныйКапитал, "Л=ru", Валюта.ПараметрыПрописи);
	ПараметрыТекста.УставныйКапиталПрописью = НРег(УставныйКапиталПрописью);
	
	ПараметрыТекста.ДолжностьДиректора = ТекстСоСтрочнойБуквы(ДанныеРуководителя.ДолжностьПредставление);
	ПараметрыТекста.ФИОДиректора       = ДанныеРуководителя.СведенияОФизическомЛице.ФИОПолные;
	ПараметрыТекста.ДокументДиректораПредставление = 
		ТекстСоСтрочнойБуквы(ДанныеРуководителя.СведенияОФизическомЛице.ДокументПредставление);
	ПараметрыТекста.АдресДиректораПредставление     = ДанныеРуководителя.СведенияОФизическомЛице.АдресПрописки;
	ПараметрыТекста.СрокПолномочийДиректораПрописью = СрокПолномочийПрописью(ДанныеРуководителя.СрокПолномочий);
	
	АдресСтруктурой = УправлениеКонтактнойИнформациейБП.АдресСтруктурой(Организация, 
		Справочники.ВидыКонтактнойИнформации.ЮрАдресОрганизации);
	ПараметрыТекста.АдресОрганизации = АдресСтруктурой.Представление;
	
	Если АдресСтруктурой.Количество() > 0 Тогда
		СловаАдреса = Новый Массив;
		Если АдресСтруктурой.Свойство("Город") 
			И ЗначениеЗаполнено(АдресСтруктурой.Город) Тогда
			СловаАдреса = СтрРазделить(АдресСтруктурой.Город, " ");
		ИначеЕсли АдресСтруктурой.Свойство("НаселенныйПункт") 
			И ЗначениеЗаполнено(АдресСтруктурой.НаселенныйПункт) Тогда
			СловаАдреса = СтрРазделить(АдресСтруктурой.НаселенныйПункт, " ");
		ИначеЕсли АдресСтруктурой.Свойство("Регион") 
			И ЗначениеЗаполнено(АдресСтруктурой.Регион) Тогда
			СловаАдреса = СтрРазделить(АдресСтруктурой.Регион, " ");
		КонецЕсли;
		Если СловаАдреса.Количество() > 0 Тогда 
			СокращениеНаселенногоПункта = СловаАдреса[СловаАдреса.ВГраница()];
			СловаАдреса.Удалить(СловаАдреса.ВГраница());
			НаселенныйПункт = СтрСоединить(СловаАдреса, " ");
			ПараметрыТекста.Город = СтрШаблон("%1. %2", СокращениеНаселенногоПункта, НаселенныйПункт);
		КонецЕсли;
	КонецЕсли;
	
	ПараметрыТекста.Дата = Формат(ТекущаяДата(),"Л=ru; ДФ='dd MMMM yyyy ''г.'''");
	
	Макет = ПолучитьМакет("ПротоколСобранияУчредителейЕдинственногоУчредителя");
	Текст = СтроковыеФункцииКлиентСервер.ВставитьПараметрыВСтроку(Макет.ПолучитьТекст(), ПараметрыТекста);
	
	ДокументРезультат = Новый ФорматированныйДокумент;
	ДокументРезультат.УстановитьHTML(Текст, Новый Структура());
	
	Для Каждого Параграф Из ДокументРезультат.Элементы Цикл
		Параграф.Отступ = 10;
		Если Параграф.ГоризонтальноеПоложение = ГоризонтальноеПоложение.ПоШирине И Параграф.Элементы.Количество() > 0 Тогда
			Параграф.Элементы[0].Текст = СтрШаблон("	%1", Параграф.Элементы[0].Текст);
		КонецЕсли;
	КонецЦикла;
	
	ИмяФайла = ПолучитьИмяВременногоФайла("rtf");
	ЭлектронноеВзаимодействиеБП.КонвертироватьВФорматRTF(ДокументРезультат, ИмяФайла);
	ДвоичныеДанные = Новый ДвоичныеДанные(ИмяФайла);
	Адрес = ПоместитьВоВременноеХранилище(ДвоичныеДанные);
	УдалитьФайлы(ИмяФайла);
	
	Возврат Адрес;
	
КонецФункции

Функция НовыеПараметрыИнструкцииРегистрации()
	
	Результат = Новый Структура;
	Результат.Вставить("СпособПодачиДокументов", "");
	Результат.Вставить("РегистрацияЧерезМФЦ",    Ложь);
	Результат.Вставить("ЕстьАдресИнспекции",     Ложь);
	Результат.Вставить("СпецРежим1",             Ложь);
	Результат.Вставить("СпецРежим2",             Ложь);
	Результат.Вставить("ОдинУчредительЮридическоеЛицо", Ложь);
	
	Возврат Результат;
	
КонецФункции

Функция ПолучитьОбластьИнструкцииРегистрация(ИмяОбласти, Шаблон, Параметры)
	
	Область = Шаблон.ПолучитьОбласть(ИмяОбласти);
	
	// Удалим все вложенные области, которые не содержат в наименовании нужного способа регистрации.
	ВсегоОбластей = Область.Области.Количество();
	
	Для НомерОбласти = 1 По ВсегоОбластей Цикл
		
		ВложеннаяОбласть = Область.Области[ВсегоОбластей-НомерОбласти];
		
		Если ИмяОбласти = ВложеннаяОбласть.Имя Тогда
			
			Продолжить;
			
		ИначеЕсли СтрНайти(ВложеннаяОбласть.Имя, "ЕстьАдресФНС") <> 0 Тогда
			
			Если Не Параметры.ЕстьАдресИнспекции Или Параметры.РегистрацияЧерезМФЦ Тогда
				Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			КонецЕсли;
			
		ИначеЕсли СтрНайти(ВложеннаяОбласть.Имя, "НетАдресаФНС") <> 0 Тогда
			
			Если Параметры.ЕстьАдресИнспекции Или Параметры.РегистрацияЧерезМФЦ Тогда
				Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			КонецЕсли;
			
		ИначеЕсли ВложеннаяОбласть.Имя = "ПодачаДокументовСпецрежим1МФЦлично" Тогда
			
			Если Не Параметры.СпецРежим1 Или Параметры.СпецРежим2 Тогда
				Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			КонецЕсли;
			
		ИначеЕсли СтрНайти(ВложеннаяОбласть.Имя, "Спецрежим1") <> 0 Тогда
			
			Если НЕ Параметры.СпецРежим1 
				ИЛИ СтрНайти(ВложеннаяОбласть.Имя, Параметры.СпособПодачиДокументов) = 0 Тогда
				Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			КонецЕсли;
			
		ИначеЕсли СтрНайти(ВложеннаяОбласть.Имя, "Спецрежим2") <> 0 Тогда
			
			Если НЕ Параметры.СпецРежим2 
				ИЛИ СтрНайти(ВложеннаяОбласть.Имя, Параметры.СпособПодачиДокументов) = 0 Тогда
				Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			КонецЕсли;
			
		ИначеЕсли ВложеннаяОбласть.Имя = "ОдинУчредительЮридическоеЛицо" Тогда
			
			Если НЕ Параметры.ОдинУчредительЮридическоеЛицо Тогда
				Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			КонецЕсли;
			
		ИначеЕсли СтрНайти(ВложеннаяОбласть.Имя, Параметры.СпособПодачиДокументов) = 0 Тогда
			
			Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			
		КонецЕсли;
		
	КонецЦикла;
	
	Возврат Область;
	
КонецФункции

Функция ПротоколСобранияУчредителейООО(Организация) Экспорт
	
	ДанныеУчредителей = ДанныеУчредителейОрганизации(Организация, ТекущаяДатаСеанса(), Истина);
	Если ДанныеУчредителей = Неопределено Тогда
		ТекстСообщения = НСтр("ru='Нет данных об учредителях организации.'");
		ВызватьИсключение ТекстСообщения;
	КонецЕсли;
	ДанныеРуководителя = ДанныеРуководителяОрганизации(Организация, ТекущаяДатаСеанса(), Истина);
	Если ДанныеРуководителя = Неопределено Тогда
		ТекстСообщения = НСтр("ru='Нет данных о руководителе организации.'");
		ВызватьИсключение ТекстСообщения;
	КонецЕсли;
	
	ПараметрыТекста = Новый Структура();
	
	Для Каждого СтрокаТаблицы Из ДанныеУчредителей.Учредители Цикл
		
		ПараметрыТекста.Вставить("СуммаВзноса" + СтрокаТаблицы.НомерСтроки, 
			СтрокаТаблицы.СуммаВзноса);
		ПараметрыТекста.Вставить("СуммаВзносаПрописью" + СтрокаТаблицы.НомерСтроки, 
			НРег(СтрокаТаблицы.СуммаВзносаПрописью));
		ПараметрыТекста.Вставить("ДоляВУставномКапитале" + СтрокаТаблицы.НомерСтроки, 
			СтрокаТаблицы.ДоляУставногоКапиталаСтрокой + "%");
		
		ПараметрыУчредителя = НовыйПараметрыУчредителяДляПротокола();
		ЗаполнитьЗначенияСвойств(ПараметрыУчредителя, СтрокаТаблицы);
		Если СтрокаТаблицы.ЭтоЮридическоеЛицо Тогда
			ЗаполнитьЗначенияСвойств(ПараметрыУчредителя, СтрокаТаблицы.СведенияОЮридическомЛице.Представитель);
			ЗаполнитьЗначенияСвойств(ПараметрыУчредителя, СтрокаТаблицы.СведенияОЮридическомЛице);
		Иначе
			ЗаполнитьЗначенияСвойств(ПараметрыУчредителя, СтрокаТаблицы.СведенияОФизическомЛице);
		КонецЕсли;
		
		ПараметрыУчредителя.ДокументПредставление  = ТекстСоСтрочнойБуквы(ПараметрыУчредителя.ДокументПредставление);
		ПараметрыУчредителя.ДолжностьПредставителя = ТекстСоСтрочнойБуквы(ПараметрыУчредителя.ДолжностьПредставителя);
		
		Если СтрокаТаблицы.ЭтоЮридическоеЛицо Тогда
			
			ПараметрыТекста.Вставить("НаименованиеУчредителя" + СтрокаТаблицы.НомерСтроки, 
				ПараметрыУчредителя.ПолноеНаименование);
			ПараметрыТекста.Вставить("КраткоеПредставлениеУчредителя" + СтрокаТаблицы.НомерСтроки, 
				ПараметрыУчредителя.ПолноеНаименование);
			
			ПредставлениеУчредителя = СтроковыеФункцииКлиентСервер.ВставитьПараметрыВСтроку(
				ШаблонПоляПротокола("ЮридическоеЛицо"), ПараметрыУчредителя);
			ПараметрыТекста.Вставить("ПредставлениеУчредителя" + СтрокаТаблицы.НомерСтроки, ПредставлениеУчредителя);
			
			ПредставительУчредителя = СтроковыеФункцииКлиентСервер.ВставитьПараметрыВСтроку(
				ШаблонПоляПротокола("Представитель"), ПараметрыУчредителя);
			ПараметрыТекста.Вставить("ПредставительУчредителя" + СтрокаТаблицы.НомерСтроки, ПредставительУчредителя);
			
		Иначе
			ПараметрыТекста.Вставить("КраткоеПредставлениеУчредителя" + СтрокаТаблицы.НомерСтроки, 
				СтрокаТаблицы.СведенияОФизическомЛице.ФИОПолные);
			
			ПредставлениеУчредителя = СтроковыеФункцииКлиентСервер.ВставитьПараметрыВСтроку(
				ШаблонПоляПротокола("ФизическоеЛицо"), ПараметрыУчредителя);
			ПараметрыТекста.Вставить("ПредставлениеУчредителя" + СтрокаТаблицы.НомерСтроки, ПредставлениеУчредителя);
			
			ПараметрыТекста.Вставить("ПредставительУчредителя" + СтрокаТаблицы.НомерСтроки,
				СтрокаТаблицы.СведенияОФизическомЛице.ФИОПолные);
		КонецЕсли;
		
	КонецЦикла;
	
	СведенияОбОрганизации = БухгалтерскийУчетПереопределяемый.СведенияОЮрФизЛице(Организация, ТекущаяДата());

	ПараметрыТекста.Вставить("НаименованиеПолное",      СведенияОбОрганизации.ПолноеНаименование);
	ПараметрыТекста.Вставить("НаименованиеСокращенное", СведенияОбОрганизации.СокращенноеНаименование);
	НаименованиеПолноеВРодительномПадеже = НаименованиеПолноеВРодительномПадеже(
		СокрЛ(СведенияОбОрганизации.ПолноеНаименование));
	ПараметрыТекста.Вставить("НаименованиеПолноеВРодительномПадеже", НаименованиеПолноеВРодительномПадеже);
	
	ПараметрыТекста.Вставить("УставныйКапитал", Формат(ДанныеУчредителей.УставныйКапитал, "ЧДЦ=2; ЧГ=0"));
	Валюта = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьВалютуРегламентированногоУчета();
	УставныйКапиталПрописью = ЧислоПрописью(ДанныеУчредителей.УставныйКапитал, "Л=ru", Валюта.ПараметрыПрописи);
	ПараметрыТекста.Вставить("УставныйКапиталПрописью", ТекстСоСтрочнойБуквы(УставныйКапиталПрописью));
	
	ПараметрыТекста.Вставить("ФИОДиректора",       ДанныеРуководителя.СведенияОФизическомЛице.ФИОПолные);
	ПараметрыТекста.Вставить("ДолжностьДиректора", ТекстСоСтрочнойБуквы(ДанныеРуководителя.ДолжностьПредставление));
	ПараметрыТекста.Вставить("ДокументДиректораПредставление", 
		ТекстСоСтрочнойБуквы(ДанныеРуководителя.СведенияОФизическомЛице.ДокументПредставление));
	ПараметрыТекста.Вставить("АдресДиректораПредставление", ДанныеРуководителя.СведенияОФизическомЛице.АдресПрописки);
	ПараметрыТекста.Вставить("СрокПолномочийДиректораПрописью", СрокПолномочийПрописью(ДанныеРуководителя.СрокПолномочий));
		
	Адрес = УправлениеКонтактнойИнформациейБП.АдресСтруктурой(Организация, 
		Справочники.ВидыКонтактнойИнформации.ЮрАдресОрганизации);
	
	ПараметрыТекста.Вставить("АдресОрганизации", Адрес.Представление);
	
	Если Адрес.Количество() > 0 Тогда
		Если Адрес.Свойство("Город") И ЗначениеЗаполнено(Адрес.Город) Тогда
			СловаАдреса = СтрРазделить(Адрес.Город, " ");
			СокращениеНаселенногоПункта = СловаАдреса[СловаАдреса.ВГраница()];
			СловаАдреса.Удалить(СловаАдреса.ВГраница());
			НаселенныйПункт = СтрСоединить(СловаАдреса, " ");
			ПараметрыТекста.Вставить("Город", Стршаблон("%1. %2", СокращениеНаселенногоПункта, НаселенныйПункт));
		ИначеЕсли Адрес.Свойство("НаселенныйПункт") И ЗначениеЗаполнено(Адрес.НаселенныйПункт) Тогда
			СловаАдреса = СтрРазделить(Адрес.НаселенныйПункт, " ");
			СокращениеНаселенногоПункта = СловаАдреса[СловаАдреса.ВГраница()];
			СловаАдреса.Удалить(СловаАдреса.ВГраница());
			НаселенныйПункт = СтрСоединить(СловаАдреса, " ");
			ПараметрыТекста.Вставить("Город", Стршаблон("%1. %2", СокращениеНаселенногоПункта, НаселенныйПункт));
		ИначеЕсли Адрес.Свойство("Регион") И ЗначениеЗаполнено(Адрес.Регион) Тогда
			СловаАдреса = СтрРазделить(Адрес.Регион, " ");
			СокращениеНаселенногоПункта = СловаАдреса[СловаАдреса.ВГраница()];
			СловаАдреса.Удалить(СловаАдреса.ВГраница());
			НаселенныйПункт = СтрСоединить(СловаАдреса, " ");
			ПараметрыТекста.Вставить("Город", Стршаблон("%1. %2", СокращениеНаселенногоПункта, НаселенныйПункт));
		КонецЕсли;
	КонецЕсли;

	ПараметрыТекста.Вставить("Дата", Формат(ТекущаяДата(), "Л=ru; ДФ='dd MMMM yyyy ''г.'''"));
		
	Макет = ПолучитьМакет("ПротоколСобранияУчредителей");
	Текст = СтроковыеФункцииКлиентСервер.ВставитьПараметрыВСтроку(Макет.ПолучитьТекст(), ПараметрыТекста);
	
	ДокументРезультат = Новый ФорматированныйДокумент;
	ДокументРезультат.УстановитьHTML(Текст, Новый Структура());
	
	НенужныеПараграфы = Новый Массив;
	Для Каждого Параграф Из ДокументРезультат.Элементы Цикл
		Если Параграф.ГоризонтальноеПоложение = ГоризонтальноеПоложение.ПоШирине 
			И Параграф.Элементы.Количество() > 0 Тогда
			Параграф.Элементы[0].Текст = СтрШаблон("    %1", Параграф.Элементы[0].Текст);
		КонецЕсли;
		// Удалим строки в которых остались незаполненные параметры.
		// Число учредителей может быть любым от 2 до 50.
		// Исходный текст рассчитан на 50 учредителей, поэтому, если их меньше,
		// то некоторые строки могли остаться с незаполненными параметрами.
		Для Каждого ЭлементПараграфа Из Параграф.Элементы Цикл
			Если ТипЗнч(ЭлементПараграфа) = Тип("ТекстФорматированногоДокумента") 
				И (СтрНайти(ЭлементПараграфа.Текст, "[КраткоеПредставлениеУчредителя") <> 0
				ИЛИ СтрНайти(ЭлементПараграфа.Текст, "[ПредставительУчредителя") <> 0
				ИЛИ СтрНайти(ЭлементПараграфа.Текст, "[ПредставлениеУчредителя") <> 0
				ИЛИ СтрНайти(ЭлементПараграфа.Текст, "[НаименованиеУчредителя") <> 0
				ИЛИ СтрНайти(ЭлементПараграфа.Текст, "[МеткаРевизора]") <> 0 ) Тогда
				НенужныеПараграфы.Добавить(Параграф);
				Прервать;
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;
	
	Для каждого Параграф Из НенужныеПараграфы Цикл
		ДокументРезультат.Элементы.Удалить(Параграф);
	КонецЦикла;
	
	ИмяФайла = ПолучитьИмяВременногоФайла("rtf");
	ЭлектронноеВзаимодействиеБП.КонвертироватьВФорматRTF(ДокументРезультат, ИмяФайла);
	ДвоичныеДанные = Новый ДвоичныеДанные(ИмяФайла);
	Адрес = ПоместитьВоВременноеХранилище(ДвоичныеДанные);
	УдалитьФайлы(ИмяФайла);
	
	Возврат Адрес;
	
КонецФункции

Функция ДоговорОбУчрежденииООО(Организация) Экспорт
	
	ДанныеУчредителей = ДанныеУчредителейОрганизации(Организация, ТекущаяДатаСеанса(), Истина);
	Если ДанныеУчредителей = Неопределено Тогда
		ТекстСообщения = НСтр("ru='Нет данных об учредителях организации.'");
		ВызватьИсключение ТекстСообщения;
	КонецЕсли;
	
	ДанныеРуководителя = ДанныеРуководителяОрганизации(Организация, ТекущаяДатаСеанса());
	Если ДанныеРуководителя = Неопределено Тогда
		ТекстСообщения = НСтр("ru='Нет данных о руководителе организации.'");
		ВызватьИсключение ТекстСообщения;
	КонецЕсли;
	
	СведенияОбОрганизации = БухгалтерскийУчетПереопределяемый.СведенияОЮрФизЛице(Организация);
	
	ТекстHTML = ПолучитьМакет("ДоговорОбУчрежденииООО").ПолучитьТекст();
	
	ПолноеНаименованиеОрганизацииВРодительномПадеже = СокрЛП(СведенияОбОрганизации.ПолноеНаименование);
	СловоОбщество = НСтр("ru = 'Общество с ограниченной ответственностью'");
	Если Лев(ВРЕГ(ПолноеНаименованиеОрганизацииВРодительномПадеже), СтрДлина(СловоОбщество)) = ВРЕГ(СловоОбщество) Тогда
		ПолноеНаименованиеОрганизацииВРодительномПадеже = НСтр("ru = 'Общества с ограниченной ответственностью'")
			+ СРЕД(ПолноеНаименованиеОрганизацииВРодительномПадеже, СтрДлина(СловоОбщество) + 1);
	КонецЕсли;
	
	ПодставитьПараметрВТекст(ТекстHTML, "ПолноеНаименованиеОрганизацииВРодительномПадеже", ПолноеНаименованиеОрганизацииВРодительномПадеже);
	ПодставитьПараметрВТекст(ТекстHTML, "ДатаДоговора", Формат(ТекущаяДатаСеанса(), "Л=ru; ДФ='dd MMMM yyyy ''г.'''"));
	ГородПоЮридическомуАдресу = УправлениеКонтактнойИнформациейБП.НаселенныйПунктПоАдресу(
		СведенияОбОрганизации.ЗначениеJSONЮридическийАдрес);
	ПодставитьПараметрВТекст(ТекстHTML, "ГородПоЮридическомуАдресуОрганизации", ГородПоЮридическомуАдресу);
	
	// Подготовим описания учредителей
	ОписаниеУчредителей = "";
	Для Каждого Учредитель Из ДанныеУчредителей.Учредители Цикл
		ОписаниеУчредителей = ОписаниеУчредителей + ОписаниеУчредителя(Учредитель);
	КонецЦикла;
	ПодставитьПараметрВТекст(ТекстHTML, "ОписаниеУчредителей", ОписаниеУчредителей);
	
	ПодставитьПараметрВТекст(ТекстHTML, "ПолноеНаименованиеОрганизации", СведенияОбОрганизации.ПолноеНаименование);
	ПодставитьПараметрВТекст(ТекстHTML, "КраткоеНаименованиеОрганизации", СведенияОбОрганизации.СокращенноеНаименование);
	ПодставитьПараметрВТекст(ТекстHTML, "ЮридическийАдресОрганизации", СведенияОбОрганизации.ЮридическийАдрес);
	
	СуммаУстановногоКапитала = ДанныеУчредителей.УставныйКапитал;
	
	Валюта = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьВалютуРегламентированногоУчета();
	СуммаУстановногоКапиталаПрописью = ЧислоПрописью(СуммаУстановногоКапитала, "Л=ru", Валюта.ПараметрыПрописи);
	
	ПодставитьПараметрВТекст(ТекстHTML, "СуммаУставногоКапитала", Формат(СуммаУстановногоКапитала, "ЧДЦ=2; ЧГ=3,0"));
	ПодставитьПараметрВТекст(ТекстHTML, "СуммаУставногоКапиталаПрописью", СуммаУстановногоКапиталаПрописью);
	
	ОписаниеУставногоКапиталаУчредителей = "";
	Для Каждого Учредитель Из ДанныеУчредителей.Учредители Цикл
		ОписаниеУставногоКапиталаУчредителей = ОписаниеУставногоКапиталаУчредителей 
			+ ОписаниеУставногоКапиталаУчредителя(Учредитель);
	КонецЦикла;
	ПодставитьПараметрВТекст(ТекстHTML, "УставныйКапиталУчредителей", ОписаниеУставногоКапиталаУчредителей);
		
	ПодставитьПараметрВТекст(ТекстHTML, "ДолжностьРуководителяОрганизации", 
		СведенияОбОрганизации.ДолжностьРуководителяПредставление);
	
	ПодписиУчредителей = "";
	Для Каждого Учредитель Из ДанныеУчредителей.Учредители Цикл
		ПодписиУчредителей = ПодписиУчредителей + ПодписьУчредителя(Учредитель);
	КонецЦикла;
	ПодставитьПараметрВТекст(ТекстHTML, "ПодписиУчредителей", ПодписиУчредителей);
	
	ДокументРезультат = Новый ФорматированныйДокумент;
	ДокументРезультат.УстановитьHTML(ТекстHTML, Новый Структура());
	
	ИмяФайла = ПолучитьИмяВременногоФайла("rtf");
	ЭлектронноеВзаимодействиеБП.КонвертироватьВФорматRTF(ДокументРезультат, ИмяФайла);
	ДвоичныеДанные = Новый ДвоичныеДанные(ИмяФайла);
	Адрес = ПоместитьВоВременноеХранилище(ДвоичныеДанные);
	УдалитьФайлы(ИмяФайла);
	
	Возврат Адрес;
	
КонецФункции

Функция КвитанцияНаОплатуГоспошлины(Организация) Экспорт
	
	КвитанцияПрисоединенныйФайл = ПрисоединенныйФайлКвитанцииНаОплатуГоспошлиныОрганизации(Организация);
	Если КвитанцияПрисоединенныйФайл = Неопределено Тогда
		Возврат Неопределено;
	КонецЕсли;
	Возврат ПоместитьВоВременноеХранилище(РаботаСФайлами.ДвоичныеДанныеФайла(КвитанцияПрисоединенныйФайл));
	
КонецФункции

Функция ПриказОВступленииВДолжностьРуководителя(Организация) Экспорт
	
	ДанныеУчредителей = ДанныеУчредителейОрганизации(Организация, ТекущаяДатаСеанса());
	Если ДанныеУчредителей = Неопределено Тогда
		ТекстСообщения = НСтр("ru='Нет данных об учредителях организации.'");
		ВызватьИсключение ТекстСообщения;
	КонецЕсли;
	ДанныеРуководителя = ДанныеРуководителяОрганизации(Организация, ТекущаяДатаСеанса(), Истина);
	Если ДанныеРуководителя = Неопределено Тогда
		ТекстСообщения = НСтр("ru='Нет данных о руководителе организации.'");
		ВызватьИсключение ТекстСообщения;
	КонецЕсли;
	
	ФорматДат = "Л=ru_RU; ДФ=dd.MM.yyyy";
	
	ПараметрыТекста = Новый Структура();
	
	НаименованияОрганизации = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(Организация, 
		"НаименованиеСокращенное, НаименованиеПолное");
	ПараметрыТекста.Вставить("НаименованиеСокращенное", НаименованияОрганизации.НаименованиеСокращенное);
	ПараметрыТекста.Вставить("НаименованиеПолное", НаименованияОрганизации.НаименованиеПолное);
	
	ПараметрыТекста.Вставить("ФИОПолныеДиректора", ДанныеРуководителя.СведенияОФизическомЛице.ФИОПолные);
	ПараметрыТекста.Вставить("ИОФамилияДиректора", ДанныеРуководителя.СведенияОФизическомЛице.ИОФамилия);
	
	ПараметрыТекста.Вставить("ДолжностьДиректора", ДанныеРуководителя.ДолжностьПредставление);
	ПараметрыТекста.Вставить("ДолжностьДиректораВРодительномПадеже", 
		СокрЛП(НРег(СклонениеПредставленийОбъектов.ПросклонятьПредставление(
			ДанныеРуководителя.ДолжностьПредставление, 2, ДанныеРуководителя.Должность))));
		
	ДатаПриказа = ДанныеРуководителя.Период;
	ПараметрыТекста.Вставить("ДатаПриказа",  Формат(ДатаПриказа, ФорматДат));
	ПараметрыТекста.Вставить("НомерПриказа", "№ 1");
	
	Адрес = УправлениеКонтактнойИнформациейБП.АдресСтруктурой(Организация, 
		Справочники.ВидыКонтактнойИнформации.ЮрАдресОрганизации);
	Если Адрес.Свойство("Город") И ЗначениеЗаполнено(Адрес.Город) Тогда
		Город = Адрес.Город;
	ИначеЕсли Адрес.Свойство("НаселенныйПункт") И ЗначениеЗаполнено(Адрес.НаселенныйПункт) Тогда
		Город = Адрес.НаселенныйПункт;
	ИначеЕсли Адрес.Свойство("Регион") И ЗначениеЗаполнено(Адрес.Регион) Тогда
		Город = СтрЗаменить(Адрес.Регион, " г", "");
	Иначе
		Город = "";
	КонецЕсли;
	ПараметрыТекста.Вставить("Город", Город);
	
	Если ДанныеУчредителей.Учредители.Количество() > 1 Тогда
		ШаблонОснования = НСтр("ru='протокол общего собрания участников общества от %1 № 1'");
	Иначе
		ШаблонОснования = НСтр("ru='решение единственного участника от %1 № 1'");
	КонецЕсли;
	ПараметрыТекста.Вставить("Основание", СтрШаблон(ШаблонОснования, Формат(ДатаПриказа, ФорматДат)));
	
	ПараметрыТекста.Вставить("ДатаНачала", Формат(ДатаПриказа, ФорматДат));
	ПараметрыТекста.Вставить("ДатаКонца", Формат(ДобавитьМесяц(ДатаПриказа, ДанныеРуководителя.СрокПолномочий * 12), ФорматДат));
	
	Макет = ПолучитьМакет("ПриказОВступленииВДолжностьРуководителя");
	Текст = СтроковыеФункцииКлиентСервер.ВставитьПараметрыВСтроку(Макет.ПолучитьТекст(), ПараметрыТекста);
	
	ДокументРезультат = Новый ФорматированныйДокумент;
	ДокументРезультат.УстановитьHTML(Текст, Новый Структура());
	
	ШрифтТекстаУчредительныхДокументов = Новый Шрифт("Times New Roman", 12);
	
	Для Каждого Параграф Из ДокументРезультат.Элементы Цикл
		Параграф.МеждустрочныйИнтервал = 1.5;
		Для Каждого Элемент Из Параграф.Элементы Цикл
			Если ТипЗнч(Элемент) = Тип("ТекстФорматированногоДокумента") Тогда
				Элемент.Шрифт = ШрифтТекстаУчредительныхДокументов;
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;
	
	ИмяФайла = ПолучитьИмяВременногоФайла("rtf");
	ЭлектронноеВзаимодействиеБП.КонвертироватьВФорматRTF(ДокументРезультат, ИмяФайла);
	ДвоичныеДанные = Новый ДвоичныеДанные(ИмяФайла);
	Адрес = ПоместитьВоВременноеХранилище(ДвоичныеДанные);
	УдалитьФайлы(ИмяФайла);
	
	Возврат Адрес;
	
КонецФункции

Функция СформироватьПриказОВступленииВДолжностьРуководителя(МассивОбъектов, ОбъектыПечати, ИмяМакета) Экспорт
	
	ТабличныйДокумент = Новый ТабличныйДокумент;
	Макет             = УправлениеПечатью.МакетПечатнойФормы("Обработка.РегистрацияОрганизации.ПриказОВступленииВДолжностьРуководителя");
	ОбластьДоговора   = Макет.ПолучитьОбласть("ТекстПриказа");
	
	Запрос = Новый Запрос();
	Запрос.Параметры.Вставить("Организации", МассивОбъектов);
	Запрос.Текст =
	"ВЫБРАТЬ
	|	Организации.Ссылка
	|ИЗ
	|	Справочник.Организации КАК Организации
	|ГДЕ
	|	Организации.Ссылка В(&Организации)
	|	И Организации.ЮридическоеФизическоеЛицо = ЗНАЧЕНИЕ(Перечисление.ЮридическоеФизическоеЛицо.ЮридическоеЛицо)";
	
	НомерСтрокиНачало = 0;
	ФорматДат = "Л=ru_RU; ДФ=dd.MM.yyyy";
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		Если НомерСтрокиНачало > 0 Тогда
			ТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();
		КонецЕсли;
		
		НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
		
		ДанныеУчредителей = ДанныеУчредителейОрганизации(Выборка.Ссылка, ТекущаяДатаСеанса());
		Если ДанныеУчредителей = Неопределено Тогда
			Продолжить;
		КонецЕсли;
		ДанныеРуководителя = ДанныеРуководителяОрганизации(Выборка.Ссылка, ТекущаяДатаСеанса(), Истина);
		Если ДанныеРуководителя = Неопределено Тогда
			Продолжить;
		КонецЕсли;
		
		ПараметрыТекста = Новый Структура();
		
		НаименованияОрганизации = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(Выборка.Ссылка, 
			"НаименованиеСокращенное, НаименованиеПолное");
		ПараметрыТекста.Вставить("НаименованиеСокращенное", НаименованияОрганизации.НаименованиеСокращенное);
		ПараметрыТекста.Вставить("НаименованиеПолное", НаименованияОрганизации.НаименованиеПолное);
		
		ПараметрыТекста.Вставить("ФИОПолныеДиректора", ДанныеРуководителя.СведенияОФизическомЛице.ФИОПолные);
		ПараметрыТекста.Вставить("ИОФамилияДиректора", ДанныеРуководителя.СведенияОФизическомЛице.ИОФамилия);
		
		ПараметрыТекста.Вставить("ДолжностьДиректора", ДанныеРуководителя.ДолжностьПредставление);
		ПараметрыТекста.Вставить("ДолжностьДиректораВРодительномПадеже", 
			СокрЛП(НРег(СклонениеПредставленийОбъектов.ПросклонятьПредставление(
				ДанныеРуководителя.ДолжностьПредставление, 2, ДанныеРуководителя.Должность))));
			
		ДатаПриказа = ДанныеРуководителя.Период;
		ПараметрыТекста.Вставить("ДатаПриказа",  Формат(ДатаПриказа, ФорматДат));
		ПараметрыТекста.Вставить("НомерПриказа", "№ 1");
		
		Адрес = УправлениеКонтактнойИнформациейБП.АдресСтруктурой(Выборка.Ссылка, 
			Справочники.ВидыКонтактнойИнформации.ЮрАдресОрганизации);
		Если Адрес.Свойство("Город") И ЗначениеЗаполнено(Адрес.Город) Тогда
			Город = Адрес.Город;
		ИначеЕсли Адрес.Свойство("НаселенныйПункт") И ЗначениеЗаполнено(Адрес.НаселенныйПункт) Тогда
			Город = Адрес.НаселенныйПункт;
		ИначеЕсли Адрес.Свойство("Регион") И ЗначениеЗаполнено(Адрес.Регион) Тогда
			Город = СтрЗаменить(Адрес.Регион, " г", "");
		Иначе
			Город = "";
		КонецЕсли;
		ПараметрыТекста.Вставить("Город", Город);
		
		Если ДанныеУчредителей.Учредители.Количество() > 1 Тогда
			ШаблонОснования = НСтр("ru='протокол общего собрания участников общества от %1 № 1'");
		Иначе
			ШаблонОснования = НСтр("ru='решение единственного участника от %1 № 1'");
		КонецЕсли;
		ПараметрыТекста.Вставить("Основание", СтрШаблон(ШаблонОснования, Формат(ДатаПриказа, ФорматДат)));
		
		ПараметрыТекста.Вставить("ДатаНачала", Формат(ДатаПриказа, ФорматДат));
		ПараметрыТекста.Вставить("ДатаКонца", Формат(ДобавитьМесяц(ДатаПриказа, ДанныеРуководителя.СрокПолномочий * 12), ФорматДат));
		
		ОбластьДоговора.Параметры.Заполнить(ПараметрыТекста);
		ТабличныйДокумент.Вывести(ОбластьДоговора);
		
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, НомерСтрокиНачало, ОбъектыПечати, Выборка.Ссылка);
	КонецЦикла;
	
	ТабличныйДокумент.АвтоМасштаб = Истина;
	
	Возврат ТабличныйДокумент;
	
КонецФункции

Функция РеквизитыРегистрирующегоОргана(КодНалоговогоОргана, ЭтоЮридическоеЛицо) Экспорт
	
	РеквизитыРегистрирующегоОргана = НовыеРеквизитыРегистрирующегоОргана();
	
	Если НЕ ЗначениеЗаполнено(КодНалоговогоОргана) Тогда
		Возврат РеквизитыРегистрирующегоОргана;
	КонецЕсли;
	
	РеквизитыНалоговогоОргана = ДанныеГосударственныхОрганов.РеквизитыНалоговогоОрганаПоКоду(КодНалоговогоОргана);
	Если ЗначениеЗаполнено(РеквизитыНалоговогоОргана.ОписаниеОшибки) Тогда
		Возврат РеквизитыРегистрирующегоОргана;
	КонецЕсли;
	
	Если ЭтоЮридическоеЛицо Тогда
		РеквизитыРегистрирующегоОргана = РеквизитыНалоговогоОргана.РегистрирующийОрганЮЛ;
	Иначе
		РеквизитыРегистрирующегоОргана = РеквизитыНалоговогоОргана.РегистрирующийОрганИП;
	КонецЕсли;
	
	РеквизитыРегистрирующегоОргана.Наименование = СтрЗаменить(РеквизитыРегистрирующегоОргана.Наименование, 
		НСтр("ru='инспекция Федеральной налоговой службы'"),
		НСтр("ru='ИФНС'"));
	
	Если Не ПустаяСтрока(РеквизитыРегистрирующегоОргана.Адрес) Тогда
		МассивПодстрок = СтрРазделить(РеквизитыРегистрирующегоОргана.Адрес, ",", Ложь);
		РеквизитыРегистрирующегоОргана.Адрес = СтрСоединить(МассивПодстрок, ",");
	КонецЕсли;
	
	Возврат РеквизитыРегистрирующегоОргана;
	
КонецФункции

Функция РеквизитыНалоговойИнспекции(КодНалоговогоОргана) Экспорт
	
	РеквизитыНалоговойИнспекции = НовыеРеквизитыРегистрирующегоОргана();
	
	Если НЕ ЗначениеЗаполнено(КодНалоговогоОргана) Тогда
		Возврат РеквизитыНалоговойИнспекции;
	КонецЕсли;
	
	РеквизитыНалоговогоОргана = ДанныеГосударственныхОрганов.РеквизитыНалоговогоОрганаПоКоду(КодНалоговогоОргана);
	Если ЗначениеЗаполнено(РеквизитыНалоговогоОргана.ОписаниеОшибки) Тогда
		Возврат РеквизитыНалоговойИнспекции;
	КонецЕсли;
	
	ЗаполнитьЗначенияСвойств(РеквизитыНалоговойИнспекции, РеквизитыНалоговогоОргана);
	
	РеквизитыНалоговойИнспекции.Наименование = СтрЗаменить(РеквизитыНалоговойИнспекции.Наименование, 
		НСтр("ru='инспекция Федеральной налоговой службы'"), 
		НСтр("ru='ИФНС'"));
	
	Если Не ПустаяСтрока(РеквизитыНалоговойИнспекции.Адрес) Тогда
		МассивПодстрок = СтрРазделить(РеквизитыНалоговойИнспекции.Адрес, ",", Ложь);
		РеквизитыНалоговойИнспекции.Адрес = СтрСоединить(МассивПодстрок, ",");
	КонецЕсли;
	
	Возврат РеквизитыНалоговойИнспекции;
	
КонецФункции

Функция НовыеРеквизитыРегистрирующегоОргана()
	
	РеквизитыГосударственногоОргана = Новый Структура;
	РеквизитыГосударственногоОргана.Вставить("Наименование", "");
	РеквизитыГосударственногоОргана.Вставить("Телефон", "");
	РеквизитыГосударственногоОргана.Вставить("Адрес", "");
	РеквизитыГосударственногоОргана.Вставить("Информация", "");
	
	Возврат РеквизитыГосударственногоОргана;
	
КонецФункции

Функция ДанныеУчредителейОрганизации(Организация, Дата, Подробно = Ложь)
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("Организация", Организация);
	Запрос.УстановитьПараметр("Дата", Дата);
	Запрос.Текст = 
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	ФормированиеУставногоКапитала.Ссылка КАК Ссылка,
	|	ФормированиеУставногоКапитала.Дата КАК Дата,
	|	ФормированиеУставногоКапитала.Организация КАК Организация,
	|	ФормированиеУставногоКапитала.УставныйКапиталДоИзменения КАК УставныйКапиталДоИзменения,
	|	ФормированиеУставногоКапитала.УставныйКапитал КАК УставныйКапитал,
	|	ФормированиеУставногоКапитала.СпособРегистрации КАК СпособРегистрации,
	|	ФормированиеУставногоКапитала.Учредители.(
	|		НомерСтроки,
	|		ФормированиеУставногоКапитала.Учредители.Учредитель ССЫЛКА Справочник.Контрагенты КАК ЭтоЮридическоеЛицо,
	|		Учредитель,
	|		СуммаВзносаДоИзменения,
	|		СуммаВзноса,
	|		ПредставительУчредителя,
	|		ДолжностьПредставителя,
	|		ПредставительНаОсновании
	|	)
	|ИЗ
	|	Документ.ФормированиеУставногоКапитала КАК ФормированиеУставногоКапитала
	|ГДЕ
	|	ФормированиеУставногоКапитала.Организация = &Организация
	|	И ФормированиеУставногоКапитала.Дата <= &Дата
	|	И НЕ ФормированиеУставногоКапитала.ПометкаУдаления
	|
	|УПОРЯДОЧИТЬ ПО
	|	Дата УБЫВ";
	Результат = Запрос.Выполнить();
	
	Если НЕ Результат.Пустой() Тогда
		Выборка = Результат.Выбрать();
		Выборка.Следующий();
		
		Данные = Новый Структура;
		Данные.Вставить("Дата",              Выборка.Дата);
		Данные.Вставить("Организация",       Выборка.Организация);
		Данные.Вставить("УставныйКапиталДоИзменения", Выборка.УставныйКапиталДоИзменения);
		Данные.Вставить("УставныйКапитал",   Выборка.УставныйКапитал);
		Данные.Вставить("СпособРегистрации", Выборка.СпособРегистрации);
		Данные.Вставить("Учредители",        Выборка.Учредители.Выгрузить());
		Данные.Учредители.Сортировать("НомерСтроки");
		Если Подробно Тогда
			ЗаполнитьПодробнуюИнформациюОбУчредителях(Данные.Учредители);
		КонецЕсли;
		
		Данные.Вставить("НовыеУчастники",    Данные.Учредители.Скопировать(Новый Структура("СуммаВзносаДоИзменения", 0)));
		Данные.Вставить("ВышедшиеУчастники", Данные.Учредители.Скопировать(Новый Структура("СуммаВзноса", 0)));
		
		Возврат Данные;
	Иначе
		Возврат Неопределено;
	КонецЕсли;
	
КонецФункции

Функция ДанныеРуководителяОрганизации(Организация, Дата, Подробно = Ложь)
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("Дата", Дата);
	Запрос.УстановитьПараметр("СтруктурнаяЕдиница", Организация);
	Запрос.УстановитьПараметр("ОтветственноеЛицо",  Перечисления.ОтветственныеЛицаОрганизаций.Руководитель);
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ОтветственныеЛицаОрганизаций.Период КАК Период,
	|	ОтветственныеЛицаОрганизаций.СтруктурнаяЕдиница КАК СтруктурнаяЕдиница,
	|	ОтветственныеЛицаОрганизаций.ОтветственноеЛицо КАК ОтветственноеЛицо,
	|	ОтветственныеЛицаОрганизаций.ФизическоеЛицо КАК ФизическоеЛицо,
	|	ОтветственныеЛицаОрганизаций.Должность КАК Должность,
	|	ОтветственныеЛицаОрганизаций.Должность.Наименование КАК ДолжностьПредставление,
	|	ОтветственныеЛицаОрганизаций.СрокПолномочий КАК СрокПолномочий
	|ИЗ
	|	РегистрСведений.ОтветственныеЛицаОрганизаций.СрезПоследних(
	|			&Дата,
	|			СтруктурнаяЕдиница = &СтруктурнаяЕдиница
	|				И ОтветственноеЛицо = &ОтветственноеЛицо) КАК ОтветственныеЛицаОрганизаций";
	Результат = Запрос.Выполнить();
	
	Если НЕ Результат.Пустой() Тогда
		СведенияОРуководителе = ОбщегоНазначения.СтрокаТаблицыЗначенийВСтруктуру(Результат.Выгрузить()[0]);
		Если Подробно Тогда
			ЗаполнитьПодробнуюИнформациюОРуководителе(СведенияОРуководителе);
		КонецЕсли;
		Возврат СведенияОРуководителе;
	Иначе
		Возврат Неопределено;
	КонецЕсли;

КонецФункции

Функция НаименованиеПолноеВРодительномПадеже(Знач НаименованиеПолное)
	
	Склоняемое = НСтр("ru='Общество'");
	СклоняемоеВРодительномПадеже = НСтр("ru='Общества'");
	
	Если СтрНачинаетсяС(НаименованиеПолное, Склоняемое) Тогда
		СклоняемоеВРодительномПадеже = НРег(СклоняемоеВРодительномПадеже);
	ИначеЕсли СтрНачинаетсяС(НаименованиеПолное, ВРег(Склоняемое)) Тогда
		СклоняемоеВРодительномПадеже = ВРег(СклоняемоеВРодительномПадеже);
	ИначеЕсли СтрНачинаетсяС(НаименованиеПолное, НРег(Склоняемое)) Тогда
		СклоняемоеВРодительномПадеже = НРег(СклоняемоеВРодительномПадеже);
	Иначе
		Возврат НаименованиеПолное;
	КонецЕсли;
	
	Результат = СклоняемоеВРодительномПадеже + Сред(НаименованиеПолное, СтрДлина(Склоняемое) + 1);
	
	Возврат Результат;
	
КонецФункции

Функция УвеличитьЗначениеНаЕдиницу(НомерПункта)
	НомерПункта = НомерПункта + 1;
	Возврат НомерПункта;
КонецФункции

Функция ИмяПрограммы()
	
	Если Метаданные.Имя = "БухгалтерияПредприятияБазовая1" Тогда
		Возврат НСтр("ru = '1С:БизнесСтарт'");
	ИначеЕсли Метаданные.Имя = "БухгалтерияПредприятияБазовая" Тогда
		Возврат НСтр("ru = '1С:Предприниматель'");
	Иначе
		Возврат НСтр("ru = '1С:Бухгалтерия'");
	КонецЕсли;
	
КонецФункции

Функция СрокПолномочийПрописью(СрокПолномочий)
	
	Результат = СтрШаблон("%1 (%2) %3",
		Формат(СрокПолномочий, "ЧДЦ=; ЧГ=0"),
		СокрП(ЧислоПрописью(СрокПолномочий, "Л=ru_RU", ",,,,,,,,0")),
		СтроковыеФункцииКлиентСервер.ЧислоЦифрамиПредметИсчисленияПрописью(СрокПолномочий, "год,года,лет", Ложь)
		);
	
	Возврат Результат;
	
КонецФункции

Функция ШаблонПоляПротокола(ИмяПоля)

	Если ИмяПоля = "ЮридическоеЛицо" Тогда
		
		Шаблон = "[ПолноеНаименование], ОГРН: [ОГРН], ИНН: [ИНН], КПП: [КПП], адрес места нахождения: [ЮридическийАдрес]. Представитель: [ДолжностьПредставителя] [ФИОПолные], действует на основании [ПредставительНаОсновании]";
		
	ИначеЕсли ИмяПоля = "ФизическоеЛицо" Тогда
		
		Шаблон = "Гражданин Российской Федерации [ФИОПолные], [ДокументПредставление], место регистрации: [АдресПрописки]";
		
	ИначеЕсли ИмяПоля = "Представитель" Тогда
		
		Шаблон = "[ФИОПолные], [ДолжностьПредставителя]";
		
	Иначе
		
		Шаблон = "";
		
	КонецЕсли;
	
	Возврат Шаблон;

КонецФункции

Функция НовыйПараметрыУчредителяДляПротокола()
	
	ПараметрыУчредителя = Новый Структура();
	
	ПараметрыУчредителя.Вставить("ПолноеНаименование");
	ПараметрыУчредителя.Вставить("ЮридическийАдрес");
	ПараметрыУчредителя.Вставить("ОГРН");
	ПараметрыУчредителя.Вставить("ИНН");
	ПараметрыУчредителя.Вставить("КПП");
	ПараметрыУчредителя.Вставить("ФИОПолные");
	ПараметрыУчредителя.Вставить("АдресПрописки");
	ПараметрыУчредителя.Вставить("ДокументПредставление");
	ПараметрыУчредителя.Вставить("ДолжностьПредставителя");
	ПараметрыУчредителя.Вставить("ПредставительНаОсновании");
	
	Возврат ПараметрыУчредителя;
	
КонецФункции

Процедура ЗаполнитьПодробнуюИнформациюОбУчредителях(ТаблицаУчредителей)
	
	ТаблицаУчредителей.Колонки.Добавить("СуммаВзносаСтрокой",    Новый ОписаниеТипов("Строка"));
	ТаблицаУчредителей.Колонки.Добавить("СуммаВзносаПрописью",   Новый ОписаниеТипов("Строка"));
	ТаблицаУчредителей.Колонки.Добавить("ДоляУставногоКапитала", 
		Новый ОписаниеТипов("Число", Новый КвалификаторыЧисла(10, 2)));
	ТаблицаУчредителей.Колонки.Добавить("ДоляУставногоКапиталаСтрокой", Новый ОписаниеТипов("Строка"));
	ТаблицаУчредителей.Колонки.Добавить("СведенияОЮридическомЛице",     Новый ОписаниеТипов("Структура"));
	ТаблицаУчредителей.Колонки.Добавить("СведенияОФизическомЛице",      Новый ОписаниеТипов("Структура"));
	
	СуммаВзносаВсего = ТаблицаУчредителей.Итог("СуммаВзноса");
	Валюта = Константы.ВалютаРегламентированногоУчета.Получить();
	
	МассивВзносов = ТаблицаУчредителей.ВыгрузитьКолонку("СуммаВзноса");
	МассивДолей = ОбщегоНазначенияКлиентСервер.РаспределитьСуммуПропорциональноКоэффициентам(100, МассивВзносов, 2);
	Если МассивДолей <> Неопределено Тогда
		ТаблицаУчредителей.ЗагрузитьКолонку(МассивДолей, "ДоляУставногоКапитала");
	КонецЕсли;
	
	Для Каждого СтрокаТаблицы Из ТаблицаУчредителей Цикл
		
		СтрокаТаблицы.СуммаВзносаСтрокой = Формат(СтрокаТаблицы.СуммаВзноса, "ЧДЦ=2; ЧГ=3,0");
		СтрокаТаблицы.СуммаВзносаПрописью = ЧислоПрописью(СтрокаТаблицы.СуммаВзноса, "Л=ru", Валюта.ПараметрыПрописи);
		СтрокаТаблицы.ДоляУставногоКапиталаСтрокой = Формат(СтрокаТаблицы.ДоляУставногоКапитала, "ЧГ=0");
		
		Если СтрокаТаблицы.ЭтоЮридическоеЛицо Тогда
			СтрокаТаблицы.СведенияОЮридическомЛице = СведенияОбУчредителеЮридическомЛице(
				СтрокаТаблицы.Учредитель,
				СтрокаТаблицы.ПредставительУчредителя,
				СтрокаТаблицы.ДолжностьПредставителя,
				СтрокаТаблицы.ПредставительНаОсновании);
		Иначе
			
			СтрокаТаблицы.СведенияОФизическомЛице = СведенияОбУчредителеФизическомЛице(СтрокаТаблицы.Учредитель);
			
		КонецЕсли;
		
	КонецЦикла;
	
КонецПроцедуры

Функция СведенияОбУчредителеЮридическомЛице(ЮридическоеЛицо, ПредставительУчредителя, ДолжностьПредставителя, ПредставительНаОсновании)
	
	СведенияОЮридическомЛице = Новый Структура;
	
	СведенияОЮрФизЛице = БухгалтерскийУчетПереопределяемый.СведенияОЮрФизЛице(ЮридическоеЛицо);
	СведенияОЮридическомЛице.Вставить("ПолноеНаименование", СведенияОЮрФизЛице.ПолноеНаименование);
	СведенияОЮридическомЛице.Вставить("ИНН", СведенияОЮрФизЛице.ИНН);
	СведенияОЮридическомЛице.Вставить("КПП", СведенияОЮрФизЛице.КПП);
	СведенияОЮридическомЛице.Вставить("ОГРН", СведенияОЮрФизЛице.ОГРН);
	СведенияОЮридическомЛице.Вставить("ЮридическийАдрес", СведенияОЮрФизЛице.ЮридическийАдрес);
	СведенияОЮридическомЛице.Вставить("Телефон", СведенияОЮрФизЛице.Телефоны);
	СведенияОЮридическомЛице.Вставить("Email", СведенияОЮрФизЛице.Email);
	
	Если ЗначениеЗаполнено(ПредставительУчредителя) Тогда
		ДанныеПредставителя = СведенияОбУчредителеФизическомЛице(ПредставительУчредителя);
		НаименованиеДолжности = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(ДолжностьПредставителя, "Наименование");
		ДанныеПредставителя.Вставить("Должность", НаименованиеДолжности);
		ДанныеПредставителя.Вставить("ДолжностьРодительныйПадеж", СклонениеПредставленийОбъектов.ПросклонятьПредставление(НаименованиеДолжности, 2, ДолжностьПредставителя));
		ДанныеПредставителя.Вставить("ОснованияПолномочийРодительныйПадеж", ПредставительНаОсновании);
	КонецЕсли;
	СведенияОЮридическомЛице.Вставить("Представитель", ДанныеПредставителя);
	
	Возврат СведенияОЮридическомЛице;
	
КонецФункции

Функция СведенияОбУчредителеФизическомЛице(ФизическоеЛицо)
	
	СписокКадровыхДанных = "Фамилия,Имя,Отчество,Пол,ДатаРождения,МестоРожденияПредставление,Страна,ИНН,"
			+ "ФамилияИО,ИОФамилия,ФИОПолные,ДокументВид,ДокументСрокДействия,ДокументКодМВД,"
			+ "ДокументСерия,ДокументНомер,ДокументДатаВыдачи,"
			+ "ДокументКемВыдан,ДокументКодПодразделения";
	
	КадровыеДанныеФизЛиц = КадровыйУчет.КадровыеДанныеФизическихЛиц(Истина, ФизическоеЛицо,
		СписокКадровыхДанных, ТекущаяДатаСеанса());
	
	ДанныеФизическогоЛица = ОбщегоНазначения.СтрокаТаблицыЗначенийВСтруктуру(КадровыеДанныеФизЛиц[0]);
	ДанныеФизическогоЛица.Вставить("ДокументПредставление", ПредставлениеДокументаФизическогоЛица(ДанныеФизическогоЛица));
	
	ДанныеФизическогоЛица.Вставить("ФИОРодительныйПадеж", 
		СклонениеПредставленийОбъектов.ПросклонятьФИО(ДанныеФизическогоЛица.ФИОПолные, 
			2, ФизическоеЛицо, ПолДляСклонений(ДанныеФизическогоЛица.Пол)));
	
	ДанныеФизическогоЛица.Вставить("ФИОВинительныйПадеж",
		СклонениеПредставленийОбъектов.ПросклонятьФИО(ДанныеФизическогоЛица.ФИОПолные,
			4, ФизическоеЛицо, ПолДляСклонений(ДанныеФизическогоЛица.Пол)));
	
	ДанныеФизическогоЛица.Вставить("АдресСтруктурой", 
		УправлениеКонтактнойИнформациейБП.АдресСтруктурой(ФизическоеЛицо,
			Справочники.ВидыКонтактнойИнформации.АдресПоПропискеФизическиеЛица, , Ложь));
	ДанныеФизическогоЛица.Вставить("АдресПрописки", ДанныеФизическогоЛица.АдресСтруктурой.Представление);
	ДанныеФизическогоЛица.Вставить("Телефон", 
		УправлениеКонтактнойИнформацией.КонтактнаяИнформацияОбъекта(ФизическоеЛицо,
			Справочники.ВидыКонтактнойИнформации.ТелефонРабочийФизическиеЛица));
	ДанныеФизическогоЛица.Вставить("Email", 
		УправлениеКонтактнойИнформацией.КонтактнаяИнформацияОбъекта(ФизическоеЛицо,
			Справочники.ВидыКонтактнойИнформации.EMailФизическиеЛица));
	
	Возврат ДанныеФизическогоЛица;
	
КонецФункции

Функция ПредставлениеДокументаФизическогоЛица(КадровыеДанные)
	
	ТекстСерия = ", серия: %1";
	ТекстНомер = ", № %1";
	ТекстДатаВыдачи = ", выдан: %1 года";
	ТекстСрокДействия = ", действует до: %1 года";
	ТекстКодПодразделения = ", № подр. %1";
	
	Возврат Строка(КадровыеДанные.ДокументВид)
		+ ?(ЗначениеЗаполнено(КадровыеДанные.ДокументСерия), СтрШаблон(ТекстСерия, КадровыеДанные.ДокументСерия), "")
		+ ?(ЗначениеЗаполнено(КадровыеДанные.ДокументНомер), СтрШаблон(ТекстНомер, КадровыеДанные.ДокументНомер), "")
		+ ?(ЗначениеЗаполнено(КадровыеДанные.ДокументДатаВыдачи), СтрШаблон(ТекстДатаВыдачи, Формат(КадровыеДанные.ДокументДатаВыдачи,"Л=ru_RU; ДФ='дд ММММ гггг'")), "")
		+ ?(ЗначениеЗаполнено(КадровыеДанные.ДокументСрокДействия), СтрШаблон(ТекстСрокДействия, Формат(КадровыеДанные.ДокументСрокДействия,"Л=ru_RU; ДФ='дд ММММ гггг'")), "")
		+ ?(ЗначениеЗаполнено(КадровыеДанные.ДокументКемВыдан), ", " + КадровыеДанные.ДокументКемВыдан, "")
		+ ?(ЗначениеЗаполнено(КадровыеДанные.ДокументКодПодразделения) И КадровыеДанные.ДокументВид = Справочники.ВидыДокументовФизическихЛиц.ПаспортРФ,
			СтрШаблон(ТекстКодПодразделения, КадровыеДанные.ДокументКодПодразделения), "");
	
КонецФункции

Процедура ЗаполнитьПодробнуюИнформациюОРуководителе(СведенияОРуководителе)
	
	СписокДанных = "Фамилия,Имя,Отчество,Пол,ДатаРождения,МестоРожденияПредставление,Страна,ИНН,"
		+ "ФамилияИО,ИОФамилия,ФИОПолные,ДокументВид,ДокументСрокДействия,ДокументКодМВД,"
		+ "ДокументСерия,ДокументНомер,ДокументДатаВыдачи,"
		+ "ДокументКемВыдан,ДокументКодПодразделения,ДокументПредставление";
	
	КадровыеДанные = КадровыйУчет.КадровыеДанныеФизическихЛиц(Истина, СведенияОРуководителе.ФизическоеЛицо,
		СписокДанных, ТекущаяДатаСеанса());
	
	ДанныеФизическогоЛица = ОбщегоНазначения.СтрокаТаблицыЗначенийВСтруктуру(КадровыеДанные[0]);
	ДанныеФизическогоЛица.Вставить("ДокументПредставление", ПредставлениеДокументаФизическогоЛица(ДанныеФизическогоЛица));
	
	ДанныеФизическогоЛица.Вставить("ФИОПолныеРодительныйПадеж",
		СклонениеПредставленийОбъектов.ПросклонятьФИО(ДанныеФизическогоЛица.ФИОПолные,
			2, СведенияОРуководителе.ФизическоеЛицо, ПолДляСклонений(ДанныеФизическогоЛица.Пол)));
	
	ДанныеФизическогоЛица.Вставить("ФИОПолныеВинительныйПадеж",
		СклонениеПредставленийОбъектов.ПросклонятьФИО(ДанныеФизическогоЛица.ФИОПолные,
			4, СведенияОРуководителе.ФизическоеЛицо, ПолДляСклонений(ДанныеФизическогоЛица.Пол)));
	
	ДанныеФизическогоЛица.Вставить("АдресСтруктурой", 
		УправлениеКонтактнойИнформациейБП.АдресСтруктурой(СведенияОРуководителе.ФизическоеЛицо,
			Справочники.ВидыКонтактнойИнформации.АдресПоПропискеФизическиеЛица, , Ложь));
	ДанныеФизическогоЛица.Вставить("АдресПрописки", ДанныеФизическогоЛица.АдресСтруктурой.Представление);
	ДанныеФизическогоЛица.Вставить("Телефон", 
		УправлениеКонтактнойИнформацией.КонтактнаяИнформацияОбъекта(СведенияОРуководителе.ФизическоеЛицо, 
			Справочники.ВидыКонтактнойИнформации.ТелефонРабочийФизическиеЛица));
	ДанныеФизическогоЛица.Вставить("Email", 
		УправлениеКонтактнойИнформацией.КонтактнаяИнформацияОбъекта(СведенияОРуководителе.ФизическоеЛицо, 
			Справочники.ВидыКонтактнойИнформации.EMailФизическиеЛица));
	
	СведенияОРуководителе.Вставить("СведенияОФизическомЛице", ДанныеФизическогоЛица);
	
КонецПроцедуры

Функция ОписаниеУчредителя(Учредитель)
	
	ОписаниеУчредителя = "";
	Если Учредитель.ЭтоЮридическоеЛицо Тогда
		
		Реквизиты = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
			НСтр("ru = 'ОГРН %1, ИНН %2, КПП %3, адрес места нахождения: %4'"),
			Учредитель.СведенияОЮридическомЛице.ОГРН,
			Учредитель.СведенияОЮридическомЛице.ИНН,
			Учредитель.СведенияОЮридическомЛице.КПП,
			Учредитель.СведенияОЮридическомЛице.ЮридическийАдрес);
		
		Если Учредитель.СведенияОЮридическомЛице.Представитель.Пол = Перечисления.ПолФизическогоЛица.Мужской Тогда
			ТекстДействующего = НСтр("ru = 'действующего'")
		Иначе
			ТекстДействующего = НСтр("ru = 'действующей'")
		КонецЕсли;
		
		ОписаниеУчредителя = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
			НСтр("ru = '<STRONG>%1</STRONG> (%2) в лице %3 %4, %5 на основании %6,<BR>'"),
			Учредитель.СведенияОЮридическомЛице.ПолноеНаименование,
			Реквизиты,
			Учредитель.СведенияОЮридическомЛице.Представитель.ДолжностьРодительныйПадеж,
			Учредитель.СведенияОЮридическомЛице.Представитель.ФИОРодительныйПадеж,
			ТекстДействующего,
			Учредитель.СведенияОЮридическомЛице.Представитель.ОснованияПолномочийРодительныйПадеж);
		
	Иначе
		
		ОписаниеУчредителя = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
			НСтр("ru = '<STRONG>%1</STRONG> (%2, зарегистрирован по адресу: %3),<BR>'"),
			Учредитель.СведенияОФизическомЛице.ФИОПолные,
			Учредитель.СведенияОФизическомЛице.ДокументПредставление,
			Учредитель.СведенияОФизическомЛице.АдресПрописки);
		
	КонецЕсли;
	
	Возврат ОписаниеУчредителя;
	
КонецФункции

Функция ОписаниеДолейУставногоКапитала(Учредители)
	
	ОписаниеДолейУставногоКапитала = "";
	
	Для Каждого Учредитель Из Учредители Цикл
		Если Учредитель.СуммаВзноса <> 0 Тогда
			ОписаниеДолейУставногоКапитала = ОписаниеДолейУставногоКапитала
				+ ОписаниеУставногоКапиталаУчредителя(Учредитель);
		КонецЕсли;
	КонецЦикла;
	
	Возврат ОписаниеДолейУставногоКапитала;
	
КонецФункции

Функция ОписаниеУставногоКапиталаУчредителя(Учредитель)
	
	Если Учредитель.ЭтоЮридическоеЛицо Тогда
		НаименованиеУчредителя = Учредитель.СведенияОЮридическомЛице.ПолноеНаименование;
	Иначе
		НаименованиеУчредителя = Учредитель.СведенияОФизическомЛице.ФИОПолные;
	КонецЕсли;
	
	ОписаниеУставногоКапиталаУчредителя = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
		НСтр("ru = '<LI><DIV align=left>%1 - номинальная стоимость доли %2 рублей (%3), что составляет %4 %5 Уставного капитала.</DIV></LI>'"),
		НаименованиеУчредителя,
		Учредитель.СуммаВзносаСтрокой,
		Учредитель.СуммаВзносаПрописью,
		Учредитель.ДоляУставногоКапиталаСтрокой, 
		"%");
		
	Возврат ОписаниеУставногоКапиталаУчредителя;
	
КонецФункции

Функция ПодписьУчредителя(Учредитель)
	
	Если Учредитель.ЭтоЮридическоеЛицо Тогда
		
		ПодписьУчредителя = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
			НСтр("ru = '<STRONG>%1</STRONG><BR>Адрес: %2<BR>ИНН / КПП: %3 / %4<BR>Телефон: %5<BR>E-mail: %6<BR><BR>_____________________ %7 %8'"),
			Учредитель.СведенияОЮридическомЛице.ПолноеНаименование,
			Учредитель.СведенияОЮридическомЛице.ЮридическийАдрес,
			Учредитель.СведенияОЮридическомЛице.ИНН,
			Учредитель.СведенияОЮридическомЛице.КПП,
			Учредитель.СведенияОЮридическомЛице.Телефон,
			Учредитель.СведенияОЮридическомЛице.Email,
			Учредитель.СведенияОЮридическомЛице.Представитель.Должность,
			Учредитель.СведенияОЮридическомЛице.Представитель.ФамилияИО);
		
	Иначе
		
		ПодписьУчредителя = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
			НСтр("ru = '<STRONG>%1</STRONG><BR>Адрес: %2<BR>ИНН: %3<BR>Телефон: %4<BR>E-mail: %5<BR><BR>_____________________ %8'"),
			Учредитель.СведенияОФизическомЛице.ФИОПолные,
			Учредитель.СведенияОФизическомЛице.АдресПрописки,
			Учредитель.СведенияОФизическомЛице.ИНН,
			Учредитель.СведенияОФизическомЛице.Телефон,
			Учредитель.СведенияОФизическомЛице.Email,
			Учредитель.СведенияОФизическомЛице.ФамилияИО);
		
	КонецЕсли;
	
	Возврат "<P>" + ПодписьУчредителя + "</P><BR>";
	
КонецФункции

Процедура ПодставитьПараметрВТекст(ТекстHTML, ИмяПараметра, ЗначениеПараметра)
	
	ТекстHTML = СтрЗаменить(ТекстHTML, "{"+ИмяПараметра+"}", ЗначениеПараметра);
	
КонецПроцедуры

Функция ТекстСоСтрочнойБуквы(Текст)

	Возврат НРег(Лев(Текст, 1)) + Сред(Текст, 2);

КонецФункции

Функция СкопироватьКлючиСтруктуры(СтруктураИсточник)
	
	СтруктураРезультат = Новый Структура;
	
	Для Каждого КлючИЗначение Из СтруктураИсточник Цикл
		Ключ = КлючИЗначение.Ключ;
		Значение = КлючИЗначение.Значение;
		ТипЗначения = ТипЗнч(Значение);
		Если ТипЗначения = Тип("Структура") Тогда
			ПустоеЗначение = СкопироватьКлючиСтруктуры(Значение);
			СтруктураРезультат.Вставить(Ключ, ПустоеЗначение);
		ИначеЕсли ТипЗначения = Тип("СписокЗначений") И Значение.Количество() <> 0 Тогда
			ПустоеЗначение = Новый СписокЗначений;
			ПустоеЗначение.Добавить(СкопироватьКлючиСтруктуры(Значение[0].Значение));
			СтруктураРезультат.Вставить(Ключ, ПустоеЗначение);
		Иначе
			ПустоеЗначение = Неопределено;
			СтруктураРезультат.Вставить(Ключ, ПустоеЗначение);
		КонецЕсли;
	КонецЦикла;
	
	Возврат СтруктураРезультат;
	
КонецФункции

Функция СобытиеЖурналаРегистрации() Экспорт
	
	Возврат НСтр("ru = 'Регистрация организации'", ОбщегоНазначения.КодОсновногоЯзыка());
	
КонецФункции

// Процедура очищает хранилище общих настроек после завершения регистрации.
//
Процедура ОчиститьСлужебныеДанныеПослеРегистрации() Экспорт
	
	ВыборкаНастроек = ХранилищеОбщихНастроек.Выбрать(Новый Структура("КлючОбъекта", ИмяКлючаНастроек()));
	Пока ВыборкаНастроек.Следующий() Цикл
		ХранилищеОбщихНастроек.Удалить(
			ВыборкаНастроек.КлючОбъекта,
			ВыборкаНастроек.КлючНастроек,
			ВыборкаНастроек.Пользователь);
	КонецЦикла;
	
КонецПроцедуры

// Возвращает сумму государственной пошлины за регистрацию физ.лица в качестве ИП
//
// Возвращаемое значение:
//   Число 15, 2
//
Функция СуммаПошлиныРегистрацияИП()
	
	Возврат 800;
	
КонецФункции

// Возвращает сумму государственной пошлины за регистрацию Юридического лица
//
// Возвращаемое значение:
//   Число 15, 2
//
Функция СуммаПошлиныРегистрацияЮЛ()
	
	Возврат 4000;
	
КонецФункции

#КонецОбласти

#Область ПолучениеИНН

Процедура ПолучитьКартинкуСКодомВФоне(ПараметрыПолучения, АдресРезультата = Неопределено) Экспорт
	
	ДанныеКодаПолученияИНН = ДанныеСервисаРегистрации.ДанныеКодаПолученияИНН();
	
	ПоместитьВоВременноеХранилище(ДанныеКодаПолученияИНН, АдресРезультата);
	
КонецПроцедуры

Процедура ПолучитьИННВФоне(ПараметрыПолучения, АдресРезультата = Неопределено) Экспорт
	
	ДанныеИНН = ДанныеСервисаРегистрации.ОпределитьИНН(ПараметрыПолучения.ДанныеФизическогоЛица, ПараметрыПолучения.Токен, ПараметрыПолучения.КодСКартинки);
	
	ПоместитьВоВременноеХранилище(ДанныеИНН, АдресРезультата);
	
КонецПроцедуры

#КонецОбласти

#Область ВнесениеИзмененийЕГРЮЛиЕГРИП

// Функция проверяет доступность внесения изменений в ЕГР по организационно-правовой форме организации.
//
// Параметры:
//   ЭтоИндивидуальныйПредприниматель - Булево - признак, является ли организация индивидуальным предпринимателем.
//   ПравоваяФорма - Строка - организационно-правовая форма организации.
//
// Возвращаемое значение:
//   Булево - Истина, если поддерживается внесение изменений в ЕГР для ОПФ организации.
//
Функция ДоступноВнесениеИзмененийЕГР(ЭтоИндивидуальныйПредприниматель, ПравоваяФорма) Экспорт
	
	Если Не ПравоДоступа("Использование", Метаданные.Обработки.РегистрацияОрганизации) Тогда
		Возврат Ложь;
	КонецЕсли;
	
	// Для ИП всегда доступно внесение изменений в ЕГР.
	Если ЭтоИндивидуальныйПредприниматель Тогда
		Возврат Истина;
	КонецЕсли;
	
	Если Не ЗначениеЗаполнено(ПравоваяФорма) Тогда
		Возврат Истина;
	КонецЕсли;
	
	Для Каждого ПоддерживаемаяПравоваяФорма Из РегистрацияОрганизацииКлиентСервер.ПоддерживаемыеПравовыеФормы() Цикл
		Если ВРег(СокрЛП(ПоддерживаемаяПравоваяФорма)) = ВРег(СокрЛП(ПравоваяФорма)) Тогда
			Возврат Истина;
		КонецЕсли;
	КонецЦикла;
	
	Возврат Ложь;
	
КонецФункции

#Область ЗаполнениеДаннымиЕГР

// Заполняет реквизиты объекта и формы данными, полученными из госреестров.
//
// Параметры:
//   ОтветДанныхЕГР - Структура - см. ОрганизацииФормыДляОтчетности.НовыйОтветДанныхЕГР(),
//                                результат запроса к сервису, предоставляющему данные госреестров
//   Форма  - УправляемаяФорма - форма РегистрацияОрганизации.ВнесениеИзмененийЕГР
//
Процедура ЗаполнитьДаннымиЕГР(ОтветДанныхЕГР, Форма) Экспорт
	
	ДанныеЕГР = ПолучитьИзВременногоХранилища(ОтветДанныхЕГР.АдресДанных);
	Если ТипЗнч(ДанныеЕГР) <> Тип("Структура") Тогда
		Возврат;
	КонецЕсли;
	
	// Инициализируем реквизит формы
	СуществующаяОрганизация = Справочники.Организации.НайтиОрганизацию(ДанныеЕГР.ИНН);
	Если ЗначениеЗаполнено(СуществующаяОрганизация) Тогда
		ОрганизацияОбъект = СуществующаяОрганизация.ПолучитьОбъект();
	Иначе
		ОрганизацияОбъект = Справочники.Организации.СоздатьЭлемент();
		ОрганизацияОбъект.Заполнить(Неопределено);
	КонецЕсли;
	ОрганизацияОбъект.ЮридическоеФизическоеЛицо = ДанныеЕГР.ЮридическоеФизическоеЛицо;
	Форма.ЗначениеВРеквизитФормы(ОрганизацияОбъект, "Объект");
	
	// Обработка заполнения по умолчанию
	ОрганизацииФормыДляОтчетности.ЗаполнитьДаннымиЕГР(ОтветДанныхЕГР, Форма);
	
	Если ОрганизацияОбъект.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо 
		И ЗначениеЗаполнено(ДанныеЕГР.ЮридическийАдрес) Тогда
		Форма.ЮридическийАдрес = ДанныеЕГР.ЮридическийАдрес.Представление;
		Форма.ЮридическийАдресЗначениеJSON = ДанныеЕГР.ЮридическийАдрес.КонтактнаяИнформация; // JSON-строка
	КонецЕсли;
	
КонецПроцедуры

// Получает сведения об учредителях, коды ОКВЭД, размер уставного капитала.
//
// Параметры:
//   ИННЗапрос        - Строка - ИНН, для которого следует получить информацию.
//   АдресРезультата  - Строка.
//
Процедура ПолучитьИнформациюОбУчредителяхИКодахОКВЭДВФоне(ИННЗапрос, АдресРезультата = Неопределено) Экспорт
	
	ИНН = СокрЛП(ИННЗапрос);
	ЭтоЮридическоеЛицо = (СтрДлина(ИНН) = 10);
	Если ЭтоЮридическоеЛицо Тогда
		ИнформацияОСвязях = РаботаСКонтрагентами.ИнформацияОСвязяхЮридическогоЛицаПоИНН(ИНН);
	Иначе
		ИнформацияОСвязях = РаботаСКонтрагентами.ИнформацияОСвязяхПредпринимателяПоИНН(ИНН);
	КонецЕсли;
	
	ДополнитьИнформациейОПредставителяхУчредителей(ИнформацияОСвязях);
	
	ПоместитьВоВременноеХранилище(ИнформацияОСвязях, АдресРезультата);
	
КонецПроцедуры

// Процедура заполнения дополнительных реквизитов формы и объекта после заполнения из ЕГР.
//
Процедура ЗаполнитьДополнительныеРеквизитыПоДаннымЕГР(Форма) Экспорт
	
	Объект = Форма.Объект;
	
	Форма.РуководительНаименование = ФИО(Форма.РуководительФамилия, Форма.РуководительИмя, Форма.РуководительОтчество);
	
	Если Объект.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ФизическоеЛицо Тогда
		ШаблонИННиОГРН = НСтр("ru = 'ИНН %1, ОГРНИП %2'");
	Иначе
		ШаблонИННиОГРН = НСтр("ru = 'ИНН %1, ОГРН %2'");
	КонецЕсли;
	Форма.ИННиОГРН = СтрШаблон(ШаблонИННиОГРН, Объект.ИНН, Объект.ОГРН);
	
	Если Объект.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ФизическоеЛицо Тогда
		
		Объект.НаименованиеСокращенное = ОрганизацииФормыКлиентСервер.СокращенноеНаименованиеИндивидульногоПредпринимателя(
			Объект.ФамилияИП, Объект.ИмяИП, Объект.ОтчествоИП);
		
		Объект.НаименованиеПолное = ОрганизацииФормыКлиентСервер.ПолноеНаименованиеИндивидульногоПредпринимателя(
			Объект.ФамилияИП, Объект.ИмяИП, Объект.ОтчествоИП);
		
	КонецЕсли;
	
	Если НЕ ЗначениеЗаполнено(Форма.НаименованиеСокращенное) Тогда
		Форма.НаименованиеСокращенное = Объект.НаименованиеСокращенное;
	КонецЕсли;
	Если НЕ ЗначениеЗаполнено(Форма.НаименованиеПолное) Тогда
		Форма.НаименованиеПолное = Объект.НаименованиеПолное;
	КонецЕсли;
	Если НЕ ЗначениеЗаполнено(Форма.КодОКВЭД2) Тогда
		Форма.КодОКВЭД2 = Объект.КодОКВЭД2;
	КонецЕсли;
	
КонецПроцедуры

// Заполняет сведения об учредителях, коды ОКВЭД, размер уставного капитала.
//
// Параметры:
//   ИнформацияОСвязях - Структура - см. РаботаСКонтрагентами.НоваяИнформацияОСвязяхЮридическогоЛица()
//                       результат запроса к сервису, возвращающему информацию о связях юридического лица,
//                       его руководителей и учредителей с другими лицами по данным ЕГРЮЛ
//   Форма  - УправляемаяФорма - форма РегистрацияОрганизации.ВнесениеИзмененийЕГР
//
Процедура ЗаполнитьИнформацияОСвязях(ИнформацияОСвязях, Форма) Экспорт
	
	Объект = Форма.Объект;
	
	ИнформацияОСвязях.Свойство("УставныйКапитал", Форма.УставныйКапитал);
	
	Форма.Учредители.Очистить();
	Если ИнформацияОСвязях.Свойство("Учредители") Тогда
		
		Учредители = ИнформацияОСвязях.Учредители.Скопировать();
		Учредители.Колонки.Учредитель.Имя = "Наименование";
		Учредители.Колонки.СуммаКапитала.Имя = "СуммаВзноса";
		Для Каждого Учредитель Из Учредители Цикл
			Учредитель.Наименование = НаименованиеПолное(Учредитель.Наименование);
		КонецЦикла;
		
		ФизическиеЛицаКонтрагенты = НайтиУчредителейСредиФизическихЛицКонтрагентов(Учредители);
		
		МассивКоэффициентов = Учредители.ВыгрузитьКолонку("СуммаВзноса");
		МассивДолей = ОбщегоНазначенияБПКлиентСервер.РаспределитьПропорционально(100, МассивКоэффициентов, 2);
		
		Для Индекс = 0 По Учредители.Количество() - 1 Цикл
			
			Учредитель = Учредители[Индекс];
			
			ФизическоеЛицоКонтрагент = УчредительФизическоеЛицоКонтрагент(Учредитель, ФизическиеЛицаКонтрагенты);
			
			НоваяСтрока = Форма.Учредители.Добавить();
			ЗаполнитьЗначенияСвойств(НоваяСтрока, Учредитель);
			
			Если ФизическоеЛицоКонтрагент <> Неопределено Тогда
				НоваяСтрока.Ссылка = ФизическоеЛицоКонтрагент.Ссылка;
				НоваяСтрока.Наименование = ФизическоеЛицоКонтрагент.НаименованиеПолное;
			КонецЕсли;
			
			НоваяСтрока.ДоляУчастия = ?(МассивДолей <> Неопределено, МассивДолей[Индекс], 0);
			НоваяСтрока.ТипУчредителя = ТипУчредителя(НоваяСтрока);
			
		КонецЦикла;
		
	КонецЕсли;
	
	Форма.ВидыДеятельности.Очистить();
	Если ИнформацияОСвязях.Свойство("ВидыДеятельности") Тогда
		
		ТаблицаВидовДеятельности = ИнформацияОСвязях.ВидыДеятельности;
		ТаблицаВидовДеятельности.Колонки.КодОКВЭД.Имя          = "Код";
		ТаблицаВидовДеятельности.Колонки.НаименованиеОКВЭД.Имя = "Наименование";
		
		ОсновнойКод = ?(ЗначениеЗаполнено(Объект.КодОКВЭД2), Объект.КодОКВЭД2, "");
		ДополнительныеКоды = Новый Массив;
		Для Каждого ВидДеятельности Из ТаблицаВидовДеятельности Цикл
			Если ВидДеятельности.ЭтоОКВЭД2 Тогда
				ЗаполнитьЗначенияСвойств(Форма.ВидыДеятельности.Добавить(), ВидДеятельности);
				Если ВидДеятельности.Код <> ОсновнойКод Тогда
					ДополнительныеКоды.Добавить(ВидДеятельности.Код);
				КонецЕсли;
			КонецЕсли;
		КонецЦикла;
		
		Объект.ДополнительныеКодыОКВЭД2 = СтрСоединить(ДополнительныеКоды, ";");
		
	КонецЕсли;
	
	Если Форма.ВидыДеятельности.Количество() = 0
		И ЗначениеЗаполнено(Объект.КодОКВЭД2) Тогда
		НоваяСтрока = Форма.ВидыДеятельности.Добавить();
		НоваяСтрока.Код = Объект.КодОКВЭД2;
	КонецЕсли;
	
КонецПроцедуры

Функция НаименованиеПолное(НаименованиеЕГР)
	
	ПравовыеФормы = Новый Массив;
	ПравовыеФормы.Добавить("Общество с ограниченной ответственностью");
	ПравовыеФормы.Добавить("Закрытое акционерное общество");
	ПравовыеФормы.Добавить("Открытое акционерное общество");
	ПравовыеФормы.Добавить("Публичное акционерное общество");
	ПравовыеФормы.Добавить("Акционерное общество");
	
	НаименованиеПолное = НаименованиеЕГР;
	Для каждого ПравоваяФорма Из ПравовыеФормы Цикл
		Если СтрНачинаетсяС(НаименованиеЕГР, ВРег(ПравоваяФорма) + " ") Тогда
			НаименованиеПолное = ПравоваяФорма + Сред(НаименованиеЕГР, СтрДлина(ПравоваяФорма) + 1);
			Прервать;
		КонецЕсли;
	КонецЦикла;
	
	Возврат НаименованиеПолное;
	
КонецФункции

Функция ТипУчредителя(Учредитель)
	
	Если ТипЗнч(Учредитель.Ссылка) = Тип("СправочникСсылка.ФизическиеЛица") Тогда
		Возврат Перечисления.ЮридическоеФизическоеЛицо.ФизическоеЛицо;
	ИначеЕсли ТипЗнч(Учредитель.Ссылка) = Тип("СправочникСсылка.Контрагенты") Тогда
		Возврат Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо;
	КонецЕсли;
	
	ДлинаИНН = СтрДлина(СокрЛП(Учредитель.ИНН));
	Если ДлинаИНН = 10 Тогда
		Возврат Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо;
	ИначеЕсли ДлинаИНН = 12 Тогда
		Возврат Перечисления.ЮридическоеФизическоеЛицо.ФизическоеЛицо;
	КонецЕсли;
	
	ДопустимоВФИОКромеКириллицы = "-. 0123456789";
	Если Не СтроковыеФункцииКлиентСервер.ТолькоКириллицаВСтроке(Учредитель.Наименование, Истина, ДопустимоВФИОКромеКириллицы) Тогда
		Возврат Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо;
	КонецЕсли;
	
	Возврат Перечисления.ЮридическоеФизическоеЛицо.ФизическоеЛицо;
	
КонецФункции

Процедура ДополнитьИнформациейОПредставителяхУчредителей(ИнформацияОСвязях)
	
	Если Не ИнформацияОСвязях.Свойство("Учредители") Тогда
		Возврат;
	КонецЕсли;
	
	ИнформацияОСвязях.Учредители.Колонки.Добавить("ПредставительУчредителя", Новый ОписаниеТипов("СправочникСсылка.ФизическиеЛица"));
	ИнформацияОСвязях.Учредители.Колонки.Добавить("ДолжностьПредставителя", Новый ОписаниеТипов("СправочникСсылка.Должности"));
	ИнформацияОСвязях.Учредители.Колонки.Добавить("ПредставительНаОсновании", ОбщегоНазначения.ОписаниеТипаСтрока(50));
	
	Для Каждого Учредитель Из ИнформацияОСвязях.Учредители Цикл
		
		Если ПустаяСтрока(Учредитель.ИНН) Тогда
			Продолжить;
		КонецЕсли;
		
		ДлинаИНН = СтрДлина(СокрЛП(Учредитель.ИНН));
		Если ДлинаИНН <> 10 Тогда
			Продолжить;
		КонецЕсли;
		
		ДанныеУчредителя = РаботаСКонтрагентами.РеквизитыЮридическогоЛицаПоИНН(Учредитель.ИНН);
		Если ЗначениеЗаполнено(ДанныеУчредителя.ОписаниеОшибки) Тогда
			ЗаписьЖурналаРегистрации(СобытиеЖурналаРегистрации(),
				УровеньЖурналаРегистрации.Ошибка,
				Метаданные.Справочники.Контрагенты,
				,
				ДанныеУчредителя.ОписаниеОшибки);
			ВызватьИсключение ДанныеУчредителя.ОписаниеОшибки;
		КонецЕсли;
		
		СведенияОРуководителе = СведенияОРуководителеУчредителя(ДанныеУчредителя);
		ЗаполнитьЗначенияСвойств(Учредитель, СведенияОРуководителе);
		
	КонецЦикла;
	
КонецПроцедуры

Функция СведенияОРуководителеУчредителя(ДанныеУчредителя, СоздаватьФизЛицо = Ложь)
	
	Результат = Новый Структура;
	Результат.Вставить("ПредставительУчредителя", Справочники.ФизическиеЛица.ПустаяСсылка());
	Результат.Вставить("ДолжностьПредставителя", Справочники.Должности.ПустаяСсылка());
	Результат.Вставить("ПредставительНаОсновании", "");
	
	Если ДанныеУчредителя.Свойство("Руководитель") И ДанныеУчредителя.Руководитель <> Неопределено Тогда
		
		РуководительСсылка = Справочники.Организации.ФизическоеЛицо(
			ДанныеУчредителя.Руководитель.Фамилия,
			ДанныеУчредителя.Руководитель.Имя,
			ДанныеУчредителя.Руководитель.Отчество,
			ДанныеУчредителя.Руководитель.ИНН);
			
		Если ЗначениеЗаполнено(РуководительСсылка) Тогда
			Результат.ПредставительУчредителя = РуководительСсылка;
		ИначеЕсли СоздаватьФизЛицо Тогда
			ДанныеФизическогоЛица = НовыеДанныеФизическогоЛица();
			ЗаполнитьЗначенияСвойств(ДанныеФизическогоЛица, ДанныеУчредителя.Руководитель);
			ОрганизацииФормыКлиентСервер.ОпределитьПолПоОтчеству(ДанныеФизическогоЛица.Пол, ДанныеФизическогоЛица.Отчество);
			Результат.ПредставительУчредителя = ЗаписатьФизическоеЛицо(ДанныеФизическогоЛица);
		КонецЕсли;
		
		Если ЗначениеЗаполнено(Результат.ПредставительУчредителя) Тогда
			Результат.ДолжностьПредставителя = РаботаСДолжностямиБППовтИсп.ДолжностьПоНаименованию(ДанныеУчредителя.Руководитель.Должность);
		КонецЕсли;
		
		Результат.ПредставительНаОсновании = РегистрацияОрганизацииКлиентСервер.ОснованиеПолномочийПредставителя();
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции

// Процедура отложенного заполнения наименований видов деятельности в коллекции формы.
// Из ЕГРЮЛ возвращаются только коды ОКВЭД, наименования заполняем из макета при необходимости.
// Например, перед открытием формы ИзменениеВидовДеятельности.
//
// Параметры:
//   КоллекцияВидовДеятельности - ДанныеФормыКоллекция с колонками:
//     * Код - Строка - код ОКВЭД
//     * ЭтоОКВЭД2 - Булево - Истина, если это ОКВЭД2
//     * Наименование - Строка - наименование вида деятельности
//
Процедура ЗаполнитьНаименованияВидовДеятельности(КоллекцияВидовДеятельности) Экспорт
	
	Перем ОКВЭД, ОКВЭД2;
	
	Для Каждого ВидДеятельности Из КоллекцияВидовДеятельности Цикл
		
		Если ВидДеятельности.ЭтоОКВЭД2 Тогда
			Если ОКВЭД2 = Неопределено Тогда
				ОКВЭД2 = ОбщегоНазначенияБПВызовСервера.ПолучитьКлассификатор("ОКВЭД2");
			КонецЕсли;
			Классификатор = ОКВЭД2;
		Иначе
			Если ОКВЭД = Неопределено Тогда
				ОКВЭД = ОбщегоНазначенияБПВызовСервера.ПолучитьКлассификатор("ОКВЭД");
			КонецЕсли;
			Классификатор = ОКВЭД;
		КонецЕсли;
		
		ВидДеятельности.Наименование = Классификатор[ВидДеятельности.Код];
		
	КонецЦикла;
	
КонецПроцедуры

#КонецОбласти

#Область ЗаписьУчредителей

// Записывает учредителей.
//
// Параметры:
//   Учредители - ТаблицаЗначений - таблица с колонками:
//     * Ссылка - СправочникСсылка.ФизическиеЛица, СправочникСсылка.Контрагенты
//     * Наименование - Строка - ФИО физического или наименование юридического лица
//     * ИНН - Строка
//     * ПредставительУчредителя - СправочникСсылка.ФизическиеЛица - представитель юридического лица
//     * ДолжностьПредставителя - СправочникСсылка.Должности - должность представителя юридического лица
//     * ПредставительНаОсновании - Строка - представитель юридического лица
//   АдресРезультата - Строка - адрес временного хранилища для таблицы учредителей
//
Процедура ЗаписатьУчредителейВФоне(Знач Учредители, АдресРезультата = Неопределено) Экспорт
	
	Результат = ЗаписатьУчредителей(Учредители);
	
	ПоместитьВоВременноеХранилище(Результат.Учредители, АдресРезультата);
	
КонецПроцедуры

// Записывает учредителей.
//
// Параметры:
//   Учредители - ТаблицаЗначений - таблица с колонками:
//     * Ссылка - СправочникСсылка.ФизическиеЛица, СправочникСсылка.Контрагенты
//     * Наименование - Строка - ФИО физического или наименование юридического лица
//     * ИНН - Строка
//     * ПредставительУчредителя - СправочникСсылка.ФизическиеЛица - представитель юридического лица
//     * ДолжностьПредставителя - СправочникСсылка.Должности - должность представителя юридического лица
//     * ПредставительНаОсновании - Строка - представитель юридического лица
//
// Возвращаемое значение:
//   Структура
//
Функция ЗаписатьУчредителей(Знач Учредители) Экспорт
	
	ФизическиеЛицаКонтрагенты = НайтиУчредителейСредиФизическихЛицКонтрагентов(Учредители);
	
	НачатьТранзакцию();
	Попытка
		
		Для Каждого Учредитель Из Учредители Цикл
			
			Если Учредитель.ТипУчредителя = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо Тогда
				Если Не ПустаяСтрока(Учредитель.ИНН) Тогда
					ДанныеЗаполненияПоИНН = РаботаСКонтрагентами.РеквизитыЮридическогоЛицаПоИНН(Учредитель.ИНН);
					Если ЗначениеЗаполнено(ДанныеЗаполненияПоИНН.ОписаниеОшибки) Тогда
						ЗаписьЖурналаРегистрации(СобытиеЖурналаРегистрации(),
								УровеньЖурналаРегистрации.Ошибка,
								Метаданные.Справочники.Контрагенты,
								,
								ДанныеЗаполненияПоИНН.ОписаниеОшибки);
						ВызватьИсключение ДанныеЗаполненияПоИНН.ОписаниеОшибки;
					КонецЕсли;
					
					ДанныеЗаполнения = Новый Структура;
					ДанныеЗаполнения.Вставить("ИНН", ДанныеЗаполненияПоИНН.ИНН);
					ДанныеЗаполнения.Вставить("КПП", ДанныеЗаполненияПоИНН.КПП);
					ДанныеЗаполнения.Вставить("Наименование", ДанныеЗаполненияПоИНН.Наименование);
					ДанныеЗаполнения.Вставить("НаименованиеПолное", ДанныеЗаполненияПоИНН.НаименованиеПолное);
					ДанныеЗаполнения.Вставить("НаименованиеСокращенное", ДанныеЗаполненияПоИНН.НаименованиеСокращенное);
					ДанныеЗаполнения.Вставить("РегистрационныйНомер", ДанныеЗаполненияПоИНН.РегистрационныйНомер);
					ДанныеЗаполнения.Вставить("ДатаРегистрации", ДанныеЗаполненияПоИНН.ДатаРегистрации);
					ДанныеЗаполнения.Вставить("ЮридическийАдресЗначениеJSON", ДанныеЗаполненияПоИНН.ЮридическийАдрес.КонтактнаяИнформация);
					Если ЗначениеЗаполнено(ДанныеЗаполненияПоИНН.Телефон) Тогда
						ДанныеЗаполнения.Вставить("ТелефонЗначениеJSON", ДанныеЗаполненияПоИНН.Телефон.КонтактнаяИнформация);
					КонецЕсли;
					ДанныеЗаполнения.Вставить("Руководитель", ДанныеЗаполненияПоИНН.Руководитель);
					
					ЗаписатьУчредителяЮридическоеЛицо(Учредитель, ДанныеЗаполнения, ФизическиеЛицаКонтрагенты);
				ИначеЕсли Не ПустаяСтрока(Учредитель.Наименование) Тогда
					ДанныеЗаполнения = Новый Структура;
					ДанныеЗаполнения.Вставить("Наименование", Учредитель.Наименование);
					ДанныеЗаполнения.Вставить("НаименованиеПолное", Учредитель.Наименование);
					ДанныеЗаполнения.Вставить("НаименованиеСокращенное", Учредитель.Наименование);
					ЗаписатьУчредителяЮридическоеЛицо(Учредитель, ДанныеЗаполнения, ФизическиеЛицаКонтрагенты);
				КонецЕсли;
				
			ИначеЕсли Учредитель.ТипУчредителя = Перечисления.ЮридическоеФизическоеЛицо.ФизическоеЛицо Тогда
				ЗаписатьУчредителяФизическоеЛицо(Учредитель, ФизическиеЛицаКонтрагенты);
			КонецЕсли;
			
		КонецЦикла;
		
		ЗафиксироватьТранзакцию();
		
	Исключение
		
		ОтменитьТранзакцию();
		ЗаписьЖурналаРегистрации(СобытиеЖурналаРегистрации(),
				УровеньЖурналаРегистрации.Ошибка, Метаданные.Справочники.Организации, ,
				ПодробноеПредставлениеОшибки(ИнформацияОбОшибке()));
		ВызватьИсключение;
		
	КонецПопытки;
	
	Возврат Новый Структура("Учредители", Учредители);
	
КонецФункции

Процедура ЗаписатьУчредителяФизическоеЛицо(Учредитель, ФизическиеЛицаКонтрагенты)
	
	Если ПустаяСтрока(Учредитель.ИНН) И ПустаяСтрока(Учредитель.Наименование) Тогда
		Возврат;
	КонецЕсли;
	
	ФизическоеЛицо = УчредительФизическоеЛицоКонтрагент(
		Учредитель, ФизическиеЛицаКонтрагенты, Перечисления.ЮридическоеФизическоеЛицо.ФизическоеЛицо);
	
	Если ФизическоеЛицо <> Неопределено Тогда
		Учредитель.Ссылка = ФизическоеЛицо.Ссылка;
		Учредитель.Наименование = ФизическоеЛицо.НаименованиеПолное;
	Иначе
		ДанныеФизическогоЛица = НовыеДанныеФизическогоЛица();
		ЗаполнитьЗначенияСвойств(ДанныеФизическогоЛица, ФизическиеЛицаКлиентСервер.ЧастиИмени(Учредитель.Наименование));
		ОрганизацииФормыКлиентСервер.ОпределитьПолПоОтчеству(ДанныеФизическогоЛица.Пол, ДанныеФизическогоЛица.Отчество);
		ДанныеФизическогоЛица.ИНН = Учредитель.ИНН;
		Учредитель.Ссылка = ЗаписатьФизическоеЛицо(ДанныеФизическогоЛица);
	КонецЕсли;
	
КонецПроцедуры

Процедура ЗаписатьУчредителяЮридическоеЛицо(Учредитель, ДанныеЗаполнения, ФизическиеЛицаКонтрагенты)
	
	Если ПустаяСтрока(Учредитель.ИНН) И ПустаяСтрока(Учредитель.Наименование) Тогда
		Возврат;
	КонецЕсли;
	
	Контрагент = УчредительФизическоеЛицоКонтрагент(
		Учредитель, ФизическиеЛицаКонтрагенты, Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо);
	
	Если Контрагент <> Неопределено Тогда
		Учредитель.Ссылка = Контрагент.Ссылка;
		Учредитель.Наименование = Контрагент.НаименованиеПолное;
	Иначе
		КонтрагентОбъект = Справочники.Контрагенты.СоздатьЭлемент();
		КонтрагентОбъект.Заполнить(ДанныеЗаполнения);
		КонтрагентОбъект.Записать();
		Учредитель.Ссылка = КонтрагентОбъект.Ссылка;
		Учредитель.Наименование = КонтрагентОбъект.НаименованиеПолное;
	КонецЕсли;
	
	СведенияОРуководителеУчредителя = СведенияОРуководителеУчредителя(ДанныеЗаполнения, Истина);
	ЗаполнитьЗначенияСвойств(Учредитель, СведенияОРуководителеУчредителя);
	
КонецПроцедуры

// Ищет в справочниках ФизическиеЛица и Контрагенты учредителей по ИНН, ФИО и наименованию.
//
// Параметры:
//   Учредители - ТаблицаЗначений - таблица с колонками:
//     * Наименование - Строка - ФИО физического или наименование юридического лица
//     * ИНН - Строка
//
// Возвращаемое значение:
//   ТаблицаЗначений
//
Функция НайтиУчредителейСредиФизическихЛицКонтрагентов(Учредители)
	
	ИННУчредителей = ОбщегоНазначения.ВыгрузитьКолонку(Учредители, "ИНН", Истина);
	НаименованияУчредителей = ОбщегоНазначения.ВыгрузитьКолонку(Учредители, "Наименование", Истина);
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("ИННУчредителей", ИННУчредителей);
	Запрос.УстановитьПараметр("НаименованияУчредителей", НаименованияУчредителей);
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	1 КАК Приоритет,
	|	Контрагенты.ЮридическоеФизическоеЛицо КАК ЮридическоеФизическоеЛицо,
	|	Контрагенты.Ссылка КАК Ссылка,
	|	Контрагенты.ИНН КАК ИНН,
	|	Контрагенты.Наименование КАК Наименование,
	|	Контрагенты.НаименованиеПолное КАК НаименованиеПолное
	|ИЗ
	|	Справочник.Контрагенты КАК Контрагенты
	|ГДЕ
	|	Контрагенты.ИНН В(&ИННУчредителей)
	|	И НЕ Контрагенты.ИНН ПОДОБНО """"
	|	И Контрагенты.ЮридическоеФизическоеЛицо = ЗНАЧЕНИЕ(Перечисление.ЮридическоеФизическоеЛицо.ЮридическоеЛицо)
	|	И НЕ Контрагенты.ПометкаУдаления
	|	И НЕ Контрагенты.ЭтоГруппа
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	3,
	|	Контрагенты.ЮридическоеФизическоеЛицо,
	|	Контрагенты.Ссылка,
	|	Контрагенты.ИНН,
	|	Контрагенты.Наименование,
	|	Контрагенты.НаименованиеПолное
	|ИЗ
	|	Справочник.Контрагенты КАК Контрагенты
	|ГДЕ
	|	Контрагенты.НаименованиеПолное В(&НаименованияУчредителей)
	|	И Контрагенты.ИНН ПОДОБНО """"
	|	И Контрагенты.ЮридическоеФизическоеЛицо = ЗНАЧЕНИЕ(Перечисление.ЮридическоеФизическоеЛицо.ЮридическоеЛицо)
	|	И НЕ Контрагенты.ПометкаУдаления
	|	И НЕ Контрагенты.ЭтоГруппа
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	1,
	|	ЗНАЧЕНИЕ(Перечисление.ЮридическоеФизическоеЛицо.ФизическоеЛицо),
	|	ФизическиеЛица.Ссылка,
	|	ФизическиеЛица.ИНН,
	|	ФизическиеЛица.ФИО,
	|	ФизическиеЛица.Наименование
	|ИЗ
	|	Справочник.ФизическиеЛица КАК ФизическиеЛица
	|ГДЕ
	|	ФизическиеЛица.ИНН В(&ИННУчредителей)
	|	И НЕ ФизическиеЛица.ИНН ПОДОБНО """"
	|	И НЕ ФизическиеЛица.ПометкаУдаления
	|	И НЕ ФизическиеЛица.ЭтоГруппа
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	2,
	|	ЗНАЧЕНИЕ(Перечисление.ЮридическоеФизическоеЛицо.ФизическоеЛицо),
	|	ФизическиеЛица.Ссылка,
	|	ФизическиеЛица.ИНН,
	|	ФизическиеЛица.ФИО,
	|	ФизическиеЛица.Наименование
	|ИЗ
	|	Справочник.ФизическиеЛица КАК ФизическиеЛица
	|ГДЕ
	|	ФизическиеЛица.ФИО В(&НаименованияУчредителей)
	|	И ФизическиеЛица.ИНН ПОДОБНО """"
	|	И НЕ ФизическиеЛица.ПометкаУдаления
	|	И НЕ ФизическиеЛица.ЭтоГруппа
	|
	|УПОРЯДОЧИТЬ ПО
	|	Приоритет";
	
	ФизическиеЛицаКонтрагенты = Запрос.Выполнить().Выгрузить();
	
	Возврат ФизическиеЛицаКонтрагенты;
	
КонецФункции

Функция УчредительФизическоеЛицоКонтрагент(Учредитель, ФизическиеЛицаКонтрагенты, ЮридическоеФизическоеЛицо = Неопределено)
	
	Если Не ПустаяСтрока(Учредитель.ИНН) Тогда
		Отбор = Новый Структура("ИНН", Учредитель.ИНН);
	ИначеЕсли Не ПустаяСтрока(Учредитель.Наименование) Тогда
		Отбор = Новый Структура("Наименование", Учредитель.Наименование);
	Иначе
		Возврат Неопределено;
	КонецЕсли;
	
	Если ЮридическоеФизическоеЛицо <> Неопределено Тогда
		Отбор.Вставить("ЮридическоеФизическоеЛицо", ЮридическоеФизическоеЛицо);
	КонецЕсли;
	
	НайденныеУчредители = ФизическиеЛицаКонтрагенты.НайтиСтроки(Отбор);
	Если НайденныеУчредители.Количество() <> 0 Тогда
		ИскомыйУчредитель = НайденныеУчредители[0];
		Для Индекс = 1 По НайденныеУчредители.ВГраница() Цикл
			Если НайденныеУчредители[Индекс].Приоритет < ИскомыйУчредитель.Приоритет Тогда
				ИскомыйУчредитель = НайденныеУчредители[Индекс];
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
	
	Возврат ИскомыйУчредитель;
	
КонецФункции

Функция ФИО(Фамилия, Имя, Отчество)
	
	Строки = Новый Массив;
	Если Не ПустаяСтрока(Фамилия) Тогда
		Строки.Добавить(Фамилия);
	КонецЕсли;
	Если Не ПустаяСтрока(Имя) Тогда
		Строки.Добавить(Имя);
	КонецЕсли;
	Если Не ПустаяСтрока(Отчество) Тогда
		Строки.Добавить(Отчество);
	КонецЕсли;
	
	Возврат СтрСоединить(Строки, " ");
	
КонецФункции

#КонецОбласти

#Область ПроверкаЗаполненияРеквизитовУчредителей

// Проверяет все ли необходимые реквизиты учредителя заполнены
//
// Параметры:
//   Учредитель - СправочникСсылка.ФизическиеЛица, СправочникСсылка.Контрагенты
//
// Возвращаемое значение:
//   Булево - Истина, если все необходимые реквизиты заполнены
//
Функция РеквизитыУчредителяЗаполнены(Учредитель) Экспорт
	
	Если Не ЗначениеЗаполнено(Учредитель) Тогда
		Возврат Ложь;
	КонецЕсли;
	
	Если ТипЗнч(Учредитель) = Тип("СправочникСсылка.Контрагенты") Тогда
		Возврат РеквизитыУчредителяКонтрагентаЗаполнены(Учредитель);
	ИначеЕсли ТипЗнч(Учредитель) = Тип("СправочникСсылка.ФизическиеЛица") Тогда
		Возврат РеквизитыУчредителяФизическогоЛицаЗаполнены(Учредитель);
	КонецЕсли;
	
	Возврат Истина;
	
КонецФункции

// Функция проверки реквизитов юридического лица
//
// Параметры:
//   Учредитель - СправочникСсылка.Контрагенты
//
// Возвращаемое значение:
//   Булево - Истина, если все необходимые реквизиты заполнены
//
Функция РеквизитыУчредителяКонтрагентаЗаполнены(Учредитель)
	
	ПроверяемыеРеквизиты = "НаименованиеПолное, ИНН, КПП, РегистрационныйНомер, ДатаРегистрации";
	ПроверяемаяКонтактнаяИнформация = "ЮрАдресКонтрагента";
	
	Возврат ПроверитьРеквизитыУчредителя(Учредитель, ПроверяемыеРеквизиты, ПроверяемаяКонтактнаяИнформация);
	
КонецФункции

// Функция проверки реквизитов физического лица
//
// Параметры:
//   Учредитель - СправочникСсылка.ФизическиеЛица
//
// Возвращаемое значение:
//   Булево - Истина, если все необходимые реквизиты заполнены
//
Функция РеквизитыУчредителяФизическогоЛицаЗаполнены(Учредитель)
	
	ПроверяемыеРеквизиты = "Фамилия, Имя, Пол, ДатаРождения";
	ПроверяемаяКонтактнаяИнформация = "АдресПоПропискеФизическиеЛица, ТелефонРабочийФизическиеЛица";
	ПроверяемыеПаспортныеДанные = "Серия, Номер, ДатаВыдачи, КемВыдан, КодПодразделения";
	
	Возврат ПроверитьРеквизитыУчредителя(Учредитель, ПроверяемыеРеквизиты, ПроверяемаяКонтактнаяИнформация, ПроверяемыеПаспортныеДанные);
	
КонецФункции

// Функция проверки заполнения реквизитов учредителя
//
// Параметры:
//   Учредитель - СправочникСсылка.ФизическиеЛица, СправочникСсылка.Контрагенты
//   ПроверяемыеРеквизиты - Строка - имена проверяемых реквизитов объекта разделенные запятыми
//   ПроверяемаяКонтактнаяИнформация - Строка - имена проверяемых видов контактной информации разделенные запятыми
//   ПроверяемыеПаспортныеДанные - Строка - имена проверяемых реквизитов регистра ДокументыФизическихЛиц разделенные запятыми
//
// Возвращаемое значение:
//   Булево - Истина, если все необходимые реквизиты заполнены
//
Функция ПроверитьРеквизитыУчредителя(Учредитель, ПроверяемыеРеквизиты, ПроверяемаяКонтактнаяИнформация = "", ПроверяемыеПаспортныеДанные = "")
	
	ПроверяемыеРеквизиты = СтрЗаменить(ПроверяемыеРеквизиты, " ", "");
	ПроверяемаяКонтактнаяИнформация = СтрЗаменить(ПроверяемаяКонтактнаяИнформация, " ", "");
	ПроверяемыеПаспортныеДанные = СтрЗаменить(ПроверяемыеПаспортныеДанные, " ", "");
	
	// Проверка заполнения значений реквизитов
	ЗначенияРеквизитов = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(Учредитель, ПроверяемыеРеквизиты);
	Для Каждого КлючИЗначение Из ЗначенияРеквизитов Цикл
		ЗначениеРеквизита = КлючИЗначение.Значение;
		Если Не ЗначениеЗаполнено(ЗначениеРеквизита) Тогда
			Возврат Ложь;
		КонецЕсли;
	КонецЦикла;
	
	// Проверка заполнения контактной информации
	Для Каждого ВидКонтактнойИнформации Из СтрРазделить(ПроверяемаяКонтактнаяИнформация, ",") Цикл
		ЗначениеКонтактнойИнформации = УправлениеКонтактнойИнформацией.КонтактнаяИнформацияОбъекта(
			Учредитель,
			Справочники.ВидыКонтактнойИнформации[ВидКонтактнойИнформации], , Истина);
		Если Не ЗначениеЗаполнено(ЗначениеКонтактнойИнформации) Тогда
			Возврат Ложь;
		КонецЕсли;
	КонецЦикла;
	
	// Проверка заполнения связанных регистров сведений
	Если ТипЗнч(Учредитель) = Тип("СправочникСсылка.ФизическиеЛица") Тогда
		
		ПаспортФизическогоЛица = Новый Структура;
		ПаспортФизическогоЛица.Вставить("Физлицо", Учредитель);
		ПаспортФизическогоЛица.Вставить("ВидДокумента", Справочники.ВидыДокументовФизическихЛиц.ПаспортРФ);
		
		ПаспортныеДанные = РегистрыСведений.ДокументыФизическихЛиц.СрезПоследних(, ПаспортФизическогоЛица);
		Для Каждого РеквизитПаспорта Из СтрРазделить(ПроверяемыеПаспортныеДанные, ",") Цикл
			Если ПаспортныеДанные.Количество() <> 0 Тогда
				ЗначениеРеквизита = ПаспортныеДанные[0][РеквизитПаспорта];
			Иначе
				ЗначениеРеквизита = Неопределено;
			КонецЕсли;
			Если Не ЗначениеЗаполнено(ЗначениеРеквизита) Тогда
				Возврат Ложь;
			КонецЕсли;
		КонецЦикла;
		
	КонецЕсли;
	
	Возврат Истина;
	
КонецФункции

#КонецОбласти

#Область ЗаполнениеДокументовДляВнесенияИзмененийЕГРЮЛиЕГРИП

Процедура СоздатьЗаявлениеОВнесенииИзмененийЕГР(Параметры, АдресРезультата = Неопределено) Экспорт
	
	Результат = Новый Структура();
	
	ДанныеПомощникаЗаполнения = Параметры.ДанныеПомощникаЗаполнения;
	ДанныеОрганизации = ДанныеПомощникаЗаполнения.ДанныеОрганизации;
	
	// Если заявление создается при начале работы, нужно записать новую организацию
	Если ПолучитьФункциональнуюОпцию("НачалоРаботы") Тогда
		
		НачатьТранзакцию();
		
		Попытка
			
			// Организация
			ОбщегоНазначенияКлиентСервер.ДополнитьСтруктуру(Результат,
				ЗаписатьОрганизацию(ДанныеОрганизации));
			
			// Учетная политика
			ДанныеУчетнойПолитики = УчетнаяПолитикаПоУмолчанию(ДанныеОрганизации.ЮридическоеФизическоеЛицо);
			ДанныеУчетнойПолитики.Вставить("Организация", Результат.Организация);
			НастройкиУчета.ОчисткаНастроекУчетнойПолитики(Результат.Организация);
			НастройкиУчета.УстановкаПараметровУчетнойПолитикиПоУмолчанию(ДанныеУчетнойПолитики, Истина);
			
			ЗафиксироватьТранзакцию();
			
		Исключение
			ОтменитьТранзакцию();
			ЗаписьЖурналаРегистрации(СобытиеЖурналаРегистрации(),
				УровеньЖурналаРегистрации.Ошибка, Метаданные.Справочники.Организации,,
				ПодробноеПредставлениеОшибки(ИнформацияОбОшибке()));
			ВызватьИсключение;
		КонецПопытки;
		
		Организация = Результат.Организация;
	Иначе
		Организация = ДанныеОрганизации.Ссылка;
	КонецЕсли;
	
	Попытка
		
		Если ДанныеОрганизации.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо Тогда
			// Учредители
			ОбщегоНазначенияКлиентСервер.ДополнитьСтруктуру(Результат,
				ЗаписатьУчредителей(ДанныеОрганизации.Учредители));
		КонецЕсли;
		
		// Регистрирующий орган
		ОбщегоНазначенияКлиентСервер.ДополнитьСтруктуру(Результат,
			ОпределитьРегистрирующийОрган(ДанныеПомощникаЗаполнения));
		
		// Заявление о регистрации изменений
		ОбщегоНазначенияКлиентСервер.ДополнитьСтруктуру(Результат,
			СоздатьЗаявлениеРегистрацииИзменений(Организация, Параметры));
		
		ЗаписатьСтатусЗаявленияОВнесенииИзмененийЕГР(Результат,
			ИнтерфейсыВзаимодействияБРОКлиентСервер.СтатусВРаботеСтрокой());
		
	Исключение
		ЗаписьЖурналаРегистрации(СобытиеЖурналаРегистрации(),
			УровеньЖурналаРегистрации.Ошибка, Метаданные.Справочники.Организации,,
			ПодробноеПредставлениеОшибки(ИнформацияОбОшибке()));
		ВызватьИсключение;
	КонецПопытки;
	
	ПоместитьВоВременноеХранилище(Результат, АдресРезультата);
	
КонецПроцедуры

Процедура ЗаполнитьЗаявлениеОВнесенииИзмененийЕГР(Параметры, АдресРезультата = Неопределено) Экспорт
	
	Результат = Новый Структура;
	
	// Флаг модифицированности данных заявления - т.к. заявление уже создано, проверяем изменены ли данные,
	// на основании которых заполнено заявление
	Модифицированность = Параметры.Модифицированность;
	
	ДанныеПомощникаЗаполнения = Параметры.ДанныеПомощникаЗаполнения;
	Изменено = ДанныеПомощникаЗаполнения.Изменено;
	ДанныеЗаявителя = ДанныеПомощникаЗаполнения.ДанныеЗаявителя;
	ДанныеОрганизации = ДанныеПомощникаЗаполнения.ДанныеОрганизации;
	
	ЭтоЮрЛицо = (ДанныеОрганизации.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо);
	
	ДанныеПротоколаРешения = Новый Структура("Номер, Дата", "___", ДанныеПомощникаЗаполнения.ДатаРешения);
	
	ИменаФайлов = ИменаФайлов();
	
	ВладелецФайлов = ?(ДанныеПомощникаЗаполнения.ИзмененияВносятсяВУчредительныеДокументы,
		Параметры.ЗаявлениеОВнесенииИзмененийУчредительныеДокументы,
		Параметры.ЗаявлениеОВнесенииИзмененийЕГР);
	
	СтатусЗаявления = ?(Параметры.ЗаявлениеВРаботе,
		ИнтерфейсыВзаимодействияБРОКлиентСервер.СтатусВРаботеСтрокой(),
		ИнтерфейсыВзаимодействияБРОКлиентСервер.СтатусПодготовленоСтрокой());
	
	ПакетДокументов = Новый Массив;
	
	Попытка
		
		Если Модифицированность Тогда
			// Заявитель
			ОбщегоНазначенияКлиентСервер.ДополнитьСтруктуру(Результат,
				ЗаписатьЗаявителя(ДанныеЗаявителя));
			// Заявление о регистрации изменений
			ОбщегоНазначенияКлиентСервер.ДополнитьСтруктуру(Результат,
				СоздатьЗаявлениеРегистрацииИзменений(ДанныеОрганизации.Ссылка, Параметры));
			ВладелецФайлов = ?(ДанныеПомощникаЗаполнения.ИзмененияВносятсяВУчредительныеДокументы,
				Результат.ЗаявлениеОВнесенииИзмененийУчредительныеДокументы,
				Результат.ЗаявлениеОВнесенииИзмененийЕГР);
				
			ЗаписатьСтатусЗаявленияОВнесенииИзмененийЕГР(Результат,
				СтатусЗаявления);
		Иначе
			ЗаписатьСтатусЗаявленияОВнесенииИзмененийЕГР(Параметры,
				СтатусЗаявления);
		КонецЕсли;
		
		// Регистрирующий орган
		ОбщегоНазначенияКлиентСервер.ДополнитьСтруктуру(Результат,
			ОпределитьРегистрирующийОрган(ДанныеПомощникаЗаполнения));
			
		Если ЭтоЮрЛицо Тогда
			
			Если Модифицированность Тогда
				// Протокол собрания или решение единственного учредителя
				УчредителиПоТипам = УчредителиПоТипам(ДанныеОрганизации.Учредители);
				КоличествоЮридическихЛиц = УчредителиПоТипам.ЮридическиеЛица.Количество();
				КоличествоФизическихЛиц  = УчредителиПоТипам.ФизическиеЛица.Количество();
				ЕдинственныйУчредительЮридическоеЛицо = (КоличествоЮридическихЛиц = 1) И (КоличествоФизическихЛиц = 0);
				ЕдинственныйУчредительФизическоеЛицо = (КоличествоЮридическихЛиц = 0) И (КоличествоФизическихЛиц = 1);
				НесколькоУчредителей = (Не ЕдинственныйУчредительЮридическоеЛицо И Не ЕдинственныйУчредительФизическоеЛицо);
				
				Если ЕдинственныйУчредительФизическоеЛицо Тогда
					ИмяМакетаПротоколаРешения = "РешениеЕдинственногоУчредителяДляИзмененияРеквизитов";
					ИмяФайлаПротоколаРешения = ИменаФайлов.РешениеЕдинственногоУчредителя;
				ИначеЕсли НесколькоУчредителей Тогда
					ИмяМакетаПротоколаРешения = "ПротоколСобранияУчредителейДляИзмененияРеквизитов";
					ИмяФайлаПротоколаРешения = ИменаФайлов.ПротоколСобранияУчредителей;
				ИначеЕсли ЕдинственныйУчредительЮридическоеЛицо Тогда
					ИмяМакетаПротоколаРешения = "ПротоколСобранияУчредителейЕдинственногоУчредителяДляИзмененияРеквизитов";
					ИмяФайлаПротоколаРешения = ИменаФайлов.ПротоколСобранияУчредителейЕдинственногоУчредителя;
				КонецЕсли;
				
				Если ИмяМакетаПротоколаРешения <> Неопределено Тогда
					ПротоколРешениеУчредителейООО = ПротоколРешениеУчредителейОООДляИзмененияРеквизитов(ДанныеПомощникаЗаполнения, ИмяМакетаПротоколаРешения);
				КонецЕсли;
				Если ПротоколРешениеУчредителейООО <> Неопределено Тогда
					ПакетДокументов.Добавить(НовыйДокумент(ВладелецФайлов, ИмяФайлаПротоколаРешения, ПротоколРешениеУчредителейООО));
				КонецЕсли;
				
			КонецЕсли;
			
			Если ДанныеПомощникаЗаполнения.ИзмененияВносятсяВУчредительныеДокументы Тогда
				
				Если Модифицированность Тогда
					// Устав
					УставООО = УставОООНоваяРедакция(ДанныеПомощникаЗаполнения, ДанныеПротоколаРешения);
					Если УставООО <> Неопределено Тогда
						ПакетДокументов.Добавить(НовыйДокумент(ВладелецФайлов, ИменаФайлов.Устав, УставООО));
					КонецЕсли;
				КонецЕсли;
				
				АдресРегистрации = ?(Изменено.Местоположение,
					ДанныеПомощникаЗаполнения.ЮридическийАдресНовыйЗначениеJSON,
					ДанныеОрганизации.ЮридическийАдресЗначениеJSON);
				
				СуммаПошлины = СуммаПошлиныЗаВнесениеИзмененийВУчредительныеДокументы();
				
				Если Модифицированность И СервисКвитанцияНаОплатуГоспошлиныДоступен() Тогда
					// Квитанция на оплату госпошлины из веб-сервиса.
					КвитанцияНаОплатуГоспошлины = ДанныеСервисаРегистрации.КвитанцияНаОплатуГоспошлины(
						"ИзмененияВУставеЮрлица",
						ДанныеЗаявителя,
						АдресРегистрации,
						КБКНалогаПоСпособуПодачиДокументов(ДанныеПомощникаЗаполнения.СпособПодачиДокументов),
						СуммаПошлины);
					Если КвитанцияНаОплатуГоспошлины <> Неопределено Тогда
						ПакетДокументов.Добавить(НовыйДокумент(
							ВладелецФайлов,
							ИменаФайлов.КвитанцияНаОплатуГоспошлины,
							КвитанцияНаОплатуГоспошлины,
							"pdf"));
					КонецЕсли;
				КонецЕсли;
				
				Если СервисКвитанцияНаОплатуГоспошлиныДоступен() Тогда
					// Реквизиты платежа на оплату госпошлины из веб-сервиса.
					ПлатежныеРеквизитыОплатаГоспошлины = ДанныеСервисаРегистрации.ПлатежныеРеквизитыОплатаГоспошлины(
						ДанныеЗаявителя,
						АдресРегистрации,
						КБКНалогаПоСпособуПодачиДокументов(ДанныеПомощникаЗаполнения.СпособПодачиДокументов),
						СуммаПошлины);
					Если ПлатежныеРеквизитыОплатаГоспошлины <> Неопределено Тогда
						Результат.Вставить("ПлатежныеРеквизитыОплатаГоспошлины", ПлатежныеРеквизитыОплатаГоспошлины);
					КонецЕсли;
				КонецЕсли;
				
			Иначе
				ПлатежныеРеквизитыОплатаГоспошлины = Неопределено;
			КонецЕсли;
			
			Если Модифицированность Тогда
				// Инструкция
				РеквизитыПрежнегоРегистрирующегоОргана = Неопределено;
				Результат.Свойство("РеквизитыПрежнегоРегистрирующегоОргана", РеквизитыПрежнегоРегистрирующегоОргана);
				
				Инструкция = ИнструкцияРегистрацияИзмененийЕГРЮЛ(
					ДанныеПомощникаЗаполнения,
					Результат.РеквизитыРегистрирующегоОргана,
					РеквизитыПрежнегоРегистрирующегоОргана,
					ПлатежныеРеквизитыОплатаГоспошлины);
				Если Инструкция <> Неопределено Тогда
					ПакетДокументов.Добавить(НовыйДокумент(ВладелецФайлов, ИменаФайлов.ИнструкцияПоВнесениюИзмененийВЕГРЮЛ, Инструкция, "pdf"));
				КонецЕсли;
			КонецЕсли;
			
		Иначе
			
			Если Модифицированность Тогда
				
				// Контактная информация ИП хранится в справочнике "Организации" и задается на втором этапе.
				ОбщегоНазначенияКлиентСервер.ДополнитьСтруктуру(Результат,
					ЗаписатьКонтактнуюИнформациюИндивидуальногоПредпринимателя(ДанныеОрганизации));
				
				Инструкция = ИнструкцияРегистрацияИзмененийЕГРИП(ДанныеПомощникаЗаполнения, Результат.РеквизитыРегистрирующегоОргана);
				Если Инструкция <> Неопределено Тогда
					ПакетДокументов.Добавить(НовыйДокумент(ВладелецФайлов, ИменаФайлов.ИнструкцияПоВнесениюИзмененийВЕГРИП, Инструкция, "pdf"));
				КонецЕсли;
				
			КонецЕсли;
			
		КонецЕсли;
		
		НайденныеПрисоединенныеФайлы = ПрисоединенныеФайлыЗаявленияПоИмени(ВладелецФайлов, ИменаФайлов());
		Для Каждого Документ Из ПакетДокументов Цикл
			ПараметрыФайла = Документ.ПараметрыФайла;
			СуществующийФайл = НайденныеПрисоединенныеФайлы.Найти(ПараметрыФайла.ИмяБезРасширения, "Наименование");
			Если СуществующийФайл = Неопределено Тогда
				РаботаСФайлами.ДобавитьФайл(ПараметрыФайла, Документ.АдресФайла);
			Иначе
				ПараметрыФайла.Вставить("АдресФайлаВоВременномХранилище", Документ.АдресФайла);
				ПараметрыФайла.Вставить("АдресВременногоХранилищаТекста", Неопределено);
				РаботаСФайлами.ОбновитьФайл(СуществующийФайл.Ссылка, ПараметрыФайла);
			КонецЕсли;
		КонецЦикла;
		
	Исключение
		
		ЗаписьЖурналаРегистрации(СобытиеЖурналаРегистрации(),
			УровеньЖурналаРегистрации.Ошибка, Метаданные.Справочники.Организации,,
			ПодробноеПредставлениеОшибки(ИнформацияОбОшибке()));
		ВызватьИсключение;
		
	КонецПопытки;
	
	ПоместитьВоВременноеХранилище(Результат, АдресРезультата);
	
КонецПроцедуры

Процедура ЗаписатьСтатусЗаявленияОВнесенииИзмененийЕГР(Параметры, СтатусЗаявления)
	
	Перем ЗаявлениеОВнесенииИзменений, ЗаявлениеОВнесенииИзмененийУчредительныеДокументы;
	
	Если Параметры.Свойство("ЗаявлениеОВнесенииИзмененийЕГР", ЗаявлениеОВнесенииИзменений)
		И ЗначениеЗаполнено(ЗаявлениеОВнесенииИзменений) Тогда
		
		ИнтерфейсыВзаимодействияБРО.СохранитьСтатусОтправкиУведомления(ЗаявлениеОВнесенииИзменений, СтатусЗаявления);
	КонецЕсли;
	
	Если Параметры.Свойство("ЗаявлениеОВнесенииИзмененийУчредительныеДокументы", ЗаявлениеОВнесенииИзмененийУчредительныеДокументы)
		И ЗначениеЗаполнено(ЗаявлениеОВнесенииИзмененийУчредительныеДокументы) Тогда
		
		ИнтерфейсыВзаимодействияБРО.СохранитьСтатусОтправкиУведомления(
			ЗаявлениеОВнесенииИзмененийУчредительныеДокументы, СтатусЗаявления);
	КонецЕсли;
	
КонецПроцедуры

Функция НовыйДокумент(Владелец, ИмяДокумента, АдресФайла, РасширениеБезТочки = "rtf")
	
	ПараметрыФайла = Новый Структура;
	ПараметрыФайла.Вставить("Автор", Пользователи.ТекущийПользователь());
	ПараметрыФайла.Вставить("ВладелецФайлов", Владелец);
	ПараметрыФайла.Вставить("ИмяБезРасширения", ИмяДокумента);
	ПараметрыФайла.Вставить("РасширениеБезТочки", РасширениеБезТочки);
	ПараметрыФайла.Вставить("ВремяИзмененияУниверсальное", Неопределено);
	
	НовыйДокумент = Новый Структура;
	НовыйДокумент.Вставить("ПараметрыФайла", ПараметрыФайла);
	НовыйДокумент.Вставить("АдресФайла",     АдресФайла);
	
	Возврат НовыйДокумент;
	
КонецФункции

Функция ЗаписатьОрганизацию(ДанныеОрганизации)
	
	Если ДанныеОрганизации.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо Тогда
		Возврат ЗаписатьЮридическоеЛицо(ДанныеОрганизации);
	Иначе
		Возврат ЗаписатьИндивидуальногоПредпринимателя(ДанныеОрганизации);
	КонецЕсли;
	
КонецФункции

Функция ЗаписатьЮридическоеЛицо(ДанныеОрганизации)
	
	Если ЗначениеЗаполнено(ДанныеОрганизации.Ссылка) Тогда
		ОрганизацияОбъект = ДанныеОрганизации.Ссылка.ПолучитьОбъект();
	Иначе
		СуществующаяОрганизация = Справочники.Организации.НайтиОрганизацию(ДанныеОрганизации.ИНН);
		Если ЗначениеЗаполнено(СуществующаяОрганизация) Тогда
			ОрганизацияОбъект = СуществующаяОрганизация.ПолучитьОбъект();
		Иначе
			ОрганизацияОбъект = Справочники.Организации.СоздатьЭлемент();
			ОрганизацияОбъект.Заполнить(Неопределено);
		КонецЕсли;
	КонецЕсли;
	
	ЗаполнитьЗначенияСвойств(ОрганизацияОбъект, ДанныеОрганизации, , "Ссылка");
	
	ОрганизацияОбъект.КодНалоговогоОргана = ДанныеОрганизации.ДанныеРегистрацииВНалоговомОргане.КодНалоговогоОргана;
	
	Если ЗначениеЗаполнено(ОрганизацияОбъект.КодНалоговогоОргана) Тогда
		Если ЗначениеЗаполнено(ОрганизацияОбъект.Ссылка) Тогда
			СуществующаяРегистрация = Справочники.РегистрацииВНалоговомОргане.РегистрацияВНалоговомОргане(
				ОрганизацияОбъект.Ссылка, 
				ОрганизацияОбъект.КПП,
				ОрганизацияОбъект.КодНалоговогоОргана);
		КонецЕсли;
		Если ЗначениеЗаполнено(СуществующаяРегистрация) Тогда
			ОрганизацияОбъект.РегистрацияВНалоговомОргане = СуществующаяРегистрация;
		Иначе
			ОрганизацияОбъект.РегистрацияВНалоговомОргане = Справочники.РегистрацииВНалоговомОргане.ПолучитьСсылку(Новый УникальныйИдентификатор);
		КонецЕсли;
	КонецЕсли;
	
	ЗаписатьАдресОрганизации(ОрганизацияОбъект, ДанныеОрганизации.ЮридическийАдресЗначениеJSON);
	
	ОрганизацияОбъект.ДополнительныеСвойства.Вставить("ОрганизацияЗарегистрирована", Ложь); // Не выполнять обработчики при записи
	ОрганизацияОбъект.Записать();
	
	ЗаписатьРегистрациюВНалоговомОргане(ОрганизацияОбъект.Ссылка, ОрганизацияОбъект.КПП, ДанныеОрганизации.ДанныеРегистрацииВНалоговомОргане);
	
	Результат = Новый Структура("Организация", ОрганизацияОбъект.Ссылка);
	
	ЗаписатьРуководителя(Результат, ДанныеОрганизации.ДанныеРуководителя, ДанныеОрганизации.ДанныеОДолжностиРуководителя);
	
	Возврат Результат;
	
КонецФункции

Функция НовыеДанныеЮридическогоЛица() Экспорт
	
	ДанныеОрганизации = Новый Структура();
	
	ДанныеОрганизации.Вставить("Ссылка", Справочники.Организации.ПустаяСсылка());
	ДанныеОрганизации.Вставить("ЮридическоеФизическоеЛицо", Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо);
	ДанныеОрганизации.Вставить("Наименование", "");
	ДанныеОрганизации.Вставить("ИНН", "");
	ДанныеОрганизации.Вставить("КПП", "");
	ДанныеОрганизации.Вставить("ОГРН", "");
	ДанныеОрганизации.Вставить("ДатаРегистрации", Дата(1, 1, 1));
	ДанныеОрганизации.Вставить("НаименованиеСокращенное", "");
	ДанныеОрганизации.Вставить("НаименованиеПолное", "");
	
	ДанныеОрганизации.Вставить("ЮридическийАдрес", "");
	ДанныеОрганизации.Вставить("ЮридическийАдресЗначениеJSON", "");
	
	ДанныеОрганизации.Вставить("КодНалоговогоОргана", "");
	
	ДанныеОрганизации.Вставить("РегистрационныйНомерПФР", "");
	ДанныеОрганизации.Вставить("КодОрганаПФР", "");
	ДанныеОрганизации.Вставить("НаименованиеТерриториальногоОрганаПФР","");
	
	ДанныеОрганизации.Вставить("РегистрационныйНомерФСС", "");
	ДанныеОрганизации.Вставить("КодПодчиненностиФСС", "");
	ДанныеОрганизации.Вставить("НаименованиеТерриториальногоОрганаФСС", "");
	
	ДанныеОрганизации.Вставить("КодОКВЭД2", "");
	ДанныеОрганизации.Вставить("НаименованиеОКВЭД2", "");
	ДанныеОрганизации.Вставить("ДополнительныеКодыОКВЭД2", "");
	
	ДанныеОрганизации.Вставить("ДанныеРегистрацииВНалоговомОргане", НовыеДанныеРегистрацииВНалоговомОргане());
	
	ДанныеОрганизации.Вставить("ДанныеРуководителя", НовыеДанныеФизическогоЛица());
	ДанныеОрганизации.Вставить("ДанныеОДолжностиРуководителя", НовыеДанныеДолжности());
	ДанныеОрганизации.Вставить("УставныйКапитал", 0);
	ДанныеОрганизации.Вставить("Учредители", НоваяТаблицаУчредителей());
	
	Возврат ДанныеОрганизации;
	
КонецФункции

Функция НоваяТаблицаУчредителей() Экспорт
	
	ТипыУчредителей = Новый Массив;
	ТипыУчредителей.Добавить(Тип("СправочникСсылка.ФизическиеЛица"));
	ТипыУчредителей.Добавить(Тип("СправочникСсылка.Контрагенты"));
	
	ТаблицаУчредителей = Новый ТаблицаЗначений;
	ТаблицаУчредителей.Колонки.Добавить("Ссылка", Новый ОписаниеТипов(ТипыУчредителей));
	ТаблицаУчредителей.Колонки.Добавить("Наименование", ОбщегоНазначения.ОписаниеТипаСтрока(255));
	ТаблицаУчредителей.Колонки.Добавить("ИНН", ОбщегоНазначения.ОписаниеТипаСтрока(12));
	ТаблицаУчредителей.Колонки.Добавить("ДоляУчастия", ОбщегоНазначения.ОписаниеТипаЧисло(10, 6));
	ТаблицаУчредителей.Колонки.Добавить("СуммаВзноса", ОбщегоНазначения.ОписаниеТипаЧисло(15, 2));
	ТаблицаУчредителей.Колонки.Добавить("ТипУчредителя", Новый ОписаниеТипов("ПеречислениеСсылка.ЮридическоеФизическоеЛицо"));
	ТаблицаУчредителей.Колонки.Добавить("ПредставительУчредителя", Новый ОписаниеТипов("СправочникСсылка.ФизическиеЛица"));
	ТаблицаУчредителей.Колонки.Добавить("ДолжностьПредставителя", Новый ОписаниеТипов("СправочникСсылка.Должности"));
	ТаблицаУчредителей.Колонки.Добавить("ПредставительНаОсновании", ОбщегоНазначения.ОписаниеТипаСтрока(50));
	
	Возврат ТаблицаУчредителей;
	
КонецФункции

// Возвращает структуру таблиц по типам учредителей
//
// Параметры:
//  ТаблицаУчредителей - ТаблицаЗначений - см. НоваяТаблицаУчредителей()
//
// Возвращаемое значение:
//   Структура
//
Функция УчредителиПоТипам(ТаблицаУчредителей) Экспорт
	
	ОтборЮридическиеЛица = Новый Структура("ТипУчредителя", Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо);
	УчредителиЮридическиеЛица = ТаблицаУчредителей.Скопировать(ОтборЮридическиеЛица);
	
	ОтборФизическиеЛица = Новый Структура("ТипУчредителя", Перечисления.ЮридическоеФизическоеЛицо.ФизическоеЛицо);
	УчредителиФизическиеЛица = ТаблицаУчредителей.Скопировать(ОтборФизическиеЛица);
	
	Возврат Новый Структура("ЮридическиеЛица, ФизическиеЛица", УчредителиЮридическиеЛица, УчредителиФизическиеЛица);
	
КонецФункции

Функция ЗаписатьИндивидуальногоПредпринимателя(ДанныеОрганизации)
	
	Если ЗначениеЗаполнено(ДанныеОрганизации.Ссылка) Тогда
		ОрганизацияОбъект = ДанныеОрганизации.Ссылка.ПолучитьОбъект();
	Иначе
		СуществующаяОрганизация = Справочники.Организации.НайтиОрганизацию(ДанныеОрганизации.ИНН);
		Если ЗначениеЗаполнено(СуществующаяОрганизация) Тогда
			ОрганизацияОбъект = СуществующаяОрганизация.ПолучитьОбъект();
		Иначе
			ОрганизацияОбъект = Справочники.Организации.СоздатьЭлемент();
			ОрганизацияОбъект.Заполнить(Неопределено);
		КонецЕсли;
	КонецЕсли;
	
	ДанныеПредпринимателя = ДанныеОрганизации.ИндивидуальныйПредприниматель;
	Если Не ЗначениеЗаполнено(ДанныеПредпринимателя.Ссылка) Тогда
		Если ЗначениеЗаполнено(ОрганизацияОбъект.ИндивидуальныйПредприниматель) Тогда
			ДанныеПредпринимателя.Ссылка = ОрганизацияОбъект.ИндивидуальныйПредприниматель;
		Иначе
			СуществующееФизическоеЛицо = Справочники.Организации.ФизическоеЛицо(
				ДанныеПредпринимателя.Фамилия,
				ДанныеПредпринимателя.Имя,
				ДанныеПредпринимателя.Отчество,
				ДанныеПредпринимателя.ИНН);
			Если СуществующееФизическоеЛицо <> Неопределено Тогда
				ДанныеПредпринимателя.Ссылка = СуществующееФизическоеЛицо;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	
	ИндивидуальныйПредприниматель = ЗаписатьФизическоеЛицо(ДанныеПредпринимателя);
	
	ЗаполнитьЗначенияСвойств(ОрганизацияОбъект, ДанныеОрганизации, , "Ссылка");
	
	ОрганизацияОбъект.ИндивидуальныйПредприниматель = ИндивидуальныйПредприниматель;
	ОрганизацияОбъект.ФамилияИП  = ДанныеПредпринимателя.Фамилия;
	ОрганизацияОбъект.ИмяИП      = ДанныеПредпринимателя.Имя;
	ОрганизацияОбъект.ОтчествоИП = ДанныеПредпринимателя.Отчество;
	ОрганизацияОбъект.ИНН        = ДанныеПредпринимателя.ИНН;
	ОрганизацияОбъект.КПП        = "";
	
	ОрганизацияОбъект.НаименованиеСокращенное = ОрганизацииФормыКлиентСервер.СокращенноеНаименованиеИндивидульногоПредпринимателя(
								ОрганизацияОбъект.ФамилияИП, ОрганизацияОбъект.ИмяИП, ОрганизацияОбъект.ОтчествоИП);
	ОрганизацияОбъект.НаименованиеПолное = ОрганизацииФормыКлиентСервер.ПолноеНаименованиеИндивидульногоПредпринимателя(
								ОрганизацияОбъект.ФамилияИП, ОрганизацияОбъект.ИмяИП, ОрганизацияОбъект.ОтчествоИП);
	ОрганизацияОбъект.Наименование = ОрганизацииФормыКлиентСервер.НаименованиеПоСокращенномуНаименованию(
										ОрганизацияОбъект.НаименованиеСокращенное);
	
	ОрганизацияОбъект.КодНалоговогоОргана = ДанныеОрганизации.ДанныеРегистрацииВНалоговомОргане.КодНалоговогоОргана;
	
	Если ЗначениеЗаполнено(ОрганизацияОбъект.КодНалоговогоОргана) Тогда
		
		СуществующаяРегистрация = Справочники.РегистрацииВНалоговомОргане.ПустаяСсылка();
		Если ЗначениеЗаполнено(ОрганизацияОбъект.Ссылка) Тогда
			СуществующаяРегистрация = Справочники.РегистрацииВНалоговомОргане.РегистрацияВНалоговомОргане(
										ОрганизацияОбъект.Ссылка, 
										"",
										ОрганизацияОбъект.КодНалоговогоОргана);
		КонецЕсли;
		Если ЗначениеЗаполнено(СуществующаяРегистрация) Тогда
			ОрганизацияОбъект.РегистрацияВНалоговомОргане = СуществующаяРегистрация;
		Иначе
			ОрганизацияОбъект.РегистрацияВНалоговомОргане = Справочники.РегистрацииВНалоговомОргане.ПолучитьСсылку(Новый УникальныйИдентификатор);
		КонецЕсли;
		
	КонецЕсли;
	
	ЗаписатьАдресОрганизации(ОрганизацияОбъект, ДанныеПредпринимателя.АдресПропискиЗначениеJSON);
	
	Если ЗначениеЗаполнено(ДанныеПредпринимателя.ТелефонРабочийЗначениеJSON) Тогда
		УправлениеКонтактнойИнформацией.ДобавитьКонтактнуюИнформацию(ОрганизацияОбъект,
				ДанныеПредпринимателя.ТелефонРабочийЗначениеJSON, Справочники.ВидыКонтактнойИнформации.ТелефонОрганизации);
	КонецЕсли;
	
	Если ЗначениеЗаполнено(ДанныеПредпринимателя.EMailЗначениеJSON) Тогда
		УправлениеКонтактнойИнформацией.ДобавитьКонтактнуюИнформацию(ОрганизацияОбъект,
				ДанныеПредпринимателя.EMailЗначениеJSON, Справочники.ВидыКонтактнойИнформации.EmailОрганизации);
	КонецЕсли;
	
	ОрганизацияОбъект.ДополнительныеСвойства.Вставить("ОрганизацияЗарегистрирована", Ложь);
	ОрганизацияОбъект.Записать();
	
	ЗаписатьРегистрациюВНалоговомОргане(ОрганизацияОбъект.Ссылка, ОрганизацияОбъект.КПП, ДанныеОрганизации.ДанныеРегистрацииВНалоговомОргане);
	
	Возврат Новый Структура("Организация", ОрганизацияОбъект.Ссылка);
	
КонецФункции

Функция ЗаписатьКонтактнуюИнформациюИндивидуальногоПредпринимателя(ДанныеОрганизации)
	
	Если Не ЗначениеЗаполнено(ДанныеОрганизации.Ссылка) Тогда
		Возврат Новый Структура;
	КонецЕсли;
	
	ОрганизацияОбъект = ДанныеОрганизации.Ссылка.ПолучитьОбъект();
	ДанныеПредпринимателя = ДанныеОрганизации.ИндивидуальныйПредприниматель;
	
	ЗаписатьАдресОрганизации(ОрганизацияОбъект, ДанныеПредпринимателя.АдресПропискиЗначениеJSON);
	
	Если ЗначениеЗаполнено(ДанныеПредпринимателя.ТелефонРабочийЗначениеJSON) Тогда
		УправлениеКонтактнойИнформацией.ДобавитьКонтактнуюИнформацию(ОрганизацияОбъект,
				ДанныеПредпринимателя.ТелефонРабочийЗначениеJSON, Справочники.ВидыКонтактнойИнформации.ТелефонОрганизации);
	КонецЕсли;
	
	Если ЗначениеЗаполнено(ДанныеПредпринимателя.EMailЗначениеJSON) Тогда
		УправлениеКонтактнойИнформацией.ДобавитьКонтактнуюИнформацию(ОрганизацияОбъект,
				ДанныеПредпринимателя.EMailЗначениеJSON, Справочники.ВидыКонтактнойИнформации.EmailОрганизации);
	КонецЕсли;
	
	ОрганизацияОбъект.ДополнительныеСвойства.Вставить("ОрганизацияЗарегистрирована", Ложь);
	ОрганизацияОбъект.Записать();
	
	Возврат Новый Структура("Организация", ОрганизацияОбъект.Ссылка);
	
КонецФункции

Функция ЗаписатьЗаявителя(ДанныеЗаявителя) Экспорт
	
	Если Не ЗначениеЗаполнено(ДанныеЗаявителя.Ссылка) Тогда
		СуществующееФизическоеЛицо = Справочники.Организации.ФизическоеЛицо(
			ДанныеЗаявителя.Фамилия,
			ДанныеЗаявителя.Имя,
			ДанныеЗаявителя.Отчество,
			ДанныеЗаявителя.ИНН);
		Если СуществующееФизическоеЛицо <> Неопределено Тогда
			ДанныеЗаявителя.Ссылка = СуществующееФизическоеЛицо;
		КонецЕсли;
	КонецЕсли;
	
	Заявитель = ЗаписатьФизическоеЛицо(ДанныеЗаявителя);
	
	Возврат Новый Структура("Заявитель", Заявитель);
	
КонецФункции

Функция СоздатьЗаявлениеРегистрацииИзменений(Организация, ПараметрыФормированияДокументов)
	
	ЗаявлениеОВнесенииИзмененийЕГР = ПараметрыФормированияДокументов.ЗаявлениеОВнесенииИзмененийЕГР;
	ЗаявлениеОВнесенииИзмененийУчредительныеДокументы = ПараметрыФормированияДокументов.ЗаявлениеОВнесенииИзмененийУчредительныеДокументы;
	ДанныеПомощникаЗаполнения = ПараметрыФормированияДокументов.ДанныеПомощникаЗаполнения;
	
	// Создаем или перезаполняем заявления по данным помощника
	ШаблонИмениОтчета = "РегламентированноеУведомлениеФорма%1";
	ПараметрыЗаявления = ПараметрыЗаявленияОРегистрацииИзменений(Организация, ДанныеПомощникаЗаполнения);
	КодыФормЗаявлений = КодыФормЗаявлений();
	
	Если ДанныеПомощникаЗаполнения.ДанныеОрганизации.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо Тогда
		Если Не ДанныеПомощникаЗаполнения.ИзмененияВносятсяВУчредительныеДокументы
			Или ДанныеПомощникаЗаполнения.ИзмененияТребуютУведомления
			Или ДанныеПомощникаЗаполнения.Изменено.Руководитель Тогда
			ИмяОтчета = СтрШаблон(ШаблонИмениОтчета, КодыФормЗаявлений.ЗаявлениеРегистрацииИзмененийЕГРЮЛ);
			ЗаявлениеОВнесенииИзмененийЕГР = Отчеты[ИмяОтчета].СоздатьЗаполненноеУведомление(ПараметрыЗаявления, ЗаявлениеОВнесенииИзмененийЕГР);
		КонецЕсли;
		Если ДанныеПомощникаЗаполнения.ИзмененияВносятсяВУчредительныеДокументы Тогда
			ИмяОтчета = СтрШаблон(ШаблонИмениОтчета, КодыФормЗаявлений.ЗаявлениеРегистрацииИзмененийУчредительныхДокументов);
			ЗаявлениеОВнесенииИзмененийУчредительныеДокументы = Отчеты[ИмяОтчета].СоздатьЗаполненноеУведомление(
				ПараметрыЗаявления, ЗаявлениеОВнесенииИзмененийУчредительныеДокументы);
		КонецЕсли;
	Иначе
		ИмяОтчета = СтрШаблон(ШаблонИмениОтчета, КодыФормЗаявлений.ЗаявлениеРегистрацииИзмененийЕГРИП);
		ЗаявлениеОВнесенииИзмененийЕГР = Отчеты[ИмяОтчета].СоздатьЗаполненноеУведомление(ПараметрыЗаявления, ЗаявлениеОВнесенииИзмененийЕГР);
	КонецЕсли;
	
	// Сохраняем данные помощника в созданном заявлении
	Результат = Новый Структура;
	Если ЗначениеЗаполнено(ЗаявлениеОВнесенииИзмененийЕГР) Тогда
		СохранитьДанныеПомощникаЗаполнения(ЗаявлениеОВнесенииИзмененийЕГР, ДанныеПомощникаЗаполнения);
		Результат.Вставить("ЗаявлениеОВнесенииИзмененийЕГР", ЗаявлениеОВнесенииИзмененийЕГР);
	КонецЕсли;
	Если ЗначениеЗаполнено(ЗаявлениеОВнесенииИзмененийУчредительныеДокументы) Тогда
		СохранитьДанныеПомощникаЗаполнения(ЗаявлениеОВнесенииИзмененийУчредительныеДокументы, ДанныеПомощникаЗаполнения);
		Результат.Вставить("ЗаявлениеОВнесенииИзмененийУчредительныеДокументы", ЗаявлениеОВнесенииИзмененийУчредительныеДокументы);
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции

Процедура СохранитьДанныеПомощникаЗаполнения(ЭкземплярУведомления, ДанныеПомощникаЗаполнения)
	
	Если Не ЗначениеЗаполнено(ЭкземплярУведомления) Тогда
		Возврат;
	КонецЕсли;
	
	ВидУведомления = УведомлениеОСпецрежимахНалогообложенияВызовСервера.ВидУведомления(ЭкземплярУведомления);
	ИмяОтчета = Перечисления.ВидыУведомленийОСпецрежимахНалогообложения.ПолучитьИмяОтчетаПоВидуУведомления(ВидУведомления);
	
	Отчеты[ИмяОтчета].СохранитьДанныеПомощника(ЭкземплярУведомления, ДанныеПомощникаЗаполнения);
	
КонецПроцедуры

Функция ПараметрыЗаявленияОРегистрацииИзменений(Организация, Знач ПараметрыЗаполнения)
	
	ПараметрыЗаполнения.Вставить("Организация", Организация);
	
	ПараметрыЗаявления = Новый Структура;
	ПараметрыЗаявления.Вставить("Организация", Организация);
	ПараметрыЗаявления.Вставить("ДополнительныеПараметры", ПараметрыЗаполнения);
	
	Возврат ПараметрыЗаявления;
	
КонецФункции

Процедура ЗаполнитьЗаявлениеРегистрацииИзмененийУчредительныхДокументов(ПараметрыОтчета, Контейнер) Экспорт
	Перем ДанныеЗаявителя;
	
	ПараметрыЗаполнения = ПараметрыОтчета.ПараметрыЗаполнения;
	
	Изменено = ПараметрыЗаполнения.Изменено;
	ДанныеОрганизации = ПараметрыЗаполнения.ДанныеОрганизации;
	
	Если Изменено.УставныйКапитал Тогда
		Учредители = ДанныеУчредителейДляЗаявлениеОВнесенииИзмененийЕГР(ПараметрыЗаполнения);
	КонецЕсли;
	
	// Титульный лист
	Контейнер.Лист001.П01010000 = ДанныеОрганизации.ОГРН;
	Контейнер.Лист001.П01020000 = ДанныеОрганизации.ИНН;
	Контейнер.Лист001.П01030000 = ДанныеОрганизации.НаименованиеПолное;
	
	// Лист А "Сведения о наименовании юридического лица"
	// Заполняется в случае изменении полного или сокращенного наименования юридического лица.
	Если Изменено.СокращенноеНаименование Или Изменено.ПолноеНаименование Тогда
		Контейнер.ЛистА.А01000000 = ПараметрыЗаполнения.НаименованиеПолноеНовое;
		Контейнер.ЛистА.А02000000 = ПараметрыЗаполнения.НаименованиеСокращенноеНовое;
	КонецЕсли;
	
	// Лист Б "Сведения об адресе (месте нахождения) постоянно действующего исполнительного органа".
	// Заполняется в случае изменения юридического адреса.
	Если Изменено.Местоположение
		Или (Изменено.ЮридическийАдрес И ПараметрыЗаполнения.ИзмененияВносятсяВУчредительныеДокументы) Тогда
		
		ЮридическийАдресНовый = ПараметрыЗаполнения.ЮридическийАдресНовыйЗначениеJSON;
		СтруктураАдреса = УправлениеКонтактнойИнформациейБП.СтруктураАдреса(ЮридическийАдресНовый);
		ЗаполнитьЗначенияСвойств(Контейнер.ЛистБ, СтруктураАдреса);
		
	КонецЕсли;
	
	// Лист В "Сведения о размере уставного капитала"
	// Заполняется в случае изменения размера уставного капитала.
	// В случае заполнения листа В заявления заполняются также соответственно листы Г, Д, Е, Ж, З, И заявления.
	Если Изменено.УставныйКапитал Тогда
		Контейнер.ЛистВ.В01000000 = "1";
		// Вид изменения, Размер, Дата принятия решения об уменьшении уставного капитала
		Если ПараметрыЗаполнения.ДанныеОрганизации.УставныйКапитал < ПараметрыЗаполнения.УставныйКапиталНовый Тогда
			Контейнер.ЛистВ.В02000000 = "1"; // увеличение уставного капитала
			Контейнер.ЛистВ.В03000000 = ПараметрыЗаполнения.УставныйКапиталНовый;
			Контейнер.ЛистВ.В04000000 = "";
		ИначеЕсли ПараметрыЗаполнения.УставныйКапиталНовый < ПараметрыЗаполнения.ДанныеОрганизации.УставныйКапитал Тогда
			Контейнер.ЛистВ.В02000000 = "2"; // уменьшение уставного капитала
			Контейнер.ЛистВ.В03000000 = ПараметрыЗаполнения.УставныйКапиталНовый;
			Контейнер.ЛистВ.В04000000 = ""; // Заполняется вручную
		КонецЕсли;
		// Дата публикации сообщения о принятии решения об уменьшении уставного капитала в органе печати.
		Контейнер.ЛистВ.В05010000 = "";
		Контейнер.ЛистВ.В05020000 = "";
	КонецЕсли;
	
	// Лист Г "Сведения об участнике - российском юридическом лице"
	// Заполняется в случае изменения размера уставного капитала ООО.
	ШаблонЛистаГ = СкопироватьКлючиСтруктуры(Контейнер.ЛистГ[0].Значение);
	Контейнер.ЛистГ.Очистить();
	
	Если Изменено.УставныйКапитал Тогда
		
		УчастникиЮридическиеЛица = Учредители.Скопировать(Новый Структура("ЭтоЮридическоеЛицо", Истина));
		УчастникиЮридическиеЛица.Сортировать("НомерСтроки Возр");
		
		Для Каждого СтрокаТаблицы Из УчастникиЮридическиеЛица Цикл
			
			НовыйЛист = СкопироватьКлючиСтруктуры(ШаблонЛистаГ);
			СведенияОЮридическомЛице = СтрокаТаблицы.СведенияОЮридическомЛице;
			Если СтрокаТаблицы.СуммаВзносаДоИзменения = 0 Тогда
				// Причина внесения изменений
				НовыйЛист.Г01000000 = "1"; // внесение сведений о новом участнике
				// Сведения об участнике, содержащиеся в ЕГРЮЛ
				НовыйЛист.Г03010000 = СведенияОЮридическомЛице.ОГРН;
				НовыйЛист.Г03020000 = СведенияОЮридическомЛице.ИНН;
				НовыйЛист.Г03030000 = СведенияОЮридическомЛице.ПолноеНаименование;
				// Доля в уставном капитале
				НовыйЛист.Г04010000 = СтрокаТаблицы.СуммаВзноса;
				НовыйЛист.Г04020100 = СтрокаТаблицы.ДоляУставногоКапитала;
			ИначеЕсли СтрокаТаблицы.СуммаВзноса = 0 Тогда
				// Причина внесения изменений
				НовыйЛист.Г01000000 = "2"; // внесение сведений о прекращении участия
				// Сведения об участнике, содержащиеся в ЕГРЮЛ
				НовыйЛист.Г02010000 = СведенияОЮридическомЛице.ОГРН;
				НовыйЛист.Г02020000 = СведенияОЮридическомЛице.ИНН;
				НовыйЛист.Г02030000 = СведенияОЮридическомЛице.ПолноеНаименование;
			Иначе
				// Причина внесения изменений
				НовыйЛист.Г01000000 = "3"; // внесение изменений в сведения об участнике
				// Сведения об участнике, содержащиеся в ЕГРЮЛ
				НовыйЛист.Г02010000 = СведенияОЮридическомЛице.ОГРН;
				НовыйЛист.Г02020000 = СведенияОЮридическомЛице.ИНН;
				НовыйЛист.Г02030000 = СведенияОЮридическомЛице.ПолноеНаименование;
				// Доля в уставном капитале
				НовыйЛист.Г04010000 = СтрокаТаблицы.СуммаВзноса;
				НовыйЛист.Г04020100 = СтрокаТаблицы.ДоляУставногоКапитала;
			КонецЕсли;
			Контейнер.ЛистГ.Добавить(НовыйЛист);
			
		КонецЦикла;
		
	КонецЕсли;
	
	Если Контейнер.ЛистГ.Количество() = 0 Тогда
		Контейнер.ЛистГ.Добавить(ШаблонЛистаГ);
	КонецЕсли;
	
	// Лист Д "Сведения об участнике - иностранном юридическом лице"
	// Заполняется в случае изменения размера уставного капитала ООО.
	ШаблонЛистаД = СкопироватьКлючиСтруктуры(Контейнер.ЛистД[0].Значение);
	Контейнер.ЛистД.Очистить();
	Контейнер.ЛистД.Добавить(ШаблонЛистаД);
	
	// Лист Е "Сведения об участнике - физическом лице"
	// Заполняется в случае изменения размера уставного капитала ООО.
	ШаблонЛистаЕ = СкопироватьКлючиСтруктуры(Контейнер.ЛистЕ[0].Значение);
	Контейнер.ЛистЕ.Очистить();
	
	Если Изменено.УставныйКапитал Тогда
		
		УчастникиФизическиеЛица = Учредители.Скопировать(Новый Структура("ЭтоЮридическоеЛицо", Ложь));
		УчастникиФизическиеЛица.Сортировать("НомерСтроки Возр");
		
		Для Каждого СтрокаТаблицы Из УчастникиФизическиеЛица Цикл
			
			НовыйЛист = СкопироватьКлючиСтруктуры(ШаблонЛистаЕ);
			СведенияОФизическомЛице = СтрокаТаблицы.СведенияОФизическомЛице;
			Если СтрокаТаблицы.СуммаВзносаДоИзменения = 0 Тогда
				// Причина внесения изменений
				НовыйЛист.Е01000000 = "1"; // внесение сведений о новом участнике
				// Сведения об участнике, вносимые в ЕГРЮЛ
				// ФИО
				НовыйЛист.Е03010100 = СведенияОФизическомЛице.Фамилия;
				НовыйЛист.Е03010200 = СведенияОФизическомЛице.Имя;
				НовыйЛист.Е03010300 = СведенияОФизическомЛице.Отчество;
				// ИНН
				НовыйЛист.Е03020000 = СведенияОФизическомЛице.ИНН;
				// Дата и место рождения
				НовыйЛист.Е03030100 = СведенияОФизическомЛице.ДатаРождения;
				НовыйЛист.Е03030200 = СведенияОФизическомЛице.МестоРожденияПредставление;
				// Паспортные данные
				НовыйЛист.Е03050100 = СведенияОФизическомЛице.ДокументКодМВД;
				НовыйЛист.Е03050200 = "" + СведенияОФизическомЛице.ДокументСерия + " " + СведенияОФизическомЛице.ДокументНомер;
				НовыйЛист.Е03050300 = СведенияОФизическомЛице.ДокументДатаВыдачи;
				НовыйЛист.Е03050400 = СведенияОФизическомЛице.ДокументКемВыдан;
				ЧастиКодаПодразделения = СтрРазделить("" + СведенияОФизическомЛице.ДокументКодПодразделения, "-", Ложь);
				Если ЧастиКодаПодразделения.Количество() = 2 Тогда
					НовыйЛист.Е03050501 = ЧастиКодаПодразделения[0];
					НовыйЛист.Е03050502 = ЧастиКодаПодразделения[1];
				КонецЕсли;
				// Адрес
				ЗаполнитьЗначенияСвойств(НовыйЛист, СведенияОФизическомЛице.АдресСтруктурой);
				// Доля в уставном капитале
				НовыйЛист.Е04010000 = СтрокаТаблицы.СуммаВзноса;
				НовыйЛист.Е04020100 = СтрокаТаблицы.ДоляУставногоКапитала;
			ИначеЕсли СтрокаТаблицы.СуммаВзноса = 0 Тогда
				// Причина внесения изменений
				НовыйЛист.Е01000000 = "2"; // внесение сведений о прекращении участия
				// Сведения об участнике, содержащиеся в ЕГРЮЛ
				// ФИО
				НовыйЛист.Е02010100 = СведенияОФизическомЛице.Фамилия;
				НовыйЛист.Е02010200 = СведенияОФизическомЛице.Имя;
				НовыйЛист.Е02010300 = СведенияОФизическомЛице.Отчество;
				// ИНН
				НовыйЛист.Е02020000 = СведенияОФизическомЛице.ИНН;
			Иначе
				// Причина внесения изменений
				НовыйЛист.Е01000000 = "3"; // внесение изменений в сведения об участнике
				// Сведения об участнике, содержащиеся в ЕГРЮЛ
				// ФИО
				НовыйЛист.Е02010100 = СведенияОФизическомЛице.Фамилия;
				НовыйЛист.Е02010200 = СведенияОФизическомЛице.Имя;
				НовыйЛист.Е02010300 = СведенияОФизическомЛице.Отчество;
				// ИНН
				НовыйЛист.Е02020000 = СведенияОФизическомЛице.ИНН;
				// Доля в уставном капитале
				НовыйЛист.Е04010000 = СтрокаТаблицы.СуммаВзноса;
				НовыйЛист.Е04020100 = СтрокаТаблицы.ДоляУставногоКапитала;
			КонецЕсли;
			Контейнер.ЛистЕ.Добавить(НовыйЛист);
			
		КонецЦикла;
		
	КонецЕсли;
	
	Если Контейнер.ЛистЕ.Количество() = 0 Тогда
		Контейнер.ЛистЕ.Добавить(ШаблонЛистаЕ);
	КонецЕсли;
	
	// Лист Ж "Сведения об участнике - Российской Федерации, субъекте Российской Федерации, муниципальном образовании"
	ШаблонЛистаЖ = СкопироватьКлючиСтруктуры(Контейнер.ЛистЖ1[0].Значение);
	Контейнер.ЛистЖ1.Очистить();
	Контейнер.ЛистЖ1.Добавить(ШаблонЛистаЖ);
	
	// Лист З "Сведения о паевом инвестиционном фонде, в состав имущества которого включена доля в уставном капитале юридического лица"
	ШаблонЛистаЗ = СкопироватьКлючиСтруктуры(Контейнер.ЛистЗ[0].Значение);
	Контейнер.ЛистЗ.Очистить();
	Контейнер.ЛистЗ.Добавить(ШаблонЛистаЗ);
	
	// Лист И "Сведения о доле в уставном капитале общества с ограниченной ответственностью, принадлежащей обществу"
	// Заполняется в случае уменьшения уставного капитала общества с ограниченной ответственностью за счет погашения доли, принадлежащей обществу.
	ШаблонЛистаИ = СкопироватьКлючиСтруктуры(Контейнер.ЛистИ[0].Значение);
	Контейнер.ЛистИ.Очистить();
	Контейнер.ЛистИ.Добавить(ШаблонЛистаИ);
	
	// Лист К заявления "Сведения о филиале/представительстве" 
	// Заполняется в случае, если вносимые в учредительные документы юридического лица изменения связаны с изменением сведений
	//  о филиале и (или) представительстве юридического лица.
	ШаблонЛистаК = СкопироватьКлючиСтруктуры(Контейнер.ЛистК[0].Значение);
	Контейнер.ЛистК.Очистить();
	Контейнер.ЛистК.Добавить(ШаблонЛистаК);
	
	// Лист Л "Сведения о кодах по ОКВЭД"
	Если Изменено.ОсновнойВидДеятельности Тогда
		// Страница 1: Сведения о кодах ОКВЭД, подлежащие внесению в ЕГРЮЛ
		Контейнер.ЛистЛ1.А01010000 = ПараметрыЗаполнения.КодОКВЭД2Новый;
		// Страница 2: Сведения о кодах ОКВЭД, подлежащие исключению из ЕГРЮЛ
		Контейнер.ЛистЛ2.А01010000 = ДанныеОрганизации.КодОКВЭД2;
	КонецЕсли;
	Если Изменено.ВидыДеятельности Тогда
		ИзмененияВидовДеятельности = ИзмененияВидовДеятельности(ПараметрыЗаполнения);
		// Страница 1: Сведения о кодах ОКВЭД, подлежащие внесению в ЕГРЮЛ
		Контейнер.МногострочнаяЧасть1.Очистить();
		Для Каждого ДобавленныйКодОКВЭД Из ИзмененияВидовДеятельности.ДобавленныеКодыОКВЭД Цикл
			Контейнер.МногострочнаяЧасть1.Добавить().А01020000 = ДобавленныйКодОКВЭД;
		КонецЦикла;
		// Страница 2: Сведения о кодах ОКВЭД, подлежащие исключению из ЕГРЮЛ
		Контейнер.МногострочнаяЧасть2.Очистить();
		Для Каждого УдаленныйКодОКВЭД Из ИзмененияВидовДеятельности.УдаленныеКодыОКВЭД Цикл
			Контейнер.МногострочнаяЧасть2.Добавить().А01020000 = УдаленныйКодОКВЭД;
		КонецЦикла;
	КонецЕсли;
	
	// Лист М "Сведения о заявителе"
	Если ПараметрыЗаполнения.Свойство("ДанныеЗаявителя", ДанныеЗаявителя) Тогда
		// Вид заявителя
		Контейнер.ЛистМ.М01000000 = 1; // 1 - руководитель постоянно действующего исполнительного органа
		// ФИО
		Контейнер.ЛистМ.М03010100 = ДанныеЗаявителя.Фамилия;
		Контейнер.ЛистМ.М03010200 = ДанныеЗаявителя.Имя;
		Контейнер.ЛистМ.М03010300 = ДанныеЗаявителя.Отчество;
		// ИНН
		Контейнер.ЛистМ.М03020000 = ДанныеЗаявителя.ИНН;
		// Дата и место рождения
		Контейнер.ЛистМ.М03030100 = ДанныеЗаявителя.ДатаРождения;
		Контейнер.ЛистМ.М03030200 = ДанныеЗаявителя.МестоРожденияПредставление;
		// Паспортные данные
		Контейнер.ЛистМ.М03040100 = "21"; // Паспорт гражданина РФ
		Контейнер.ЛистМ.М03040200 = СтрШаблон("%1 %2", ДанныеЗаявителя.ПаспортныеДанные.Серия, ДанныеЗаявителя.ПаспортныеДанные.Номер);
		Контейнер.ЛистМ.М03040300 = ДанныеЗаявителя.ПаспортныеДанные.ДатаВыдачи;
		Контейнер.ЛистМ.М03040400 = ДанныеЗаявителя.ПаспортныеДанные.КемВыдан;
		ЧастиКодаПодразделения = СтрРазделить(ДанныеЗаявителя.ПаспортныеДанные.КодПодразделения, "-", Ложь);
		Если ЧастиКодаПодразделения.Количество() = 2 Тогда
			Контейнер.ЛистМ.М03040501 = ЧастиКодаПодразделения[0];
			Контейнер.ЛистМ.М03040502 = ЧастиКодаПодразделения[1];
		КонецЕсли;
		// Адрес
		ДополнительныеПараметрыКИ = Новый Структура("НаименованиеВключаетСокращение", Ложь);
		ЗаполнитьЗначенияСвойств(Контейнер.ЛистМ,
			УправлениеКонтактнойИнформациейБП.СтруктураАдреса(ДанныеЗаявителя.АдресПропискиЗначениеJSON, ДополнительныеПараметрыКИ));
		// Телефон
		Контейнер.ЛистМ.М03060100 = УправлениеКонтактнойИнформацией.ПредставлениеКонтактнойИнформации(ДанныеЗаявителя.ТелефонРабочийЗначениеJSON,
			Справочники.ВидыКонтактнойИнформации.ТелефонРабочийФизическиеЛица);
		// EMail
		Контейнер.ЛистМ.М03060200 = УправлениеКонтактнойИнформацией.ПредставлениеКонтактнойИнформации(ДанныеЗаявителя.EMailЗначениеJSON,
			Справочники.ВидыКонтактнойИнформации.EMailФизическиеЛица);
		// Получение документов
		Если ПараметрыЗаполнения.Свойство("СпособРегистрации") Тогда
			Контейнер.ЛистМ.М04000000 = ПараметрыЗаполнения.СпособРегистрации;
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

Процедура ЗаполнитьЗаявлениеРегистрацииИзмененийЕГРЮЛ(ПараметрыОтчета, Контейнер) Экспорт
	Перем ДанныеЗаявителя;
	
	ПараметрыЗаполнения = ПараметрыОтчета.ПараметрыЗаполнения;
	
	Изменено = ПараметрыЗаполнения.Изменено;
	ДанныеОрганизации = ПараметрыЗаполнения.ДанныеОрганизации;
	
	Если Изменено.Учредители И Не Изменено.УставныйКапитал Тогда
		Учредители = ДанныеУчредителейДляЗаявлениеОВнесенииИзмененийЕГР(ПараметрыЗаполнения);
	КонецЕсли;
	
	// Титульный лист
	Контейнер.Лист001.П01010000 = ДанныеОрганизации.ОГРН;
	Контейнер.Лист001.П01020000 = ДанныеОрганизации.ИНН;
	Контейнер.Лист001.П01030000 = ДанныеОрганизации.НаименованиеПолное;
	// Заявление представлено
	Контейнер.Лист001.П02000000 = "1"; // в связи с изменением сведений о юридическом лице
	
	// Лист А "Сведения о наименовании юридического лица"
	// Заполняется в случае исправления ошибки в наименовании или полном наименовании юридического лица,
	// допущенной заявителем в ранее представленном заявлении.
	ШаблонЛистаА = СкопироватьКлючиСтруктуры(Контейнер.ЛистА);
	ЗаполнитьЗначенияСвойств(Контейнер.ЛистА, ШаблонЛистаА);
	
	// Лист Б "Сведения об адресе (месте нахождения) постоянно действующего исполнительного органа"
	// Заполняется в случае изменения юридического адреса
	Если Изменено.ЮридическийАдрес Тогда
		ЮридическийАдресНовый = ПараметрыЗаполнения.ЮридическийАдресНовыйЗначениеJSON;
		СтруктураАдреса = УправлениеКонтактнойИнформациейБП.СтруктураАдреса(ЮридическийАдресНовый);
		ЗаполнитьЗначенияСвойств(Контейнер.ЛистБ, СтруктураАдреса);
	Иначе
		ШаблонЛистаБ = СкопироватьКлючиСтруктуры(Контейнер.ЛистБ);
		ЗаполнитьЗначенияСвойств(Контейнер.ЛистБ, ШаблонЛистаБ);
	КонецЕсли;
	
	// Лист В "Сведения об участнике - российском юридическом лице"
	// Заполняется при изменении состава участников общества
	ШаблонЛистаВ = СкопироватьКлючиСтруктуры(Контейнер.ЛистВ1[0].Значение);
	Контейнер.ЛистВ1.Очистить();
	
	Если Изменено.Учредители И Не Изменено.УставныйКапитал Тогда
		
		УчастникиЮридическиеЛица = Учредители.Скопировать(Новый Структура("ЭтоЮридическоеЛицо", Истина));
		УчастникиЮридическиеЛица.Сортировать("НомерСтроки Возр");
		Для Каждого СтрокаТаблицы Из УчастникиЮридическиеЛица Цикл
			
			Если СтрокаТаблицы.СуммаВзносаДоИзменения = СтрокаТаблицы.СуммаВзноса  Тогда
				Продолжить;
			КонецЕсли;
			
			НовыйЛист = СкопироватьКлючиСтруктуры(ШаблонЛистаВ);
			СведенияОЮридическомЛице = СтрокаТаблицы.СведенияОЮридическомЛице;
			Если СтрокаТаблицы.СуммаВзносаДоИзменения = 0 Тогда
				// Причина внесения изменений
				НовыйЛист.В01000000 = "1"; // внесение сведений о новом участнике
				// Сведения об участнике, вносимые в ЕГРЮЛ
				НовыйЛист.В03010000 = СведенияОЮридическомЛице.ОГРН;
				НовыйЛист.В03020000 = СведенияОЮридическомЛице.ИНН;
				НовыйЛист.В03030000 = СведенияОЮридическомЛице.ПолноеНаименование;
				// Доля в уставном капитале
				НовыйЛист.В04010000 = СтрокаТаблицы.СуммаВзноса;
				НовыйЛист.В04020100 = СтрокаТаблицы.ДоляУставногоКапитала;
			ИначеЕсли СтрокаТаблицы.СуммаВзноса = 0 Тогда
				// Причина внесения изменений
				НовыйЛист.В01000000 = "2"; // внесение сведений о прекращении участия
				// Сведения об участнике, содержащиеся в ЕГРЮЛ
				НовыйЛист.В02010000 = СведенияОЮридическомЛице.ОГРН;
				НовыйЛист.В02020000 = СведенияОЮридическомЛице.ИНН;
				НовыйЛист.В02030000 = СведенияОЮридическомЛице.ПолноеНаименование;
			ИначеЕсли СтрокаТаблицы.СуммаВзносаДоИзменения <> СтрокаТаблицы.СуммаВзноса Тогда
				// Причина внесения изменений
				НовыйЛист.В01000000 = "3"; // внесение изменений в сведения об участнике
				// Сведения об участнике, содержащиеся в ЕГРЮЛ
				НовыйЛист.В02010000 = СведенияОЮридическомЛице.ОГРН;
				НовыйЛист.В02020000 = СведенияОЮридическомЛице.ИНН;
				НовыйЛист.В02030000 = СведенияОЮридическомЛице.ПолноеНаименование;
				// Доля в уставном капитале
				НовыйЛист.В04010000 = СтрокаТаблицы.СуммаВзноса;
				НовыйЛист.В04020100 = СтрокаТаблицы.ДоляУставногоКапитала;
			КонецЕсли;
			Контейнер.ЛистВ1.Добавить(НовыйЛист);
			
		КонецЦикла;
		
	КонецЕсли;
	
	Если Контейнер.ЛистВ1.Количество() = 0 Тогда
		Контейнер.ЛистВ1.Добавить(ШаблонЛистаВ);
	КонецЕсли;
	
	// Лист Г "Сведения об участнике - иностранном юридическом лице"
	// Заполняется при изменении состава участников общества
	ШаблонЛистаГ = СкопироватьКлючиСтруктуры(Контейнер.ЛистГ1_2[0].Значение);
	Контейнер.ЛистГ1_2.Очистить();
	Контейнер.ЛистГ1_2.Добавить(ШаблонЛистаГ);
	
	// Лист Д "Сведения об участнике - физическом лиц"
	// Заполняется при изменении состава участников общества
	ШаблонЛистаД = СкопироватьКлючиСтруктуры(Контейнер.ЛистД[0].Значение);
	Контейнер.ЛистД.Очистить();
	
	Если Изменено.Учредители И Не Изменено.УставныйКапитал Тогда
		
		УчастникиФизическиеЛица = Учредители.Скопировать(Новый Структура("ЭтоЮридическоеЛицо", Ложь));
		УчастникиФизическиеЛица.Сортировать("НомерСтроки Возр");
		Для Каждого СтрокаТаблицы Из УчастникиФизическиеЛица Цикл
			
			Если СтрокаТаблицы.СуммаВзносаДоИзменения = СтрокаТаблицы.СуммаВзноса Тогда
				Продолжить;
			КонецЕсли;
			
			НовыйЛист = СкопироватьКлючиСтруктуры(ШаблонЛистаД);
			СведенияОФизическомЛице = СтрокаТаблицы.СведенияОФизическомЛице;
			Если СтрокаТаблицы.СуммаВзносаДоИзменения = 0 Тогда
				// Причина внесения изменений
				НовыйЛист.Д01000000 = "1"; // внесение сведений о новом участнике
				// Сведения об участнике, вносимые в ЕГРЮЛ
				// ФИО
				НовыйЛист.Д03010100 = СведенияОФизическомЛице.Фамилия;
				НовыйЛист.Д03010200 = СведенияОФизическомЛице.Имя;
				НовыйЛист.Д03010300 = СведенияОФизическомЛице.Отчество;
				// ИНН
				НовыйЛист.Д03020000 = СведенияОФизическомЛице.ИНН;
				// Дата и место рождения
				НовыйЛист.Д03030100 = СведенияОФизическомЛице.ДатаРождения;
				НовыйЛист.Д03030200 = СведенияОФизическомЛице.МестоРожденияПредставление;
				// Паспортные данные
				НовыйЛист.Д03050100 = СведенияОФизическомЛице.ДокументКодМВД;
				НовыйЛист.Д03050200 = "" + СведенияОФизическомЛице.ДокументСерия + " " + СведенияОФизическомЛице.ДокументНомер;
				НовыйЛист.Д03050300 = СведенияОФизическомЛице.ДокументДатаВыдачи;
				НовыйЛист.Д03050400 = СведенияОФизическомЛице.ДокументКемВыдан;
				ЧастиКодаПодразделения = СтрРазделить("" + СведенияОФизическомЛице.ДокументКодПодразделения, "-", Ложь);
				Если ЧастиКодаПодразделения.Количество() = 2 Тогда
					НовыйЛист.Д03050501 = ЧастиКодаПодразделения[0];
					НовыйЛист.Д03050502 = ЧастиКодаПодразделения[1];
				КонецЕсли;
				// Адрес
				ЗаполнитьЗначенияСвойств(НовыйЛист, СведенияОФизическомЛице.АдресСтруктурой);
				// Доля в уставном капитале
				НовыйЛист.Д04010000 = СтрокаТаблицы.СуммаВзноса;
				НовыйЛист.Д04020100 = СтрокаТаблицы.ДоляУставногоКапитала;
			ИначеЕсли СтрокаТаблицы.СуммаВзноса = 0 Тогда
				// Причина внесения изменений
				НовыйЛист.Д01000000 = "2"; // внесение сведений о прекращении участия
				// Сведения об участнике, содержащиеся в ЕГРЮЛ
				// ФИО
				НовыйЛист.Д02010100 = СведенияОФизическомЛице.Фамилия;
				НовыйЛист.Д02010200 = СведенияОФизическомЛице.Имя;
				НовыйЛист.Д02010300 = СведенияОФизическомЛице.Отчество;
				// ИНН
				НовыйЛист.Д02020000 = СведенияОФизическомЛице.ИНН;
			ИначеЕсли СтрокаТаблицы.СуммаВзносаДоИзменения <> СтрокаТаблицы.СуммаВзноса Тогда
				// Причина внесения изменений
				НовыйЛист.Д01000000 = "3"; // внесение изменений в сведения об участнике
				// Сведения об участнике, содержащиеся в ЕГРЮЛ
				// ФИО
				НовыйЛист.Д02010100 = СведенияОФизическомЛице.Фамилия;
				НовыйЛист.Д02010200 = СведенияОФизическомЛице.Имя;
				НовыйЛист.Д02010300 = СведенияОФизическомЛице.Отчество;
				// ИНН
				НовыйЛист.Д02020000 = СведенияОФизическомЛице.ИНН;
				// Доля в уставном капитале
				НовыйЛист.Д04010000 = СтрокаТаблицы.СуммаВзноса;
				НовыйЛист.Д04020100 = СтрокаТаблицы.ДоляУставногоКапитала;
			КонецЕсли;
			Контейнер.ЛистД.Добавить(НовыйЛист);
			
		КонецЦикла;
		
	КонецЕсли;
	
	Если Контейнер.ЛистД.Количество() = 0 Тогда
		Контейнер.ЛистД.Добавить(ШаблонЛистаД);
	КонецЕсли;
	
	// Лист Е "Сведения об участнике - Российской Федерации, субъекте Российской Федерации, муниципальном образовании"
	// Заполняется при изменении состава участников общества
	ШаблонЛистаЕ1 = СкопироватьКлючиСтруктуры(Контейнер.ЛистЕ1[0].Значение);
	Контейнер.ЛистЕ1.Очистить();
	Контейнер.ЛистЕ1.Добавить(ШаблонЛистаЕ1);
	
	// Лист Ж "Сведения о паевом инвестиционном фонде, в состав имущества которого включена доля в уставном капитале юридического лица"
	// Заполняется при изменении состава участников общества
	ШаблонЛистаЖ = СкопироватьКлючиСтруктуры(Контейнер.ЛистЖ1_2[0].Значение);
	Контейнер.ЛистЖ1_2.Очистить();
	Контейнер.ЛистЖ1_2.Добавить(ШаблонЛистаЖ);
	
	// Лист З "Сведения о доле в уставном капитале общества с ограниченной ответственностью, принадлежащей обществу"
	// Заполняется в случае приобретения обществом с ограниченной ответственностью доли в уставном капитале общества,
	// распределения или продажи принадлежащей обществу доли в уставном капитале общества.
	ШаблонЛистаЗ = СкопироватьКлючиСтруктуры(Контейнер.ЛистЗ);
	ЗаполнитьЗначенияСвойств(Контейнер.ЛистЗ, ШаблонЛистаЗ);
	
	// Лист И заявления "Сведения о держателе реестра акционеров акционерного общества"
	// Заполняется в случае изменения сведений о держателе реестра акционеров акционерного общества.
	ШаблонЛистаИ = СкопироватьКлючиСтруктуры(Контейнер.ЛистИ);
	ЗаполнитьЗначенияСвойств(Контейнер.ЛистИ, ШаблонЛистаИ);
	
	// Лист К "Сведения о физическом лице, имеющем право без доверенности действовать от имени юридического лица"
	// Заполняется при смене руководителя
	ШаблонЛистаК = СкопироватьКлючиСтруктуры(Контейнер.ЛистК[0].Значение);
	Контейнер.ЛистК.Очистить();
	Если Изменено.Руководитель Тогда
		
		// Новый руководитель
		ДанныеНовогоРуководителя = ПараметрыЗаполнения.ДанныеНовогоРуководителя;
		ДанныеОДолжностиНовогоРуководителя = ПараметрыЗаполнения.ДанныеОДолжностиНовогоРуководителя;
		
		НовыйЛист = СкопироватьКлючиСтруктуры(ШаблонЛистаК);
		// Причина внесения сведений
		НовыйЛист.К01000000 = "1"; // Возложение полномочий
		// ФИО
		НовыйЛист.К03010100 = ДанныеНовогоРуководителя.Фамилия;
		НовыйЛист.К03010200 = ДанныеНовогоРуководителя.Имя;
		НовыйЛист.К03010300 = ДанныеНовогоРуководителя.Отчество;
		// ИНН
		НовыйЛист.К03020000 = ДанныеНовогоРуководителя.ИНН;
		// Дата и место рождения
		НовыйЛист.К03030100 = ДанныеНовогоРуководителя.ДатаРождения;
		НовыйЛист.К03030200 = ДанныеНовогоРуководителя.МестоРожденияПредставление;
		// Должность
		НовыйЛист.К03040000 = Строка(ДанныеОДолжностиНовогоРуководителя.Должность);
		// Паспортные данные
		НовыйЛист.К03050100 = "21"; // Паспорт гражданина РФ
		НовыйЛист.К03050200 = СтрШаблон("%1 %2", ДанныеНовогоРуководителя.ПаспортныеДанные.Серия, ДанныеНовогоРуководителя.ПаспортныеДанные.Номер);
		НовыйЛист.К03050300 = ДанныеНовогоРуководителя.ПаспортныеДанные.ДатаВыдачи;
		НовыйЛист.К03050400 = ДанныеНовогоРуководителя.ПаспортныеДанные.КемВыдан;
		ЧастиКодаПодразделения = СтрРазделить(ДанныеНовогоРуководителя.ПаспортныеДанные.КодПодразделения, "-", Ложь);
		Если ЧастиКодаПодразделения.Количество() = 2 Тогда
			НовыйЛист.К03050501 = ЧастиКодаПодразделения[0];
			НовыйЛист.К03050502 = ЧастиКодаПодразделения[1];
		КонецЕсли;
		// Адрес
		ДополнительныеПараметрыКИ = Новый Структура("НаименованиеВключаетСокращение", Ложь);
		ЗаполнитьЗначенияСвойств(НовыйЛист,
			УправлениеКонтактнойИнформациейБП.СтруктураАдреса(ДанныеНовогоРуководителя.АдресПропискиЗначениеJSON, ДополнительныеПараметрыКИ));
		// Телефон
		НовыйЛист.К03070000 = УправлениеКонтактнойИнформацией.ПредставлениеКонтактнойИнформации(ДанныеНовогоРуководителя.ТелефонРабочийЗначениеJSON,
			Справочники.ВидыКонтактнойИнформации.ТелефонРабочийФизическиеЛица);
		Контейнер.ЛистК.Добавить(НовыйЛист);
		
		// Прежний руководитель
		ДанныеРуководителя = ПараметрыЗаполнения.ДанныеОрганизации.ДанныеРуководителя;
		
		НовыйЛист = СкопироватьКлючиСтруктуры(ШаблонЛистаК);
		// Причина внесения сведений
		НовыйЛист.К01000000 = "2"; // Прекращение полномочий
		// ФИО
		НовыйЛист.К02010100 = ДанныеРуководителя.Фамилия;
		НовыйЛист.К02010200 = ДанныеРуководителя.Имя;
		НовыйЛист.К02010300 = ДанныеРуководителя.Отчество;
		// ИНН
		НовыйЛист.К02020000 = ДанныеРуководителя.ИНН;
		Контейнер.ЛистК.Добавить(НовыйЛист);
	Иначе
		Контейнер.ЛистК.Добавить(ШаблонЛистаК);
	КонецЕсли;
	
	// Лист Л "Сведения об управляющей организации"
	// Заполняется в случае изменений сведений об управляющей организации юридического лица.
	ШаблонЛистаЛ = СкопироватьКлючиСтруктуры(Контейнер.ЛистЛ[0].Значение);
	Контейнер.ЛистЛ.Очистить();
	Контейнер.ЛистЛ.Добавить(ШаблонЛистаЛ);
	
	// Лист М "Сведения об управляющем"
	// Заполняется в случае изменений сведений об управляющем юридического лица.
	ШаблонЛистаМ = СкопироватьКлючиСтруктуры(Контейнер.ЛистМ[0].Значение);
	Контейнер.ЛистМ.Очистить();
	Контейнер.ЛистМ.Добавить(ШаблонЛистаМ);
	
	// Лист Н "Сведения о кодах по Общероссийскому классификатору видов экономической деятельности"
	// Заполняется при изменении кодов ОКВЭД
	Если Изменено.ОсновнойВидДеятельности И Не ПараметрыЗаполнения.ИзмененияВносятсяВУчредительныеДокументы Тогда
		// Страница 1: Сведения о кодах ОКВЭД, подлежащие внесению в ЕГРЮЛ
		Контейнер.ЛистН1.А01010000 = ПараметрыЗаполнения.КодОКВЭД2Новый;
		// Страница 2: Сведения о кодах ОКВЭД, подлежащие исключению из ЕГРЮЛ
		Контейнер.ЛистН2.А01010000 = ДанныеОрганизации.КодОКВЭД2;
	КонецЕсли;
	Если Изменено.ВидыДеятельности И Не ПараметрыЗаполнения.ИзмененияВносятсяВУчредительныеДокументы Тогда
		ИзмененияВидовДеятельности = ИзмененияВидовДеятельности(ПараметрыЗаполнения);
		// Страница 1: Сведения о кодах ОКВЭД, подлежащие внесению в ЕГРЮЛ
		Контейнер.МногострочнаяЧасть1.Очистить();
		Для Каждого ДополнительныйКод Из ИзмененияВидовДеятельности.ДобавленныеКодыОКВЭД Цикл
			Контейнер.МногострочнаяЧасть1.Добавить().А01020000 = ДополнительныйКод;
		КонецЦикла;
		// Страница 2: Сведения о кодах ОКВЭД, подлежащие исключению из ЕГРЮЛ
		Контейнер.МногострочнаяЧасть2.Очистить();
		Для Каждого ДополнительныйКод Из ИзмененияВидовДеятельности.УдаленныеКодыОКВЭД Цикл
			Контейнер.МногострочнаяЧасть2.Добавить().А01020000 = ДополнительныйКод;
		КонецЦикла;
	КонецЕсли;
	
	// Лист О "Сведения о филиале/представительстве"
	// Заполняется в случае внесения в Единый государственный реестр юридических лиц сведений о филиале и (или) представительстве,
	// содержащихся в учредительных документах юридического лица, но не отраженных в Едином государственном реестре юридических лиц.
	ШаблонЛистаО = СкопироватьКлючиСтруктуры(Контейнер.ЛистО[0].Значение);
	Контейнер.ЛистО.Очистить();
	Контейнер.ЛистО.Добавить(ШаблонЛистаО);
	
	// Лист П "Сведения о размере уставного капитала (складочного капитала, уставного фонда, паевого фонда)"
	// Заполняется в случае исправления ошибки в сведениях о размере уставного (складочного) капитала, уставного (паевого) фонда,
	// допущенной заявителем в ранее представленном заявлении.
	ШаблонЛистаП = СкопироватьКлючиСтруктуры(Контейнер.ЛистП);
	ЗаполнитьЗначенияСвойств(Контейнер.ЛистП, ШаблонЛистаП);
	
	// Лист Р "Сведения о заявителе"
	Если ПараметрыЗаполнения.Свойство("ДанныеЗаявителя", ДанныеЗаявителя) Тогда
		НовыйЛист = СкопироватьКлючиСтруктуры(Контейнер.ЛистР[0].Значение);
		Контейнер.ЛистР.Очистить();
		// Вид заявителя
		НовыйЛист.Р01000000 = "01"; // 01 - руководитель постоянно действующего исполнительного органа
		// Сведения о юридическом лице, от имени которого действует заявитель
		НовыйЛист.Р02010000 = ДанныеОрганизации.ОГРН;
		НовыйЛист.Р02020000 = ДанныеОрганизации.ИНН;
		НовыйЛист.Р02030000 = ДанныеОрганизации.НаименованиеПолное;
		// ФИО
		НовыйЛист.Р04010100 = ДанныеЗаявителя.Фамилия;
		НовыйЛист.Р04010200 = ДанныеЗаявителя.Имя;
		НовыйЛист.Р04010300 = ДанныеЗаявителя.Отчество;
		// ИНН
		НовыйЛист.Р04020000 = ДанныеЗаявителя.ИНН;
		// Дата и место рождения
		НовыйЛист.Р04030100 = ДанныеЗаявителя.ДатаРождения;
		НовыйЛист.Р04030200 = ДанныеЗаявителя.МестоРожденияПредставление;
		// Паспортные данные
		НовыйЛист.Р04040100 = "21"; // Паспорт гражданина РФ
		НовыйЛист.Р04040200 = СтрШаблон("%1 %2", ДанныеЗаявителя.ПаспортныеДанные.Серия, ДанныеЗаявителя.ПаспортныеДанные.Номер);
		НовыйЛист.Р04040300 = ДанныеЗаявителя.ПаспортныеДанные.ДатаВыдачи;
		НовыйЛист.Р04040400 = ДанныеЗаявителя.ПаспортныеДанные.КемВыдан;
		ЧастиКодаПодразделения = СтрРазделить(ДанныеЗаявителя.ПаспортныеДанные.КодПодразделения, "-", Ложь);
		Если ЧастиКодаПодразделения.Количество() = 2 Тогда
			НовыйЛист.Р04040501 = ЧастиКодаПодразделения[0];
			НовыйЛист.Р04040502 = ЧастиКодаПодразделения[1];
		КонецЕсли;
		// Адрес
		ДополнительныеПараметрыКИ = Новый Структура("НаименованиеВключаетСокращение", Ложь);
		ЗаполнитьЗначенияСвойств(НовыйЛист,
			УправлениеКонтактнойИнформациейБП.СтруктураАдреса(ДанныеЗаявителя.АдресПропискиЗначениеJSON, ДополнительныеПараметрыКИ));
		// Телефон
		НовыйЛист.Р04060100 = УправлениеКонтактнойИнформацией.ПредставлениеКонтактнойИнформации(ДанныеЗаявителя.ТелефонРабочийЗначениеJSON,
			Справочники.ВидыКонтактнойИнформации.ТелефонРабочийФизическиеЛица);
		// EMail
		НовыйЛист.Р04060200 = УправлениеКонтактнойИнформацией.ПредставлениеКонтактнойИнформации(ДанныеЗаявителя.EMailЗначениеJSON,
			Справочники.ВидыКонтактнойИнформации.EMailФизическиеЛица);
		// Получение документов
		Если ПараметрыЗаполнения.Свойство("СпособРегистрации") Тогда
			НовыйЛист.Р05000000 = ПараметрыЗаполнения.СпособРегистрации;
		КонецЕсли;
		Контейнер.ЛистР.Добавить(НовыйЛист);
	КонецЕсли;
	
КонецПроцедуры

Процедура ЗаполнитьЗаявлениеРегистрацииИзмененийЕГРИП(ПараметрыОтчета, Контейнер) Экспорт
	Перем ДанныеЗаявителя;
	
	ПараметрыЗаполнения = ПараметрыОтчета.ПараметрыЗаполнения;
	
	Изменено = ПараметрыЗаполнения.Изменено;
	ДанныеОрганизации = ПараметрыЗаполнения.ДанныеОрганизации;
	
	// Титульный лист
	// Сведения об индивидуальном предпринимателе, содержащиеся в ЕГРИП
	Контейнер.Лист001.П01010100 = ДанныеОрганизации.ОГРН;
	Контейнер.Лист001.П01010200 = ДанныеОрганизации.ИндивидуальныйПредприниматель.Фамилия;
	Контейнер.Лист001.П01010300 = ДанныеОрганизации.ИндивидуальныйПредприниматель.Имя;
	Контейнер.Лист001.П01010400 = ДанныеОрганизации.ИндивидуальныйПредприниматель.Отчество;
	Контейнер.Лист001.П01010500 = ДанныеОрганизации.ИНН;
	// Заявление представлено
	Контейнер.Лист001.П01020100 = "1"; // в связи с изменением сведений об индивидуальном предпринимателе
	
	// Лист А "Сведения о данных индивидуального предпринимателя"
	// Заполняется в случае изменения (исправления) фамилии, имени, отчества, сведений о рождении
	// индивидуального предпринимателя - иностранного гражданина или лица без гражданства.
	ШаблонЛистаА = СкопироватьКлючиСтруктуры(Контейнер.ЛистА);
	ЗаполнитьЗначенияСвойств(Контейнер.ЛистА, ШаблонЛистаА);
	
	// Лист Б "Сведения о гражданстве"
	// Заполняется при изменении гражданства гражданином РФ или иностранным гражданином, приобретении гражданства лицом без гражданства.
	ШаблонЛистаБ = СкопироватьКлючиСтруктуры(Контейнер.ЛистБ);
	ЗаполнитьЗначенияСвойств(Контейнер.ЛистБ, ШаблонЛистаБ);
	
	// Лист В "Сведения о месте пребывания в Российской Федерации"
	// Заполняется в отношении физического лица, не имеющего место жительства на территории РФ.
	ШаблонЛистаВ = СкопироватьКлючиСтруктуры(Контейнер.ЛистВ);
	ЗаполнитьЗначенияСвойств(Контейнер.ЛистВ, ШаблонЛистаВ);
	
	// Лист Г "Сведения о документе, удостоверяющем личность"
	// Заполняется иностранным гражданином или лицом без гражданства.
	ШаблонЛистаГ = СкопироватьКлючиСтруктуры(Контейнер.ЛистГ);
	ЗаполнитьЗначенияСвойств(Контейнер.ЛистГ, ШаблонЛистаГ);
	
	// Лист Д "Сведения о документе, подтверждающем право иностранного гражданина или лица без гражданства
	//        временно или постоянно проживать на территории Российской Федерации"
	// Заполняется в случае изменения данных вида на жительство или разрешения на временное проживание.
	ШаблонЛистаД = СкопироватьКлючиСтруктуры(Контейнер.ЛистД);
	ЗаполнитьЗначенияСвойств(Контейнер.ЛистД, ШаблонЛистаД);
	
	// Лист Е "Сведения о кодах по Общероссийскому классификатору видов экономической деятельности"
	Если Изменено.ОсновнойВидДеятельности Тогда
		// Страница 1: Сведения о кодах ОКВЭД, подлежащие внесению в ЕГРЮЛ
		Контейнер.ЛистЕ1.А01010000 = ПараметрыЗаполнения.КодОКВЭД2Новый;
		// Страница 2: Сведения о кодах ОКВЭД, подлежащие исключению из ЕГРЮЛ
		Контейнер.ЛистЕ2.А01010000 = ДанныеОрганизации.КодОКВЭД2;
	КонецЕсли;
	Если Изменено.ВидыДеятельности Тогда
		ИзмененияВидовДеятельности = ИзмененияВидовДеятельности(ПараметрыЗаполнения);
		// Страница 1: Сведения о кодах ОКВЭД, подлежащие внесению в ЕГРЮЛ
		Контейнер.МногострочнаяЧасть1.Очистить();
		Для Каждого ДобавленныйКодОКВЭД Из ИзмененияВидовДеятельности.ДобавленныеКодыОКВЭД Цикл
			Контейнер.МногострочнаяЧасть1.Добавить().А01020000 = ДобавленныйКодОКВЭД;
		КонецЦикла;
		// Страница 2: Сведения о кодах ОКВЭД, подлежащие исключению из ЕГРЮЛ
		Контейнер.МногострочнаяЧасть2.Очистить();
		Для Каждого УдаленныйКодОКВЭД Из ИзмененияВидовДеятельности.УдаленныеКодыОКВЭД Цикл
			Контейнер.МногострочнаяЧасть2.Добавить().А01020000 = УдаленныйКодОКВЭД;
		КонецЦикла;
	КонецЕсли;
	
	// Лист Ж
	Если ПараметрыЗаполнения.Свойство("СпособРегистрации") Тогда
		Контейнер.ЛистЖ.Ж01010000 = ПараметрыЗаполнения.СпособРегистрации;
	КонецЕсли;
	Если ПараметрыЗаполнения.Свойство("ДанныеЗаявителя", ДанныеЗаявителя) Тогда
		Контейнер.ЛистЖ.Ж01020000 = УправлениеКонтактнойИнформацией.ПредставлениеКонтактнойИнформации(ДанныеЗаявителя.ТелефонРабочийЗначениеJSON,
			Справочники.ВидыКонтактнойИнформации.ТелефонРабочийФизическиеЛица);
		Контейнер.ЛистЖ.Ж01030000 = УправлениеКонтактнойИнформацией.ПредставлениеКонтактнойИнформации(ДанныеЗаявителя.EMailЗначениеJSON,
			Справочники.ВидыКонтактнойИнформации.EMailФизическиеЛица);
	КонецЕсли;
	
КонецПроцедуры

// Возвращает сумму государственной пошлины за внесение изменений в учредительные документы
//
// Возвращаемое значение:
//   Число 15, 2
//
Функция СуммаПошлиныЗаВнесениеИзмененийВУчредительныеДокументы() Экспорт
	
	Возврат 800;
	
КонецФункции

// Возвращает учетную политику по умолчанию при внесении изменений в ЕГРЮЛ/ЕГРИП
//
Функция УчетнаяПолитикаПоУмолчанию(ЮридическоеФизическоеЛицо)
	
	ЭтоЮрЛицо = (ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо);
	
	ВидОрганизации = ?(ЭтоЮрЛицо, "ЮридическоеЛицо", "ИндивидуальныйПредприниматель");
	СистемаНалогообложения = "УпрощеннаяДоходы";
	ПлательщикЕНВД = Ложь;
	ПрименяетсяУСНПатент = Ложь;
	
	Возврат РегистрыСведений.НастройкиСистемыНалогообложения.СтруктураУчетнойПолитики(
		ВидОрганизации,
		СистемаНалогообложения,
		ПлательщикЕНВД,
		ПрименяетсяУСНПатент);
	
КонецФункции

Функция СведенияОНалоговомОрганеПоАдресу(Знач Адрес)
	
	Если Не ЗначениеЗаполнено(Адрес) Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	СведенияОНалоговомОрганеПоАдресу = АдресныйКлассификатор.КодыАдреса(Адрес, "Сервис1С");
	
	КодНалоговогоОрганаПоАдресу = Формат(СведенияОНалоговомОрганеПоАдресу.КодИФНСЮЛ, "ЧЦ=4; ЧДЦ=; ЧВН=; ЧГ=0");
	
	Если ЗначениеЗаполнено(КодНалоговогоОрганаПоАдресу) Тогда
		
		Сведения = Новый Структура();
		Сведения.Вставить("КодНалоговогоОргана", КодНалоговогоОрганаПоАдресу);
		Сведения.Вставить("КодПоОКТМО", Формат(СведенияОНалоговомОрганеПоАдресу.ОКТМО, "ЧДЦ=; ЧГ=0"));
		Сведения.Вставить("КодПоОКАТО", Формат(СведенияОНалоговомОрганеПоАдресу.ОКАТО, "ЧДЦ=; ЧГ=0"));
		
		Возврат Сведения;
		
	КонецЕсли;
	
	Возврат Неопределено;
	
КонецФункции

Функция ОпределитьРегистрирующийОрган(ДанныеПомощникаЗаполнения) Экспорт
	
	Результат = Новый Структура;
	
	Изменено = ДанныеПомощникаЗаполнения.Изменено;
	ДанныеОрганизации = ДанныеПомощникаЗаполнения.ДанныеОрганизации;
	ДанныеЗаявителя = ДанныеПомощникаЗаполнения.ДанныеЗаявителя;
	Если ДанныеОрганизации.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо Тогда
		Если Изменено.Местоположение Тогда
			// Изменения регистрируются по новому местоположению
			АдресРегистрации = ДанныеПомощникаЗаполнения.ЮридическийАдресНовыйЗначениеJSON;
		Иначе
			// Изменения регистрируются по юридическому адресу
			АдресРегистрации = ДанныеОрганизации.ЮридическийАдресЗначениеJSON;
		КонецЕсли;
	Иначе
		// Изменения регистрируются по адресу прописки
		АдресРегистрации = ДанныеЗаявителя.АдресПропискиЗначениеJSON;
	КонецЕсли;
	
	СведенияОНалоговомОргане = СведенияОНалоговомОрганеПоАдресу(АдресРегистрации);
	Если СведенияОНалоговомОргане <> Неопределено Тогда
		КодНалоговогоОргана = СведенияОНалоговомОргане.КодНалоговогоОргана;
	Иначе
		КодНалоговогоОргана = "";
	КонецЕсли;
	
	Результат.Вставить("РеквизитыРегистрирующегоОргана",
		РеквизитыРегистрирующегоОргана(КодНалоговогоОргана, Истина));
	
	Если Изменено.Местоположение Тогда
		
		СведенияОПрежнемНалоговомОргане = СведенияОНалоговомОрганеПоАдресу(ДанныеОрганизации.ЮридическийАдресЗначениеJSON);
		Если СведенияОПрежнемНалоговомОргане <> Неопределено Тогда
			КодПрежнегоНалоговогоОргана = СведенияОПрежнемНалоговомОргане.КодНалоговогоОргана;
		Иначе
			КодПрежнегоНалоговогоОргана = "";
		КонецЕсли;
		
		Результат.Вставить("РеквизитыПрежнегоРегистрирующегоОргана",
			РеквизитыРегистрирующегоОргана(КодПрежнегоНалоговогоОргана, Истина));
		
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции

Функция ДанныеУчредителейДляЗаявлениеОВнесенииИзмененийЕГР(ДанныеПомощникаЗаполнения)
	
	Изменено = ДанныеПомощникаЗаполнения.Изменено;
	
	Если Изменено.Учредители Или Изменено.УставныйКапитал Тогда
		
		Учредители = ДанныеПомощникаЗаполнения.УчредителиНовые.Скопировать();
		ОбщегоНазначенияБПВызовСервера.ПронумероватьТаблицу(Учредители);
		Учредители.Колонки.Добавить("СуммаВзносаДоИзменения", ОбщегоНазначения.ОписаниеТипаЧисло(15, 2));
		Учредители.Колонки.Добавить("ДоляУчастияДоИзменения", ОбщегоНазначения.ОписаниеТипаЧисло(10, 6));
		
		УчредителиДоИзменения = ДанныеПомощникаЗаполнения.ДанныеОрганизации.Учредители.Скопировать();
		ОбщегоНазначенияБПВызовСервера.ПронумероватьТаблицу(УчредителиДоИзменения);
		Для Каждого СтрокаТаблицы Из УчредителиДоИзменения Цикл
			НайденныеСтроки = Учредители.НайтиСтроки(Новый Структура("Ссылка", СтрокаТаблицы.Ссылка));
			Если НайденныеСтроки.Количество() = 0 Тогда
				// Внесены сведения о прекращении участия
				НоваяСтрока = Учредители.Добавить();
				ЗаполнитьЗначенияСвойств(НоваяСтрока, СтрокаТаблицы, , "СуммаВзноса, ДоляУчастия");
				НоваяСтрока.СуммаВзносаДоИзменения = СтрокаТаблицы.СуммаВзноса;
				НоваяСтрока.ДоляУчастияДоИзменения = СтрокаТаблицы.ДоляУчастия;
			ИначеЕсли НайденныеСтроки.Количество() = 1 Тогда
				НайденныеСтроки[0].СуммаВзносаДоИзменения = СтрокаТаблицы.СуммаВзноса;
			Иначе
				ВызватьИсключение НСтр("ru = 'В таблице учредителей обнаружены дубли участников'");
			КонецЕсли;
		КонецЦикла;
	Иначе
		Учредители = ДанныеПомощникаЗаполнения.ДанныеОрганизации.Учредители.Скопировать();
		ОбщегоНазначенияБПВызовСервера.ПронумероватьТаблицу(Учредители);
		Учредители.Колонки.Добавить("СуммаВзносаДоИзменения", ОбщегоНазначения.ОписаниеТипаЧисло(15, 2));
		Учредители.ЗагрузитьКолонку(Учредители.ВыгрузитьКолонку("СуммаВзносаДоИзменения"), "СуммаВзноса");
	КонецЕсли;
	
	Учредители.Колонки.Ссылка.Имя = "Учредитель";
	Учредители.Колонки.Добавить("ЭтоЮридическоеЛицо", Новый ОписаниеТипов("Булево"));
	Для Каждого Участник Из Учредители Цикл
		Участник.ЭтоЮридическоеЛицо = Участник.ТипУчредителя = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо;
	КонецЦикла;
	Учредители.Колонки.Удалить("ТипУчредителя");
	
	ЗаполнитьПодробнуюИнформациюОбУчредителях(Учредители);
	
	Возврат Учредители;
	
КонецФункции

#КонецОбласти

#КонецОбласти

#Область УставООО

// Формирует печатную форму устава организации.
//
// Параметры:
//  Организация - СправочникСсылка.Организации - организация, по которой формируется устав.
//
// Возвращаемое значение:
//  Строка - адрес во временном хранилище, которое содержит двоичные данные сформированного документа в формате RTF.
//
Функция УставООО(Организация) Экспорт
	
	ДанныеУчредителей = ДанныеУчредителейОрганизации(Организация, ТекущаяДатаСеанса());
	Если ДанныеУчредителей = Неопределено Тогда
		ВызватьИсключение НСтр("ru = 'Нет данных об учредителях организации.'");
	КонецЕсли;
	
	ДанныеРуководителя = ДанныеРуководителяОрганизации(Организация, ТекущаяДатаСеанса());
	Если ДанныеРуководителя = Неопределено Тогда
		ВызватьИсключение НСтр("ru = 'Нет данных о руководителе организации.'");
	КонецЕсли;
	
	ДанныеОрганизации = НовыеДанныеЮридическогоЛица();
	ЗаполнитьЗначенияСвойств(ДанныеОрганизации,
		ОбщегоНазначения.ЗначенияРеквизитовОбъекта(Организация, "НаименованиеСокращенное, НаименованиеПолное"));
	СтруктураЮрАдреса = УправлениеКонтактнойИнформациейБП.АдресСтруктурой(Организация, Справочники.ВидыКонтактнойИнформации.ЮрАдресОрганизации);
	ДанныеОрганизации.ЮридическийАдрес = СтруктураЮрАдреса.Представление;
	ДанныеОрганизации.ЮридическийАдресЗначениеJSON = СтруктураЮрАдреса.ЗначениеJSON;
	ДанныеОрганизации.УставныйКапитал = ДанныеУчредителей.УставныйКапитал;
	ЗаполнитьЗначенияСвойств(ДанныеОрганизации.ДанныеОДолжностиРуководителя, ДанныеРуководителя);
	
	ДанныеПротоколаРешения = Новый Структура("Номер, Дата", "1", ДанныеУчредителей.Дата);
	
	Возврат ЗаполнитьУставООО(ДанныеОрганизации, ДанныеПротоколаРешения, ДанныеУчредителей.Учредители.Количество());
	
КонецФункции

Функция УставОООНоваяРедакция(ДанныеПомощникаЗаполнения, ДанныеПротоколаРешения)
	
	ДанныеОрганизации = ОбщегоНазначенияКлиентСервер.СкопироватьСтруктуру(ДанныеПомощникаЗаполнения.ДанныеОрганизации);
	
	Изменено = ДанныеПомощникаЗаполнения.Изменено;
	
	Если Изменено.ПолноеНаименование Или Изменено.СокращенноеНаименование Тогда
		ДанныеОрганизации.НаименованиеПолное = ДанныеПомощникаЗаполнения.НаименованиеПолноеНовое;
		ДанныеОрганизации.НаименованиеСокращенное = ДанныеПомощникаЗаполнения.НаименованиеСокращенноеНовое;
	КонецЕсли;
	
	Если Изменено.ЮридическийАдрес Или Изменено.Местоположение Тогда
		ДанныеОрганизации.ЮридическийАдрес = ДанныеПомощникаЗаполнения.ЮридическийАдресНовый;
		ДанныеОрганизации.ЮридическийАдресЗначениеJSON = ДанныеПомощникаЗаполнения.ЮридическийАдресНовыйЗначениеJSON;
	КонецЕсли;
	
	Если Изменено.УставныйКапитал Тогда
		ДанныеОрганизации.УставныйКапитал = ДанныеПомощникаЗаполнения.УставныйКапиталНовый;
	КонецЕсли;
	
	Если Изменено.Руководитель Тогда
		ДанныеОрганизации.ДанныеОДолжностиРуководителя = ОбщегоНазначенияКлиентСервер.СкопироватьСтруктуру(ДанныеПомощникаЗаполнения.ДанныеОДолжностиНовогоРуководителя);
	КонецЕсли;
	
	Возврат ЗаполнитьУставООО(ДанныеОрганизации, ДанныеПротоколаРешения, ДанныеОрганизации.Учредители.Количество());
	
КонецФункции

Функция ЗаполнитьУставООО(ДанныеОрганизации, ДанныеПротоколаРешения, КоличествоУчредителей)
	
	ПараметрыТекста = Новый Структура();
	
	ПараметрыТекста.Вставить("НомерПротокола", ДанныеПротоколаРешения.Номер);
	ПараметрыТекста.Вставить("ДатаПротокола", Формат(ДанныеПротоколаРешения.Дата, "ДФ='dd MMMM yyyy ''г.'''"));
	
	ПараметрыТекста.Вставить("НаименованиеСокращенное", ДанныеОрганизации.НаименованиеСокращенное);
	ПараметрыТекста.Вставить("НаименованиеПолное", ДанныеОрганизации.НаименованиеПолное);
	
	ПараметрыТекста.Вставить("НаименованиеПолноеВРодительномПадеже", НаименованиеПолноеВРодительномПадеже(ДанныеОрганизации.НаименованиеПолное));
	
	ПараметрыТекста.Вставить("ЮрАдресОрганизации", ДанныеОрганизации.ЮридическийАдрес);
	
	Валюта = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьВалютуРегламентированногоУчета();
	УставныйКапиталСВалютой = ОбщегоНазначенияБПВызовСервера.ФорматСумм(ДанныеОрганизации.УставныйКапитал, Валюта);
	УставныйКапиталПрописью = ЧислоПрописью(ДанныеОрганизации.УставныйКапитал, "Л=ru", Валюта.ПараметрыПрописи);
	ПараметрыТекста.Вставить("УставныйКапитал", СтрШаблон("%1 (%2)", УставныйКапиталСВалютой, УставныйКапиталПрописью));
	
	ДолжностьДиректораСтрокой = Строка(ДанныеОрганизации.ДанныеОДолжностиРуководителя.Должность);
	
	ПараметрыТекста.Вставить("ДолжностьДиректора", Строка(ДолжностьДиректораСтрокой));
	ПараметрыТекста.Вставить("ДолжностьДиректораВРодительномПадеже", 
		СокрЛП(СклонениеПредставленийОбъектов.ПросклонятьПредставление(Строка(ДолжностьДиректораСтрокой), 2)));
	ПараметрыТекста.Вставить("ДолжностьДиректораВДательномПадеже", 
		СокрЛП(СклонениеПредставленийОбъектов.ПросклонятьПредставление(Строка(ДолжностьДиректораСтрокой), 3)));
	ПараметрыТекста.Вставить("ДолжностьДиректораВТворительномПадеже", 
		СокрЛП(СклонениеПредставленийОбъектов.ПросклонятьПредставление(Строка(ДолжностьДиректораСтрокой), 5)));
	
	ПараметрыТекста.Вставить("СрокПолномочийДиректораПрописью", СрокПолномочийПрописью(ДанныеОрганизации.ДанныеОДолжностиРуководителя.СрокПолномочий));
	
	ИмяМакета = ?(КоличествоУчредителей = 1, "УставЕдинственногоУчредителя", "УставОбщества");
	Макет = ПолучитьМакет(ИмяМакета);
	
	Текст = СтроковыеФункцииКлиентСервер.ВставитьПараметрыВСтроку(Макет.ПолучитьТекст(), ПараметрыТекста);
	
	ДокументРезультат = Новый ФорматированныйДокумент;
	ДокументРезультат.УстановитьHTML(Текст, Новый Структура());
	
	ШрифтТекстаУчредительныхДокументов = Новый Шрифт("Times New Roman", 12);
	
	Для Каждого Параграф Из ДокументРезультат.Элементы Цикл
		Параграф.МеждустрочныйИнтервал = 1.5;
		Для Каждого Элемент Из Параграф.Элементы Цикл
			Если ТипЗнч(Элемент) = Тип("ТекстФорматированногоДокумента") Тогда
				Элемент.Шрифт = ШрифтТекстаУчредительныхДокументов;
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;
	
	ИмяФайла = ПолучитьИмяВременногоФайла("rtf");
	ЭлектронноеВзаимодействиеБП.КонвертироватьВФорматRTF(ДокументРезультат, ИмяФайла);
	ДвоичныеДанные = Новый ДвоичныеДанные(ИмяФайла);
	АдресХранилища = ПоместитьВоВременноеХранилище(ДвоичныеДанные);
	УдалитьФайлы(ИмяФайла);
	
	Возврат АдресХранилища;
	
КонецФункции

#КонецОбласти

#Область ПротоколРешениеУчредителейООО

// Формирует печатную форму решения учредителей ООО в зависимости от переданного макета
//
Функция ПротоколРешениеУчредителейОООДляИзмененияРеквизитов(ДанныеПомощникаЗаполнения, ИмяМакета)
	
	ДанныеПечати = ДанныеПечатиПротоколаРешенияДляИзмененияРеквизитов(ДанныеПомощникаЗаполнения);
	
	ТекстHTML = ПолучитьМакет(ИмяМакета).ПолучитьТекст();
	
	ТекстHTML = СтроковыеФункцииКлиентСервер.ВставитьПараметрыВСтроку(ТекстHTML, ДанныеПечати.ПараметрыПечати);
	
	УдалитьБлокиHTML(ТекстHTML, ДанныеПечати.БлокиКУдалению);
	
	ПодставитьНомераПунктов(ТекстHTML, "[НомерПункта]");
	ПодставитьНомераПунктов(ТекстHTML, "[НомерПунктаПовестка]");
	ПодставитьНомераПунктовТекстом(ТекстHTML);
	
	ДокументРезультат = Новый ФорматированныйДокумент;
	ДокументРезультат.УстановитьHTML(ТекстHTML, Новый Структура());
	
	ИмяФайла = ПолучитьИмяВременногоФайла("rtf");
	ЭлектронноеВзаимодействиеБП.КонвертироватьВФорматRTF(ДокументРезультат, ИмяФайла);
	ДвоичныеДанные = Новый ДвоичныеДанные(ИмяФайла);
	Адрес = ПоместитьВоВременноеХранилище(ДвоичныеДанные);
	УдалитьФайлы(ИмяФайла);
	
	Возврат Адрес;
	
КонецФункции

Процедура УдалитьБлокиHTML(ТекстHTML, БлокиКУдалению)
	
	ЧтениеHTML = Новый ЧтениеHTML;
	ЧтениеHTML.УстановитьСтроку(ТекстHTML);
	
	ПостроительDOM = Новый ПостроительDOM;
	ДокументDOM = ПостроительDOM.Прочитать(ЧтениеHTML);
	
	ЧтениеHTML.Закрыть();
	
	Для Каждого БлокКУдалению Из БлокиКУдалению Цикл
		УдаляемыйБлок = ДокументDOM.ПолучитьЭлементПоИдентификатору(БлокКУдалению);
		Если УдаляемыйБлок <> Неопределено Тогда
			УдаляемыйБлок.РодительскийУзел.УдалитьДочерний(УдаляемыйБлок);
		КонецЕсли;
	КонецЦикла;
	
	ЗаписьHTML = Новый ЗаписьHTML;
	ЗаписьHTML.УстановитьСтроку();
	ЗаписьDOM = Новый ЗаписьDOM;
	ЗаписьDOM.Записать(ДокументDOM, ЗаписьHTML);
	
	ТекстHTML = ЗаписьHTML.Закрыть();
	
КонецПроцедуры

Процедура ПодставитьНомераПунктов(ТекстHTML, ТегНомерПункта)
	
	НомерПункта = 0;
	
	ПозицияНомераПункта = СтрНайти(ТекстHTML, ТегНомерПункта);
	Пока ПозицияНомераПункта <> 0 Цикл
		НомерПункта = НомерПункта + 1;
		ТекстHTML = Лев(ТекстHTML, ПозицияНомераПункта - 1)
			+ Формат(НомерПункта, "ЧДЦ=") 
			+ Сред(ТекстHTML, ПозицияНомераПункта + СтрДлина(ТегНомерПункта));
		
		ПозицияНомераПункта = СтрНайти(ТекстHTML, ТегНомерПункта);
	КонецЦикла;
	
	
КонецПроцедуры

Процедура ПодставитьНомераПунктовТекстом(ТекстHTML)
	
	НомерПункта = 0;
	
	ТегНомерПункта = "[НомерПунктаТекстом]";
	ПозицияНомераПункта = СтрНайти(ТекстHTML, ТегНомерПункта);
	Пока ПозицияНомераПункта <> 0 Цикл
		НомерПункта = НомерПункта + 1;
		ТекстHTML = Лев(ТекстHTML, ПозицияНомераПункта - 1)
			+ НомерПунктаТекстом(НомерПункта)
			+ Сред(ТекстHTML, ПозицияНомераПункта + СтрДлина(ТегНомерПункта));
		
		ПозицияНомераПункта = СтрНайти(ТекстHTML, ТегНомерПункта);
	КонецЦикла;
	
	
КонецПроцедуры

Функция НомерПунктаТекстом(НомерПункта)
	
	Если НомерПункта = 1 Тогда
		Возврат НСтр("ru='первому'");
	ИначеЕсли НомерПункта = 2 Тогда
		Возврат НСтр("ru='второму'");
	ИначеЕсли НомерПункта = 3 Тогда
		Возврат НСтр("ru='третьему'");
	ИначеЕсли НомерПункта = 4 Тогда
		Возврат НСтр("ru='четвертому'");
	ИначеЕсли НомерПункта = 5 Тогда
		Возврат НСтр("ru='пятому'");
	ИначеЕсли НомерПункта = 6 Тогда
		Возврат НСтр("ru='шестому'");
	ИначеЕсли НомерПункта = 7 Тогда
		Возврат НСтр("ru='седьмому'");
	ИначеЕсли НомерПункта = 8 Тогда
		Возврат НСтр("ru='восьмому'");
	ИначеЕсли НомерПункта = 9 Тогда
		Возврат НСтр("ru='девятому'");
	ИначеЕсли НомерПункта = 10 Тогда
		Возврат НСтр("ru='десятому'");
	ИначеЕсли НомерПункта = 11 Тогда
		Возврат НСтр("ru='одиннадцатому'");
	ИначеЕсли НомерПункта = 12 Тогда
		Возврат НСтр("ru='двенадцатому'");
	ИначеЕсли НомерПункта = 13 Тогда
		Возврат НСтр("ru='тринадцатому'");
	ИначеЕсли НомерПункта = 14 Тогда
		Возврат НСтр("ru='четырнадцатому'");
	ИначеЕсли НомерПункта = 15 Тогда
		Возврат НСтр("ru='пятнадцатому'");
	ИначеЕсли НомерПункта = 16 Тогда
		Возврат НСтр("ru='шестнадцатому'");
	ИначеЕсли НомерПункта = 17 Тогда
		Возврат НСтр("ru='семнадцатому'");
	ИначеЕсли НомерПункта = 18 Тогда
		Возврат НСтр("ru='восемнадцатому'");
	ИначеЕсли НомерПункта = 19 Тогда
		Возврат НСтр("ru='девятнадцатому'");
	ИначеЕсли НомерПункта = 20 Тогда
		Возврат НСтр("ru='двадцатому'");
	Иначе
		Возврат "";
	КонецЕсли;

КонецФункции 

Функция ДанныеПечатиПротоколаРешенияДляИзмененияРеквизитов(ДанныеПомощникаЗаполнения)
	
	ПараметрыПечати = Новый Структура;
	БлокиКУдалению  = Новый Массив;
	
	ЗаполнитьОбщиеДанныеДляИзмененияРеквизитов(ПараметрыПечати, ДанныеПомощникаЗаполнения.ДанныеОрганизации, ДанныеПомощникаЗаполнения.ДатаРешения);
	
	ЗаполнитьДанныеУчредителейДляИзмененияРеквизитов(ПараметрыПечати, ДанныеПомощникаЗаполнения.ДанныеОрганизации.Учредители);
	
	Если ДанныеПомощникаЗаполнения.Изменено.Руководитель Тогда
		ДанныеРуководителя = ДанныеПомощникаЗаполнения.ДанныеНовогоРуководителя;
		ДанныеОДолжностиРуководителя = ДанныеПомощникаЗаполнения.ДанныеОДолжностиНовогоРуководителя;
	Иначе
		ДанныеРуководителя = ДанныеПомощникаЗаполнения.ДанныеОрганизации.ДанныеРуководителя;
		ДанныеОДолжностиРуководителя = ДанныеПомощникаЗаполнения.ДанныеОрганизации.ДанныеОДолжностиРуководителя;
	КонецЕсли;
	ЗаполнитьДанныеРуководителяДляИзмененияРеквизитов(ПараметрыПечати, ДанныеРуководителя, ДанныеОДолжностиРуководителя);
	
	ЗаполнитьДанныеИзмененияРуководителя(ПараметрыПечати, БлокиКУдалению, ДанныеПомощникаЗаполнения);
	
	ЗаполнитьДанныеНаименованияДляИзмененияРеквизитов(ПараметрыПечати, БлокиКУдалению, ДанныеПомощникаЗаполнения);
	
	ЗаполнитьДанныеАдресаДляИзмененияРеквизитов(ПараметрыПечати, БлокиКУдалению, ДанныеПомощникаЗаполнения);
	
	ЗаполнитьДанныеИзмененияУчредителей(ПараметрыПечати, БлокиКУдалению, ДанныеПомощникаЗаполнения);
	
	ЗаполнитьДанныеИзмененияОсновногоОКВЭД(ПараметрыПечати, БлокиКУдалению, ДанныеПомощникаЗаполнения);
	
	ИзмененияВидовДеятельности = ИзмененияВидовДеятельности(ДанныеПомощникаЗаполнения);
	ЗаполнитьДанныеДобавленияДополнительныхОКВЭД(ПараметрыПечати, БлокиКУдалению, ИзмененияВидовДеятельности);
	ЗаполнитьДанныеИсключенияДополнительныхОКВЭД(ПараметрыПечати, БлокиКУдалению, ИзмененияВидовДеятельности);
	
	ЗаполнитьДанныеИзмененияУставаДляИзмененияРеквизитов(ПараметрыПечати, БлокиКУдалению, ДанныеПомощникаЗаполнения);
	
	ДанныеПечати = Новый Структура;
	ДанныеПечати.Вставить("ПараметрыПечати", ПараметрыПечати);
	ДанныеПечати.Вставить("БлокиКУДалению", БлокиКУдалению);
	Возврат ДанныеПечати;
	
КонецФункции

Функция ОписаниеУчастниковОбщества(Учредители)
	
	ОписаниеУчастников = "";
	Для Каждого Учредитель Из Учредители Цикл
		Если Учредитель.ЭтоЮридическоеЛицо Тогда
			НаименованиеУчредителя = Учредитель.СведенияОЮридическомЛице.ПолноеНаименование;
		Иначе
			НаименованиеУчредителя = Учредитель.СведенияОФизическомЛице.ФИОПолные;
		КонецЕсли;
		
		ОписаниеУчастников = ОписаниеУчастников + СтрШаблон(НСтр("ru = '<LI>%1.</LI>'"), НаименованиеУчредителя);
	КонецЦикла;
	
	Возврат ОписаниеУчастников;
	
КонецФункции

Процедура ЗаполнитьОбщиеДанныеДляИзмененияРеквизитов(ПараметрыПечати, ДанныеОрганизации, ДатаРешения)
	
	ПолноеНаименованиеОрганизацииВРодительномПадеже = СокрЛП(ДанныеОрганизации.НаименованиеПолное);
	СловоОбщество = НСтр("ru = 'Общество с ограниченной ответственностью'");
	Если Лев(ВРег(ПолноеНаименованиеОрганизацииВРодительномПадеже), СтрДлина(СловоОбщество)) = ВРег(СловоОбщество) Тогда
		ПолноеНаименованиеОрганизацииВРодительномПадеже = НСтр("ru = 'Общества с ограниченной ответственностью'")
			+ Сред(ПолноеНаименованиеОрганизацииВРодительномПадеже, СтрДлина(СловоОбщество) + 1);
	КонецЕсли;
	
	Город = УправлениеКонтактнойИнформациейБП.НаселенныйПунктПоАдресу(ДанныеОрганизации.ЮридическийАдресЗначениеJSON);
	
	ПараметрыПечати.Вставить("НаименованиеПолноеВРодительномПадеже", ПолноеНаименованиеОрганизацииВРодительномПадеже);
	ПараметрыПечати.Вставить("ДатаПроведения",                       Формат(ДатаРешения, "ДФ='dd MMMM yyyy ''г.'''"));
	ПараметрыПечати.Вставить("МестоПроведения",                      Город);
	
КонецПроцедуры

Процедура ЗаполнитьДанныеУчредителейДляИзмененияРеквизитов(ПараметрыПечати, Учредители)
	
	ДополнительныеСведенияОбУчредителях = Новый Соответствие;
	Для Каждого СтрокаТаблицы Из Учредители Цикл
		Если СтрокаТаблицы.ТипУчредителя = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо Тогда
			СведенияОбУчредителе = СведенияОбУчредителеЮридическомЛице(
				СтрокаТаблицы.Ссылка,
				СтрокаТаблицы.ПредставительУчредителя,
				СтрокаТаблицы.ДолжностьПредставителя,
				СтрокаТаблицы.ПредставительНаОсновании);
		Иначе
			СведенияОбУчредителе = СведенияОбУчредителеФизическомЛице(СтрокаТаблицы.Ссылка);
		КонецЕсли;
		ДополнительныеСведенияОбУчредителях.Вставить(СтрокаТаблицы.Ссылка, СведенияОбУчредителе);
	КонецЦикла;
	
	Если Учредители.Количество() = 1 Тогда
		СтрокаТаблицы = Учредители[0];
		ДанныеУчредителя = ДополнительныеСведенияОбУчредителях[СтрокаТаблицы.Ссылка];
		
		Если СтрокаТаблицы.ТипУчредителя = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо Тогда
			ПолноеНаименованиеОрганизацииВРодительномПадеже = СокрЛП(ДанныеУчредителя.ПолноеНаименование);
			СловоОбщество = НСтр("ru = 'Общество с ограниченной ответственностью'");
			Если Лев(ВРег(ПолноеНаименованиеОрганизацииВРодительномПадеже), СтрДлина(СловоОбщество)) = ВРег(СловоОбщество) Тогда
				ПолноеНаименованиеОрганизацииВРодительномПадеже = НСтр("ru = 'Общества с ограниченной ответственностью'")
					+ СРед(ПолноеНаименованиеОрганизацииВРодительномПадеже, СтрДлина(СловоОбщество) + 1);
			КонецЕсли;
			ПараметрыПечати.Вставить("НаименованиеУчредителяПолноеВРодительномПадеже", ПолноеНаименованиеОрганизацииВРодительномПадеже);
		Иначе
			ПараметрыПечати.Вставить("ФИОПолные",                    ДанныеУчредителя.ФИОПолные);
			ПараметрыПечати.Вставить("ФИОПолныеРодительныйПадеж",    ДанныеУчредителя.ФИОРодительныйПадеж);
			ПараметрыПечати.Вставить("ДокументПредставление",        ДанныеУчредителя.ДокументПредставление);
			ПараметрыПечати.Вставить("АдресПоПропискеПредставление", ДанныеУчредителя.АдресПрописки);
			ПараметрыПечати.Вставить("Принял",
				?(ДанныеУчредителя.Пол = Перечисления.ПолФизическогоЛица.Женский, НСтр("ru = 'приняла'"), НСтр("ru = 'принял'")));
		КонецЕсли;
		
	Иначе
		ПараметрыПечати.Вставить("ПредставлениеУчредителей", ПредставлениеУчредителейДляИзмененияРеквизитов(Учредители, ДополнительныеСведенияОбУчредителях));
		ПараметрыПечати.Вставить("ПодписиУчредителей", ПодписиУчредителейДляИзмененияРеквизитов(Учредители, ДополнительныеСведенияОбУчредителях));
		ПараметрыПечати.Вставить("РешениеГолосования", РешениеГолосованияДляПротоколаСобранияУчредителей());
	КонецЕсли;
	
КонецПроцедуры

Функция ПредставлениеУчредителейДляИзмененияРеквизитов(Учредители, ДополнительныеСведенияОбУчредителях)
	
	ПредставлениеУчредителей = "";
	Для Каждого СтрокаТаблицы Из Учредители Цикл
		
		Если СтрокаТаблицы.ТипУчредителя = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо Тогда
			Шаблон = "<LI><DIV align=left>[ПолноеНаименование], ОГРН: [ОГРН], ИНН: [ИНН], КПП: [КПП], адрес места нахождения: [ЮридическийАдрес]. "
				+ "Представитель: [ДолжностьПредставителя] [ФИОПолные], действует на основании [ПредставительНаОсновании]</DIV></LI>";
		Иначе
			Шаблон = "<LI><DIV align=left>Гражданин Российской Федерации [ФИОПолные], "
				+ "[ДокументПредставление], место регистрации: [АдресПрописки]</DIV></LI>";
		КонецЕсли;
		
		ДополнительныеСведения = ДополнительныеСведенияОбУчредителях[СтрокаТаблицы.Ссылка];
		
		ПараметрыУчредителя = НовыйПараметрыУчредителяДляПротокола();
		Если СтрокаТаблицы.ТипУчредителя = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо Тогда
			ЗаполнитьЗначенияСвойств(ПараметрыУчредителя, ДополнительныеСведения.Представитель);
		КонецЕсли;
		ЗаполнитьЗначенияСвойств(ПараметрыУчредителя, СтрокаТаблицы);
		ЗаполнитьЗначенияСвойств(ПараметрыУчредителя, ДополнительныеСведения);
		
		ПредставлениеУчредителей = ПредставлениеУчредителей
			+ СтроковыеФункцииКлиентСервер.ВставитьПараметрыВСтроку(Шаблон, ПараметрыУчредителя)
			+ Символы.ПС
			+ Символы.ПС;
	КонецЦикла;
	
	Возврат ПредставлениеУчредителей;
	
КонецФункции

Функция ПодписиУчредителейДляИзмененияРеквизитов(Учредители, ДополнительныеСведенияОбУчредителях)
	
	ПодписиУчредителей = "";
	
	Для Каждого СтрокаТаблицы Из Учредители Цикл
		
		Если СтрокаТаблицы.ТипУчредителя = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо Тогда
			Шаблон = "<BR>[ПолноеНаименование] <BR>Представитель:_____________________[ДолжностьПредставителя] [ФИОПолные]";
		Иначе
			Шаблон = "<BR>_____________________[ДолжностьПредставителя] [ФИОПолные]";
		КонецЕсли;
		
		ДополнительныеСведения = ДополнительныеСведенияОбУчредителях[СтрокаТаблицы.Ссылка];
		
		ПараметрыУчредителя = НовыйПараметрыУчредителяДляПротокола();
		Если СтрокаТаблицы.ТипУчредителя = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо Тогда
			ЗаполнитьЗначенияСвойств(ПараметрыУчредителя, ДополнительныеСведения.Представитель);
		КонецЕсли;
		ЗаполнитьЗначенияСвойств(ПараметрыУчредителя, СтрокаТаблицы);
		ЗаполнитьЗначенияСвойств(ПараметрыУчредителя, ДополнительныеСведения);
		
		ПодписиУчредителей = ПодписиУчредителей
			+ СтроковыеФункцииКлиентСервер.ВставитьПараметрыВСтроку(Шаблон, ПараметрыУчредителя)
			+ Символы.ПС
			+ Символы.ПС;
	КонецЦикла;
	
	Возврат ПодписиУчредителей;
	
КонецФункции

Функция РешениеГолосованияДляПротоколаСобранияУчредителей()
	
	Возврат "<P align=justify>Результаты голосования: ""За"" - единогласно, ""Против"" - нет, ""Воздержался"" - нет</P>
			|<P align=justify><STRONG>Решение принято единогласно.</STRONG></P>";
	
КонецФункции

Процедура ЗаполнитьДанныеРуководителяДляИзмененияРеквизитов(ПараметрыПечати, ДанныеРуководителя, ДанныеОДолжностиРуководителя)
	
	ПараметрыПечати.Вставить("ФИОРуководителяВРодительномПадеже", 
		СклонениеПредставленийОбъектов.ПросклонятьФИО(
			ФИО(ДанныеРуководителя.Фамилия, ДанныеРуководителя.Имя, ДанныеРуководителя.Отчество),
			2,
			ДанныеРуководителя.Ссылка,
			ПолДляСклонений(ДанныеРуководителя.Пол)));
	
	ПараметрыПечати.Вставить("ФИОРуководителяВВинительномПадеже", 
		СклонениеПредставленийОбъектов.ПросклонятьФИО(
			ФИО(ДанныеРуководителя.Фамилия, ДанныеРуководителя.Имя, ДанныеРуководителя.Отчество),
			4,
			ДанныеРуководителя.Ссылка,
			ПолДляСклонений(ДанныеРуководителя.Пол)));
	
КонецПроцедуры

Процедура ЗаполнитьДанныеИзмененияРуководителя(ПараметрыПечати, БлокиКУдалению, ДанныеПомощникаЗаполнения)
	
	Изменено = ДанныеПомощникаЗаполнения.Изменено;
	
	Если Изменено.Руководитель Тогда
		
		ДанныеРуководителя = ДанныеПомощникаЗаполнения.ДанныеОрганизации.ДанныеРуководителя;
		ДанныеОДолжностиРуководителя = ДанныеПомощникаЗаполнения.ДанныеОрганизации.ДанныеОДолжностиРуководителя;
		
		ПараметрыПечати.Вставить("ФИОСтарогоРуководителяВРодительномПадеже", 
			СклонениеПредставленийОбъектов.ПросклонятьФИО(
				ФИО(ДанныеРуководителя.Фамилия, ДанныеРуководителя.Имя, ДанныеРуководителя.Отчество),
				2,
				ДанныеРуководителя.Ссылка,
				ПолДляСклонений(ДанныеРуководителя.Пол)));
		
		ПараметрыПечати.Вставить("ФИОСтарогоРуководителяВВинительномПадеже", 
			СклонениеПредставленийОбъектов.ПросклонятьФИО(
				ФИО(ДанныеРуководителя.Фамилия, ДанныеРуководителя.Имя, ДанныеРуководителя.Отчество),
				4,
				ДанныеРуководителя.Ссылка,
				ПолДляСклонений(ДанныеРуководителя.Пол)));
		
		ПараметрыПечати.Вставить("ДолжностьСтарогоРуководителяРодительныйПадеж", 
			СклонениеПредставленийОбъектов.ПросклонятьПредставление(
				Строка(ДанныеОДолжностиРуководителя.Должность),
				2,
				ДанныеОДолжностиРуководителя.Должность));
		
		ДанныеНовогоРуководителя = ДанныеПомощникаЗаполнения.ДанныеНовогоРуководителя;
		ДанныеОДолжностиНовогоРуководителя = ДанныеПомощникаЗаполнения.ДанныеОДолжностиНовогоРуководителя;
		
		ПараметрыПечати.Вставить("ДокументРуководителя", СтрШаблон("Паспорт гражданина РФ, серия: %1, № %2, выдан: %3 %4 года, код подразделения %5",
			ДанныеНовогоРуководителя.ПаспортныеДанные.Серия,
			ДанныеНовогоРуководителя.ПаспортныеДанные.Номер,
			ДанныеНовогоРуководителя.ПаспортныеДанные.КемВыдан,
			Формат(ДанныеНовогоРуководителя.ПаспортныеДанные.ДатаВыдачи, "ДФ='дд ММММ гггг'"),
			ДанныеНовогоРуководителя.ПаспортныеДанные.КодПодразделения));
		
		ПараметрыПечати.Вставить("АдресРуководителя", ДанныеНовогоРуководителя.АдресПрописки);
		
		ПараметрыПечати.Вставить("ДолжностьРуководителяРодительныйПадеж", 
			СклонениеПредставленийОбъектов.ПросклонятьПредставление(
				Строка(ДанныеОДолжностиНовогоРуководителя.Должность),
				2,
				ДанныеОДолжностиНовогоРуководителя.Должность));
		
	Иначе
		БлокиКУдалению.Добавить("Руководитель");
		БлокиКУдалению.Добавить("ПовесткаРуководитель");
	КонецЕсли;
	
КонецПроцедуры

Процедура ЗаполнитьДанныеНаименованияДляИзмененияРеквизитов(ПараметрыПечати, БлокиКУдалению, ДанныеПомощникаЗаполнения)
	
	Изменено = ДанныеПомощникаЗаполнения.Изменено;
	
	Если Изменено.ПолноеНаименование Или Изменено.СокращенноеНаименование Тогда
		
		ОписаниеНаименований = Новый Массив;
		
		Если Изменено.ПолноеНаименование Тогда
			ОписаниеНаименований.Добавить(СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
				" " + НСтр("ru = 'полное наименование - %1'"),
				ДанныеПомощникаЗаполнения.НаименованиеПолноеНовое));
		КонецЕсли;
		
		Если Изменено.СокращенноеНаименование Тогда
			ОписаниеНаименований.Добавить(СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
				" " + НСтр("ru = 'сокращенное наименование - %1'"), 
				ДанныеПомощникаЗаполнения.НаименованиеСокращенноеНовое));
		КонецЕсли;
		
		ПараметрыПечати.Вставить("ОписаниеНовогоНаименования", СтрСоединить(ОписаниеНаименований, ","));
		
	Иначе
		БлокиКУдалению.Добавить("Наименование");
		БлокиКУдалению.Добавить("ПовесткаНаименование");
	КонецЕсли;
	
КонецПроцедуры

Процедура ЗаполнитьДанныеАдресаДляИзмененияРеквизитов(ПараметрыПечати, БлокиКУдалению, ДанныеПомощникаЗаполнения)
	
	Изменено = ДанныеПомощникаЗаполнения.Изменено;
	
	Если Изменено.ЮридическийАдрес Или Изменено.Местоположение Тогда
		
		ПараметрыПечати.Вставить("НовыйАдресОрганизации", ДанныеПомощникаЗаполнения.ЮридическийАдресНовый);
		
	Иначе
		
		БлокиКУдалению.Добавить("Адрес");
		БлокиКУдалению.Добавить("ПовесткаАдрес");
		
	КонецЕсли;
	
КонецПроцедуры

Процедура ЗаполнитьДанныеИзмененияУчредителей(ПараметрыПечати, БлокиКУдалению, ДанныеПомощникаЗаполнения)
	
	ВалютаРегламентированногоУчета = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьВалютуРегламентированногоУчета();
	
	Изменено = ДанныеПомощникаЗаполнения.Изменено;
	
	УставныйКапиталДоИзменения = ДанныеПомощникаЗаполнения.ДанныеОрганизации.УставныйКапитал;
	
	Если Изменено.УставныйКапитал Или Изменено.Учредители Тогда
		Учредители = ДанныеУчредителейДляЗаявлениеОВнесенииИзмененийЕГР(ДанныеПомощникаЗаполнения);
	КонецЕсли;
	
	Если Изменено.УставныйКапитал Тогда
		
		ПараметрыПечати.Вставить("УставныйКапиталДоИзменения", Формат(УставныйКапиталДоИзменения, "ЧДЦ=2; ЧГ=3,0"));
		ПараметрыПечати.Вставить("УставныйКапиталДоИзмененияПрописью",
			ЧислоПрописью(УставныйКапиталДоИзменения, "Л=ru", ВалютаРегламентированногоУчета.ПараметрыПрописи));
		
		ПараметрыПечати.Вставить("УставныйКапитал", ДанныеПомощникаЗаполнения.УставныйКапиталНовый);
		ПараметрыПечати.Вставить("УставныйКапиталПрописью",
			ЧислоПрописью(ДанныеПомощникаЗаполнения.УставныйКапиталНовый, "Л=ru", ВалютаРегламентированногоУчета.ПараметрыПрописи));
			
	КонецЕсли;
	
	// Есть увеличение уставного капитала.
	Если Изменено.УставныйКапитал И УставныйКапиталДоИзменения < ДанныеПомощникаЗаполнения.УставныйКапиталНовый Тогда
		ОписаниеИзмененияУставногоКапитала = ОписаниеИзмененияУставногоКапиталаДляИзмененияРеквизитов(Учредители);
		ПараметрыПечати.Вставить("ОписаниеИзмененияУставногоКапитала", ОписаниеИзмененияУставногоКапитала);
	Иначе
		БлокиКУдалению.Добавить("УвеличениеУставногоКапитала");
		БлокиКУдалению.Добавить("ПовесткаУвеличениеУставногоКапитала");
	КонецЕсли;
	
	// Есть уменьшение уставного капитала.
	Если Изменено.УставныйКапитал И ДанныеПомощникаЗаполнения.УставныйКапиталНовый < УставныйКапиталДоИзменения Тогда
		
		УставныйКапиталУменьшение = УставныйКапиталДоИзменения - ДанныеПомощникаЗаполнения.УставныйКапиталНовый;
		
		ПараметрыПечати.Вставить("УставныйКапиталУменьшение", Формат(УставныйКапиталУменьшение, "ЧДЦ=2; ЧГ=3,0"));
		ПараметрыПечати.Вставить("УставныйКапиталУменьшениеПрописью",
			ЧислоПрописью(УставныйКапиталУменьшение, "Л=ru", ВалютаРегламентированногоУчета.ПараметрыПрописи));
		
	Иначе
		БлокиКУдалению.Добавить("УменьшениеУставногоКапитала");
		БлокиКУдалению.Добавить("ПовесткаУменьшениеУставногоКапитала");
	КонецЕсли;
	
	Если Изменено.Учредители Тогда
		НовыеУчастники    = Учредители.Скопировать(Новый Структура("СуммаВзносаДоИзменения", 0));
		ВышедшиеУчастники = Учредители.Скопировать(Новый Структура("СуммаВзноса", 0));
	КонецЕсли;
	
	// Есть новые участники.
	Если Изменено.Учредители И НовыеУчастники.Количество() > 0 Тогда
		ПараметрыПечати.Вставить("ОписаниеВводаНовыхУчастников", ОписаниеВводаНовыхУчастников(НовыеУчастники));
		ПараметрыПечати.Вставить("ОписаниеНовыхУчастников",      ОписаниеУчастниковОбщества(НовыеУчастники));
		ПараметрыПечати.Вставить("ОписаниеДолейНовыхУчастников", ОписаниеДолейУставногоКапитала(НовыеУчастники));
	Иначе
		ПараметрыПечати.Вставить("ОписаниеВводаНовыхУчастников", "");
		
		БлокиКУдалению.Добавить("ПовесткаНовыеУчастникиОбщества");
		БлокиКУдалению.Добавить("НовыеУчастникиОбщества");
	КонецЕсли;
	
	// Есть вышедшие участники.
	Если Изменено.Учредители И ВышедшиеУчастники.Количество() > 0 Тогда
		ПараметрыПечати.Вставить("ОписаниеВышедшихУчастников", ОписаниеУчастниковОбщества(ВышедшиеУчастники));
	Иначе
		БлокиКУдалению.Добавить("ПовесткаВышедшиеУчастникиОбщества");
		БлокиКУдалению.Добавить("ВышедшиеУчастникиОбщества");
	КонецЕсли;
	
	// Если доля вышедших участников равна доле новых участников, то считаем, что это продажа доли.
	// Общество в таком случае ничего не выплачивает.
	Если Изменено.Учредители И НовыеУчастники.Количество() > 0 И ВышедшиеУчастники.Количество() > 0 
		И НовыеУчастники.Итог("СуммаВзноса") = ВышедшиеУчастники.Итог("СуммаВзносаДоИзменения") Тогда
		БлокиКУдалению.Добавить("ВыплатыБывшимУчастникиОбщества");
	КонецЕсли;
	
	// Есть перераспределение уставного капитала.
	Если (Изменено.УставныйКапитал Или Изменено.Учредители) И ИзмененыДолиУчастников(Учредители) Тогда
		ПараметрыПечати.Вставить("ОписаниеДолейУставногоКапитала", ОписаниеДолейУставногоКапитала(Учредители));
	Иначе
		БлокиКУдалению.Добавить("ПовесткаРаспределениеУставногоКапитала");
		БлокиКУдалению.Добавить("РаспределениеУставногоКапитала");
	КонецЕсли;
	
КонецПроцедуры

Процедура ЗаполнитьДанныеИзмененияОсновногоОКВЭД(ПараметрыПечати, БлокиКУдалению, ДанныеПомощникаЗаполнения)
	
	Изменено = ДанныеПомощникаЗаполнения.Изменено;
	
	Если Изменено.ОсновнойВидДеятельности Тогда
		
		ТаблицаВидовДеятельности = Справочники.Организации.КлассификаторОКВЭД2();
		
		ПараметрыПечати.Вставить("ОсновнойВидДеятельности",
			ОписаниеВидаДеятельности(ДанныеПомощникаЗаполнения.КодОКВЭД2Новый, ТаблицаВидовДеятельности));
		
	Иначе
		БлокиКУдалению.Добавить("ОсновнойВидДеятельности");
		БлокиКУдалению.Добавить("ПовесткаОсновнойВидДеятельности");
	КонецЕсли;
	
КонецПроцедуры

Процедура ЗаполнитьДанныеДобавленияДополнительныхОКВЭД(ПараметрыПечати, БлокиКУдалению, ИзмененияВидовДеятельности)
	
	Если ИзмененияВидовДеятельности.ДобавленныеКодыОКВЭД.Количество() > 0 Тогда
		ТаблицаВидовДеятельности = Справочники.Организации.КлассификаторОКВЭД2();
		ОписаниеНовыхВидовДеятельности = ОписаниеВидовДеятельности(ИзмененияВидовДеятельности.ДобавленныеКодыОКВЭД, ТаблицаВидовДеятельности);
		ПараметрыПечати.Вставить("ОписаниеНовыхВидовДеятельности", ОписаниеНовыхВидовДеятельности);
	Иначе
		БлокиКУдалению.Добавить("НовыеВидыДеятельности");
		БлокиКУдалению.Добавить("ПовесткаНовыеВидыДеятельности");
	КонецЕсли;
	
КонецПроцедуры

Процедура ЗаполнитьДанныеИсключенияДополнительныхОКВЭД(ПараметрыПечати, БлокиКУдалению, ИзмененияВидовДеятельности)
	
	Если ИзмененияВидовДеятельности.УдаленныеКодыОКВЭД.Количество() > 0 Тогда
		ТаблицаВидовДеятельности = Справочники.Организации.КлассификаторОКВЭД2();
		ОписаниеИсключенныхВидовДеятельности = ОписаниеВидовДеятельности(ИзмененияВидовДеятельности.УдаленныеКодыОКВЭД, ТаблицаВидовДеятельности);
		ПараметрыПечати.Вставить("ОписаниеИсключенныхВидовДеятельности", ОписаниеИсключенныхВидовДеятельности);
	Иначе
		БлокиКУдалению.Добавить("ИсключенныеВидыДеятельности");
		БлокиКУдалению.Добавить("ПовесткаИсключенныеВидыДеятельности");
	КонецЕсли;
	
КонецПроцедуры

Функция ИзмененияВидовДеятельности(ДанныеПомощникаЗаполнения)
	
	ИзмененияВидовДеятельности = Новый Структура("ДобавленныеКодыОКВЭД, УдаленныеКодыОКВЭД", Новый Массив, Новый Массив);
	
	Если ДанныеПомощникаЗаполнения.Изменено.ВидыДеятельности Тогда
		ДополнительныеКодыОКВЭД2Новые = СтрРазделить(ДанныеПомощникаЗаполнения.ДополнительныеКодыОКВЭД2Новые, ";", Ложь);
		ДополнительныеКодыОКВЭД2      = СтрРазделить(ДанныеПомощникаЗаполнения.ДанныеОрганизации.ДополнительныеКодыОКВЭД2, ";", Ложь);
		Для Каждого ДополнительныйКод Из ДополнительныеКодыОКВЭД2Новые Цикл
			Если ДополнительныеКодыОКВЭД2.Найти(ДополнительныйКод) = Неопределено Тогда
				ИзмененияВидовДеятельности.ДобавленныеКодыОКВЭД.Добавить(ДополнительныйКод);
			КонецЕсли;
		КонецЦикла;
		Для Каждого ДополнительныйКод Из ДополнительныеКодыОКВЭД2 Цикл
			Если ДополнительныеКодыОКВЭД2Новые.Найти(ДополнительныйКод) = Неопределено Тогда
				ИзмененияВидовДеятельности.УдаленныеКодыОКВЭД.Добавить(ДополнительныйКод);
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
	
	Возврат ИзмененияВидовДеятельности;
	
КонецФункции

Процедура ЗаполнитьДанныеИзмененияУставаДляИзмененияРеквизитов(ПараметрыПечати, БлокиКУдалению, ДанныеПомощникаЗаполнения)
	
	Если Не ДанныеПомощникаЗаполнения.ИзмененияВносятсяВУчредительныеДокументы Тогда
		
		БлокиКУдалению.Добавить("НоваяРедакцияУстава");
		БлокиКУдалению.Добавить("ПовесткаНоваяРедакцияУстава");
		
	КонецЕсли;
	
КонецПроцедуры

Функция ОписаниеИзмененияУставногоКапиталаДляИзмененияРеквизитов(Учредители)
	
	ОписанияИзмененийУставногоКапитала = Новый Массив;
	
	ВалютаРегламентированногоУчета = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьВалютуРегламентированногоУчета();
	
	Для Каждого Учредитель ИЗ Учредители Цикл
		
		ДополнительныйВзнос = Учредитель.СуммаВзноса - Учредитель.СуммаВзносаДоИзменения;
		
		Если ДополнительныйВзнос > 0 Тогда
			
			ОписаниеУчредителяРодительныйПадеж = ?(Учредитель.ЭтоЮридическоеЛицо,
				Учредитель.СведенияОЮридическомЛице.ПолноеНаименование,
				Учредитель.СведенияОФизическомЛице.ФИОРодительныйПадеж);
			
			ОписанияИзмененийУставногоКапитала.Добавить(СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
				" " + НСтр("ru = '%1 в виде денежных средств в размере %2 рублей (%3)'"),
				ОписаниеУчредителяРодительныйПадеж,
				Формат(ДополнительныйВзнос, "ЧДЦ=2; ЧГ=3,0"),
				ЧислоПрописью(ДополнительныйВзнос, "Л=ru", ВалютаРегламентированногоУчета.ПараметрыПрописи)));
			
		КонецЕсли;
		
	КонецЦикла;
	
	Если ОписанияИзмененийУставногоКапитала.Количество() = 0 Тогда
		Возврат "";
	ИначеЕсли ОписанияИзмененийУставногоКапитала.Количество() = 1 Тогда
		Возврат СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
			НСтр("ru = 'вклада %1.</P>
				|<P align=justify>Вклад в уставный капитал должен быть внесен в течение 5 дней со дня принятия данного решения.'"),
			СтрСоединить(ОписанияИзмененийУставногоКапитала, ","));
	Иначе
		Возврат СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
			НСтр("ru = 'вкладов:</P>
				|<P><UL><LI>%1</LI></UL></P><P></P>
				|<P align=justify>Вклады в уставный капитал должны быть внесены в течение 5 дней со дня принятия данного решения.'"),
			СтрСоединить(ОписанияИзмененийУставногоКапитала, "</LI><LI>"));
	КонецЕсли;
	
КонецФункции

Функция ОписаниеВводаНовыхУчастников(НовыеУчредители)
	
	ОписаниеУчредителей = "";
	Для Каждого Учредитель Из НовыеУчредители Цикл
		
		Если Учредитель.ЭтоЮридическоеЛицо Тогда
			ОписаниеУчредителя = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
				НСтр("ru = 'На основании поданного заявления ввести в состав участников Общества %1, ИНН %2, КПП %3, адрес места нахождения: %4.'"),
				Учредитель.СведенияОЮридическомЛице.ПолноеНаименование,
				Учредитель.СведенияОЮридическомЛице.ИНН,
				Учредитель.СведенияОЮридическомЛице.КПП,
				Учредитель.СведенияОЮридическомЛице.ЮридическийАдрес);
		Иначе
			ОписаниеУчредителя = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
				НСтр("ru = 'На основании поданного заявления ввести в состав участников Общества гражданина Российской Федерации %1, %2, место регистрации: %3.'"),
					Учредитель.СведенияОФизическомЛице.ФИОВинительныйПадеж,
					Учредитель.СведенияОФизическомЛице.ДокументПредставление,
					Учредитель.СведенияОФизическомЛице.АдресПрописки);
		КонецЕсли;
		
		ОписаниеУчредителей = ОписаниеУчредителей + СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
			НСтр("ru = '<DIV><P align=justify>[НомерПункта]. %1</P>
				|</DIV>'"),
				ОписаниеУчредителя);
	КонецЦикла;
	
	Возврат ОписаниеУчредителей;
	
КонецФункции

Функция ИзмененыДолиУчастников(Учредители)
	
	УчредителиИзменены = Ложь;
	Для Каждого Учредитель Из Учредители Цикл
		Если Учредитель.СуммаВзносаДоИзменения <> Учредитель.СуммаВзноса Тогда
			УчредителиИзменены = Истина;
		КонецЕсли;
	КонецЦикла;
	
	Возврат УчредителиИзменены;
	
КонецФункции

Функция ОписаниеВидовДеятельности(КодыОКВЭД2, ТаблицаОКВЭД)
	
	ОписаниеВидовДеятельности = "";
	
	Для Каждого КодОКВЭД2 ИЗ КодыОКВЭД2 Цикл
		
		ОписаниеВидовДеятельности = ОписаниеВидовДеятельности + 
			СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
				НСтр("ru = '<LI><DIV align=left>%1</DIV></LI>'"),
				ОписаниеВидаДеятельности(КодОКВЭД2, ТаблицаОКВЭД));
		
	КонецЦикла;
	
	Возврат ОписаниеВидовДеятельности;
	
КонецФункции

Функция ОписаниеВидаДеятельности(КодОКВЭД2, ТаблицаОКВЭД)
	
	ОписаниеОКВЭД = "";
	
	СтрокиКодаОКВЭД2 = ТаблицаОКВЭД.НайтиСтроки(Новый Структура("Код", КодОКВЭД2));
	Если СтрокиКодаОКВЭД2.Количество() > 0 Тогда
		ОписаниеОКВЭД = СтрокиКодаОКВЭД2[0].Наименование;
	КонецЕсли;
	
	Если ОписаниеОКВЭД = "" Тогда
		Возврат КодОКВЭД2;
	Иначе
		Возврат СтрШаблон("%1 - %2", КодОКВЭД2, ОписаниеОКВЭД);
	КонецЕсли;
	
КонецФункции

Функция ПолДляСклонений(Пол)
	
	Если Пол = Перечисления.ПолФизическогоЛица.Мужской Тогда
		Возврат 1;
	ИначеЕсли Пол = Перечисления.ПолФизическогоЛица.Женский Тогда
		Возврат 2;
	Иначе
		Возврат Неопределено;
	КонецЕсли;
	
КонецФункции

#КонецОбласти

#Область ИнструкцияПоРегистрации

Функция ИнструкцияРегистрацияИзмененийЕГРИП(ДанныеПомощникаЗаполнения, РеквизитыРегистрирующегоОргана)

	СпособыПодачиДокументов = РегистрацияОрганизацииКлиентСервер.СпособыПодачиДокументов();
	
	СпособПодачиДокументов = ДанныеПомощникаЗаполнения.СпособПодачиДокументов;
	
	ШаблонИнструкции = ПолучитьМакет("ИнструкцияРегистрацияИзмененийЕГРИП");
	Результат = Новый ТабличныйДокумент;
	Результат.ПолеСверху = 5;
	Результат.ПолеСлева  = 10;
	Результат.ПолеСправа = 10;
	
	// Выводим область "Заголовок".
	ОбластьЗаголовка = ШаблонИнструкции.ПолучитьОбласть("Заголовок");
	ТекстЗаголовка = НСтр("ru='Инструкция по внесению изменений ИП'");
	Если СпособПодачиДокументов = СпособыПодачиДокументов.ИФНСпредставитель Тогда
		ТекстЗаголовка = СтрШаблон("%1" + Символы.ПС + "%2",
			ТекстЗаголовка,
			НСтр("ru='через представителя'"));
	ИначеЕсли СпособПодачиДокументов = СпособыПодачиДокументов.Почта Тогда
		ТекстЗаголовка = СтрШаблон("%1" + Символы.ПС + "%2",
			ТекстЗаголовка,
			НСтр("ru='по почте'"));
	КонецЕсли;
	ОбластьЗаголовка.Параметры.Заголовок                    = ТекстЗаголовка;
	ОбластьЗаголовка.НижнийКолонтитул.Выводить              = Истина;
	ОбластьЗаголовка.НижнийКолонтитул.ТекстСлева            = ОбщегоНазначенияБП.ДомашняяСтраницаСервиса();
	ОбластьЗаголовка.НижнийКолонтитул.ТекстВЦентре          = ИмяПрограммы();
	ОбластьЗаголовка.НижнийКолонтитул.НачальнаяСтраница     = 1;
	ОбластьЗаголовка.НижнийКолонтитул.ВертикальноеПоложение = ВертикальноеПоложение.Центр;
	Результат.Вывести(ОбластьЗаголовка);
	
	НомерШага = 0;
	
	ПараметрыНомераШагов = Новый Структура;
	ПараметрыИнструкции = НовыеПараметрыИнструкцииВнесенияИзменений();
	ПараметрыИнструкции.СпособПодачиДокументов = СпособПодачиДокументов;
	ПараметрыИнструкции.РегистрацияЧерезМФЦ    = (СпособПодачиДокументов = СпособыПодачиДокументов.МФЦлично);
	ПараметрыИнструкции.ЕстьАдресИнспекции     = ЗначениеЗаполнено(РеквизитыРегистрирующегоОргана.Наименование);
	
	Если СпособПодачиДокументов = СпособыПодачиДокументов.ИФНСпредставитель
		Или СпособПодачиДокументов = СпособыПодачиДокументов.Почта Тогда
		// Выводим область "Сходите к нотариусу".
		Область = ПолучитьОбластьИнструкцииВнесенияИзменений("ЗаверениеКопийУНотариуса", ШаблонИнструкции, ПараметрыИнструкции);
		ПараметрыНомераШагов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
		Область.Параметры.Заполнить(ПараметрыНомераШагов);
		Результат.Вывести(Область);
	КонецЕсли;
	
	// Выводим область "Подготовка документов".
	Область = ПолучитьОбластьИнструкцииВнесенияИзменений("ПодготовкаДокументов", ШаблонИнструкции, ПараметрыИнструкции);
	ПараметрыНомераШагов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Область.Параметры.Заполнить(ПараметрыНомераШагов);
	Результат.Вывести(Область);
	
	// Выводим область "Подача документов".
	Область = ПолучитьОбластьИнструкцииВнесенияИзменений("ПодачаДокументов", ШаблонИнструкции, ПараметрыИнструкции);
	ПараметрыНомераШагов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Область.Параметры.Заполнить(ПараметрыНомераШагов);
	Если ПараметрыИнструкции.ЕстьАдресИнспекции И Не ПараметрыИнструкции.РегистрацияЧерезМФЦ Тогда
		Область.Параметры.НаименованиеФНС = РеквизитыРегистрирующегоОргана.Наименование;
		Область.Параметры.АдресФНС = РеквизитыРегистрирующегоОргана.Адрес;
		Область.Параметры.ТелефонФНС = РеквизитыРегистрирующегоОргана.Телефон;
	КонецЕсли;
	Результат.Вывести(Область);
	
	Если СпособПодачиДокументов = СпособыПодачиДокументов.ИФНСпредставитель Тогда
		Результат.ВывестиГоризонтальныйРазделительСтраниц();
	КонецЕсли;
	
	// Выводим область "Получение документов".
	Область = ПолучитьОбластьИнструкцииВнесенияИзменений("ПолучениеДокументов", ШаблонИнструкции, ПараметрыИнструкции);
	ПараметрыНомераШагов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Область.Параметры.Заполнить(ПараметрыНомераШагов);
	Результат.Вывести(Область);
	
	ИмяФайла = ПолучитьИмяВременногоФайла("pdf");
	Результат.Записать(ИмяФайла, ТипФайлаТабличногоДокумента.PDF);
	ДвоичныеДанные = Новый ДвоичныеДанные(ИмяФайла);
	Адрес = ПоместитьВоВременноеХранилище(ДвоичныеДанные);
	УдалитьФайлы(ИмяФайла);
	
	Возврат Адрес;
	
КонецФункции

Функция ИнструкцияРегистрацияИзмененийЕГРЮЛ(ДанныеПомощникаЗаполнения, РеквизитыРегистрирующегоОргана, РеквизитыПрежнегоРегистрирующегоОргана, ПлатежныеРеквизитыОплатаГоспошлины)
	
	Если ДанныеПомощникаЗаполнения.ИзмененияТребуютУведомления Тогда
		Инструкция = ИнструкцияРегистрацияИзмененийЕГРЮЛсУведомлением(ДанныеПомощникаЗаполнения, РеквизитыРегистрирующегоОргана, РеквизитыПрежнегоРегистрирующегоОргана, ПлатежныеРеквизитыОплатаГоспошлины);
	Иначе
		Инструкция = ИнструкцияРегистрацияИзмененийЕГРЮЛбезУведомления(ДанныеПомощникаЗаполнения, РеквизитыРегистрирующегоОргана, ПлатежныеРеквизитыОплатаГоспошлины);
	КонецЕсли;
	
	Возврат Инструкция;
	
КонецФункции

Функция ИнструкцияРегистрацияИзмененийЕГРЮЛсУведомлением(ДанныеПомощникаЗаполнения, РеквизитыРегистрирующегоОргана, РеквизитыПрежнегоРегистрирующегоОргана, ПлатежныеРеквизитыОплатаГоспошлины)
	
	СпособыПодачиДокументов = РегистрацияОрганизацииКлиентСервер.СпособыПодачиДокументов();
	
	СпособПодачиДокументов = ДанныеПомощникаЗаполнения.СпособПодачиДокументов;
	
	ПараметрыИнструкции = НовыеПараметрыИнструкцииВнесенияИзменений();
	ПараметрыИнструкции.СпособПодачиДокументов = СпособПодачиДокументов;
	ПараметрыИнструкции.РегистрацияЧерезМФЦ = (СпособПодачиДокументов = СпособыПодачиДокументов.МФЦлично);
	ПараметрыИнструкции.ЕстьАдресИнспекции = ЗначениеЗаполнено(РеквизитыРегистрирующегоОргана.Наименование);
	ПараметрыИнструкции.ЕстьАдресПрежнейИнспекции = ЗначениеЗаполнено(РеквизитыПрежнегоРегистрирующегоОргана.Наименование);
	ПараметрыИнструкции.ИзмененияТребуютУведомления = ДанныеПомощникаЗаполнения.ИзмененияТребуютУведомления;
	ПараметрыИнструкции.ИзмененияВносятсяВУчредительныеДокументы = ДанныеПомощникаЗаполнения.ИзмененияВносятсяВУчредительныеДокументы;
	ПараметрыИнструкции.НесколькоУчредителей = (ДанныеПомощникаЗаполнения.ДанныеОрганизации.Учредители.Количество() > 1);
	ПараметрыИнструкции.ЕстьПлатежныеРеквизиты = ЗначениеЗаполнено(ПлатежныеРеквизитыОплатаГоспошлины);
	
	Если ПараметрыИнструкции.НесколькоУчредителей Тогда
		ШаблонИнструкции = ПолучитьМакет("ИнструкцияРегистрацияИзмененийЕГРЮЛНесколькоУчредителейСменаМестоположения");
	Иначе
		ШаблонИнструкции = ПолучитьМакет("ИнструкцияРегистрацияИзмененийЕГРЮЛОдинУчредительСменаМестоположения");
	КонецЕсли;
	
	Результат = Новый ТабличныйДокумент;
	Результат.ПолеСверху = 5;
	Результат.ПолеСлева  = 10;
	Результат.ПолеСправа = 10;
	
	// Выводим область "Заголовок".
	ОбластьЗаголовка = ШаблонИнструкции.ПолучитьОбласть("Заголовок");
	ТекстЗаголовка = НСтр("ru='Инструкция по внесению изменений ООО'");
	Если СпособПодачиДокументов = СпособыПодачиДокументов.ИФНСпредставитель Тогда
		ТекстЗаголовка = СтрШаблон("%1" + Символы.ПС + "%2",
			ТекстЗаголовка,
			НСтр("ru='через представителя'"));
	ИначеЕсли СпособПодачиДокументов = СпособыПодачиДокументов.Почта Тогда
		ТекстЗаголовка = СтрШаблон("%1" + Символы.ПС + "%2",
			ТекстЗаголовка,
			НСтр("ru='по почте'"));
	КонецЕсли;
	ОбластьЗаголовка.Параметры.Заголовок                    = ТекстЗаголовка;
	ОбластьЗаголовка.НижнийКолонтитул.Выводить              = Истина;
	ОбластьЗаголовка.НижнийКолонтитул.ТекстСлева            = ОбщегоНазначенияБП.ДомашняяСтраницаСервиса();
	ОбластьЗаголовка.НижнийКолонтитул.ТекстВЦентре          = ИмяПрограммы();
	ОбластьЗаголовка.НижнийКолонтитул.НачальнаяСтраница     = 1;
	ОбластьЗаголовка.НижнийКолонтитул.ВертикальноеПоложение = ВертикальноеПоложение.Центр;
	
	Результат.Вывести(ОбластьЗаголовка);
	
	НомерШага = 0;
	
	// Выводим область "Собрание учредителей".
	Если ПараметрыИнструкции.НесколькоУчредителей Тогда
		Область = ПолучитьОбластьИнструкцииВнесенияИзменений("ПроведениеСобранияУчредителей", ШаблонИнструкции, ПараметрыИнструкции);
		ПараметрыНомераШагов = Новый Структура;
		ПараметрыНомераШагов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
		Область.Параметры.Заполнить(ПараметрыНомераШагов);
		Результат.Вывести(Область);
	КонецЕсли;

	// Выводим область "Сходите к нотариусу".
	Область = ПолучитьОбластьИнструкцииВнесенияИзменений("ЗаверениеЗаявленийУНотариуса", ШаблонИнструкции, ПараметрыИнструкции);
	ПараметрыНомераШагов = Новый Структура;
	ПараметрыНомераШагов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Если ПараметрыИнструкции.НесколькоУчредителей Тогда
		НомерПункта = 1; // Первый пункт в макете - Доверенность на руководителя.
	Иначе
		НомерПункта = 0;
	КонецЕсли;
	Если СпособПодачиДокументов = СпособыПодачиДокументов.ИФНСпредставитель Тогда
		ПараметрыНомераШагов.Вставить("НомерПунктаНотариальнаяДоверенность", УвеличитьЗначениеНаЕдиницу(НомерПункта));
	КонецЕсли;
	ПараметрыНомераШагов.Вставить("НомерПунктаЗаявлениеР14001", УвеличитьЗначениеНаЕдиницу(НомерПункта));
	ПараметрыНомераШагов.Вставить("НомерПунктаЗаявлениеР13001", УвеличитьЗначениеНаЕдиницу(НомерПункта));
	Область.Параметры.Заполнить(ПараметрыНомераШагов);
	Результат.Вывести(Область);
	
	// Выводим область "Подготовка документов".
	Область = ПолучитьОбластьИнструкцииВнесенияИзменений("ПодготовкаДокументов", ШаблонИнструкции, ПараметрыИнструкции);
	ПараметрыПодготовкаДокументов = Новый Структура;
	ПараметрыПодготовкаДокументов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	ПараметрыПодготовкаДокументов.Вставить("СуммаПошлины", СуммаПошлиныЗаВнесениеИзмененийВУчредительныеДокументы());
	
	НомерПункта = ?(ПараметрыИнструкции.НесколькоУчредителей, 1, 0);
	
	Если ПараметрыИнструкции.НесколькоУчредителей Тогда
		Если СпособПодачиДокументов = СпособыПодачиДокументов.ИФНСпредставитель Тогда
			ПараметрыПодготовкаДокументов.Вставить("НомерПунктаДокументУдостоверяющийЛичность", УвеличитьЗначениеНаЕдиницу(НомерПункта));
		КонецЕсли;
	ИначеЕсли СпособПодачиДокументов <> СпособыПодачиДокументов.Почта Тогда
		ПараметрыПодготовкаДокументов.Вставить("НомерПунктаДокументУдостоверяющийЛичность", УвеличитьЗначениеНаЕдиницу(НомерПункта));
	КонецЕсли;
	ПараметрыПодготовкаДокументов.Вставить("НомерПунктаРешение",   УвеличитьЗначениеНаЕдиницу(НомерПункта));
	ПараметрыПодготовкаДокументов.Вставить("НомерПунктаР14001",    УвеличитьЗначениеНаЕдиницу(НомерПункта));
	ПараметрыПодготовкаДокументов.Вставить("НомерПунктаР13001",    УвеличитьЗначениеНаЕдиницу(НомерПункта));
	ПараметрыПодготовкаДокументов.Вставить("НомерПунктаУстав",     УвеличитьЗначениеНаЕдиницу(НомерПункта));
	ПараметрыПодготовкаДокументов.Вставить("НомерПунктаКвитанция", УвеличитьЗначениеНаЕдиницу(НомерПункта));
	ПараметрыПодготовкаДокументов.Вставить("НомерПунктаАдрес",     УвеличитьЗначениеНаЕдиницу(НомерПункта));
	Если ПараметрыИнструкции.ЕстьПлатежныеРеквизиты Тогда
		Область.Параметры.Заполнить(ПлатежныеРеквизитыОплатаГоспошлины);
	КонецЕсли;
	
	Область.Параметры.Заполнить(ПараметрыПодготовкаДокументов);
	Результат.Вывести(Область);
	
	// Выводим область "Подача документов в прежнюю налоговую".
	Область = ПолучитьОбластьИнструкцииВнесенияИзменений("ПодачаДокументовВПрежнююНалоговую", ШаблонИнструкции, ПараметрыИнструкции);
	ПараметрыНомераШагов = Новый Структура;
	ПараметрыНомераШагов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Область.Параметры.Заполнить(ПараметрыНомераШагов);
	Если ПараметрыИнструкции.ЕстьАдресПрежнейИнспекции И Не ПараметрыИнструкции.РегистрацияЧерезМФЦ Тогда
		Область.Параметры.НаименованиеФНС = РеквизитыПрежнегоРегистрирующегоОргана.Наименование;
		Область.Параметры.АдресФНС = РеквизитыПрежнегоРегистрирующегоОргана.Адрес;
		Область.Параметры.ТелефонФНС = РеквизитыПрежнегоРегистрирующегоОргана.Телефон;
	КонецЕсли;
	Результат.Вывести(Область);
	
	// Выводим область "Получение документов".
	Область = ПолучитьОбластьИнструкцииВнесенияИзменений("ПолучениеДокументовИзПрежнейНалоговой", ШаблонИнструкции, ПараметрыИнструкции);
	ПараметрыНомераШагов = Новый Структура;
	ПараметрыНомераШагов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Область.Параметры.Заполнить(ПараметрыНомераШагов);
	Результат.Вывести(Область);
	
	// Выводим область "Ожидание".
	Область = ПолучитьОбластьИнструкцииВнесенияИзменений("Ожидание", ШаблонИнструкции, ПараметрыИнструкции);
	ПараметрыНомераШагов = Новый Структура;
	ПараметрыНомераШагов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Область.Параметры.Заполнить(ПараметрыНомераШагов);
	Результат.Вывести(Область);
	
	// Выводим область "Подача документов".
	Область = ПолучитьОбластьИнструкцииВнесенияИзменений("ПодачаДокументов", ШаблонИнструкции, ПараметрыИнструкции);
	ПараметрыНомераШагов = Новый Структура;
	ПараметрыНомераШагов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Область.Параметры.Заполнить(ПараметрыНомераШагов);
	Если ПараметрыИнструкции.ЕстьАдресИнспекции И Не ПараметрыИнструкции.РегистрацияЧерезМФЦ Тогда
		Область.Параметры.НаименованиеФНС = РеквизитыРегистрирующегоОргана.Наименование;
		Область.Параметры.АдресФНС = РеквизитыРегистрирующегоОргана.Адрес;
		Область.Параметры.ТелефонФНС = РеквизитыРегистрирующегоОргана.Телефон;
	КонецЕсли;
	Результат.Вывести(Область);
	
	// Выводим область "Получение документов".
	Область = ПолучитьОбластьИнструкцииВнесенияИзменений("ПолучениеДокументов", ШаблонИнструкции, ПараметрыИнструкции);
	ПараметрыНомераШагов = Новый Структура;
	ПараметрыНомераШагов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Область.Параметры.Заполнить(ПараметрыНомераШагов);
	Результат.Вывести(Область);
	
	ИмяФайла = ПолучитьИмяВременногоФайла("pdf");
	Результат.Записать(ИмяФайла, ТипФайлаТабличногоДокумента.PDF);
	ДвоичныеДанные = Новый ДвоичныеДанные(ИмяФайла);
	Адрес = ПоместитьВоВременноеХранилище(ДвоичныеДанные);
	УдалитьФайлы(ИмяФайла);
	
	Возврат Адрес;

КонецФункции

Функция ИнструкцияРегистрацияИзмененийЕГРЮЛбезУведомления(ДанныеПомощникаЗаполнения, РеквизитыРегистрирующегоОргана, ПлатежныеРеквизитыОплатаГоспошлины)
	
	СпособыПодачиДокументов = РегистрацияОрганизацииКлиентСервер.СпособыПодачиДокументов();
	
	СпособПодачиДокументов = ДанныеПомощникаЗаполнения.СпособПодачиДокументов;
	
	ПараметрыИнструкции = НовыеПараметрыИнструкцииВнесенияИзменений();
	ПараметрыИнструкции.СпособПодачиДокументов = СпособПодачиДокументов;
	ПараметрыИнструкции.РегистрацияЧерезМФЦ = (СпособПодачиДокументов = СпособыПодачиДокументов.МФЦлично);
	ПараметрыИнструкции.ЕстьАдресИнспекции = ЗначениеЗаполнено(РеквизитыРегистрирующегоОргана.Наименование);
	ПараметрыИнструкции.ИзмененияТребуютУведомления = ДанныеПомощникаЗаполнения.ИзмененияТребуютУведомления;
	ПараметрыИнструкции.ИзмененияВносятсяВУчредительныеДокументы = ДанныеПомощникаЗаполнения.ИзмененияВносятсяВУчредительныеДокументы;
	ПараметрыИнструкции.НесколькоУчредителей = (ДанныеПомощникаЗаполнения.ДанныеОрганизации.Учредители.Количество() > 1);
	ПараметрыИнструкции.ЕстьПлатежныеРеквизиты = ЗначениеЗаполнено(ПлатежныеРеквизитыОплатаГоспошлины);
	
	Если ПараметрыИнструкции.НесколькоУчредителей Тогда
		ШаблонИнструкции = ПолучитьМакет("ИнструкцияРегистрацияИзмененийЕГРЮЛНесколькоУчредителей");
	Иначе
		ШаблонИнструкции = ПолучитьМакет("ИнструкцияРегистрацияИзмененийЕГРЮЛОдинУчредитель");
	КонецЕсли;
	
	Результат = Новый ТабличныйДокумент;
	Результат.ПолеСверху = 5;
	Результат.ПолеСлева  = 10;
	Результат.ПолеСправа = 10;
	
	// Выводим область "Заголовок".
	ОбластьЗаголовка = ШаблонИнструкции.ПолучитьОбласть("Заголовок");
	ТекстЗаголовка = НСтр("ru='Инструкция по внесению изменений ООО'");
	Если СпособПодачиДокументов = СпособыПодачиДокументов.ИФНСпредставитель Тогда
		ТекстЗаголовка = СтрШаблон("%1" + Символы.ПС + "%2",
			ТекстЗаголовка,
			НСтр("ru='через представителя'"));
	ИначеЕсли СпособПодачиДокументов = СпособыПодачиДокументов.Почта Тогда
		ТекстЗаголовка = СтрШаблон("%1" + Символы.ПС + "%2",
			ТекстЗаголовка,
			НСтр("ru='по почте'"));
	КонецЕсли;
	ОбластьЗаголовка.Параметры.Заголовок                    = ТекстЗаголовка;
	ОбластьЗаголовка.НижнийКолонтитул.Выводить              = Истина;
	ОбластьЗаголовка.НижнийКолонтитул.ТекстСлева            = ОбщегоНазначенияБП.ДомашняяСтраницаСервиса();
	ОбластьЗаголовка.НижнийКолонтитул.ТекстВЦентре          = ИмяПрограммы();
	ОбластьЗаголовка.НижнийКолонтитул.НачальнаяСтраница     = 1;
	ОбластьЗаголовка.НижнийКолонтитул.ВертикальноеПоложение = ВертикальноеПоложение.Центр;
	
	Результат.Вывести(ОбластьЗаголовка);
	
	НомерШага = 0;
	
	// Выводим область "Собрание учредителей".
	Если ПараметрыИнструкции.НесколькоУчредителей Тогда
		Область = ПолучитьОбластьИнструкцииВнесенияИзменений("ПроведениеСобранияУчредителей", ШаблонИнструкции, ПараметрыИнструкции);
		ПараметрыНомераШагов = Новый Структура;
		ПараметрыНомераШагов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
		Область.Параметры.Заполнить(ПараметрыНомераШагов);
		Результат.Вывести(Область);
	КонецЕсли;
	
	// Выводим область "Сходите к нотариусу".
	Область = ПолучитьОбластьИнструкцииВнесенияИзменений("ЗаверениеЗаявленийУНотариуса", ШаблонИнструкции, ПараметрыИнструкции);
	ПараметрыНомераШагов = Новый Структура;
	ПараметрыНомераШагов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Если ПараметрыИнструкции.НесколькоУчредителей Тогда
		НомерПункта = 1; // Первый пункт в макете - Доверенность на руководителя.
	Иначе
		НомерПункта = 0;
	КонецЕсли;
	Если СпособПодачиДокументов = СпособыПодачиДокументов.ИФНСпредставитель Тогда
		ПараметрыНомераШагов.Вставить("НомерПунктаНотариальнаяДоверенность", УвеличитьЗначениеНаЕдиницу(НомерПункта));
	КонецЕсли;
	Если ПараметрыИнструкции.ИзмененияТребуютУведомления Тогда
		ПараметрыНомераШагов.Вставить("НомерПунктаЗаявлениеР14001", УвеличитьЗначениеНаЕдиницу(НомерПункта));
	КонецЕсли;
	Если ПараметрыИнструкции.ИзмененияВносятсяВУчредительныеДокументы Тогда
		ПараметрыНомераШагов.Вставить("НомерПунктаЗаявлениеР13001", УвеличитьЗначениеНаЕдиницу(НомерПункта));
	КонецЕсли;
	Область.Параметры.Заполнить(ПараметрыНомераШагов);
	Результат.Вывести(Область);
	
	Если ПараметрыИнструкции.ИзмененияВносятсяВУчредительныеДокументы Тогда
		Результат.ВывестиГоризонтальныйРазделительСтраниц();
	КонецЕсли;
	
	// Выводим область "Подготовка документов".
	Область = ПолучитьОбластьИнструкцииВнесенияИзменений("ПодготовкаДокументов", ШаблонИнструкции, ПараметрыИнструкции);
	ПараметрыПодготовкаДокументов = Новый Структура;
	ПараметрыПодготовкаДокументов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	ПараметрыПодготовкаДокументов.Вставить("СуммаПошлины", СуммаПошлиныЗаВнесениеИзмененийВУчредительныеДокументы());
	Если ПараметрыИнструкции.НесколькоУчредителей Тогда
		НомерПункта = 1; // Первый пункт в макете - Доверенность на руководителя.
	Иначе
		НомерПункта = 0;
	КонецЕсли;
	
	Если ПараметрыИнструкции.НесколькоУчредителей Тогда
		Если СпособПодачиДокументов = СпособыПодачиДокументов.ИФНСпредставитель Тогда
			ПараметрыПодготовкаДокументов.Вставить("НомерПунктаДокументУдостоверяющийЛичность", УвеличитьЗначениеНаЕдиницу(НомерПункта));
		КонецЕсли;
	ИначеЕсли СпособПодачиДокументов <> СпособыПодачиДокументов.Почта Тогда
		ПараметрыПодготовкаДокументов.Вставить("НомерПунктаДокументУдостоверяющийЛичность", УвеличитьЗначениеНаЕдиницу(НомерПункта));
	КонецЕсли;
	ПараметрыПодготовкаДокументов.Вставить("НомерПунктаРешение", УвеличитьЗначениеНаЕдиницу(НомерПункта));
	Если ПараметрыИнструкции.ИзмененияТребуютУведомления Тогда
		ПараметрыПодготовкаДокументов.Вставить("НомерПунктаР14001", УвеличитьЗначениеНаЕдиницу(НомерПункта));
	КонецЕсли;
	Если ПараметрыИнструкции.ИзмененияВносятсяВУчредительныеДокументы Тогда
		ПараметрыПодготовкаДокументов.Вставить("НомерПунктаР13001",    УвеличитьЗначениеНаЕдиницу(НомерПункта));
		ПараметрыПодготовкаДокументов.Вставить("НомерПунктаУстав",     УвеличитьЗначениеНаЕдиницу(НомерПункта));
		ПараметрыПодготовкаДокументов.Вставить("НомерПунктаКвитанция", УвеличитьЗначениеНаЕдиницу(НомерПункта));
		Если ПараметрыИнструкции.ЕстьПлатежныеРеквизиты Тогда
			Область.Параметры.Заполнить(ПлатежныеРеквизитыОплатаГоспошлины);
		КонецЕсли;
	КонецЕсли;
	
	Область.Параметры.Заполнить(ПараметрыПодготовкаДокументов);
	Результат.Вывести(Область);
	
	// Выводим область "Подача документов".
	Область = ПолучитьОбластьИнструкцииВнесенияИзменений("ПодачаДокументов", ШаблонИнструкции, ПараметрыИнструкции);
	ПараметрыНомераШагов = Новый Структура;
	ПараметрыНомераШагов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Область.Параметры.Заполнить(ПараметрыНомераШагов);
	Если ПараметрыИнструкции.ЕстьАдресИнспекции И Не ПараметрыИнструкции.РегистрацияЧерезМФЦ Тогда
		Область.Параметры.НаименованиеФНС = РеквизитыРегистрирующегоОргана.Наименование;
		Область.Параметры.АдресФНС = РеквизитыРегистрирующегоОргана.Адрес;
		Область.Параметры.ТелефонФНС = РеквизитыРегистрирующегоОргана.Телефон;
	КонецЕсли;
	Результат.Вывести(Область);
	
	// Выводим область "Получение документов".
	Область = ПолучитьОбластьИнструкцииВнесенияИзменений("ПолучениеДокументов", ШаблонИнструкции, ПараметрыИнструкции);
	ПараметрыНомераШагов = Новый Структура;
	ПараметрыНомераШагов.Вставить("НомерШага", УвеличитьЗначениеНаЕдиницу(НомерШага));
	Область.Параметры.Заполнить(ПараметрыНомераШагов);
	Результат.Вывести(Область);
	
	ИмяФайла = ПолучитьИмяВременногоФайла("pdf");
	Результат.Записать(ИмяФайла, ТипФайлаТабличногоДокумента.PDF);
	ДвоичныеДанные = Новый ДвоичныеДанные(ИмяФайла);
	Адрес = ПоместитьВоВременноеХранилище(ДвоичныеДанные);
	УдалитьФайлы(ИмяФайла);
	
	Возврат Адрес;
	
КонецФункции

Функция ПолучитьОбластьИнструкцииВнесенияИзменений(ИмяОбласти, Шаблон, Параметры)
	
	Область = Шаблон.ПолучитьОбласть(ИмяОбласти);
	
	// Удалим все вложенные области, которые не содержат в наименовании нужного способа регистрации.
	ВсегоОбластей = Область.Области.Количество();
	
	Для НомерОбласти = 1 По ВсегоОбластей Цикл
		
		ВложеннаяОбласть = Область.Области[ВсегоОбластей-НомерОбласти];
		
		Если ИмяОбласти = ВложеннаяОбласть.Имя Тогда
			
			Продолжить;
			
		ИначеЕсли ВложеннаяОбласть.Имя = "ПлатежныеРеквизиты" Тогда
			
			Если НЕ Параметры.ЕстьПлатежныеРеквизиты Тогда
				Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			КонецЕсли;
			
			
		ИначеЕсли ВложеннаяОбласть.Имя = "ПодтверждениеАдреса" Тогда
			
			Если НЕ Параметры.ЕстьСменаАдреса Тогда
				Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			КонецЕсли;
			
		ИначеЕсли ВложеннаяОбласть.Имя = "ЕстьАдресФНС" Тогда
			
			Если НЕ Параметры.ЕстьАдресИнспекции Или Параметры.РегистрацияЧерезМФЦ Тогда
				Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			КонецЕсли;
			
		ИначеЕсли ВложеннаяОбласть.Имя = "НетАдресаФНС" Тогда 
			
			Если Параметры.ЕстьАдресИнспекции Или Параметры.РегистрацияЧерезМФЦ Тогда
				Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			КонецЕсли;
			
		ИначеЕсли ВложеннаяОбласть.Имя = "ЕстьАдресПрежнейФНС" Тогда
			
			Если НЕ Параметры.ЕстьАдресПрежнейИнспекции Или Параметры.РегистрацияЧерезМФЦ Тогда
				Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			КонецЕсли;
			
		ИначеЕсли ВложеннаяОбласть.Имя = "НетАдресаПрежнейФНС" Тогда 
			
			Если Параметры.ЕстьАдресПрежнейИнспекции Или Параметры.РегистрацияЧерезМФЦ Тогда
				Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			КонецЕсли;
		
		ИначеЕсли ВложеннаяОбласть.Имя = "ОдинУчредительЮридическоеЛицо" Тогда
			
			Если НЕ Параметры.ОдинУчредительЮридическоеЛицо Тогда
				Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			КонецЕсли;
			
		ИначеЕсли СтрНайти(ВложеннаяОбласть.Имя, Параметры.СпособПодачиДокументов) = 0 Тогда
			
			Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			
		ИначеЕсли СтрЗаканчиваетсяНа(ВложеннаяОбласть.Имя, "Р13001") Тогда
			
			Если НЕ Параметры.ИзмененияВносятсяВУчредительныеДокументы Тогда
				Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			КонецЕсли;
			
		ИначеЕсли СтрЗаканчиваетсяНа(ВложеннаяОбласть.Имя, "Р14001") Тогда
			
			Если НЕ Параметры.ИзмененияТребуютУведомления Тогда
				Область.УдалитьОбласть(ВложеннаяОбласть, ТипСмещенияТабличногоДокумента.ПоГоризонтали);
			КонецЕсли;
			
		КонецЕсли;
		
	КонецЦикла;
	
	Возврат Область;
	
КонецФункции

Функция НовыеПараметрыИнструкцииВнесенияИзменений()
	
	Результат = Новый Структура;
	Результат.Вставить("СпособПодачиДокументов",                   "");
	Результат.Вставить("РегистрацияЧерезМФЦ",                      Ложь);
	Результат.Вставить("ЕстьАдресИнспекции",                       Ложь);
	Результат.Вставить("ЕстьАдресПрежнейИнспекции",                Ложь);
	Результат.Вставить("ИзмененияТребуютУведомления",              Ложь);
	Результат.Вставить("ИзмененияВносятсяВУчредительныеДокументы", Ложь);
	Результат.Вставить("ОдинУчредительЮридическоеЛицо",            Ложь);
	Результат.Вставить("НесколькоУчредителей",                     Ложь);
	Результат.Вставить("ЕстьПлатежныеРеквизиты",                   Ложь);
	Возврат Результат;
	
КонецФункции

#КонецОбласти

#Область ОбновлениеРеквизитовОрганизацииПоЗаявлению

// Функция проверяет наличие незавершенного процесса внесения изменений в ЕГР
// по статусам заявлений.
//
// Параметры:
//   Организация - СправочникСсылка.Организации - ссылка на организацию.
//
// Возвращаемое значение:
//   Булево - Истина, если есть незавершенный процесс внесения изменений в ЕГР.
//
Функция СостояниеВнесенияИзмененийЕГР(Организация) Экспорт
	
	Состояние = Новый Структура;
	Состояние.Вставить("Изменения", Ложь);
	Состояние.Вставить("Заявление", Ложь);
	Состояние.Вставить("Документы", Ложь);
	
	Если Не ЗначениеЗаполнено(Организация) Тогда
		Возврат Состояние;
	КонецЕсли;
	
	АктуальныеЗаявления = НайтиАктуальныеЗаявленияОВнесенииИзмененийЕГР(Организация);
	
	Если ЗначениеЗаполнено(АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийУчредительныеДокументы) Тогда
		СостояниеЗаявления = АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийУчредительныеДокументыСостояниеОтправки;
	ИначеЕсли ЗначениеЗаполнено(АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийЕГР) Тогда
		СостояниеЗаявления = АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийЕГРСостояниеОтправки;
	КонецЕсли;
	
	Если СостояниеЗаявления = Неопределено Тогда
		Возврат Состояние;
	КонецЕсли;
	
	Состояние.Заявление = (СостояниеЗаявления.Статус = ИнтерфейсыВзаимодействияБРОКлиентСервер.СтатусВРаботеСтрокой());
	Состояние.Документы = (СостояниеЗаявления.Статус = ИнтерфейсыВзаимодействияБРОКлиентСервер.СтатусПодготовленоСтрокой())
		Или (СостояниеЗаявления.Статус = ИнтерфейсыВзаимодействияБРОКлиентСервер.СтатусСданоСтрокой());
	Состояние.Изменения = Не (Состояние.Заявление Или Состояние.Документы);
	
	Возврат Состояние;
	
КонецФункции

// Процедура проверяет регистрацию изменений, указанных в актуальном заявлении, в ЕГРЮЛ/ЕГРИП
// и готовит данные для обновления реквизитов организации.
//
// Параметры:
//   Организация - СправочникСсылка.Организации - ссылка на организацию.
//   АдресРезультата - Строка - адрес куда будет помещен результат проверки - структура с ключами:
//      * ИзмененияВнесеныВЕГР - Булево - результат сравнения данных помощника с данными ЕГР
//      * ОжиданиеОтвета - Булево - выполняется длительная операция на веб-сервисе и необходим повторный вызов процедуры.
//      * ОбновляемыеРеквизиты - Структура - измененные реквизиты организации с новыми значениями.
//
Процедура ПодготовитьДанныеДляЗавершенияРегистрацииИзмененийЕГРВФоне(Организация, АдресРезультата) Экспорт
	
	Результат = Новый Структура;
	Результат.Вставить("ИзмененияВнесеныВЕГР", Ложь);
	Результат.Вставить("ОжиданиеОтвета", Ложь);
	Результат.Вставить("ДанныеПомощникаЗаполнения", Неопределено);
	
	Если Не ЗначениеЗаполнено(Организация) Тогда
		ПоместитьВоВременноеХранилище(Результат, АдресРезультата);
		Возврат;
	КонецЕсли;
	
	АктуальныеЗаявления = НайтиАктуальныеЗаявленияОВнесенииИзмененийЕГР(Организация);
	ДанныеПомощника = ДанныеПомощникаВнесенияИзмененийЕГР(АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийЕГР);
	Если ДанныеПомощника.Количество() = 0 И ЗначениеЗаполнено(АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийУчредительныеДокументы) Тогда
		ДанныеПомощника = ДанныеПомощникаВнесенияИзмененийЕГР(АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийУчредительныеДокументы);
	КонецЕсли;
	
	// В заявлении нет данных помощника, возможно оно заполнено вручную.
	Если ДанныеПомощника.Количество() = 0 Тогда
		ПоместитьВоВременноеХранилище(Результат, АдресРезультата);
		Возврат;
	КонецЕсли;
	
	// Контактная информация могла быть сохранена в старом формате, приведем поля контактной информации к новому формату.
	КонвертироватьКонтактнуюИнформациюПомощникаРегистрацииИзменений(ДанныеПомощника);
	
	Результат.ДанныеПомощникаЗаполнения = ДанныеПомощника;
	
	ОбщегоНазначенияКлиентСервер.ДополнитьСтруктуру(Результат, ИзмененияВнесеныВЕГР(ДанныеПомощника), Истина);
	
	// Если изменения зарегистрированы в реестре, сохраним результат сравнения, чтобы не вызывать лишний раз веб-сервис.
	Если Результат.ИзмененияВнесеныВЕГР Тогда
		ДанныеПомощника.Вставить("ИзмененияВнесеныВЕГР", Результат.ИзмененияВнесеныВЕГР);
		Если ЗначениеЗаполнено(АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийЕГР) Тогда
			СохранитьДанныеПомощникаЗаполнения(АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийЕГР, ДанныеПомощника);
			СтатусЗаявления = АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийЕГРСостояниеОтправки.Статус;
		КонецЕсли;
		Если ЗначениеЗаполнено(АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийУчредительныеДокументы) Тогда
			СохранитьДанныеПомощникаЗаполнения(АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийУчредительныеДокументы, ДанныеПомощника);
			СтатусЗаявления = АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийУчредительныеДокументыСостояниеОтправки.Статус;
		КонецЕсли;
		ЗаписатьСтатусЗаявленияОВнесенииИзмененийЕГР(АктуальныеЗаявления, СтатусЗаявления);
	КонецЕсли;
	
	ПоместитьВоВременноеХранилище(Результат, АдресРезультата);
	
КонецПроцедуры

// Процедура завершает процесс внесения изменений в ЕГР:
//   - устанавливает финальный статус у заявлений о внесении изменений,
//   - отражает в программе изменение состава учредителей и/или размера уставного капитала,
//   - записывает новые сведения в информационную базу, если ЭтоНачалоРаботы
//
// Параметры:
//   Организация - СправочникСсылка.Организации - ссылка на организацию.
//
Функция ЗавершитьВнесениеИзмененийЕГР(Организация, ДатаРегистрацииИзмененийЕГР) Экспорт
	
	АктуальныеЗаявления = НайтиАктуальныеЗаявленияОВнесенииИзмененийЕГР(Организация);
	
	ДанныеПомощника = ДанныеПомощникаВнесенияИзмененийЕГР(АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийЕГР);
	Если ДанныеПомощника.Количество() = 0 И ЗначениеЗаполнено(АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийУчредительныеДокументы) Тогда
		ДанныеПомощника = ДанныеПомощникаВнесенияИзмененийЕГР(АктуальныеЗаявления.ЗаявлениеОВнесенииИзмененийУчредительныеДокументы);
	КонецЕсли;
	
	НачатьТранзакцию();
	Попытка
		ЗаписатьИзменениеУставногоКапитала(ДанныеПомощника, ДатаРегистрацииИзмененийЕГР);
		
		ЗаписатьСтатусЗаявленияОВнесенииИзмененийЕГР(
			АктуальныеЗаявления, РегистрацияОрганизацииКлиентСервер.ФинальныйСтатусЗаявленияОВнесенииИзмененийЕГР());
		
		ЗафиксироватьТранзакцию();
	Исключение
		ОтменитьТранзакцию();
		
		ТекстОшибки = НСтр("ru = 'Не удалось обновить реквизиты организации:
			|%1'");
		
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю(СтрШаблон(ТекстОшибки, КраткоеПредставлениеОшибки(ИнформацияОбОшибке())));
		
		ОписаниеОшибки = СтрШаблон(ТекстОшибки, ПодробноеПредставлениеОшибки(ИнформацияОбОшибке()));
		
		ЗаписьЖурналаРегистрации(
			СобытиеЖурналаРегистрации(),
			УровеньЖурналаРегистрации.Ошибка,
			Метаданные.Справочники.Организации,
			,
			ОписаниеОшибки);
		
		Возврат Ложь;
	КонецПопытки;
	
	Возврат Истина;
	
КонецФункции

Функция ИзмененияВнесеныВЕГР(ДанныеПомощника)
	
	Результат = Новый Структура;
	Результат.Вставить("ИзмененияВнесеныВЕГР", Ложь);
	Результат.Вставить("ОжиданиеОтвета", Ложь);
	
	Если ТипЗнч(ДанныеПомощника) <> Тип("Структура") Тогда
		Возврат Результат;
	КонецЕсли;
	
	// Если ранее уже сравнили данные ЕГР с данными помощника, еще раз сравнивать не нужно.
	Если ДанныеПомощника.Свойство("ИзмененияВнесеныВЕГР")
		И ДанныеПомощника.ИзмененияВнесеныВЕГР Тогда
		Результат.ИзмененияВнесеныВЕГР = Истина;
		Возврат Результат;
	КонецЕсли;
	
	Изменено = Неопределено;
	Если Не ДанныеПомощника.Свойство("Изменено", Изменено) Тогда
		Возврат Результат;
	КонецЕсли;
	
	ЗапросДанныхЕГР = ОрганизацииФормыДляОтчетностиКлиентСервер.НовыйЗапросДанныхЕГР();
	ЗапросДанныхЕГР.ИНН = ДанныеПомощника.ДанныеОрганизации.ИНН;
	ЗапросДанныхЕГР.ЮридическоеФизическоеЛицо = ДанныеПомощника.ДанныеОрганизации.ЮридическоеФизическоеЛицо;
	ЗапросДанныхЕГР.ОбъектЗаполнен = Истина;
	ЗапросДанныхЕГР.ОтборОПФ = РегистрацияОрганизацииКлиентСервер.ПоддерживаемыеПравовыеФормы();
	
	ОтветДанныхЕГР = ОрганизацииФормыДляОтчетностиВызовСервера.ЗапроситьДанныеЕГР(ЗапросДанныхЕГР);
	Если Не ЭтоАдресВременногоХранилища(ОтветДанныхЕГР.АдресДанных) Тогда
		Возврат Результат;
	КонецЕсли;
	
	ДанныеЕГР = ПолучитьИзВременногоХранилища(ОтветДанныхЕГР.АдресДанных);
	Если ТипЗнч(ДанныеЕГР) <> Тип("Структура") Тогда
		Результат.ИзмененияВнесеныВЕГР = Ложь;
		Возврат Результат;
	КонецЕсли;
	
	Результат.ИзмененияВнесеныВЕГР = Истина;
	
	// Проверяем только те реквизиты, которые были изменены в помощнике.
	Если Изменено.СокращенноеНаименование Тогда
		Результат.ИзмененияВнесеныВЕГР = Результат.ИзмененияВнесеныВЕГР И ДанныеЕГР.Свойство("НаименованиеСокращенное")
			И (ВРег(ДанныеПомощника.НаименованиеСокращенноеНовое) = ВРег(ДанныеЕГР.НаименованиеСокращенное));
	КонецЕсли;
	
	Если Изменено.ПолноеНаименование Тогда
		Результат.ИзмененияВнесеныВЕГР = Результат.ИзмененияВнесеныВЕГР И ДанныеЕГР.Свойство("НаименованиеСокращенное")
			И (ВРег(ДанныеПомощника.НаименованиеПолноеНовое) = ВРег(ДанныеЕГР.НаименованиеПолное));
	КонецЕсли;
	
	Если Изменено.ЮридическийАдрес Или Изменено.Местоположение Тогда
		Результат.ИзмененияВнесеныВЕГР = Результат.ИзмененияВнесеныВЕГР
			И ДанныеЕГР.Свойство("ЮридическийАдрес")
			И УправлениеКонтактнойИнформациейБП.СравнитьАдреса(
				ДанныеПомощника.ЮридическийАдресНовыйЗначениеJSON, ДанныеЕГР.ЮридическийАдрес.КонтактнаяИнформация);
	КонецЕсли;
	
	Если Изменено.Руководитель Тогда
		ДанныеОДолжности = ДанныеПомощника.ДанныеОДолжностиНовогоРуководителя;
		Результат.ИзмененияВнесеныВЕГР = Результат.ИзмененияВнесеныВЕГР
			И ДанныеЕГР.Свойство("Руководитель")
			И ДанныеРуководителяСовпадают(ДанныеПомощника.ДанныеНовогоРуководителя, ДанныеЕГР.Руководитель)
			И ВРег(Строка(ДанныеОДолжности.Должность)) = ВРег(ДанныеЕГР.Руководитель.Должность);
	КонецЕсли;
	
	Если Изменено.ОсновнойВидДеятельности Тогда
		Результат.ИзмененияВнесеныВЕГР = Результат.ИзмененияВнесеныВЕГР
			И ДанныеЕГР.Свойство("КодОКВЭД")
			И (ДанныеПомощника.КодОКВЭД2Новый = ДанныеЕГР.КодОКВЭД);
	КонецЕсли;
	
	// Изменение основных сведений еще не внесено в ЕГР, проверять изменение учредителей и кодов ОКВЭД не требуется.
	Если Не Результат.ИзмененияВнесеныВЕГР Тогда
		Возврат Результат;
	КонецЕсли;
	
	// Данные об учредителях и дополнительных кодах ОКВЭД получаются отдельным запросом.
	ИнформацияОСвязях = Неопределено;
	Если Изменено.Учредители Или Изменено.УставныйКапитал Или Изменено.ВидыДеятельности Тогда
		АдресДанныхЕГР = ПоместитьВоВременноеХранилище(Неопределено);
		ПолучитьИнформациюОбУчредителяхИКодахОКВЭДВФоне(ДанныеПомощника.ДанныеОрганизации.ИНН, АдресДанныхЕГР);
		ИнформацияОСвязях = ПолучитьИзВременногоХранилища(АдресДанныхЕГР);
		
		Результат.ОжиданиеОтвета = ИнформацияОСвязях.ОжиданиеОтвета;
		Если Результат.ОжиданиеОтвета Тогда
			Возврат Результат;
		КонецЕсли;
	КонецЕсли;
	
	Если Изменено.Учредители Тогда
		Результат.ИзмененияВнесеныВЕГР = Результат.ИзмененияВнесеныВЕГР
			И ИнформацияОСвязях.Свойство("Учредители")
			И УчредителиСовпадают(ДанныеПомощника.УчредителиНовые, ИнформацияОСвязях.Учредители);
	КонецЕсли;
	
	Если Изменено.УставныйКапитал Тогда
		Результат.ИзмененияВнесеныВЕГР = Результат.ИзмененияВнесеныВЕГР
			И ИнформацияОСвязях.Свойство("УставныйКапитал")
			И (ДанныеПомощника.УставныйКапиталНовый = ИнформацияОСвязях.УставныйКапитал);
	КонецЕсли;
	
	Если Изменено.ВидыДеятельности Тогда
		Результат.ИзмененияВнесеныВЕГР = Результат.ИзмененияВнесеныВЕГР
			И ИнформацияОСвязях.Свойство("ВидыДеятельности")
			И ВидыДеятельностиСовпадают(ДанныеПомощника.ВидыДеятельностиНовые, ИнформацияОСвязях.ВидыДеятельности);
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции

Функция ДанныеРуководителяСовпадают(РуководительИзПомощника, РуководительИзЕГР)
	
	СравниваемыеПоля = Новый Массив;
	СравниваемыеПоля.Добавить("Фамилия");
	СравниваемыеПоля.Добавить("Имя");
	СравниваемыеПоля.Добавить("Отчество");
	СравниваемыеПоля.Добавить("ИНН");
	
	Для Каждого Поле Из СравниваемыеПоля Цикл
		ЗначениеИзПомощника = ОбщегоНазначенияКлиентСервер.СвойствоСтруктуры(РуководительИзПомощника, Поле);
		ЗначениеИзЕГР = ОбщегоНазначенияКлиентСервер.СвойствоСтруктуры(РуководительИзЕГР, Поле);
		Если ВРег(СокрЛП(ЗначениеИзПомощника)) <> ВРег(СокрЛП(ЗначениеИзЕГР)) Тогда
			Возврат Ложь;
		КонецЕсли;
	КонецЦикла;
	
	Возврат Истина;
	
КонецФункции

Функция УчредителиСовпадают(Знач УчредителиПомощника, Знач УчредителиЕГР)
	
	Если ТипЗнч(УчредителиПомощника) <> ТипЗнч(УчредителиЕГР) Тогда
		Возврат Ложь;
	КонецЕсли;
	
	Если УчредителиПомощника.Количество() <> УчредителиЕГР.Количество() Тогда
		Возврат Ложь;
	КонецЕсли;
	
	УчредителиЕГР.Колонки.Учредитель.Имя = "Наименование";
	УчредителиЕГР.Колонки.СуммаКапитала.Имя = "СуммаВзноса";
	
	// Приведем значения колонки "Наименование" в обеих таблицах к одному регистру.
	Для Каждого Учредитель Из УчредителиПомощника Цикл
		Учредитель.Наименование = ВРег(Учредитель.Наименование);
	КонецЦикла;
	
	Для Каждого Учредитель Из УчредителиЕГР Цикл
		Учредитель.Наименование = ВРег(Учредитель.Наименование);
	КонецЦикла;
	
	КолонкиСравнения = "Наименование,ИНН,СуммаВзноса";
	
	Возврат Не ОбщегоНазначения.КоллекцииИдентичны(УчредителиПомощника, УчредителиЕГР, КолонкиСравнения);
	
КонецФункции

Функция ВидыДеятельностиСовпадают(Знач ВидыДеятельностиПомощника, Знач ВидыДеятельностиЕГР)
	
	Если ТипЗнч(ВидыДеятельностиПомощника) <> ТипЗнч(ВидыДеятельностиЕГР) Тогда
		Возврат Ложь;
	КонецЕсли;
	
	СравниваемыеКолонки = "Код,ЭтоОКВЭД2";
	
	ВидыДеятельностиЕГР.Колонки.КодОКВЭД.Имя = "Код";
	
	Возврат ОбщегоНазначения.КоллекцииИдентичны(ВидыДеятельностиПомощника, ВидыДеятельностиЕГР, СравниваемыеКолонки);
	
КонецФункции

Процедура ЗаписатьИзменениеУставногоКапитала(ДанныеПомощника, ДатаРегистрацииИзмененийЕГР)
	
	Перем Изменено;
	
	Если Не ДанныеПомощника.Свойство("Изменено", Изменено) Тогда
		Возврат;
	КонецЕсли;
	
	Если Не (Изменено.Учредители Или Изменено.УставныйКапитал) Тогда
		Возврат;
	КонецЕсли;
	
	ДанныеОрганизации = ДанныеПомощника.ДанныеОрганизации;
	
	УставныйКапиталОбъект = Документы.ФормированиеУставногоКапитала.СоздатьДокумент();
	ЗаполнениеДокументов.Заполнить(УставныйКапиталОбъект);
	
	УставныйКапиталОбъект.Дата = ДатаРегистрацииИзмененийЕГР;
	
	УставныйКапиталОбъект.Организация = ДанныеОрганизации.Ссылка;
	УставныйКапиталОбъект.УставныйКапиталДоИзменения = ДанныеОрганизации.УставныйКапитал;
	
	Если ДанныеПомощника.УставныйКапиталНовый <> 0 Тогда
		УставныйКапиталОбъект.УставныйКапитал = ДанныеПомощника.УставныйКапиталНовый;
	Иначе
		УставныйКапиталОбъект.УставныйКапитал = ДанныеОрганизации.УставныйКапитал;
	КонецЕсли;
	
	УставныйКапиталОбъект.СпособРегистрации = ДанныеПомощника.СпособРегистрации;
	УставныйКапиталОбъект.СформированПомощникомРегистрации = Истина;
	УставныйКапиталОбъект.ИзменениеУставногоКапитала = Истина;
	
	УставныйКапиталОбъект.Учредители.Очистить();
	
	УчредителиДоИзменения = ДанныеОрганизации.Учредители.Скопировать();
	УчредителиДоИзменения.Колонки.Ссылка.Имя = "Учредитель";
	УчредителиДоИзменения.Колонки.СуммаВзноса.Имя = "СуммаВзносаДоИзменения";
	
	УставныйКапиталОбъект.Учредители.Загрузить(УчредителиДоИзменения);
	
	Если Изменено.Учредители Тогда
		
		Для Каждого Учредитель Из ДанныеПомощника.УчредителиНовые Цикл
			СтрокиУчредителя = УставныйКапиталОбъект.Учредители.НайтиСтроки(Новый Структура("Учредитель", Учредитель.Ссылка));
			Если СтрокиУчредителя.Количество() > 0 Тогда
				СтрокиУчредителя[0].СуммаВзноса = Учредитель.СуммаВзноса;
			Иначе
				СтрокаУчредителя = УставныйКапиталОбъект.Учредители.Добавить();
				ЗаполнитьЗначенияСвойств(СтрокаУчредителя, Учредитель);
				СтрокаУчредителя.Учредитель = Учредитель.Ссылка;
			КонецЕсли;
		КонецЦикла;
		
	Иначе
		
		// Учредители не изменились, скопируем сумму взноса до изменения в колонку сумма взноса после изменения.
		УставныйКапиталОбъект.Учредители.ЗагрузитьКолонку(
			УставныйКапиталОбъект.Учредители.ВыгрузитьКолонку("СуммаВзносаДоИзменения"), "СуммаВзноса");
		
	КонецЕсли;
	
	УставныйКапиталОбъект.Комментарий =  НСтр("ru='#Сформирован помощником регистрации'");
	
	УставныйКапиталОбъект.Записать(РежимЗаписиДокумента.Проведение);
	ДанныеПомощника.Вставить("ФормированиеУставногоКапитала", УставныйКапиталОбъект.Ссылка);
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

// Возвращает Истина, если сервис 1С:Контрагент подключен и доступен.
//
// Возвращаемое значение:
//   Булево
//
Функция ДоступенСервис1СКонтрагент() Экспорт
	
	Возврат РаботаСКонтрагентамиБП.Сервис1СКонтрагентПодключен();
	
КонецФункции

// Проверяет срок действия Российского паспорта
//
// Параметры:
//   ДатаВыдачи - Дата - дата выдачи
//   ДатаРождения - Дата - дата рождения
//   Причина - Строка - исходящий параметр - причина, по которой паспорт признан недействительным
//
// Возвращаемое значение:
//   Булево
//
Функция ПаспортДействителен(ДатаВыдачи, ДатаРождения = Неопределено, Причина = "") Экспорт
	
	Сегодня = ТекущаяДатаСеанса();
	Если Сегодня < ДатаВыдачи Тогда
		Причина = НСтр("ru = 'выдан позже текущей даты'");
		Возврат Ложь;
	КонецЕсли;
	
	Если ДатаРождения <> Неопределено Тогда
		Если ДатаВыдачи < ДатаРождения Тогда
			Причина = НСтр("ru = 'выдан раньше рождения'");
			Возврат Ложь;
		КонецЕсли;
		Возраст45 = ДобавитьМесяц(ДатаРождения, 12 * 45);
		Если ДатаВыдачи <= Возраст45 И Возраст45 <= Сегодня Тогда
			Причина = НСтр("ru = 'нарушен срок замены в 45 лет'");
			Возврат Ложь;
		КонецЕсли;
		Возраст20 = ДобавитьМесяц(ДатаРождения, 12 * 20);
		Если ДатаВыдачи <= Возраст20 И Возраст20 <= Сегодня Тогда
			Причина = НСтр("ru = 'нарушен срок замены в 20 лет'");
			Возврат Ложь;
		КонецЕсли;
	КонецЕсли;
	
	Возврат Истина;
	
КонецФункции

Функция КодыФормЗаявлений() Экспорт
	
	КодыФорм = Новый Структура;
	КодыФорм.Вставить("ЗаявлениеРегистрацииООО", "Р11001");
	КодыФорм.Вставить("ЗаявлениеРегистрацииИзмененийУчредительныхДокументов", "Р13001");
	КодыФорм.Вставить("ЗаявлениеРегистрацииИзмененийЕГРЮЛ", "Р14001");
	КодыФорм.Вставить("ЗаявлениеРегистрацииИП", "Р21001");
	КодыФорм.Вставить("ЗаявлениеРегистрацииИзмененийЕГРИП", "Р24001");
	
	Возврат КодыФорм;
	
КонецФункции

Функция ИменаФайлов() Экспорт
	
	ИменаФайлов = Новый Структура;
	ИменаФайлов.Вставить("Устав", НСтр("ru = 'Устав'"));
	ИменаФайлов.Вставить("РешениеЕдинственногоУчредителя", НСтр("ru = 'Решение единственного учредителя'"));
	ИменаФайлов.Вставить("ПротоколСобранияУчредителейЕдинственногоУчредителя", НСтр("ru = 'Образец протокола собрания учредителей'"));
	ИменаФайлов.Вставить("ПротоколСобранияУчредителей", НСтр("ru = 'Протокол собрания учредителей'"));
	ИменаФайлов.Вставить("КвитанцияНаОплатуГоспошлины", НСтр("ru = 'Квитанция на оплату госпошлины'"));
	ИменаФайлов.Вставить("ИнструкцияПоВнесениюИзмененийВЕГРИП", НСтр("ru = 'Инструкция по внесению изменений в ЕГРИП'"));
	ИменаФайлов.Вставить("ИнструкцияПоВнесениюИзмененийВЕГРЮЛ", НСтр("ru = 'Инструкция по внесению изменений в ЕГРЮЛ'"));
	
	Возврат ИменаФайлов;
	
КонецФункции

Функция ДанныеПомощникаВнесенияИзмененийЕГР(Заявление) Экспорт
	Перем ДанныеПомощникаЗаполнения;
	
	ДанныеУведомления = Заявление.ДанныеУведомления.Получить();
	Если ТипЗнч(ДанныеУведомления) = Тип("Структура")
		И ДанныеУведомления.Свойство("ДанныеПомощникаЗаполнения", ДанныеПомощникаЗаполнения) Тогда
		Возврат ДанныеПомощникаЗаполнения;
	Иначе
		Возврат Новый Структура;
	КонецЕсли;
	
КонецФункции

Функция ПрисоединенныйФайлЗаявленияПоИмени(Заявление, ИмяФайла) Экспорт
	
	НайденныеПрисоединенныеФайлы = ПрисоединенныеФайлыЗаявленияПоИмени(Заявление, Новый Структура("ИмяФайла", ИмяФайла));
	ФайлЗаявления = НайденныеПрисоединенныеФайлы.Найти(ИмяФайла, "Наименование");
	
	Если ЗначениеЗаполнено(ФайлЗаявления) Тогда
		Возврат ФайлЗаявления.Ссылка;
	Иначе
		Возврат Неопределено;
	КонецЕсли;
	
КонецФункции

Функция ПрисоединенныеФайлыЗаявленияПоИмени(Заявление, ИменаФайлов)
	
	Файлы = Новый Массив;
	РаботаСФайлами.ЗаполнитьПрисоединенныеФайлыКОбъекту(Заявление, Файлы);
	
	МассивИмен = Новый Массив;
	Для Каждого КлючИЗначение Из ИменаФайлов Цикл
		МассивИмен.Добавить(КлючИЗначение.Значение);
	КонецЦикла;
	
	Запрос = Новый Запрос();
	Запрос.Параметры.Вставить("ПрисоединенныеФайлы", Файлы);
	Запрос.Параметры.Вставить("МассивИмен", МассивИмен);
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ПрисоединенныеФайлы.Ссылка,
	|	ПрисоединенныеФайлы.Наименование
	|ИЗ
	|	Справочник.УведомлениеОСпецрежимахНалогообложенияПрисоединенныеФайлы КАК ПрисоединенныеФайлы
	|ГДЕ
	|	ПрисоединенныеФайлы.Ссылка В(&ПрисоединенныеФайлы)
	|	И ПрисоединенныеФайлы.Наименование В(&МассивИмен)
	|	И НЕ ПрисоединенныеФайлы.ПометкаУдаления";
	
	ТаблицаПоименованныхСсылок = Запрос.Выполнить().Выгрузить();
	ТаблицаПоименованныхСсылок.Индексы.Добавить("Наименование");
	
	Возврат ТаблицаПоименованныхСсылок;
	
КонецФункции

Функция ИспользуетсяСервисРегистрации() Экспорт
	
	Возврат ПолучитьФункциональнуюОпцию("ИспользоватьСервисРегистрации") И СервисРегистрацииДоступен();
	
КонецФункции

Функция СервисРегистрацииДоступен()
	
	Возврат ОбщегоНазначения.РазделениеВключено() Или РежимОтладкиСервисаРегистрации();
	
КонецФункции

Функция СервисУзнатьИННДоступен() Экспорт
	
	Возврат ОбщегоНазначения.РазделениеВключено() Или РежимОтладкиСервисаРегистрации();
	
КонецФункции

Функция СервисКвитанцияНаОплатуГоспошлиныДоступен() Экспорт
	
	Возврат ОбщегоНазначения.РазделениеВключено() Или РежимОтладкиСервисаРегистрации();
	
КонецФункции

Функция РежимОтладкиСервисаРегистрации()
	
	Если ОбщегоНазначенияКлиентСервер.РежимОтладки() Тогда
		ПараметрЗапускаПриложения = ПараметрыСеанса.ПараметрыКлиентаНаСервере.Получить("ПараметрЗапуска");
		Возврат СтрНайти(ВРег(ПараметрЗапускаПриложения), "СЕРВИСРЕГИСТРАЦИИ") > 0;
	КонецЕсли;
	
	Возврат Ложь;
	
КонецФункции

Процедура КонвертироватьКонтактнуюИнформациюПомощникаРегистрацииИзменений(ДанныеПомощника) Экспорт
	
	Если ДанныеПомощника.Свойство("ЮридическийАдресНовыйЗначенияПолей") Тогда
		АдресJSON = УправлениеКонтактнойИнформацией.КонтактнаяИнформацияВJSON(
			ДанныеПомощника.ЮридическийАдресНовыйЗначенияПолей);
		
		ДанныеПомощника.Вставить("ЮридическийАдресНовыйЗначениеJSON", АдресJSON);
		ДанныеПомощника.Удалить("ЮридическийАдресНовыйЗначенияПолей");
	КонецЕсли;
	
	ДанныеОрганизации = ДанныеПомощника.ДанныеОрганизации;
	
	Если ДанныеОрганизации.Свойство("ЮридическийАдресЗначенияПолей") Тогда
		АдресJSON = УправлениеКонтактнойИнформацией.КонтактнаяИнформацияВJSON(ДанныеОрганизации.ЮридическийАдресЗначенияПолей);
		
		ДанныеОрганизации.Вставить("ЮридическийАдресЗначениеJSON", АдресJSON);
		ДанныеОрганизации.Удалить("ЮридическийАдресЗначенияПолей");
	КонецЕсли;
	
	КонвертироватьКонтактнуюИнформациюФизическогоЛица(ДанныеОрганизации); // для ИП
	
	Если ДанныеОрганизации.Свойство("ДанныеРуководителя") Тогда
		КонвертироватьКонтактнуюИнформациюФизическогоЛица(ДанныеОрганизации.ДанныеРуководителя);
	КонецЕсли;
	
	Если ДанныеПомощника.Свойство("ДанныеНовогоРуководителя") Тогда
		КонвертироватьКонтактнуюИнформациюФизическогоЛица(ДанныеПомощника.ДанныеНовогоРуководителя);
	КонецЕсли;
	
	Если ДанныеПомощника.Свойство("ДанныеЗаявителя") Тогда
		КонвертироватьКонтактнуюИнформациюФизическогоЛица(ДанныеПомощника.ДанныеЗаявителя);
	КонецЕсли;
	
КонецПроцедуры

Процедура КонвертироватьКонтактнуюИнформациюФизическогоЛица(ДанныеФизическогоЛица)
	
	Если ДанныеФизическогоЛица.Свойство("АдресПропискиЗначенияПолей") Тогда
		АдресJSON = УправлениеКонтактнойИнформацией.КонтактнаяИнформацияВJSON(ДанныеФизическогоЛица.АдресПропискиЗначенияПолей);
		
		ДанныеФизическогоЛица.Вставить("АдресПропискиЗначениеJSON", АдресJSON);
		ДанныеФизическогоЛица.Удалить("АдресПропискиЗначенияПолей");
	КонецЕсли;
	
	Если ДанныеФизическогоЛица.Свойство("ТелефонРабочийЗначенияПолей") Тогда
		ТелефонJSON = УправлениеКонтактнойИнформацией.КонтактнаяИнформацияВJSON(ДанныеФизическогоЛица.ТелефонРабочийЗначенияПолей);
		
		ДанныеФизическогоЛица.Вставить("ТелефонРабочийЗначениеJSON", ТелефонJSON);
		ДанныеФизическогоЛица.Удалить("ТелефонРабочийЗначенияПолей");
	КонецЕсли;
	
	Если ДанныеФизическогоЛица.Свойство("EMailЗначенияПолей") Тогда
		EMailJSON = УправлениеКонтактнойИнформацией.КонтактнаяИнформацияВJSON(ДанныеФизическогоЛица.EMailЗначенияПолей);
		
		ДанныеФизическогоЛица.Вставить("EMailЗначениеJSON", EMailJSON);
		ДанныеФизическогоЛица.Удалить("EMailЗначенияПолей");
	КонецЕсли;
	
КонецПроцедуры

Функция КБКНалогаПоСпособуПодачиДокументов(СпособПодачиДокументов) Экспорт
	
	СпособыПодачиДокументов = РегистрацияОрганизацииКлиентСервер.СпособыПодачиДокументов();
	
	Налог = Справочники.ВидыНалоговИПлатежейВБюджет.НалогПоВиду(
			Перечисления.ВидыНалогов.Госпошлина_ГосрегистрацияОрганизаций, Истина);
	Если СпособПодачиДокументов = СпособыПодачиДокументов.МФЦлично Тогда
		КБК = Справочники.ВидыНалоговИПлатежейВБюджет.КБК(
			Налог, Перечисления.ВидыПлатежейВГосБюджет.ГосрегистрацияОрганизацийЧерезМФЦ);
	Иначе
		КБК = Справочники.ВидыНалоговИПлатежейВБюджет.КБК(Налог, Перечисления.ВидыПлатежейВГосБюджет.Налог);
	КонецЕсли;
	
	Возврат КБК;
	
КонецФункции

Функция ПараметрыЗаявлениеНаПолучениеПатента(ПараметрыВыполнения, Организация)
	
	ДанныеПомощникаРегистрации = Обработки.РегистрацияОрганизации.ДанныеПомощникаРегистрации();
	
	РеквизитыПатента = Неопределено;
	Если НЕ ПараметрыВыполнения.ЗаявлениеПатент
		ИЛИ (НЕ ДанныеПомощникаРегистрации.Свойство("Патент", РеквизитыПатента)
		ИЛИ РеквизитыПатента.Свойство("ПропуститьШаг") И РеквизитыПатента.ПропуститьШаг = Истина) Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	СтруктураРезультат = Новый Структура;
	
	Для Каждого ТекРеквизит Из РеквизитыПатента Цикл
		СтруктураРезультат.Вставить(ТекРеквизит.Ключ, ТекРеквизит.Значение);
	КонецЦикла;
	
	СтруктураРезультат.Вставить("Организация", Организация);
	СтруктураРезультат.Вставить("ДатаСоставления", ПараметрыВыполнения.ДатаСоставления);
	СтруктураРезультат.Вставить("Представитель", ПараметрыВыполнения.Представитель);
	СтруктураРезультат.Вставить("ДокументПредставителя", ПараметрыВыполнения.ДокументПредставителя);
	
	Возврат СтруктураРезультат;
	
КонецФункции

#КонецОбласти

#КонецЕсли