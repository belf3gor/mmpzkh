
&НаСервере
Процедура ВыполнитьУстановкуДолейНаСервере()
	// Вставить содержимое обработчика.
ТекстОтбора = "";
Запрос = Новый Запрос;
Запрос.Текст = "ВЫБРАТЬ
	|	КВП_РазмерыДолейЛицевыхСчетов.ЛицевойСчет КАК ЛицевойСчет,
	|	КВП_РазмерыДолейЛицевыхСчетов.Объект КАК ОбъектЛС,
	|	КВП_РазмерыДолейЛицевыхСчетов.Период КАК Период
	|ИЗ
	|	 РегистрСведений.КВП_РазмерыДолейЛицевыхСчетов.СрезПоследних(&Дата)
	|   			КАК КВП_РазмерыДолейЛицевыхСчетов";
	Запрос.УстановитьПараметр("Дата", КонецДня(Объект.Дата));
	Выборка=Запрос.Выполнить().Выбрать();
	
	Пока  Выборка.Следующий() Цикл
		УстановитьДоли(Выборка.ОбъектЛС.ссылка, Выборка.ЛицевойСчет.ссылка, Выборка.Период);
    КонецЦикла;

	
	
			
КонецПроцедуры
Процедура УстановитьДоли(ОбъектЛС, ЛицСчет, ПериодДоли)

	МенеджерЗаписи = РегистрыСведений.КВП_РазмерыДолейЛицевыхСчетов.СоздатьМенеджерЗаписи();
	МенеджерЗаписи.Объект = ОбъектЛС;
	МенеджерЗаписи.ЛицевойСчет = ЛицСчет;
	МенеджерЗаписи.Период = ПериодДоли;
	МенеджерЗаписи.ДоляЧислитель = 1;
	МенеджерЗаписи.ДоляЗнаменатель = 1;			
	МенеджерЗаписи.Записать(); 
КонецПроцедуры

&НаКлиентеНаСервереБезКонтекста
// Процедура управляет элементами формы.
Процедура УправлениеФормой(Форма)
	
	Объект = Форма.Объект;
КонецПроцедуры


	

&НаКлиенте
Процедура ВыполнитьУстановкуДолей(Команда)
	УправлениеФормой(ЭтотОбъект);
	ВыполнитьУстановкуДолейНаСервере();
КонецПроцедуры
