#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Возвращает развернутое соответствие остатков дней и сроков событий
//
Функция СрокиПоДням() Экспорт
	
	СрокиПоДням = Новый Соответствие;
	
	ГраницыСроков = ГраницыСроков();
	
	СрокСобытия = Неопределено;
	
	ВГраницаДиапазона = ВерхняяГраница();
	
	Для День = 0 По ВГраницаДиапазона Цикл
		
		НайденныйСрок = ГраницыСроков.Получить(День);
		Если НайденныйСрок <> Неопределено Тогда
			СрокСобытия = НайденныйСрок;
		КонецЕсли;
		
		СрокиПоДням.Вставить(День, СрокСобытия);
		
	КонецЦикла;
	
	Возврат СрокиПоДням;
	
КонецФункции

Функция ВерхняяГраница() Экспорт
	
	Возврат 35;
	
КонецФункции

Функция Порядок(ОтносительныйСрок, Срок) Экспорт
	
	Если ОтносительныйСрок = Сегодня Тогда
		Возврат 0;
	ИначеЕсли ОтносительныйСрок = Завтра Тогда
		Возврат 1;
	ИначеЕсли ОтносительныйСрок = НесколькоДней Тогда
		Возврат Срок;
	ИначеЕсли ОтносительныйСрок = Неделя Тогда
		Возврат 7;
	ИначеЕсли ОтносительныйСрок = ДвеНедели Тогда
		Возврат 14;
	ИначеЕсли ОтносительныйСрок = ТриНедели Тогда
		Возврат 21;
	ИначеЕсли ОтносительныйСрок = Месяц Тогда
		Возврат 31;
	ИначеЕсли ОтносительныйСрок = Просрочено Тогда
		Возврат -1;
	КонецЕсли
	
КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Функция ГраницыСроков()
	
	ГраницыСроков = Новый Соответствие;
	
	ГраницыСроков.Вставить(0,  Сегодня);
	ГраницыСроков.Вставить(1,  Завтра);
	ГраницыСроков.Вставить(2,  НесколькоДней);
	ГраницыСроков.Вставить(7,  Неделя);
	ГраницыСроков.Вставить(14, ДвеНедели);
	ГраницыСроков.Вставить(19, ТриНедели);
	ГраницыСроков.Вставить(23, Месяц);
	
	ГраницыСроков.Вставить(ВерхняяГраница(), ПустаяСсылка());
	
	Возврат Новый ФиксированноеСоответствие(ГраницыСроков);
	
КонецФункции

#КонецОбласти

#КонецЕсли
