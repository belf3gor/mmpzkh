
#Область СлужебныеПроцедуры

// Выполнение обработки.
Процедура ВыполнитьОбработку(АдресХранилища, РазмерБумаги) Экспорт
	
	ДокументРезультат = Новый ТабличныйДокумент();
	
	Отчет = Отчеты.КВП_ФормыРегистрационногоУчета.Создать();
	
	Отчет.Дата = УПЖКХ_ТиповыеМетодыКлиентСервер.ПолучитьРабочуюДату();
	
	Отчет.РазмерБумаги = РазмерБумаги;
	
	Для Каждого СтрокаТаблицы Из СписокПроживающих Цикл
		
		Если СтрокаТаблицы.Проживающий.Пустая() Тогда
			УПЖКХ_ТиповыеМетодыКлиентСервер.СообщитьОбОшибке("Не заполнена строка №" + СтрокаТаблицы.НомерСтроки + ".");
			Продолжить;
		КонецЕсли;

		Если Не СтрокаТаблицы.Вид = Перечисления.КВП_ВидыАдресов.Выбытие
		   И Не СтрокаТаблицы.Вид = Перечисления.КВП_ВидыАдресов.Прибытие Тогда
			УПЖКХ_ТиповыеМетодыКлиентСервер.СообщитьОбОшибке(
				"Не выбран вид адреса в строке №" + СтрокаТаблицы.НомерСтроки + ".");
			Продолжить;
		КонецЕсли;
		
		Если СтрокаТаблицы.Количество < 1 Тогда
			Продолжить;
		КонецЕсли;
		
		ДокументАдресныйЛисток = Новый ТабличныйДокумент();
		ДокументАдресныйЛисток.ИмяПараметровПечати = "КВП_ПечатьАдресныхЛистков_АдресныйЛисток";

		СтрокаТч = Отчет.ТаблицаДляПечати.Добавить();
		
		Если СтрокаТаблицы.Вид = Перечисления.КВП_ВидыАдресов.Прибытие Тогда
			СтрокаТч.НомерФормы = "Ф2";
		Иначе	
			СтрокаТч.НомерФормы = "Ф7";
		КонецЕсли;
		
		СтрокаТч.Проживающий = СтрокаТаблицы.Проживающий;
		
	КонецЦикла;
	
	Отчет.ВыводитьОборотнуюСторонуСправа = ВыводитьОборотнуюСторонуСправа;
	Отчет.ОбновитьОтчет(ДокументРезультат);
	
	Если Отчет.РазмерБумаги = Перечисления.КВП_РазмерБумаги.А5 Тогда
		ДокументРезультат.ОриентацияСтраницы = ОриентацияСтраницы.Ландшафт;
	Иначе
		ДокументРезультат.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	КонецЕсли;
	
	ПоместитьВоВременноеХранилище(ДокументРезультат, АдресХранилища);

КонецПроцедуры

#КонецОбласти
