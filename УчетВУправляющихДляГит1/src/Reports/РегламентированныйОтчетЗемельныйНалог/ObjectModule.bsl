#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныеПроцедурыИФункции

Процедура РассчитатьПоказателиРеглОтчета(ПараметрыРасчета, Данные) Экспорт
	
	Если ВРег(СокрЛП(ПараметрыРасчета.ИмяРаздела)) = ВРег("Раздел2") Тогда
		
		Если ВРег(СокрЛП(ПараметрыРасчета.ИмяФормы)) = ВРег("ФормаОтчета2018Кв3")
			ИЛИ ВРег(СокрЛП(ПараметрыРасчета.ИмяФормы)) = ВРег("ФормаОтчета2018Кв1") Тогда
			
			ИменаРасчПоказателей = Новый Массив;
			ИменаРасчПоказателей.Добавить("П000020011003");
			ИменаРасчПоказателей.Добавить("П000020014003");
			ИменаРасчПоказателей.Добавить("П000020015003");
			ИменаРасчПоказателей.Добавить("П000020017003");
			ИменаРасчПоказателей.Добавить("П000020019003");
			ИменаРасчПоказателей.Добавить("П000020021003");
			ИменаРасчПоказателей.Добавить("П000020023003");
			ИменаРасчПоказателей.Добавить("П000020025003");
			
			Стр170 = 0;
			Для каждого Пок Из Данные Цикл
				Если ИменаРасчПоказателей.Найти(Пок.Ключ) = Неопределено И ЗначениеЗаполнено(Пок.Значение) Тогда
					Стр170 = 1;
					Прервать;
				КонецЕсли;
			КонецЦикла;
			
			Стр130 = Данные["П000020013003"];
			Стр160 = Данные["П000020016003"];
			Если Стр130 > 0 И Стр160 > 0 Тогда
				Стр170 = Окр(Макс(Стр130 - Стр160, 0) / Стр130, 4);
			КонецЕсли;
			
			Данные.Вставить("П000020017003", Стр170);
			
			// Стр. 110.
			//
			Стр050 = РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Данные["П000020005003"]);
			
			Строка060_Числ = 1;
			Строка060_Знам = 1;
			Если ЗначениеЗаполнено(Данные["П000020006003_Числ"]) И ЗначениеЗаполнено(Данные["П000020006003_Знам"]) Тогда
				Строка060_Числ = Данные["П000020006003_Числ"];
				Строка060_Знам = Данные["П000020006003_Знам"];
			КонецЕсли;
			
			Стр080 = РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Данные["П000020008003"]);
			
			ЗаполненаСтр100 = Ложь;
			Строка100_Числ = 1;
			Строка100_Знам = 1;
			Если ЗначениеЗаполнено(Данные["П000020010003_Числ"]) И ЗначениеЗаполнено(Данные["П000020010003_Знам"]) Тогда
				Строка100_Числ = Данные["П000020010003_Числ"];
				Строка100_Знам = Данные["П000020010003_Знам"];
				ЗаполненаСтр100 = Истина;
			КонецЕсли;
			
			Стр170 = Данные["П000020017003"];
			
			ОсноваДляРасчетаСтр110 = Стр050 * Строка060_Числ / Строка060_Знам;
			ОсноваДляРасчетаСтр110_Окр
			= РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, ОсноваДляРасчетаСтр110);
			
			Стр110 = ОсноваДляРасчетаСтр110;
			Если Стр080 > 0 Тогда
				Стр110 = Макс(ОсноваДляРасчетаСтр110_Окр - Стр080, 0);
			ИначеЕсли ЗаполненаСтр100 Тогда
				Стр110 = Макс(ОсноваДляРасчетаСтр110_Окр - РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(
				ПараметрыРасчета, ОсноваДляРасчетаСтр110 * (Строка100_Числ * (1 - Стр170) / Строка100_Знам)), 0);
			КонецЕсли;
			
			Данные.Вставить("П000020011003",
			РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Стр110));
			
			// Стр. 140.
			//
			Данные.Вставить("П000020014003", Окр(Стр130 / 12, 4));
			
			// Стр. 150.
			//
			Стр040 = СокрЛП(Данные["П000020004003"]);
			Стр110 = РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Данные["П000020011003"]);
			Стр120 = Данные["П000020012003"];
			Стр140 = Данные["П000020014003"];
			Стр145 = Данные["П000020014503"];
			Стр145 = ?(Стр145 = 0, 1, Стр145);
			
			ОсноваДляРасчетаСтр150 = Стр110 * Стр120 * Стр140 * Стр145 / 100;
			
			Если Стр040 = "1" Тогда
				Стр150 = ОсноваДляРасчетаСтр150 * 2;
			ИначеЕсли Стр040 = "2" Тогда
				Стр150 = ОсноваДляРасчетаСтр150 * 4;
			Иначе
				Стр150 = ОсноваДляРасчетаСтр150;
			КонецЕсли;
			
			Данные.Вставить("П000020015003",
			РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Стр150));
			
			// Стр. 190.
			//
			Стр190 = 0;
			КодЛьготы = СокрЛП(Данные["П000020018003_КодЛьготы"]);
			
			Если ЗначениеЗаполнено(КодЛьготы) Тогда
				Стр150 = РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(
				ПараметрыРасчета, Данные["П000020015003"]);
				Стр170 = Данные["П000020017003"];
				Стр190 = Стр150 * (1 - Стр170);
			КонецЕсли;
			
			Данные.Вставить("П000020019003",
			РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Стр190));
			
			// Стр. 210.
			//
			Стр210 = 0;
			КодЛьготы = СокрЛП(Данные["П000020020003"]);
			
			Если ЗначениеЗаполнено(КодЛьготы) Тогда
				Стр150 = РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(
				ПараметрыРасчета, Данные["П000020015003"]);
				Стр170 = Данные["П000020017003"];
				Стр210 = Стр150 * (1 - Стр170);
			КонецЕсли;
			
			Данные.Вставить("П000020021003",
			РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Стр210));
			
			// Стр. 230.
			//
			КодЛьготы = СокрЛП(Данные["П000020022003_КодЛьготы"]);
			Стр220_Процент = Данные["П000020022003_Процент"];
			
			Если ЗначениеЗаполнено(КодЛьготы) Тогда
				Если Стр220_Процент > 0 Тогда
					Стр150 = РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(
					ПараметрыРасчета, Данные["П000020015003"]);
					Стр230 = Стр150 * Стр220_Процент / 100;
					Данные.Вставить("П000020023003",
					РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Стр230));
				Иначе
					// Случай, когда стр. 230 не авторассчитывается (предусмотрен режим ввода значения вручную).
				КонецЕсли;
			Иначе
				Данные.Вставить("П000020023003", 0);
			КонецЕсли;
			
			Если ВРег(СокрЛП(ПараметрыРасчета.ИмяФормы)) = ВРег("ФормаОтчета2018Кв3") Тогда
				
				// Стр. 245.
				//
				КодЛьготы = СокрЛП(Данные["П000020024003_КодЛьготы"]);
				Стр240_ПониженнаяСтавка = Данные["П000020024003_ПониженнаяСтавка"];
				Если ЗначениеЗаполнено(КодЛьготы) Тогда
					Если Стр240_ПониженнаяСтавка > 0 Тогда
						Стр040 = СокрЛП(Данные["П000020004003"]);
						Стр110 = РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(
						ПараметрыРасчета, Данные["П000020011003"]);
						Стр120 = Данные["П000020012003"];
						Стр140 = Данные["П000020014003"];
						Стр145 = Данные["П000020014503"];
						Стр145 = ?(Стр145 = 0, 1, Стр145);
						ОсноваДляРасчетаСтр245 = Стр110 * Макс((Стр120 - Стр240_ПониженнаяСтавка), 0) * Стр140 * Стр145 / 100;
						Если Стр040 = "1" Тогда
							Стр245 = ОсноваДляРасчетаСтр245 * 2;
						ИначеЕсли Стр040 = "2" Тогда
							Стр245 = ОсноваДляРасчетаСтр245 * 4;
						Иначе
							Стр245 = ОсноваДляРасчетаСтр245;
						КонецЕсли;
						Данные.Вставить("П000020024503",
						РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Стр245));
					Иначе
						// Для ячейки с показателем стр. 245 установлен режим ввода значения вручную.
					КонецЕсли;
				Иначе
					Данные.Вставить("П000020024503", 0);
				КонецЕсли;
				
				// Стр. 250.
				//
				Стр150 = РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Данные["П000020015003"]);
				Стр190 = РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Данные["П000020019003"]);
				Стр210 = РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Данные["П000020021003"]);
				Стр230 = РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Данные["П000020023003"]);
				Стр245 = РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Данные["П000020024503"]);
				
				Стр250 = Стр150;
				Если Стр190 > 0 Тогда
					Стр250 = Стр150 - Стр190;
				ИначеЕсли Стр210 > 0 Тогда
					Стр250 = Стр150 - Стр210;
				ИначеЕсли Стр230 > 0 Тогда
					Стр250 = Стр150 - Стр230;
				ИначеЕсли Стр245 > 0 Тогда
					Стр250 = Стр150 - Стр245;
				КонецЕсли;
				
				Данные.Вставить("П000020025003", Макс(Стр250, 0));
				
			Иначе // "ФормаОтчета2018Кв1"
				
				// Стр. 250.
				//
				Стр150 = РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Данные["П000020015003"]);
				Стр190 = РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Данные["П000020019003"]);
				Стр210 = РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Данные["П000020021003"]);
				Стр230 = РегламентированнаяОтчетностьКлиентСервер.ОкруглитьЧислоПоФормату(ПараметрыРасчета, Данные["П000020023003"]);
				Стр240 = СокрЛП(Данные["П000020024003_КодЛьготы"]);
				
				Стр250 = Стр150;
				Если Стр190 > 0 Тогда
					Стр250 = Стр150 - Стр190;
				ИначеЕсли Стр210 > 0 Тогда
					Стр250 = Стр150 - Стр210;
				ИначеЕсли Стр230 > 0 Тогда
					Стр250 = Стр150 - Стр230;
				ИначеЕсли ЗначениеЗаполнено(Стр240) Тогда
					Стр250 = Стр110 * Стр120 * Стр140 / 100;
				КонецЕсли;
				
				Данные.Вставить("П000020025003", Макс(Стр250, 0));
				
			КонецЕсли;
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли