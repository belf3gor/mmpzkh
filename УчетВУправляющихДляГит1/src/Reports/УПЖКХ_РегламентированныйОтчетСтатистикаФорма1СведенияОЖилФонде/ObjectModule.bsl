
////////////////////////////////////////////////////////////////////////////////
// ПЕРЕМЕННЫЕ МОДУЛЯ

#Область ПеременныеМодуля

Перем мТаблицаСоставПоказателей Экспорт; // Таблица значений - состав показателей отчета.

Перем мСтруктураВариантыЗаполнения Экспорт; // Структура состава показателей отчета.

Перем мСтруктураМногостраничныхРазделов Экспорт; // Структура многостраничных разделов.

Перем мДеревоСтраницОтчета Экспорт; // Дерево значений - структура листов отчета.

Перем мЕстьВыбранные Экспорт; // Признак выбора печатных листов.

Перем мВыбраннаяФорма Экспорт; // Имя выбранной формы отчета.

Перем мСкопированаФорма Экспорт; // Признак скопированной формы.

Перем мСохраненныйДок Экспорт; // Ссылка на документ, хранящий данные отчета.

Перем мДатаНачалаПериодаОтчета Экспорт; // Дата начала периода отчета.
Перем мДатаКонцаПериодаОтчета  Экспорт; // Дата окончания периода отчета.
Перем мПериодичность Экспорт;           // Периодичность отчета.

Перем мПолноеИмяФайлаВнешнейОбработки Экспорт; // Полное имя файла внешней обработки.

Перем мЗаписьЗапрещена Экспорт; // Флаг запрета записи.

Перем мИнтервалАвтосохранения Экспорт; // Интервал автосохранения.

Перем мТаблицаФормОтчета Экспорт; // Таблица форм отчета.

Перем мРезультатПоиска Экспорт; // Таблица с результатами поиска.
Перем мСчетчикиСтраницПриПоиске Экспорт; // Счетчики страниц при поиске.

Перем мЗаписываетсяНовыйДокумент Экспорт; // Флаг записи нового документа.
Перем мВариант Экспорт; // Вариант отчета.

Перем мФормыИФорматы Экспорт; // Формы и форматы отчета.
Перем мВерсияОтчета Экспорт;  // Версия отчета.

#КонецОбласти 

////////////////////////////////////////////////////////////////////////////////
// ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ ДЛЯ ОПРЕДЕЛЕНИЯ ДЕРЕВА ФОРМ И ФОРМАТОВ

#Область ВспомогательныеФункцииДляОпределенияДереваФормИФорматов

Функция СоздатьДеревоФормИФорматов()
	
	мФормыИФорматы = Новый ДеревоЗначений;
	мФормыИФорматы.Колонки.Добавить("Код");
	мФормыИФорматы.Колонки.Добавить("ДатаПриказа");
	мФормыИФорматы.Колонки.Добавить("НомерПриказа");
	мФормыИФорматы.Колонки.Добавить("ДатаНачалаДействия");
	мФормыИФорматы.Колонки.Добавить("ДатаОкончанияДействия");
	мФормыИФорматы.Колонки.Добавить("ИмяОбъекта");
	мФормыИФорматы.Колонки.Добавить("Описание");
	Возврат мФормыИФорматы;
	
КонецФункции

Функция ОпределитьФормуВДеревеФормИФорматов(ДеревоФормИФорматов, Код, ДатаПриказа = '00010101', НомерПриказа = "", ИмяОбъекта = "",
			ДатаНачалаДействия = '00010101', ДатаОкончанияДействия = '00010101', Описание = "")
	
	НовСтр                       = ДеревоФормИФорматов.Строки.Добавить();
	НовСтр.Код                   = СокрЛП(Код);
	НовСтр.ДатаПриказа           = ДатаПриказа;
	НовСтр.НомерПриказа          = СокрЛП(НомерПриказа);
	НовСтр.ДатаНачалаДействия    = ДатаНачалаДействия;
	НовСтр.ДатаОкончанияДействия = ДатаОкончанияДействия;
	НовСтр.ИмяОбъекта            = СокрЛП(ИмяОбъекта);
	НовСтр.Описание              = СокрЛП(Описание);
	Возврат НовСтр;
	
КонецФункции

#КонецОбласти 

////////////////////////////////////////////////////////////////////////////////
// ОПРЕДЕЛЕНИЕ ДЕРЕВА ФОРМ И ФОРМАТОВ ОТЧЕТА

#Область ОпределениеДереваФормИФорматовОтчета

мФормыИФорматы = СоздатьДеревоФормИФорматов();

// Определение форм.
Форма20130101 = ОпределитьФормуВДеревеФормИФорматов(мФормыИФорматы, "0609200", '20131008', "393", "ФормаОтчета2013Годовая");
Форма20160101 = ОпределитьФормуВДеревеФормИФорматов(мФормыИФорматы, "0609200", '20160815', "427", "ФормаОтчета2016Годовая");

ОписаниеТиповСтрока = УПЖКХ_ТиповыеМетодыКлиентСервер.ПолучитьОписаниеТиповСтроки(0);

МассивТипов = Новый Массив;
МассивТипов.Добавить(Тип("Дата"));
ОписаниеТиповДата = Новый ОписаниеТипов(МассивТипов, , Новый КвалификаторыДаты(ЧастиДаты.Дата));

мТаблицаФормОтчета = Новый ТаблицаЗначений;
мТаблицаФормОтчета.Колонки.Добавить("ФормаОтчета",        ОписаниеТиповСтрока);
мТаблицаФормОтчета.Колонки.Добавить("ОписаниеОтчета",     ОписаниеТиповСтрока, "Утверждена",  20);
мТаблицаФормОтчета.Колонки.Добавить("ДатаНачалоДействия", ОписаниеТиповДата,   "Действует с", 5);
мТаблицаФормОтчета.Колонки.Добавить("ДатаКонецДействия",  ОписаниеТиповДата,   "         по", 5);

НоваяФорма = мТаблицаФормОтчета.Добавить();
НоваяФорма.ФормаОтчета        = "ФормаОтчета2013Годовая";
НоваяФорма.ОписаниеОтчета     = "Форма утверждена приказом Росстата от 08.10.2013 № 393";
НоваяФорма.ДатаНачалоДействия = '20130101';
НоваяФорма.ДатаКонецДействия  = '20151231';

НоваяФорма = мТаблицаФормОтчета.Добавить();
НоваяФорма.ФормаОтчета        = "ФормаОтчета2016Годовая";
НоваяФорма.ОписаниеОтчета     = "Форма утверждена приказом Росстата от 15.08.2016 № 427";
НоваяФорма.ДатаНачалоДействия = '20160101';
НоваяФорма.ДатаКонецДействия  = УПЖКХ_ТиповыеМетодыКлиентСервер.ПустоеЗначениеТипа(Тип("Дата"));

#КонецОбласти 
