#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

////////////////////////////////////////////////////////////////////////////////
// ПРОГРАММНЫЙ ИНТЕРФЕЙС

Функция ПолучитьПараметрыИсполненияОтчета() Экспорт
	
	Результат = Новый Структура;
	Результат.Вставить("ИспользоватьПередКомпоновкойМакета", Истина);
	Результат.Вставить("ИспользоватьПриВыводеЗаголовка",     Истина);
	Результат.Вставить("ИспользоватьДанныеРасшифровки",      Истина);
	Результат.Вставить("ИспользоватьПослеВыводаРезультата",  Истина);
							
	Возврат Результат;
	
КонецФункции

// В процедуре можно доработать компоновщик перед выводом в отчет
// Изменения сохранены не будут
//
Процедура ПередКомпоновкойМакета(ПараметрыОтчета, Схема, КомпоновщикНастроек) Экспорт
	
	БухгалтерскиеОтчетыВызовСервера.УстановитьПараметрОрганизация(КомпоновщикНастроек, ПараметрыОтчета.ОрганизацияРасшифровки);
	
	БухгалтерскиеОтчетыКлиентСервер.УстановитьПараметр(КомпоновщикНастроек, "НачалоПериода", НачалоДня(ПараметрыОтчета.НачалоПериода));
	
	БухгалтерскиеОтчетыКлиентСервер.УстановитьПараметр(КомпоновщикНастроек, "КонецПериода",  КонецДня(ПараметрыОтчета.КонецПериода));
	
	БухгалтерскиеОтчетыКлиентСервер.УстановитьПараметр(КомпоновщикНастроек, "НачалоГода",    ПараметрыОтчета.НачалоГода);
	
	// Схемы расшифровок содержат запасную строку с обозначением периода
	ПредставлениеПериода = ПараметрыОтчета.ПредставлениеПериода;
	СправкиРасчеты.ДополнитьПериодОтчетаПримечанием(ПредставлениеПериода, ПараметрыОтчета);
	БухгалтерскиеОтчетыКлиентСервер.УстановитьПараметр(КомпоновщикНастроек, "ПредставлениеПериода", ПредставлениеПериода);
	
	БухгалтерскиеОтчетыКлиентСервер.УстановитьПараметр(
		КомпоновщикНастроек,
		"Период",
		Новый Граница(КонецДня(ПараметрыОтчета.КонецПериода), 
		ВидГраницы.Включая));
		
	Если ПараметрыОтчета.ТолькоОшибки Тогда	
		БухгалтерскиеОтчетыКлиентСервер.ДобавитьОтбор(КомпоновщикНастроек, "Контроль", , ВидСравненияКомпоновкиДанных.Заполнено);
	КонецЕсли;
	
КонецПроцедуры

Функция ПолучитьТекстЗаголовка(ПараметрыОтчета) Экспорт 
	
	Возврат ЗаголовокОтчета(ПараметрыОтчета, Истина);
	
КонецФункции	

Процедура ПриВыводеЗаголовка(ПараметрыОтчета, КомпоновщикНастроек, Результат) Экспорт 
	
	Макет = Отчеты.АнализСостоянияНалоговогоУчетаПоНалогуНаПрибыль.ПолучитьМакет("МакетЗаголовкаРасшифровки");
	
	ОбластьОтчета = Макет.ПолучитьОбласть("Заголовок");
	ОбластьОтчета.Параметры.ТекстЗаголовка = ПолучитьТекстЗаголовка(ПараметрыОтчета);
	
	Результат.Вывести(ОбластьОтчета);
	
КонецПроцедуры

Процедура ПослеВыводаРезультата(ПараметрыОтчета, Результат) Экспорт
	
	Если СправкиРасчеты.ТребуетсяДополнитьПериодОтчетаПримечанием(ПараметрыОтчета) Тогда
		
		СправкиРасчеты.ДобавитьПримечание(Результат, ПараметрыОтчета.ИнформацияНалоговыйПериод);
		
	КонецЕсли;
	
КонецПроцедуры


Процедура СформироватьОтчет(Знач ПараметрыОтчета, АдресХранилища) Экспорт
	
	ДокументРезультат = Новый ТабличныйДокумент;
	ДокументСхемы = ПолучитьМакет(ПараметрыОтчета.ИмяСхемы);
	
	Расшифровка = ПараметрыОтчета.Расшифровка;
	
	КэшПараметровОтчета = ПараметрыОтчета.КэшПараметровОтчета;
	НомерТекущейСхемы = ПараметрыОтчета.НомерТекущейСхемы;
	
	Если НЕ КэшПараметровОтчета.Свойство("КэшМакетов") Тогда	
		КэшПараметровОтчета.Вставить("КэшМакетов"     , Новый Структура);
		КэшПараметровОтчета.Вставить("ИсторияОткрытий", Новый СписокЗначений);		
	КонецЕсли;
	
	Если ТипЗнч(Расшифровка) = Тип("Соответствие") Тогда
		ПараметрыОтчета.ОрганизацияРасшифровки = Расшифровка.Получить("Организация");
		
		СтруктураВП = Новый Структура;
		СтруктураВП.Вставить("НомерТекущейСхемы", НомерТекущейСхемы);
		СтруктураВП = ПолучитьСтруктуруВременныхПараметров(ПараметрыОтчета, СтруктураВП, НомерТекущейСхемы);		
	Иначе		
		СтруктураВП = ПолучитьСтруктуруВременныхПараметров(ПараметрыОтчета, , НомерТекущейСхемы);		
	КонецЕсли;
	
	СтруктураВП.Вставить("НомерТекущейСхемы",	НомерТекущейСхемы);
	КэшПараметровОтчета.Вставить("СтруктураВП",	СтруктураВП);
	
	// установим формируемую схему
	Если НомерТекущейСхемы = 0 ИЛИ НомерТекущейСхемы = 20 Тогда		
		СформироватьРасчетНалогаНаПрибыль(ПараметрыОтчета, ДокументСхемы, КэшПараметровОтчета);		
	ИначеЕсли НомерТекущейСхемы = 1 ИЛИ НомерТекущейСхемы = 21 Тогда		
		СформироватьДоходы(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета);		                                             
	ИначеЕсли НомерТекущейСхемы = 2 ИЛИ НомерТекущейСхемы = 22 Тогда		
		СформироватьРасходы(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета);		
	ИначеЕсли НомерТекущейСхемы = 3 ИЛИ НомерТекущейСхемы = 23 Тогда		
		СформироватьРасходыПоТоварам(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета);		
	ИначеЕсли НомерТекущейСхемы = 4 ИЛИ НомерТекущейСхемы = 24 Тогда			
		СформироватьРасходыПроизводства(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета);		
	ИначеЕсли НомерТекущейСхемы = 5 ИЛИ НомерТекущейСхемы = 25 Тогда		
		СформироватьТранспортныеРасходы(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета);		
	ИначеЕсли НомерТекущейСхемы = 6 ИЛИ НомерТекущейСхемы = 26 Тогда		
		СформироватьКосвенныеРасходы(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета);		
	ИначеЕсли НомерТекущейСхемы = 7 ИЛИ НомерТекущейСхемы = 27 Тогда		
		СформироватьПрочиеРасходы(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета);		
	ИначеЕсли НомерТекущейСхемы = 8 ИЛИ НомерТекущейСхемы = 28 Тогда		
		СформироватьРаспределяемыеРасходы(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета);		
	ИначеЕсли НомерТекущейСхемы = 9 ИЛИ НомерТекущейСхемы = 29 Тогда		
		СформироватьСтоимостьЗапасов(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета);		
	ИначеЕсли НомерТекущейСхемы = 10 ИЛИ НомерТекущейСхемы = 30 Тогда		
		СформироватьОбычныеРасходы(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета);
	КонецЕсли;

	Если Не ПустаяСтрока(ПараметрыОтчета.ИнформацияНалоговыйПериод) Тогда
		ЭлементНазваниеОрганизации = ДокументСхемы.ЭлементыГрафическойСхемы.Найти("НазваниеОрганизации");
		Если ЭлементНазваниеОрганизации <> Неопределено Тогда
			ЭлементНазваниеОрганизации.Подсказка = ПараметрыОтчета.ИнформацияНалоговыйПериод;
		КонецЕсли;
	КонецЕсли;
	
	КэшПараметровОтчета.ИсторияОткрытий.Добавить(НомерТекущейСхемы);
	
	РезультатВыполнения = Новый Структура;
	РезультатВыполнения.Вставить("КэшПараметровОтчета", КэшПараметровОтчета);
	РезультатВыполнения.Вставить("РезультатСхемы"     , ДокументСхемы);
	РезультатВыполнения.Вставить("Результат"          , ДокументРезультат);
	
	ПоместитьВоВременноеХранилище(РезультатВыполнения, АдресХранилища);
	
КонецПроцедуры

Процедура СформироватьРасшифровку(Знач ПараметрыОтчета, АдресХранилища) Экспорт
	
	КэшПараметровОтчета = ПараметрыОтчета.КэшПараметровОтчета;
	
	ПараметрыОтчета.ОрганизацияРасшифровки = КэшПараметровОтчета.ТекущаяРасшифровка["Организация"];
	
	СхемаКомпоновкиДанных = ПолучитьМакет(КэшПараметровОтчета.ТекущаяРасшифровка["НомерТекущейСхемы"]);
	
	Если Не УчетнаяПолитика.ПоддержкаПБУ18(ПараметрыОтчета.ОрганизацияРасшифровки, КонецДня(ПараметрыОтчета.КонецПериода)) Тогда
		
		// Запретим расчет полей, значения которых не могут быть показаны пользователю
		
		ЗапрещенныеПоля = Новый Массив;
		ЗапрещенныеПоля.Добавить("СуммаВР");
		ЗапрещенныеПоля.Добавить("СуммаПР");
		ЗапрещенныеПоля.Добавить("Контроль");
		
		Для Каждого ИмяЗапрещенногоПоля Из ЗапрещенныеПоля Цикл
			
			ЗапрещенноеПоле = СхемаКомпоновкиДанных.ПоляИтога.Найти(ИмяЗапрещенногоПоля);
			Если ЗапрещенноеПоле = Неопределено Тогда
				Продолжить;
			КонецЕсли;
			
			ЗапрещенноеПоле.Выражение = "0";
			
		КонецЦикла;
		
	КонецЕсли;
	
	НеРазворачиватьПоРегистраторам = КэшПараметровОтчета.ТекущаяРасшифровка["НеРазворачиватьПоРегистраторам"];
	Если НеРазворачиватьПоРегистраторам = Истина Тогда
		ВариантыНастроек = СхемаКомпоновкиДанных.ВариантыНастроек.Найти("БезРегистратора");
	Иначе
		ВариантыНастроек = СхемаКомпоновкиДанных.ВариантыНастроек.Найти("Основной");
	КонецЕсли;
	
	Если ВариантыНастроек = Неопределено Тогда
		ВариантНастройки = СхемаКомпоновкиДанных.НастройкиПоУмолчанию;
	Иначе
		ВариантНастройки = ВариантыНастроек.Настройки;
	КонецЕсли;
	
	КомпоновщикНастроек = Новый КомпоновщикНастроекКомпоновкиДанных;
	КомпоновщикНастроек.ЗагрузитьНастройки(ВариантНастройки);
	
	КомпоновщикНастроек.Настройки.ДополнительныеСвойства.Вставить("ВыводитьПодвал");
	КомпоновщикНастроек.Настройки.ДополнительныеСвойства.ВыводитьПодвал = Ложь;
	
	УстановитьПараметрыРасшифровкиСчетаВыручкиСебестоимости(
		КомпоновщикНастроек.Настройки.ПараметрыДанных,
		СхемаКомпоновкиДанных,
		ПараметрыОтчета.КонецПериода,
		ПараметрыОтчета.ОрганизацияРасшифровки);
	
	ПараметрыОтчета.Вставить("СхемаКомпоновкиДанных",     СхемаКомпоновкиДанных);
	ПараметрыОтчета.Вставить("НастройкиКомпоновкиДанных", КомпоновщикНастроек.ПолучитьНастройки());
	
	ВременныйАдресХранилища = ПоместитьВоВременноеХранилище(Неопределено, Новый УникальныйИдентификатор);
	БухгалтерскиеОтчетыВызовСервера.СформироватьОтчет(ПараметрыОтчета, ВременныйАдресХранилища);
	РезультатВыполнения = ПолучитьИзВременногоХранилища(ВременныйАдресХранилища);
	ДокументРезультат   = РезультатВыполнения.Результат;
	
	ДанныеРасшифровки   = "";
	Если РезультатВыполнения.Свойство("ДанныеРасшифровки") Тогда
		ДанныеРасшифровки = РезультатВыполнения.ДанныеРасшифровки;
	КонецЕсли;
	
	ПоместитьВоВременноеХранилище(РезультатВыполнения, АдресХранилища);
	
КонецПроцедуры

Процедура ВывестиЛегенду(ЭлементыСхемы) Экспорт 
	
	ЭлементыСхемы.Легенда1.ЦветРамки 	= WebЦвета.Красный;
	ЭлементыСхемы.Легенда1.Фигура		= ФигурыГрафическойСхемы.Блок;
	ЭлементыСхемы.Легенда2.Наименование	= НСтр("ru = 'Не выполняется правило БУ = НУ + ПР + ВР'");
	
КонецПроцедуры


////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ 


////////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

Функция ПолучитьСтруктуруВременныхПараметров(ПараметрыОтчета, СтруктураВП = Неопределено, НомерТекущейСхемы)
	
	Если СтруктураВП = Неопределено Тогда
		СтруктураВП = Новый Структура;
		
		Если НомерТекущейСхемы > 20 И ЗначениеЗаполнено(ПараметрыОтчета.Организация.ГоловнаяОрганизация) Тогда
			ПараметрыОтчета.ОрганизацияРасшифровки = ПараметрыОтчета.Организация.ГоловнаяОрганизация;	
		Иначе
			ПараметрыОтчета.ОрганизацияРасшифровки = ПараметрыОтчета.Организация;
		КонецЕсли;	
	КонецЕсли;
	
	СтруктураВП.Вставить("ГоловнаяОрганизация", ПараметрыОтчета.ОрганизацияРасшифровки.ГоловнаяОрганизация);
	СтруктураВП.Вставить("ПоказыватьЛегенду",   Ложь);	
	
	Возврат СтруктураВП;  
	
КонецФункции

Процедура СформироватьРасчетНалогаНаПрибыль(ПараметрыОтчета, Документ, КэшПараметровОтчета)
	
	СтруктураВП = КэшПараметровОтчета.СтруктураВП;
	
	Документ 		  = ПолучитьМакет("РасчетНалогаНаПрибыль");
	ЭлементыСхемы 	  = Документ.ЭлементыГрафическойСхемы;
	РасшифровкаМакета = Новый Структура;
	НастройкаРамок    = Новый Структура;
	
	ПоддержкаБУ18  = УчетнаяПолитика.ПоддержкаПБУ18(ПараметрыОтчета.ОрганизацияРасшифровки, КонецДня(ПараметрыОтчета.КонецПериода));
	НалогНаПрибыль = ?(ПоддержкаБУ18, ПланыСчетов.Хозрасчетный.РасчетНалогаНаПрибыль, 
		ПланыСчетов.Хозрасчетный.РасчетыСБюджетом);
		
		
	РасчетСтавкиНалогаНаПрибыль = Неопределено;
	НалоговыйУчетОбособленныхПодразделений.ВыполнитьЗапросРасчетСтавкиНалогаНаПрибыльЗаМесяц(
		РасчетСтавкиНалогаНаПрибыль, ПараметрыОтчета.Организация, КонецДня(ПараметрыОтчета.КонецПериода));
	
	СтрокаСтавки = Неопределено;
	Если РасчетСтавкиНалогаНаПрибыль <> Неопределено Тогда	
		ТаблицаСтавок = РасчетСтавкиНалогаНаПрибыль.Выгрузить();
		СтрокаСтавки = ТаблицаСтавок.Найти(ПараметрыОтчета.ОрганизацияРасшифровки,"Организация");
	КонецЕсли;
	
	Если СтрокаСтавки = Неопределено Тогда
		СтавкаНалогаНаПрибыль = РасчетНалогаНаПрибыль.СуммарнаяУстановленнаяСтавкаНалога(
			ПараметрыОтчета.КонецПериода,
			ПараметрыОтчета.ОрганизацияРасшифровки,
			"Процент");
	Иначе
		СтавкаНалогаНаПрибыль = Окр(СтрокаСтавки.Ставка, 6);
	КонецЕсли;
	
	СписокОП = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьСписокОбособленныхПодразделений(ПараметрыОтчета.ОрганизацияРасшифровки);
	
	Счет99_2Хозрасчетный = ?(ПоддержкаБУ18, ПланыСчетов.Хозрасчетный.ПрибылиИУбытки_НалогНаПрибыль, 
		ПланыСчетов.Хозрасчетный.ПрибылиИУбыткиНеЕНВД);
		
	ОрганизацияГоловная = ?(ПараметрыОтчета.ВключатьОбособленныеПодразделения, СтруктураВП.ГоловнаяОрганизация,
		ПараметрыОтчета.ОрганизацияРасшифровки);
		
	Запрос = Новый Запрос;	// Запрос переиспользуется. Для одного из выполнений запроса ниже устанавливается МенеджерВременныхТаблиц
	Запрос.УстановитьПараметр("Счет99_2Хозрасчетный",	   Счет99_2Хозрасчетный);
	Запрос.УстановитьПараметр("ОрганизацияГоловная",  	   ОрганизацияГоловная);
	Запрос.УстановитьПараметр("НачалоПериода",     	       ПараметрыОтчета.НачалоПериода);
	Запрос.УстановитьПараметр("КонецПериода",     	       КонецДня(ПараметрыОтчета.КонецПериода));
	Запрос.УстановитьПараметр("Организация",         	   СписокОП);
	Запрос.УстановитьПараметр("НалогНаПрибыль",			   НалогНаПрибыль);
	Запрос.УстановитьПараметр("СтавкаНалогаНаПрибыль",	   СтавкаНалогаНаПрибыль);
	
	// Доходы
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация КАК Организация,
	|	ХозрасчетныйОбороты.СуммаОборотКт КАК ДоходыБУ,
	|	ХозрасчетныйОбороты.СуммаНУОборотКт КАК ДоходыНУ,
	|	ХозрасчетныйОбороты.СуммаПРОборотКт КАК ДоходыПР,
	|	ХозрасчетныйОбороты.СуммаВРОборотКт КАК ДоходыВР
	|ПОМЕСТИТЬ ВТХозрасчетный
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, , Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыручкаНеЕНВД)), , Организация В (&Организация), НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи)), ) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	ХозрасчетныйОбороты.СуммаОборотКт,
	|	ХозрасчетныйОбороты.СуммаНУОборотКт,
	|	ХозрасчетныйОбороты.СуммаПРОборотКт,
	|	ХозрасчетныйОбороты.СуммаВРОборотКт
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			Организация В (&Организация)
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения),
	|			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходыИРасходы)),
	|			) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	-ХозрасчетныйОбороты.СуммаОборотДт,
	|	-ХозрасчетныйОбороты.СуммаНУОборотДт,
	|	-ХозрасчетныйОбороты.СуммаПРОборотДт,
	|	-ХозрасчетныйОбороты.СуммаВРОборотДт
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_НДС), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_Акцизы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_ЭкспортныеПошлины)),
	|			,
	|			Организация В (&Организация),
	|			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи)),
	|			) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	-ХозрасчетныйОбороты.СуммаОборотДт,
	|	-ХозрасчетныйОбороты.СуммаНУОборотДт,
	|	-ХозрасчетныйОбороты.СуммаПРОборотДт,
	|	-ХозрасчетныйОбороты.СуммаВРОборотДт
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			Организация В (&Организация)
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов))
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения),
	|			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДС), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСНачисленныйПоОтгрузке)),
	|			) КАК ХозрасчетныйОбороты
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТХозрасчетный.Организация КАК Организация,
	|	СУММА(ЕСТЬNULL(ВТХозрасчетный.ДоходыБУ, 0)) КАК ДоходыБУ,
	|	СУММА(ЕСТЬNULL(ВТХозрасчетный.ДоходыНУ, 0)) КАК ДоходыНУ,
	|	СУММА(ЕСТЬNULL(ВТХозрасчетный.ДоходыПР, 0)) КАК ДоходыПР,
	|	СУММА(ЕСТЬNULL(ВТХозрасчетный.ДоходыВР, 0)) КАК ДоходыВР
	|ИЗ
	|	ВТХозрасчетный КАК ВТХозрасчетный
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТХозрасчетный.Организация
	|ИТОГИ ПО
	|	ОБЩИЕ";
	
	Результат 	  = Запрос.Выполнить();
	ВыборкаДоходы = Результат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам, "ОБЩИЕ");
	ЕстьДоходы 	  = ВыборкаДоходы.Следующий();
	Доходы        = ЗначенияПолейСхемы(ВыборкаДоходы, "Доходы");
	
	// В бухгалтерском и налоговом учете возвраты прошлых лет отражаются существенно разными способами
	// (см. НалоговыйУчет.СкорректироватьПроводкиВозвратТоваровПрибылиУбыткиПрошлыхЛет).
	// Чтобы можно было убедиться в корректности учета, в отчете показываем эти суммы по одинаковым правилам (бухгалтерского учета).
	// Для этого суммы доходов и расходов НУ должны быть скорректированы на суммы убытков и прибыли, отраженных по возвратам прошлых лет.
	ВозвратыПрошлыхЛет = ПрибыльУбытокВозвратыПрошлыхЛет(
		ПараметрыОтчета.НачалоПериода,
		КонецДня(ПараметрыОтчета.КонецПериода),
		ОрганизацияГоловная,
		СписокОП);
		
	Если ЕстьДоходы Тогда
		
		// Скорректируем сумму доходов на прибыли и убытки по возвратам прошлых лет так,
		// чтобы сумма доходов была рассчитана по правилам бухгалтерского учета.
		// В налоговом учете в составе доходов отражена прибыль по возвратам прошлых лет.
		// Поэтому прибыль нужно вычесть из суммы доходов.
		// В бухгалтерском учете доходы уменьшены на сумму выручки по возвращенным товарам,
		// которые в налоговом учете отражаются в составе убытка.
		// Поэтому сумму доходов налогового учета также уменьшим на эту величину - вычтем убыток.
		Доходы.ДоходыНУ = Доходы.ДоходыНУ - ВозвратыПрошлыхЛет.Прибыль - ВозвратыПрошлыхЛет.Убыток;
	
		ЗаполнитьПоляСхемы(ЭлементыСхемы, Доходы);
		
		РасшифровкаМакета.Вставить("РасшифровкаДоходы",  ПереходКСхеме(ПараметрыОтчета, 1, СтруктураВП, Истина));
		
	КонецЕсли;
	
	// Расходы
	МенеджерВременныхТаблицДолиЕНВД = Новый МенеджерВременныхТаблиц;
	Налоговыйучет.СоздатьДолиЕНВД(
		МенеджерВременныхТаблицДолиЕНВД,
		Запрос.Параметры.НачалоПериода,
		Запрос.Параметры.КонецПериода,
		Запрос.Параметры.Организация); 
		
	Запрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблицДолиЕНВД; // Очищается после выполнения запроса
		
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация КАК Организация,
	|	ХозрасчетныйОбороты.СуммаОборотДт КАК РасходыБУ,
	|	ХозрасчетныйОбороты.СуммаНУОборотДт КАК РасходыНУ,
	|	ХозрасчетныйОбороты.СуммаПРОборотДт КАК РасходыПР,
	|	ХозрасчетныйОбороты.СуммаВРОборотДт КАК РасходыВР
	|ПОМЕСТИТЬ ВТХозрасчетный
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, , Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуНеЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыНеЕНВД)), , Организация В (&Организация), НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи)), ) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ + ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт * (1 - ДолиЕНВД.ДоляЕНВД)
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ + ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт * (1 - ДолиЕНВД.ДоляЕНВД)
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ + ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт * (1 - ДолиЕНВД.ДоляЕНВД)
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ + ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт * (1 - ДолиЕНВД.ДоляЕНВД)
	|		ИНАЧЕ 0
	|	КОНЕЦ
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			Месяц,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			Организация В (&Организация)
	|				И НЕ ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов))
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения),
	|			,
	|			) КАК ХозрасчетныйОбороты
	|		ЛЕВОЕ СОЕДИНЕНИЕ ДолиЕНВД КАК ДолиЕНВД
	|		ПО ХозрасчетныйОбороты.Период = ДолиЕНВД.МесяцЕНВД
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	ХозрасчетныйОбороты.СуммаНУОборотКт,
	|	ХозрасчетныйОбороты.СуммаПРОборотКт,
	|	ХозрасчетныйОбороты.СуммаВРОборотКт
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.РасходыБудущихПериодов),
	|			Организация В (&Организация)
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.РасходыБудущихПериодов).ВидРБП В (ЗНАЧЕНИЕ(Перечисление.ВидыРБП.УбыткиПрошлыхЛет), ЗНАЧЕНИЕ(Перечисление.ВидыРБП.УбыткиОтРеализацииАмортизируемогоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыРБП.УбыткиПрошлыхЛетОбслуживающихПроизводствИХозяйств)),
	|			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрибылиИУбыткиНеЕНВД)),
	|			) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	ХозрасчетныйОбороты.СуммаОборотДт,
	|	ХозрасчетныйОбороты.СуммаНУОборотДт,
	|	ХозрасчетныйОбороты.СуммаПРОборотДт,
	|	ХозрасчетныйОбороты.СуммаВРОборотДт
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			Организация В (&Организация)
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов))
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения),
	|			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДС), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСНачисленныйПоОтгрузке)),
	|			) КАК ХозрасчетныйОбороты
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТХозрасчетный.Организация КАК Организация,
	|	СУММА(ВТХозрасчетный.РасходыБУ) КАК РасходыБУ,
	|	СУММА(ВТХозрасчетный.РасходыНУ) КАК РасходыНУ,
	|	СУММА(ВТХозрасчетный.РасходыПР) КАК РасходыПР,
	|	СУММА(ВТХозрасчетный.РасходыВР) КАК РасходыВР
	|ИЗ
	|	ВТХозрасчетный КАК ВТХозрасчетный
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТХозрасчетный.Организация
	|ИТОГИ ПО
	|	ОБЩИЕ";
	
	Результат 		= Запрос.Выполнить();
	МенеджерВременныхТаблицДолиЕНВД.Закрыть();
	Запрос.МенеджерВременныхТаблиц = Неопределено;
	
	ВыборкаРасходы 	= Результат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам, "ОБЩИЕ");
	
	ЕстьРасходы = ВыборкаРасходы.Следующий();
	Расходы     = ЗначенияПолейСхемы(ВыборкаРасходы, "Расходы");
	
	Если ЕстьРасходы Тогда
		
		// Скорректируем сумму расходов на прибыли и убытки по возвратам прошлых лет так,
		// чтобы сумма расходов была рассчитана по правилам бухгалтерского учета.
		// В налоговом учете в составе расходов отражен убыток по возвратам прошлых лет.
		// Поэтому убыток нужно вычесть из суммы расходов.
		// В бухгалтерском учете расходы уменьшены на сумму себестоимости возвращенных товаров,
		// которые в налоговом учете отражаются в составе прибыли.
		// Поэтому сумму расходов налогового учета также уменьшим на эту величину - вычтем прибыль.
		Расходы.РасходыНУ = Расходы.РасходыНУ - ВозвратыПрошлыхЛет.Прибыль - ВозвратыПрошлыхЛет.Убыток;
		
		ЗаполнитьСхему(ЭлементыСхемы, Расходы, Результат.Колонки);
		РасшифровкаМакета.Вставить("РасшифровкаРасходы", ПереходКСхеме(ПараметрыОтчета, 2, СтруктураВП, Истина));
		
	КонецЕсли;
	
	// Прибыль
	ПараметрыДляРамки = Новый Соответствие;
	ПараметрыДляРамки.Вставить("БазаБУ", ?(ЕстьДоходы,Доходы.ДоходыБУ,0) - ?(ЕстьРасходы,Расходы.РасходыБУ,0));
	ЭлементыСхемы.БазаБУ.Наименование = Формат(ПараметрыДляРамки["БазаБУ"], "ЧЦ=20; ЧДЦ=0; ЧРГ=' '");
	ПараметрыДляРамки.Вставить("БазаНУ", ?(ЕстьДоходы,Доходы.ДоходыНУ,0) - ?(ЕстьРасходы,Расходы.РасходыНУ,0));
	ЭлементыСхемы.БазаНУ.Наименование = Формат(ПараметрыДляРамки["БазаНУ"], "ЧЦ=20; ЧДЦ=0; ЧРГ=' '");
	ПараметрыДляРамки.Вставить("БазаПР", ?(ЕстьДоходы,Доходы.ДоходыПР,0) - ?(ЕстьРасходы,Расходы.РасходыПР,0));
	ЭлементыСхемы.БазаПР.Наименование = Формат(ПараметрыДляРамки["БазаПР"], "ЧЦ=20; ЧДЦ=0; ЧРГ=' '");
	ПараметрыДляРамки.Вставить("БазаВР", ?(ЕстьДоходы,Доходы.ДоходыВР,0) - ?(ЕстьРасходы,Расходы.РасходыВР,0));
	ЭлементыСхемы.БазаВР.Наименование = Формат(ПараметрыДляРамки["БазаВР"], "ЧЦ=20; ЧДЦ=0; ЧРГ=' '");
	
	НастроитьРамку(ПараметрыДляРамки, "База", ЭлементыСхемы.БазаРасшифровка, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
		
	// Налог
	Запрос.УстановитьПараметр("БазаНУ",?(ЕстьДоходы,Доходы.ДоходыНУ,0) - ?(ЕстьРасходы,Расходы.РасходыНУ,0));
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация КАК Организация,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПостоянноеНалоговоеОбязательство))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт - ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК НАЛОГБУ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПостоянноеНалоговоеОбязательство))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт - ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК НАлогПР,
	|	0 КАК НалогВР
	|ПОМЕСТИТЬ ВТХозрасчетный
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, , Счет В ИЕРАРХИИ (&НалогНаПРибыль), , Организация = &ОрганизацияГоловная, КорСчет В ИЕРАРХИИ (&Счет99_2Хозрасчетный), ) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	ХозрасчетныйОбороты.СуммаОборотКт - ХозрасчетныйОбороты.СуммаОборотДт
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (&НалогНаПРибыль),
	|			,
	|			Организация = &ОрганизацияГоловная
	|				И НЕ КорСубконто1 = ЗНАЧЕНИЕ(Перечисление.ВидыАктивовИОбязательств.УбытокТекущегоПериода),
	|			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОтложенныеНалоговыеАктивы))
	|				ИЛИ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОтложенныеНалоговыеОбязательства)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВидыАктивовИОбязательств)) КАК ХозрасчетныйОбороты
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТХозрасчетный.Организация КАК Организация,
	|	СУММА(ВТХозрасчетный.НАЛОГБУ) КАК НалогБУ,
	|	-СУММА(ВТХозрасчетный.НАлогПР) КАК НалогПР,
	|	-СУММА(ВТХозрасчетный.НалогВР) КАК НалогВР,
	|	&БазаНУ * &СтавкаНалогаНаПрибыль / 100 КАК НалогНУ,
	|	СУММА(ВТХозрасчетный.НАЛОГБУ) + СУММА(ВТХозрасчетный.НАлогПР) + СУММА(ВТХозрасчетный.НалогВР) КАК НалогБУКор
	|ИЗ
	|	ВТХозрасчетный КАК ВТХозрасчетный
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТХозрасчетный.Организация";
	
	Результат = Запрос.Выполнить();
	Выборка = Результат.Выбрать();
	
	Если Выборка.Следующий() Тогда
		НалогБУ = ?(ПоддержкаБУ18, Выборка.НалогБУ, ПараметрыДляРамки["БазаБУ"] * СтавкаНалогаНаПрибыль / 100);
		НалогНУ = Выборка.НалогНУ;
		НалогПР = -Выборка.НалогПР;
		НалогВР = -Выборка.НалогВР;
		НалогБУКор = ?(ПоддержкаБУ18, Выборка.НалогБУКор, ПараметрыДляРамки["БазаБУ"] * СтавкаНалогаНаПрибыль / 100);
		
		ЭлементыСхемы.НалогБУ.Наименование    = Формат(НалогБУ,    "ЧЦ=20; ЧДЦ=0; ЧРГ=' '");
		ЭлементыСхемы.НалогНУ.Наименование    = Формат(НалогНУ,    "ЧЦ=20; ЧДЦ=0; ЧРГ=' '");
		ЭлементыСхемы.НалогПР.Наименование    = Формат(НалогПР,    "ЧЦ=20; ЧДЦ=0; ЧРГ=' '");
		ЭлементыСхемы.НалогВР.Наименование    = Формат(НалогВР,    "ЧЦ=20; ЧДЦ=0; ЧРГ=' '");
		ЭлементыСхемы.НалогБУКор.Наименование = Формат(НалогБУКор, "ЧЦ=20; ЧДЦ=0; ЧРГ=' '");
	КонецЕсли;
	
	ЭлементыСхемы.СтавкаНалогаНаПрибыль.Наименование = Строка(СтавкаНалогаНаПрибыль) + "%";
	
	НастроитьРамку(Выборка, 	   "Налог",   ЭлементыСхемы.РасшифровкаНалог,   СтруктураВП.ПоказыватьЛегенду, НастройкаРамок, Истина);		
	НастроитьРамку(Доходы,         "Доходы",  ЭлементыСхемы.РасшифровкаДоходы,  СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Расходы,        "Расходы", ЭлементыСхемы.РасшифровкаРасходы, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	
	Если СтруктураВП.ПоказыватьЛегенду Тогда
		ВывестиЛегенду(ЭлементыСхемы);		
	КонецЕсли;
	
	ЭлементыСхемы.НазваниеОрганизации.Наименование = ЗаголовокОтчета(ПараметрыОтчета);
	
	// Сохраняем историю
	СохранитьИсториюСхемы(КэшПараметровОтчета, "РасчетНалогаНаПрибыль", РасшифровкаМакета, НастройкаРамок, ЭлементыСхемы);
	
КонецПроцедуры

Процедура СформироватьДоходы(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета)
	
	СтруктураВП = КэшПараметровОтчета.СтруктураВП;
	
	РасшифровкаМакета = Новый Структура;
	НастройкаРамок    = Новый Структура;
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("НачалоПериода", ПараметрыОтчета.НачалоПериода);
	Запрос.УстановитьПараметр("КонецПериода",  КонецДня(ПараметрыОтчета.КонецПериода));
	Запрос.УстановитьПараметр("Организация",   ПараметрыОтчета.ОрганизацияРасшифровки);
	
	УстановитьПараметрыСчетаВыручкиСебестоимости(Запрос, ПараметрыОтчета.КонецПериода, ПараметрыОтчета.ОрганизацияРасшифровки);
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ПрочиеДоходыИРасходы.Ссылка КАК Ссылка
	|ПОМЕСТИТЬ СтатьиПрибылиУбыткиПрошлыхЛет
	|ИЗ
	|	Справочник.ПрочиеДоходыИРасходы КАК ПрочиеДоходыИРасходы
	|ГДЕ
	|	ПрочиеДоходыИРасходы.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрибыльУбытокПрошлыхЛет)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация КАК Организация,
	|	ХозрасчетныйОбороты.СуммаОборотКт КАК Доходы90БУ,
	|	ХозрасчетныйОбороты.СуммаНУОборотКт КАК Доходы90НУ,
	|	ХозрасчетныйОбороты.СуммаПРОборотКт КАК Доходы90ПР,
	|	ХозрасчетныйОбороты.СуммаВРОборотКт КАК Доходы90ВР,
	|	0 КАК Доходы91УчБУ,
	|	0 КАК Доходы91УчНУ,
	|	0 КАК Доходы91УчПР,
	|	0 КАК Доходы91УчВР,
	|	0 КАК Доходы91НЕБУ,
	|	0 КАК Доходы91НЕНУ,
	|	0 КАК Доходы91НЕПР,
	|	0 КАК Доходы91НЕВР
	|ПОМЕСТИТЬ ВТХозрасчетный
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, , Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыручкаНеЕНВД)), , Организация = &Организация, , ) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат В (ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)),
	|			,
	|			) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	-ХозрасчетныйОбороты.СуммаОборотДт,
	|	-ХозрасчетныйОбороты.СуммаНУОборотДт,
	|	-ХозрасчетныйОбороты.СуммаПРОборотДт,
	|	-ХозрасчетныйОбороты.СуммаВРОборотДт,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, , Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_НДС), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_Акцизы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_ЭкспортныеПошлины)), , Организация = &Организация, , ) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА -ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА -ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА -ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА -ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА -ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА -ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА -ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА -ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы))
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат В (ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)),
	|			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДС), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСНачисленныйПоОтгрузке)),
	|			) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Прибыли.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	-ЕСТЬNULL(СУММА(Прибыли.СуммаНУОборотКт), 0),
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			СчетДт В (&СчетаСебестоимостьПродаж),
	|			,
	|			СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			Организация = &Организация
	|				И СубконтоКт1 В
	|					(ВЫБРАТЬ
	|						СтатьиПрибылиУбыткиПрошлыхЛет.Ссылка
	|					ИЗ
	|						СтатьиПрибылиУбыткиПрошлыхЛет)) КАК Прибыли
	|
	|СГРУППИРОВАТЬ ПО
	|	Прибыли.Организация
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Убытки.Организация,
	|	0,
	|	-ЕСТЬNULL(СУММА(Убытки.СуммаНУОборотДт), 0),
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			СчетКт В (&СчетаВыручка),
	|			,
	|			Организация = &Организация
	|				И СубконтоДт1 В
	|					(ВЫБРАТЬ
	|						СтатьиПрибылиУбыткиПрошлыхЛет.Ссылка
	|					ИЗ
	|						СтатьиПрибылиУбыткиПрошлыхЛет)) КАК Убытки
	|
	|СГРУППИРОВАТЬ ПО
	|	Убытки.Организация
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТХозрасчетный.Организация КАК Организация,
	|	СУММА(ВТХозрасчетный.Доходы90БУ) КАК Доходы90БУ,
	|	СУММА(ВТХозрасчетный.Доходы90НУ) КАК Доходы90НУ,
	|	СУММА(ВТХозрасчетный.Доходы90ПР) КАК Доходы90ПР,
	|	СУММА(ВТХозрасчетный.Доходы90ВР) КАК Доходы90ВР,
	|	СУММА(ВТХозрасчетный.Доходы91УчБУ) КАК Доходы91УчБУ,
	|	СУММА(ВТХозрасчетный.Доходы91УчНУ) КАК Доходы91УчНУ,
	|	СУММА(ВТХозрасчетный.Доходы91УчПР) КАК Доходы91УчПР,
	|	СУММА(ВТХозрасчетный.Доходы91УчВР) КАК Доходы91УчВР,
	|	СУММА(ВТХозрасчетный.Доходы91НЕБУ) КАК Доходы91НЕБУ,
	|	СУММА(ВТХозрасчетный.Доходы91НЕНУ) КАК Доходы91НЕНУ,
	|	СУММА(ВТХозрасчетный.Доходы91НЕПР) КАК Доходы91НЕПР,
	|	СУММА(ВТХозрасчетный.Доходы91НЕВР) КАК Доходы91НЕВР,
	|	СУММА(ВТХозрасчетный.Доходы91УчБУ + ВТХозрасчетный.Доходы91НЕБУ) КАК Доходы91БУ,
	|	СУММА(ВТХозрасчетный.Доходы91УчНУ + ВТХозрасчетный.Доходы91НЕНУ) КАК Доходы91НУ,
	|	СУММА(ВТХозрасчетный.Доходы91УчПР + ВТХозрасчетный.Доходы91НЕПР) КАК Доходы91ПР,
	|	СУММА(ВТХозрасчетный.Доходы91УчВР + ВТХозрасчетный.Доходы91НЕВР) КАК Доходы91ВР,
	|	СУММА(ВТХозрасчетный.Доходы90БУ + ВТХозрасчетный.Доходы91УчБУ) КАК Доходы9091БУ,
	|	СУММА(ВТХозрасчетный.Доходы90НУ + ВТХозрасчетный.Доходы91УчНУ) КАК Доходы9091НУ,
	|	СУММА(ВТХозрасчетный.Доходы90ПР + ВТХозрасчетный.Доходы91УчПР) КАК Доходы9091ПР,
	|	СУММА(ВТХозрасчетный.Доходы90ВР + ВТХозрасчетный.Доходы91УчВР) КАК Доходы9091ВР,
	|	СУММА(ВТХозрасчетный.Доходы90БУ + ВТХозрасчетный.Доходы91УчБУ + ВТХозрасчетный.Доходы91НЕБУ) КАК ДоходыБУ,
	|	СУММА(ВТХозрасчетный.Доходы90НУ + ВТХозрасчетный.Доходы91УчНУ + ВТХозрасчетный.Доходы91НЕНУ) КАК ДоходыНУ,
	|	СУММА(ВТХозрасчетный.Доходы90ПР + ВТХозрасчетный.Доходы91УчПР + ВТХозрасчетный.Доходы91НЕПР) КАК ДоходыПР,
	|	СУММА(ВТХозрасчетный.Доходы90ВР + ВТХозрасчетный.Доходы91УчВР + ВТХозрасчетный.Доходы91НЕВР) КАК ДоходыВР
	|ИЗ
	|	ВТХозрасчетный КАК ВТХозрасчетный
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТХозрасчетный.Организация";
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		Запрос.УстановитьПараметр("Организация", ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьСписокОбособленныхПодразделений(ПараметрыОтчета.ОрганизацияРасшифровки));
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "Организация = &Организация", "Организация В (&Организация)");
		
	КонецЕсли;
	
	Результат = Запрос.Выполнить();
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СформироватьТаблицуОрганизаций(ПараметрыОтчета, ДокументРезультат, Результат.Выгрузить(), 
			"Доходы", 1, "Доходы", КэшПараметровОтчета);
		Возврат;
		
	Иначе
		
		ИмяМакета     = "Доходы" + ПараметрыОтчета.СуффиксСхемы;
		ДокументСхемы = ПолучитьМакет(ИмяМакета);
		ЭлементыСхемы = ДокументСхемы.ЭлементыГрафическойСхемы;
		
	КонецЕсли;
	
	Выборка = Результат.Выбрать();
	Выборка.Следующий();
	
	ЗаполнитьСхему(ЭлементыСхемы, Выборка, Результат.Колонки);
		
	НастроитьРамку(Выборка, "Доходы", 	  ЭлементыСхемы.РасшифровкаНалог, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);	
	НастроитьРамку(Выборка, "Доходы9091", ЭлементыСхемы.Расшифровка9091,  СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);	
	НастроитьРамку(Выборка, "Доходы91НЕ", ЭлементыСхемы.Расшифровка91Не,  СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "Доходы91Уч", ЭлементыСхемы.Расшифровка91Уч,  СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "Доходы90",   ЭлементыСхемы.Расшифровка90, 	  СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "Доходы91",   ЭлементыСхемы.Расшифровка91, 	  СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	
	Если НЕ ПараметрыОтчета.ВключатьОбособленныеПодразделения Тогда
		
		РасшифровкаМакета.Вставить("РасшифровкаНалог", ПереходКСхеме(ПараметрыОтчета, 0, СтруктураВП));
		ЭлементыСхемы.РасшифровкаНалог.Гиперссылка = Истина;
		
	КонецЕсли;	
		
	РасшифровкаМакета.Вставить("Расшифровка90",   ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаВыручкаПоОбычнымВидамДеятельности"));
	РасшифровкаМакета.Вставить("Расшифровка9091", ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаДоходыУчитываемыеПриОпределенииНалоговойБазы"));
	РасшифровкаМакета.Вставить("Расшифровка91НЕ", ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаДоходыНеУчитываемыеВНалоговойБазе"));
	РасшифровкаМакета.Вставить("Расшифровка91Уч", ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаПрочиеДоходыУчитываемыеВНУ"));
	РасшифровкаМакета.Вставить("Расшифровка91",   ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаПрочиеДоходы"));
		
	Если СтруктураВП.ПоказыватьЛегенду Тогда
		
		ВывестиЛегенду(ЭлементыСхемы);
		
	КонецЕсли;
	
	ЭлементыСхемы.НазваниеОрганизации.Наименование = ЗаголовокОтчета(ПараметрыОтчета);
	
	// Сохраняем историю
	СохранитьИсториюСхемы(КэшПараметровОтчета, ИмяМакета, РасшифровкаМакета, НастройкаРамок, ЭлементыСхемы);
	
КонецПроцедуры

Процедура СформироватьРасходы(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета)
	
	СтруктураВП = КэшПараметровОтчета.СтруктураВП;
	
	РасшифровкаМакета = Новый Структура;
	НастройкаРамок    = Новый Структура;
	
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц; // Для СоздатьДолиЕНВД().
	
	СписокОП = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьСписокОбособленныхПодразделений(ПараметрыОтчета.ОрганизацияРасшифровки);
	
	Запрос.УстановитьПараметр("НачалоПериода", ПараметрыОтчета.НачалоПериода);
	Запрос.УстановитьПараметр("КонецПериода",  КонецДня(ПараметрыОтчета.КонецПериода));
	Запрос.УстановитьПараметр("Организация",   ПараметрыОтчета.ОрганизацияРасшифровки);
	Запрос.УстановитьПараметр("СписокОП", 	   СписокОП);
	
	УстановитьПараметрыСчетаВыручкиСебестоимости(Запрос, ПараметрыОтчета.КонецПериода, ПараметрыОтчета.ОрганизацияРасшифровки);
	
	Налоговыйучет.СоздатьДолиЕНВД(
		Запрос.МенеджерВременныхТаблиц,
		Запрос.Параметры.НачалоПериода,
		Запрос.Параметры.КонецПериода,
		Запрос.Параметры.СписокОП); 
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ПрочиеДоходыИРасходы.Ссылка КАК Ссылка
	|ПОМЕСТИТЬ СтатьиПрибылиУбыткиПрошлыхЛет
	|ИЗ
	|	Справочник.ПрочиеДоходыИРасходы КАК ПрочиеДоходыИРасходы
	|ГДЕ
	|	ПрочиеДоходыИРасходы.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрибыльУбытокПрошлыхЛет)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация КАК Организация,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПрямыеРасходыТоварыУчБУ,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПрямыеРасходыТоварыУчНУ,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПрямыеРасходыТоварыУчПР,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПрямыеРасходыТоварыУчВР,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПрямыеРасходыУслугиБУ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПрямыеРасходыУслугиНУ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПрямыеРасходыУслугиПР,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПрямыеРасходыУслугиВР,
	|	0 КАК ТранспортныеРасходыБУ,
	|	0 КАК ТранспортныеРасходыНУ,
	|	0 КАК ТранспортныеРасходыПР,
	|	0 КАК ТранспортныеРасходыВР,
	|	0 КАК КосвенныеРасходыНЕБУ,
	|	0 КАК КосвенныеРасходыНеНУ,
	|	0 КАК КосвенныеРасходыНеПР,
	|	0 КАК КосвенныеРасходыНеВР,
	|	0 КАК КосвенныеРасходыУчБУ,
	|	0 КАК КосвенныеРасходыУчНУ,
	|	0 КАК КосвенныеРасходыУчПР,
	|	0 КАК КосвенныеРасходыУчВР,
	|	0 КАК ПрочиеРасходыУчБУ,
	|	0 КАК ПрочиеРасходыУчНУ,
	|	0 КАК ПрочиеРасходыУчПР,
	|	0 КАК ПрочиеРасходыУчВР,
	|	0 КАК ПрочиеРасходыНеБУ,
	|	0 КАК ПрочиеРасходыНеНУ,
	|	0 КАК ПрочиеРасходыНеПР,
	|	0 КАК ПрочиеРасходыНеВР,
	|	0 КАК ПрямыеРасходыТоварыНеБУ,
	|	0 КАК ПрямыеРасходыТоварыНеНУ,
	|	0 КАК ПрямыеРасходыТоварыНеПР,
	|	0 КАК ПрямыеРасходыТоварыНеВр,
	|	0 КАК КосвенныеРасходыРаспрБУ,
	|	0 КАК КосвенныеРасходыРаспрНУ,
	|	0 КАК КосвенныеРасходыРаспрПР,
	|	0 КАК КосвенныеРасходыРаспрВР
	|ПОМЕСТИТЬ ВТХозрасчетный
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, , Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД)), , Организация = &Организация, , ) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			Месяц,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов)),
	|			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДС), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСНачисленныйПоОтгрузке)),
	|			) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ВЫБОР
	|					КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|						ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|					ИНАЧЕ 0
	|				КОНЕЦ + ВЫБОР
	|					КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|						ТОГДА ХозрасчетныйОбороты.СуммаОборотДт * (1 - ДолиЕНВД.ДоляЕНВД)
	|					ИНАЧЕ 0
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ВЫБОР
	|					КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|						ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|					ИНАЧЕ 0
	|				КОНЕЦ + ВЫБОР
	|					КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|						ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт * (1 - ДолиЕНВД.ДоляЕНВД)
	|					ИНАЧЕ 0
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ВЫБОР
	|					КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|						ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|					ИНАЧЕ 0
	|				КОНЕЦ + ВЫБОР
	|					КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|						ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт * (1 - ДолиЕНВД.ДоляЕНВД)
	|					ИНАЧЕ 0
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|			ТОГДА ВЫБОР
	|					КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|						ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|					ИНАЧЕ 0
	|				КОНЕЦ + ВЫБОР
	|					КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|						ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт * (1 - ДолиЕНВД.ДоляЕНВД)
	|					ИНАЧЕ 0
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			Месяц,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|				И НЕ ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов)),
	|			,
	|			) КАК ХозрасчетныйОбороты
	|		ЛЕВОЕ СОЕДИНЕНИЕ ДолиЕНВД КАК ДолиЕНВД
	|		ПО ХозрасчетныйОбороты.Период = ДолиЕНВД.МесяцЕНВД
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения)
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения)
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения)
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения)
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ В (ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы), ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ В (ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы), ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ В (ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы), ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ В (ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы), ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, , Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуНеЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыНеЕНВД)), , Организация = &Организация, , ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат)) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОбороты.СуммаОборотДт,
	|	ХозрасчетныйОбороты.СуммаНУОборотДт,
	|	ХозрасчетныйОбороты.СуммаПРОборотДт,
	|	ХозрасчетныйОбороты.СуммаВРОборотДт
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуНеЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыНеЕНВД)),
	|			,
	|			Организация = &Организация
	|				И КорСубконто1.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|				И НЕ КорСубконто1.ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения),
	|			,
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат)) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОбороты.СуммаНУОборотКт,
	|	ХозрасчетныйОбороты.СуммаПРОборотКт,
	|	ХозрасчетныйОбороты.СуммаВРОборотКт,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.РасходыБудущихПериодов),
	|			Организация = &Организация
	|				И Субконто1.ВидРБП В (ЗНАЧЕНИЕ(Перечисление.ВидыРБП.УбыткиПрошлыхЛет), ЗНАЧЕНИЕ(Перечисление.ВидыРБП.УбыткиОтРеализацииАмортизируемогоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыРБП.УбыткиПрошлыхЛетОбслуживающихПроизводствИХозяйств)),
	|			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрибылиИУбыткиНеЕНВД)),
	|			) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Прибыли.Организация,
	|	0,
	|	-ЕСТЬNULL(СУММА(Прибыли.СуммаНУОборотКт), 0),
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			СчетДт В (&СчетаСебестоимостьПродаж),
	|			,
	|			СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			Организация = &Организация
	|				И СубконтоКт1 В
	|					(ВЫБРАТЬ
	|						СтатьиПрибылиУбыткиПрошлыхЛет.Ссылка
	|					ИЗ
	|						СтатьиПрибылиУбыткиПрошлыхЛет)) КАК Прибыли
	|
	|СГРУППИРОВАТЬ ПО
	|	Прибыли.Организация
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Убытки.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	-ЕСТЬNULL(СУММА(Убытки.СуммаНУОборотДт), 0),
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			СчетКт В (&СчетаВыручка),
	|			,
	|			Организация = &Организация
	|				И СубконтоДт1 В
	|					(ВЫБРАТЬ
	|						СтатьиПрибылиУбыткиПрошлыхЛет.Ссылка
	|					ИЗ
	|						СтатьиПрибылиУбыткиПрошлыхЛет)) КАК Убытки
	|
	|СГРУППИРОВАТЬ ПО
	|	Убытки.Организация
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТХозрасчетный.Организация КАК Организация,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыУчБУ) КАК ПрямыеРасходыТоварыУчБУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыУчНУ) КАК ПрямыеРасходыТоварыУчНУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыУчПР) КАК ПрямыеРасходыТоварыУчПР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыУчВР) КАК ПрямыеРасходыТоварыУчВР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыУслугиБУ) КАК ПрямыеРасходыУслугиБУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыУслугиНУ) КАК ПрямыеРасходыУслугиНУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыУслугиПР) КАК ПрямыеРасходыУслугиПР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыУслугиВР) КАК ПрямыеРасходыУслугиВР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыУчБУ) КАК ПрочиеРасходыУчБУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыУчНУ) КАК ПрочиеРасходыУчНУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыУчПР) КАК ПрочиеРасходыУчПР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыУчВР) КАК ПрочиеРасходыУчВР,
	|	СУММА(ВТХозрасчетный.ТранспортныеРасходыБУ) КАК ТранспортныеРасходыБУ,
	|	СУММА(ВТХозрасчетный.ТранспортныеРасходыНУ) КАК ТранспортныеРасходыНУ,
	|	СУММА(ВТХозрасчетный.ТранспортныеРасходыПР) КАК ТранспортныеРасходыПР,
	|	СУММА(ВТХозрасчетный.ТранспортныеРасходыВР) КАК ТранспортныеРасходыВР,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыНЕБУ) КАК КосвенныеРасходыНЕБУ,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыНеНУ) КАК КосвенныеРасходыНеНУ,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыНеПР) КАК КосвенныеРасходыНеПР,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыНеВР) КАК КосвенныеРасходыНеВР,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыУчБУ) КАК КосвенныеРасходыУчБУ,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыУчНУ) КАК КосвенныеРасходыУчНУ,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыУчПР) КАК КосвенныеРасходыУчПР,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыУчВР) КАК КосвенныеРасходыУчВР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыНеБУ) КАК ПрочиеРасходыНеБУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыНеНУ) КАК ПрочиеРасходыНеНУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыНеПР) КАК ПрочиеРасходыНеПР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыНеВР) КАК ПрочиеРасходыНеВР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыНеБУ) КАК ПрямыеРасходыТоварыНеБУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыНеНУ) КАК ПрямыеРасходыТоварыНеНУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыНеПР) КАК ПрямыеРасходыТоварыНеПР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыНеВр) КАК ПрямыеРасходыТоварыНеВр,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыРаспрБУ) КАК КосвенныеРасходыРаспрБУ,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыРаспрНУ) КАК КосвенныеРасходыРаспрНУ,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыРаспрПР) КАК КосвенныеРасходыРаспрПР,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыРаспрВР) КАК КосвенныеРасходыРаспрВР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыУчБУ + ВТХозрасчетный.ПрямыеРасходыУслугиБУ + ВТХозрасчетный.ПрочиеРасходыУчБУ + ВТХозрасчетный.ТранспортныеРасходыБУ + ВТХозрасчетный.КосвенныеРасходыНЕБУ + ВТХозрасчетный.КосвенныеРасходыУчБУ + ВТХозрасчетный.ПрочиеРасходыНеБУ + ВТХозрасчетный.ПрямыеРасходыТоварыНеБУ + ВТХозрасчетный.КосвенныеРасходыРаспрБУ) КАК РасходыБУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыУчНУ + ВТХозрасчетный.ПрямыеРасходыУслугиНУ + ВТХозрасчетный.ПрочиеРасходыУчНУ + ВТХозрасчетный.ТранспортныеРасходыНУ + ВТХозрасчетный.КосвенныеРасходыНеНУ + ВТХозрасчетный.КосвенныеРасходыУчНУ + ВТХозрасчетный.ПрочиеРасходыНеНУ + ВТХозрасчетный.ПрямыеРасходыТоварыНеНУ + ВТХозрасчетный.КосвенныеРасходыРаспрНУ) КАК РасходыНУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыУчПР + ВТХозрасчетный.ПрямыеРасходыУслугиПР + ВТХозрасчетный.ПрочиеРасходыУчПР + ВТХозрасчетный.ТранспортныеРасходыПР + ВТХозрасчетный.КосвенныеРасходыНеПР + ВТХозрасчетный.КосвенныеРасходыУчПР + ВТХозрасчетный.ПрочиеРасходыНеПР + ВТХозрасчетный.ПрямыеРасходыТоварыНеПР + ВТХозрасчетный.КосвенныеРасходыРаспрПР) КАК РасходыПР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыУчВР + ВТХозрасчетный.ПрямыеРасходыУслугиВР + ВТХозрасчетный.ПрочиеРасходыУчВР + ВТХозрасчетный.ТранспортныеРасходыВР + ВТХозрасчетный.КосвенныеРасходыНеВР + ВТХозрасчетный.КосвенныеРасходыУчВР + ВТХозрасчетный.ПрочиеРасходыНеВР + ВТХозрасчетный.ПрямыеРасходыТоварыНеВр + ВТХозрасчетный.КосвенныеРасходыРаспрВР) КАК РасходыВР
	|ИЗ
	|	ВТХозрасчетный КАК ВТХозрасчетный
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТХозрасчетный.Организация";
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СписокОП = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьСписокОбособленныхПодразделений(ПараметрыОтчета.ОрганизацияРасшифровки);
		Запрос.УстановитьПараметр("Организация", СписокОП);
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "Организация = &Организация", "Организация В (&Организация)");
		
	КонецЕсли;
	
	Результат = Запрос.Выполнить();
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СформироватьТаблицуОрганизаций(ПараметрыОтчета, ДокументРезультат, Результат.Выгрузить(), 
			"Расходы", 2, "Расходы", КэшПараметровОтчета);
		Возврат;
		
	Иначе
		
		ЭтоЕНВД       = УчетнаяПолитика.ПлательщикЕНВД(ПараметрыОтчета.ОрганизацияРасшифровки, ПараметрыОтчета.КонецПериода);
		ИмяМакета	  = ?(ЭтоЕНВД, "РасходыЕНВД", "Расходы") + ПараметрыОтчета.СуффиксСхемы;
		ДокументСхемы = ПолучитьМакет(ИмяМакета);
		ЭлементыСхемы = ДокументСхемы.ЭлементыГрафическойСхемы;
		
	КонецЕсли;
	
	Выборка = Результат.Выбрать();
	Выборка.Следующий();
	
	НастроитьРамку(Выборка, "Расходы",               ЭлементыСхемы.РасшифровкаНалог,               СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);	
	НастроитьРамку(Выборка, "ПрямыеРасходыТоварыУч", ЭлементыСхемы.РасшифровкаРасходыТовары,       СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "ПрочиеРасходыУч",       ЭлементыСхемы.РасшифровкаПрочиеРасходы,       СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "ПрямыеРасходыУслуги",   ЭлементыСхемы.РасшифровкаРасходыПроизводства, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "ПрочиеРасходыНе",       ЭлементыСхемы.РасшифровкаПрочиеРасходы_1,     СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "ТранспортныеРасходы",   ЭлементыСхемы.РасшифровкаТраспортныеРасходы,  СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "ПрямыеРасходыТоварыНе", ЭлементыСхемы.РасшифровкаРасходыТовары_1,     СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "КосвенныеРасходыУч",    ЭлементыСхемы.РасшифровкаКосвенныеРасходы,    СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "КосвенныеРасходыНе",    ЭлементыСхемы.РасшифровкаКосвенныеРасходы_1,  СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	
	Если ЭтоЕНВД Тогда
		
		НастроитьРамку(Выборка, "КосвенныеРасходыРаспр", ЭлементыСхемы.РасшифровкаРаспределяемыеРасходы, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
		
	КонецЕсли;
	
	ЗаполнитьСхему(ЭлементыСхемы, Выборка, Результат.Колонки);
			
	Если НЕ ПараметрыОтчета.ВключатьОбособленныеПодразделения Тогда
		
		РасшифровкаМакета.Вставить("РасшифровкаНалог", ПереходКСхеме(ПараметрыОтчета, 0, СтруктураВП));
		
	КонецЕсли;
	
	РасшифровкаМакета.Вставить("РасшифровкаРасходыТовары",         ПереходКСхеме(ПараметрыОтчета, 3,  СтруктураВП));
	РасшифровкаМакета.Вставить("РасшифровкаРасходыПроизводства",   ПереходКСхеме(ПараметрыОтчета, 4,  СтруктураВП));
	РасшифровкаМакета.Вставить("РасшифровкаТраспортныеРасходы",    ПереходКСхеме(ПараметрыОтчета, 5,  СтруктураВП));
	РасшифровкаМакета.Вставить("РасшифровкаКосвенныеРасходы",      ПереходКСхеме(ПараметрыОтчета, 6,  СтруктураВП));
	РасшифровкаМакета.Вставить("РасшифровкаПрочиеРасходы",         ПереходКСхеме(ПараметрыОтчета, 7,  СтруктураВП));
	РасшифровкаМакета.Вставить("РасшифровкаРаспределяемыеРасходы", ПереходКСхеме(ПараметрыОтчета, 8,  СтруктураВП));
	РасшифровкаМакета.Вставить("РасшифровкаРасходыОбычные",        ПереходКСхеме(ПараметрыОтчета, 10, СтруктураВП));
	
	Если СтруктураВП.ПоказыватьЛегенду Тогда
		
		ВывестиЛегенду(ЭлементыСхемы);
		
	КонецЕсли;
	
	ЭлементыСхемы.НазваниеОрганизации.Наименование = ЗаголовокОтчета(ПараметрыОтчета);
	
	// Сохраняем историю
	СохранитьИсториюСхемы(КэшПараметровОтчета, ИмяМакета, РасшифровкаМакета, НастройкаРамок, ЭлементыСхемы);
	
КонецПроцедуры

Процедура СформироватьОбычныеРасходы(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета)
	
	СтруктураВП	= КэшПараметровОтчета.СтруктураВП;
	
	РасшифровкаМакета = Новый Структура;
	НастройкаРамок    = Новый Структура;
	
	МассивСтатьиЗатратНомГруппы = Новый Массив;
	МассивСтатьиЗатратНомГруппы.Добавить(ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат);
	МассивСтатьиЗатратНомГруппы.Добавить(ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы);
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("НачалоПериодаПрошлого", '20000101');
	Запрос.УстановитьПараметр("КонецПериодаПрошлого",  НачалоДня(ПараметрыОтчета.НачалоПериода) - 1);
	Запрос.УстановитьПараметр("НачалоПериода",		   ПараметрыОтчета.НачалоПериода);
	Запрос.УстановитьПараметр("КонецПериода",		   КонецДня(ПараметрыОтчета.КонецПериода));
	Запрос.УстановитьПараметр("Организация", 		   ПараметрыОтчета.ОрганизацияРасшифровки);
	Запрос.УстановитьПараметр("СтатьиЗатратНомГруппы", МассивСтатьиЗатратНомГруппы);
	                                                                                    
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.НоменклатурныеГруппы) КАК Субконто1
	|ПОМЕСТИТЬ ВТНоменклатурныеГруппы
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, , Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыручкаЕНВД)), ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы), Организация = &Организация, , ) КАК ХозрасчетныйОбороты
	|
	|СГРУППИРОВАТЬ ПО
	|	ХозрасчетныйОбороты.Субконто1
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Субконто1
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ХозрасчетныйОстаткиИОбороты.Организация КАК Организация,
	|	0 КАК РасходыТранспортныеБУ,
	|	0 КАК РасходыТранспортныеНУ,
	|	0 КАК РасходыТранспортныеПР,
	|	0 КАК РасходыТранспортныеВР,
	|	0 КАК РасходыТранспортныеНачБУ,
	|	0 КАК РасходыТранспортныеНачНУ,
	|	0 КАК РасходыТранспортныеНачПР,
	|	0 КАК РасходыТранспортныеНачВР,
	|	0 КАК Расходы1БУ,
	|	0 КАК Расходы1НУ,
	|	0 КАК Расходы1ПР,
	|	0 КАК Расходы1Вр,
	|	0 КАК Расходы2БУ,
	|	0 КАК Расходы2НУ,
	|	0 КАК Расходы2Пр,
	|	0 КАК Расходы2ВР,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток КАК РасходыПрямыеБУ,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНУНачальныйОстаток КАК РасходыПрямыеНУ,
	|	ХозрасчетныйОстаткиИОбороты.СуммаПРНачальныйОстаток КАК РасходыПрямыеПР,
	|	ХозрасчетныйОстаткиИОбороты.СуммаВРНачальныйОстаток КАК РасходыПрямыеВР,
	|	0 КАК РасходыКосвенныеБУ,
	|	0 КАК РасходыКосвенныеНУ,
	|	0 КАК РасходыКосвенныеПР,
	|	0 КАК РасходыКосвенныеВР,
	|	0 КАК АмортизацияБУ,
	|	0 КАК АмортизацияНУ,
	|	0 КАК АмортизацияПР,
	|	0 КАК АмортизацияВР,
	|	0 КАК Расходы3БУ,
	|	0 КАК Расходы3НУ,
	|	0 КАК Расходы3ПР,
	|	0 КАК Расходы3ВР,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток КАК НЗПБУ,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНУНачальныйОстаток КАК НЗПНУ,
	|	ХозрасчетныйОстаткиИОбороты.СуммаПРНачальныйОстаток КАК НЗППР,
	|	ХозрасчетныйОстаткиИОбороты.СуммаВРНачальныйОстаток КАК НЗПВР
	|ПОМЕСТИТЬ ВТХозрасчетный
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы),
	|			НЕ ВЫРАЗИТЬ(Субконто1 КАК Справочник.НоменклатурныеГруппы) В
	|						(ВЫБРАТЬ
	|							ВТНоменклатурныеГруппы.Субконто1
	|						ИЗ
	|							ВТНоменклатурныеГруппы КАК ВТНоменклатурныеГруппы)
	|				И Организация = &Организация) КАК ХозрасчетныйОстаткиИОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				ИЛИ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|					И ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ <> ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.Амортизация)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				ИЛИ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|					И ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ <> ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.Амортизация)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				ИЛИ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|					И ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ <> ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.Амортизация)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				ИЛИ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|					И ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ <> ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.Амортизация)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|				И НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|				И НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|				И НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|				И НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу))
	|				И НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу))
	|				И НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу))
	|				И НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу))
	|				И НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.Амортизация)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.Амортизация)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.Амортизация)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.Амортизация)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|				ИЛИ Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения),
	|			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства)),
	|			) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОстаткиИОбороты.Организация,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОстаткиИОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаОборотДт + ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОстаткиИОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаНУОборотДт + ХозрасчетныйОстаткиИОбороты.СуммаНУНачальныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОстаткиИОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаПРОборотДт + ХозрасчетныйОстаткиИОбороты.СуммаПРНачальныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОстаткиИОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаВРОборотДт + ХозрасчетныйОстаткиИОбороты.СуммаВРНачальныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОстаткиИОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОстаткиИОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаНУНачальныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОстаткиИОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаПРНачальныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОстаткиИОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаВРНачальныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОстаткиИОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|				И НЕ ХозрасчетныйОстаткиИОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОстаткиИОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|				И НЕ ХозрасчетныйОстаткиИОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаНУНачальныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОстаткиИОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|				И НЕ ХозрасчетныйОстаткиИОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаПРНачальныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОстаткиИОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)
	|				И НЕ ХозрасчетныйОстаткиИОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаВРНачальныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)) КАК ХозрасчетныйОстаткиИОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОстаткиИОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНУНачальныйОстаток,
	|	ХозрасчетныйОстаткиИОбороты.СуммаПРНачальныйОстаток,
	|	ХозрасчетныйОстаткиИОбороты.СуммаВРНачальныйОстаток,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНУНачальныйОстаток,
	|	ХозрасчетныйОстаткиИОбороты.СуммаПРНачальныйОстаток,
	|	ХозрасчетныйОстаткиИОбороты.СуммаВРНачальныйОстаток
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, , , Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПроизводствоИзДавальческогоСырья)), , Организация = &Организация) КАК ХозрасчетныйОстаткиИОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОбороты.СуммаВРОборотКт,
	|	0,
	|	-ХозрасчетныйОбороты.СуммаВРОборотКт,
	|	0,
	|	-ХозрасчетныйОбороты.СуммаВРОборотКт,
	|	0,
	|	ХозрасчетныйОбороты.СуммаВРОборотКт,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат),
	|			Организация = &Организация
	|				И Субконто1.ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения),
	|			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыНеЕНВД)),
	|			) КАК ХозрасчетныйОбороты
	|ГДЕ
	|	ХозрасчетныйОбороты.СуммаВРОборотКт < 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОбороты.СуммаОборотДт - ХозрасчетныйОбороты.СуммаОборотКт,
	|	ХозрасчетныйОбороты.СуммаНУОборотДт - ХозрасчетныйОбороты.СуммаНУОборотКт,
	|	ХозрасчетныйОбороты.СуммаПРОборотДт - ХозрасчетныйОбороты.СуммаПРОборотКт,
	|	ХозрасчетныйОбороты.СуммаВРОборотДт - ХозрасчетныйОбороты.СуммаВРОборотКт,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериодаПрошлого,
	|			&КонецПериодаПрошлого,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ В (ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ДобровольноеЛичноеСтрахование), ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ДобровольноеЛичноеСтрахованиеНаСлучайСмертиИлиУтратыРаботоспособности), ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ДобровольноеСтрахованиеПоДоговорамДолгосрочногоСтрахованияЖизниРаботников), ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ПредставительскиеРасходы), ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.РасходыНаВозмещениеЗатратРаботниковПоУплатеПроцентов), ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.РасходыНаРекламуНормируемые)),
	|			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства)),
	|			) КАК ХозрасчетныйОбороты
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТХозрасчетный.Организация,
	|	СУММА(ВТХозрасчетный.РасходыТранспортныеБУ) КАК РасходыТранспортныеБУ,
	|	СУММА(ВТХозрасчетный.РасходыТранспортныеНУ) КАК РасходыТранспортныеНУ,
	|	СУММА(ВТХозрасчетный.РасходыТранспортныеПР) КАК РасходыТранспортныеПР,
	|	СУММА(ВТХозрасчетный.РасходыТранспортныеВР) КАК РасходыТранспортныеВР,
	|	СУММА(ВТХозрасчетный.РасходыТранспортныеНачБУ) КАК РасходыТранспортныеНачБУ,
	|	СУММА(ВТХозрасчетный.РасходыТранспортныеНачНУ) КАК РасходыТранспортныеНачНУ,
	|	СУММА(ВТХозрасчетный.РасходыТранспортныеНачПР) КАК РасходыТранспортныеНачПР,
	|	СУММА(ВТХозрасчетный.РасходыТранспортныеНачВР) КАК РасходыТранспортныеНачВР,
	|	СУММА(ВТХозрасчетный.Расходы1БУ) КАК Расходы1БУ,
	|	СУММА(ВТХозрасчетный.Расходы1НУ) КАК Расходы1НУ,
	|	СУММА(ВТХозрасчетный.Расходы1ПР) КАК Расходы1ПР,
	|	СУММА(ВТХозрасчетный.Расходы1Вр) КАК Расходы1Вр,
	|	СУММА(ВТХозрасчетный.Расходы2БУ) КАК Расходы2БУ,
	|	СУММА(ВТХозрасчетный.Расходы2НУ) КАК Расходы2НУ,
	|	СУММА(ВТХозрасчетный.Расходы2Пр) КАК Расходы2Пр,
	|	СУММА(ВТХозрасчетный.Расходы2ВР) КАК Расходы2ВР,
	|	СУММА(ВТХозрасчетный.РасходыПрямыеБУ) КАК РасходыПрямыеБУ,
	|	СУММА(ВТХозрасчетный.РасходыПрямыеНУ) КАК РасходыПрямыеНУ,
	|	СУММА(ВТХозрасчетный.РасходыПрямыеПР) КАК РасходыПрямыеПР,
	|	СУММА(ВТХозрасчетный.РасходыПрямыеВР) КАК РасходыПрямыеВР,
	|	СУММА(ВТХозрасчетный.РасходыКосвенныеБУ) КАК РасходыКосвенныеБУ,
	|	СУММА(ВТХозрасчетный.РасходыКосвенныеНУ) КАК РасходыКосвенныеНУ,
	|	СУММА(ВТХозрасчетный.РасходыКосвенныеПР) КАК РасходыКосвенныеПР,
	|	СУММА(ВТХозрасчетный.РасходыКосвенныеВР) КАК РасходыКосвенныеВР,
	|	СУММА(ВТХозрасчетный.РасходыПрямыеБУ + ВТХозрасчетный.РасходыКосвенныеБУ + ВТХозрасчетный.РасходыТранспортныеБУ) КАК РасходыБУ,
	|	СУММА(ВТХозрасчетный.РасходыПрямыеНУ + ВТХозрасчетный.РасходыКосвенныеНУ + ВТХозрасчетный.РасходыТранспортныеНУ) КАК РасходыНУ,
	|	СУММА(ВТХозрасчетный.РасходыПрямыеПР + ВТХозрасчетный.РасходыКосвенныеПР + ВТХозрасчетный.РасходыТранспортныеПР) КАК РасходыПР,
	|	СУММА(ВТХозрасчетный.РасходыПрямыеВР + ВТХозрасчетный.РасходыКосвенныеВР + ВТХозрасчетный.РасходыТранспортныеВР) КАК РасходыВР,
	|	СУММА(ВТХозрасчетный.АмортизацияБУ) КАК АмортизацияБУ,
	|	СУММА(ВТХозрасчетный.АмортизацияНУ) КАК АмортизацияНУ,
	|	СУММА(ВТХозрасчетный.АмортизацияПР) КАК АмортизацияПР,
	|	СУММА(ВТХозрасчетный.АмортизацияВР) КАК АмортизацияВР,
	|	СУММА(ВТХозрасчетный.Расходы3БУ) КАК Расходы3БУ,
	|	СУММА(ВТХозрасчетный.Расходы3НУ) КАК Расходы3НУ,
	|	СУММА(ВТХозрасчетный.Расходы3ПР) КАК Расходы3ПР,
	|	СУММА(ВТХозрасчетный.Расходы3ВР) КАК Расходы3ВР,
	|	СУММА(ВТХозрасчетный.НЗПБУ) КАК НЗПБУ,
	|	СУММА(ВТХозрасчетный.НЗПНУ) КАК НЗПНУ,
	|	СУММА(ВТХозрасчетный.НЗППР) КАК НЗППР,
	|	СУММА(ВТХозрасчетный.НЗПВР) КАК НЗПВР
	|ИЗ
	|	ВТХозрасчетный КАК ВТХозрасчетный
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТХозрасчетный.Организация";
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		Запрос.УстановитьПараметр("Организация", ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьСписокОбособленныхПодразделений(ПараметрыОтчета.ОрганизацияРасшифровки));
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "Организация = &Организация", "Организация В (&Организация)");
		
	КонецЕсли;
	
	Результат = Запрос.Выполнить();
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СформироватьТаблицуОрганизаций(ПараметрыОтчета, ДокументРезультат, Результат.Выгрузить(), "Расходы", 10, 
			"Расходы по обычным видам деятельности", КэшПараметровОтчета);
		Возврат;
		
	Иначе
		
		ИмяМакета     = "РасходыОбычные" + ПараметрыОтчета.СуффиксСхемы;
		ДокументСхемы = ПолучитьМакет(ИмяМакета);
		ЭлементыСхемы = ДокументСхемы.ЭлементыГрафическойСхемы;
		
	КонецЕсли;
	
	Выборка = Результат.Выбрать();
	Выборка.Следующий();
	
	ЗаполнитьСхему(ЭлементыСхемы, Выборка, Результат.Колонки);
	
	НастроитьРамку(Выборка, "РасходыПрямые",          ЭлементыСхемы.РасшифровкаРасходыПрямые,          СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "РасходыКосвенные",       ЭлементыСхемы.РасшифровкаРасходыКосвенные,       СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "РасходыТранспортные",    ЭлементыСхемы.РасшифровкаРасходыТранспортные,    СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "Расходы1",               ЭлементыСхемы.РасшифровкаРасходы1,               СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "Амортизация",            ЭлементыСхемы.РасшифровкаАмортизация,            СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "Расходы2",               ЭлементыСхемы.РасшифровкаРасходы2,               СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "РасходыТранспортныеНач", ЭлементыСхемы.РасшифровкаРасходыТранспортныеНач, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "Расходы3",               ЭлементыСхемы.РасшифровкаРасходы3,               СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "НЗП",                    ЭлементыСхемы.РасшифровкаНЗП,                    СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "Расходы",                ЭлементыСхемы.Расходы,                           СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);	
	
	РасшифровкаМакета.Вставить("РасшифровкаРасходы1",               ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаСтоимостьТоваровРБП"));
	РасшифровкаМакета.Вставить("РасшифровкаРасходыПрямые",          ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаПрямыеПроизводственныеРасходы"));
	РасшифровкаМакета.Вставить("РасшифровкаРасходыКосвенные",       ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаКосвенныеРасходы"));
	РасшифровкаМакета.Вставить("РасшифровкаРасходыТранспортные",    ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаТранспортныхРасходов"));
	РасшифровкаМакета.Вставить("РасшифровкаРасходыТранспортныеНач", ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаТранспортныхРасходовОтнесенныхНаНачалоПериода"));
	РасшифровкаМакета.Вставить("РасшифровкаАмортизация",            ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаАмортизация"));
	РасшифровкаМакета.Вставить("РасшифровкаРасходы2",               ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаУслугиСтороннихОрганизаций"));
	РасшифровкаМакета.Вставить("РасшифровкаРасходы3",               ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаКосвенныеРасходыНеВключенные"));
	РасшифровкаМакета.Вставить("РасшифровкаНЗП",                    ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаНезавершенноеПроизводствоПрошлыхЛет"));
	
	Если СтруктураВП.ПоказыватьЛегенду Тогда
		
		ВывестиЛегенду(ЭлементыСхемы);
		
	КонецЕсли;
	
	ЭлементыСхемы.НазваниеОрганизации.Наименование 	= ЗаголовокОтчета(ПараметрыОтчета);
	
	// Сохраняем историю
	СохранитьИсториюСхемы(КэшПараметровОтчета, ИмяМакета, РасшифровкаМакета, НастройкаРамок, ЭлементыСхемы);

КонецПроцедуры

Процедура СформироватьПрочиеРасходы(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета)
	
	СтруктураВП = КэшПараметровОтчета.СтруктураВП;
	
	РасшифровкаМакета = Новый Структура;
	НастройкаРамок    = Новый Структура;
	
	СписокОП = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьСписокОбособленныхПодразделений(ПараметрыОтчета.ОрганизацияРасшифровки);
	
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц; // Для СоздатьДолиЕНВД()
	
	Запрос.УстановитьПараметр("НачалоПериода", ПараметрыОтчета.НачалоПериода);
	Запрос.УстановитьПараметр("КонецПериода",  КонецДня(ПараметрыОтчета.КонецПериода));
	Запрос.УстановитьПараметр("Организация",   ПараметрыОтчета.ОрганизацияРасшифровки);
	Запрос.УстановитьПараметр("СписокОП",      СписокОП);
	
	УстановитьПараметрыСчетаВыручкиСебестоимости(Запрос, ПараметрыОтчета.КонецПериода, ПараметрыОтчета.ОрганизацияРасшифровки);
	
	Налоговыйучет.СоздатьДолиЕНВД(
		Запрос.МенеджерВременныхТаблиц,
		Запрос.Параметры.НачалоПериода,
		Запрос.Параметры.КонецПериода,
		Запрос.Параметры.СписокОП); 
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ПрочиеДоходыИРасходы.Ссылка КАК Ссылка
	|ПОМЕСТИТЬ СтатьиПрибылиУбыткиПрошлыхЛет
	|ИЗ
	|	Справочник.ПрочиеДоходыИРасходы КАК ПрочиеДоходыИРасходы
	|ГДЕ
	|	ПрочиеДоходыИРасходы.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрибыльУбытокПрошлыхЛет)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация КАК Организация,
	|	ХозрасчетныйОбороты.СуммаОборотДт КАК ПрочиеРасходыОСБУ,
	|	ХозрасчетныйОбороты.СуммаНУОборотДт КАК ПрочиеРасходыОСНУ,
	|	ХозрасчетныйОбороты.СуммаПРОборотДт КАК ПрочиеРасходыОСПР,
	|	ХозрасчетныйОбороты.СуммаВРОборотДт КАК ПрочиеРасходыОСВР,
	|	0 КАК ПрочиеРасходыДрБУ,
	|	0 КАК ПрочиеРасходыДрНУ,
	|	0 КАК ПрочиеРасходыДрПР,
	|	0 КАК ПрочиеРасходыДрВР,
	|	0 КАК ПрочиеРасходыНеБУ,
	|	0 КАК ПрочиеРасходыНеНУ,
	|	0 КАК ПрочиеРасходыНеПР,
	|	0 КАК ПрочиеРасходыНеВР,
	|	0 КАК ПрочиеРасходыРаспрБУ,
	|	0 КАК ПрочиеРасходыРаспрНУ,
	|	0 КАК ПрочиеРасходыРаспрПР,
	|	0 КАК ПрочиеРасходыРаспрВР,
	|	ХозрасчетныйОбороты.СуммаОборотДт КАК ПрочиеРасходыНеЕНВДБУ,
	|	ХозрасчетныйОбороты.СуммаНУОборотДт КАК ПрочиеРасходыНеЕНВДНУ,
	|	ХозрасчетныйОбороты.СуммаПРОборотДт КАК ПрочиеРасходыНеЕНВДПР,
	|	ХозрасчетныйОбороты.СуммаВРОборотДт КАК ПрочиеРасходыНеЕНВДВР,
	|	0 КАК ПрочиеРасходыЕНВДБУ,
	|	0 КАК ПрочиеРасходыЕНВДНУ,
	|	0 КАК ПрочиеРасходыЕНВДПР,
	|	0 КАК ПрочиеРасходыЕНВДВР
	|ПОМЕСТИТЬ ВТХозрасчетный
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы))
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету,
	|			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости)),
	|			) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОбороты.СуммаОборотДт,
	|	ХозрасчетныйОбороты.СуммаНУОборотДт,
	|	ХозрасчетныйОбороты.СуммаПРОборотДт,
	|	ХозрасчетныйОбороты.СуммаВРОборотДт,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОбороты.СуммаОборотДт,
	|	ХозрасчетныйОбороты.СуммаНУОборотДт,
	|	ХозрасчетныйОбороты.СуммаПРОборотДт,
	|	ХозрасчетныйОбороты.СуммаВРОборотДт,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|				И НЕ ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы)),
	|			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДС), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСНачисленныйПоОтгрузке)),
	|			) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОбороты.СуммаОборотДт,
	|	ХозрасчетныйОбороты.СуммаНУОборотДт,
	|	ХозрасчетныйОбороты.СуммаПРОборотДт,
	|	ХозрасчетныйОбороты.СуммаВРОборотДт,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОбороты.СуммаОборотДт,
	|	ХозрасчетныйОбороты.СуммаНУОборотДт,
	|	ХозрасчетныйОбороты.СуммаПРОборотДт,
	|	ХозрасчетныйОбороты.СуммаВРОборотДт,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы)),
	|			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДС), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСНачисленныйПоОтгрузке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости)),
	|			) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОбороты.СуммаНУОборотКт,
	|	ХозрасчетныйОбороты.СуммаПРОборотКт,
	|	ХозрасчетныйОбороты.СуммаВРОборотКт,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОбороты.СуммаНУОборотКт,
	|	ХозрасчетныйОбороты.СуммаПРОборотКт,
	|	ХозрасчетныйОбороты.СуммаВРОборотКт,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.РасходыБудущихПериодов),
	|			Организация = &Организация
	|				И Субконто1.ВидРБП В (ЗНАЧЕНИЕ(Перечисление.ВидыРБП.УбыткиПрошлыхЛет), ЗНАЧЕНИЕ(Перечисление.ВидыРБП.УбыткиОтРеализацииАмортизируемогоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыРБП.УбыткиПрошлыхЛетОбслуживающихПроизводствИХозяйств)),
	|			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрибылиИУбыткиНеЕНВД)),
	|			) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОбороты.СуммаОборотДт,
	|	ХозрасчетныйОбороты.СуммаНУОборотДт,
	|	ХозрасчетныйОбороты.СуммаПРОборотДт,
	|	ХозрасчетныйОбороты.СуммаВРОборотДт,
	|	0,
	|	0,
	|	0,
	|	0,
	|	-ХозрасчетныйОбороты.СуммаОборотДт,
	|	-ХозрасчетныйОбороты.СуммаНУОборотДт,
	|	-ХозрасчетныйОбороты.СуммаПРОборотДт,
	|	-ХозрасчетныйОбороты.СуммаВРОборотДт,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|				И НЕ ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету,
	|			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДС), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСНачисленныйПоОтгрузке)),
	|			) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОбороты.СуммаОборотДт,
	|	ХозрасчетныйОбороты.СуммаНУОборотДт,
	|	ХозрасчетныйОбороты.СуммаПРОборотДт,
	|	ХозрасчетныйОбороты.СуммаВРОборотДт,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОбороты.СуммаОборотДт * ДолиЕНВД.ДоляЕНВД,
	|	ХозрасчетныйОбороты.СуммаНУОборотДт * ДолиЕНВД.ДоляЕНВД,
	|	ХозрасчетныйОбороты.СуммаПРОборотДт * ДолиЕНВД.ДоляЕНВД,
	|	ХозрасчетныйОбороты.СуммаВРОборотДт * ДолиЕНВД.ДоляЕНВД
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			Месяц,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыиРасходы),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты),
	|			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДС), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСНачисленныйПоОтгрузке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОСвОрганизации), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования)),
	|			) КАК ХозрасчетныйОбороты
	|		ЛЕВОЕ СОЕДИНЕНИЕ ДолиЕНВД КАК ДолиЕНВД
	|		ПО ХозрасчетныйОбороты.Период = ДолиЕНВД.МесяцЕНВД
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Убытки.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	-ЕСТЬNULL(СУММА(Убытки.СуммаНУОборотДт), 0),
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	-ЕСТЬNULL(СУММА(Убытки.СуммаНУОборотДт), 0),
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			СчетКт В (&СчетаВыручка),
	|			,
	|			Организация = &Организация
	|				И СубконтоДт1 В
	|					(ВЫБРАТЬ
	|						СтатьиПрибылиУбыткиПрошлыхЛет.Ссылка
	|					ИЗ
	|						СтатьиПрибылиУбыткиПрошлыхЛет)) КАК Убытки
	|
	|СГРУППИРОВАТЬ ПО
	|	Убытки.Организация
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТХозрасчетный.Организация КАК Организация,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыОСБУ) КАК ПрочиеРасходыОСБУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыОСНУ) КАК ПрочиеРасходыОСНУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыОСПР) КАК ПрочиеРасходыОСПР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыОСВР) КАК ПрочиеРасходыОСВР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыДрБУ) КАК ПрочиеРасходыДрБУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыДрНУ) КАК ПрочиеРасходыДрНУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыДрПР) КАК ПрочиеРасходыДрПР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыДрВР) КАК ПрочиеРасходыДрВР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыНеБУ) КАК ПрочиеРасходыНеБУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыНеНУ) КАК ПрочиеРасходыНеНУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыНеПР) КАК ПрочиеРасходыНеПР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыНеВР) КАК ПрочиеРасходыНеВР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыРаспрБУ) КАК ПрочиеРасходыРаспрБУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыРаспрНУ) КАК ПрочиеРасходыРаспрНУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыРаспрПР) КАК ПрочиеРасходыРаспрПР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыРаспрВР) КАК ПрочиеРасходыРаспрВР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыНеЕНВДБУ) КАК ПрочиеРасходыНеЕНВДБУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыНеЕНВДНУ) КАК ПрочиеРасходыНеЕНВДНУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыНеЕНВДПР) КАК ПрочиеРасходыНеЕНВДПР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыНеЕНВДВР) КАК ПрочиеРасходыНеЕНВДВР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыЕНВДБУ) КАК ПрочиеРасходыЕНВДБУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыЕНВДНУ) КАК ПрочиеРасходыЕНВДНУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыЕНВДПР) КАК ПрочиеРасходыЕНВДПР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыЕНВДВР) КАК ПрочиеРасходыЕНВДВР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыОСБУ + ВТХозрасчетный.ПрочиеРасходыДрБУ) КАК ПрочиеРасходыБУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыОСНУ + ВТХозрасчетный.ПрочиеРасходыДрНУ) КАК ПрочиеРасходыНУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыОСПР + ВТХозрасчетный.ПрочиеРасходыДрПР) КАК ПрочиеРасходыПР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыОСВР + ВТХозрасчетный.ПрочиеРасходыДрВР) КАК ПрочиеРасходыВР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыНеЕНВДБУ + ВТХозрасчетный.ПрочиеРасходыРаспрБУ - ВТХозрасчетный.ПрочиеРасходыЕНВДБУ) КАК ПрочиеРасходыУчБУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыНеЕНВДНУ + ВТХозрасчетный.ПрочиеРасходыРаспрНУ - ВТХозрасчетный.ПрочиеРасходыЕНВДНУ) КАК ПрочиеРасходыУчНУ,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыНеЕНВДПР + ВТХозрасчетный.ПрочиеРасходыРаспрПР - ВТХозрасчетный.ПрочиеРасходыЕНВДПР) КАК ПрочиеРасходыУчПР,
	|	СУММА(ВТХозрасчетный.ПрочиеРасходыНеЕНВДВР + ВТХозрасчетный.ПрочиеРасходыРаспрВР - ВТХозрасчетный.ПрочиеРасходыЕНВДВР) КАК ПрочиеРасходыУчВР
	|ИЗ
	|	ВТХозрасчетный КАК ВТХозрасчетный
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТХозрасчетный.Организация";
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		Запрос.УстановитьПараметр("Организация", СписокОП);
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "Организация = &Организация", "Организация В (&Организация)");
		
	КонецЕсли;
	
	Результат = Запрос.Выполнить();
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СформироватьТаблицуОрганизаций(ПараметрыОтчета, ДокументРезультат, Результат.Выгрузить(),
			"ПрочиеРасходы", 7, "Прочие расходы", КэшПараметровОтчета);
		Возврат;
		
	Иначе
		
		ЭтоЕНВД       = УчетнаяПолитика.ПлательщикЕНВД(ПараметрыОтчета.ОрганизацияРасшифровки, ПараметрыОтчета.КонецПериода);
		ИмяМакета     = ?(ЭтоЕНВД, "РасходыПрочиеЕНВД", "РасходыПрочие") + ПараметрыОтчета.СуффиксСхемы;
		ДокументСхемы = ПолучитьМакет(ИмяМакета);
		ЭлементыСхемы = ДокументСхемы.ЭлементыГрафическойСхемы;
		
	КонецЕсли;
	
	Выборка = Результат.Выбрать();
	Выборка.Следующий();
	
	// заполняем схему
	ЗаполнитьСхему(ЭлементыСхемы, Выборка, Результат.Колонки);
	
	Если ЭтоЕНВД Тогда
		
		// устанавливаем параметры рамок блоков
		НастроитьРамку(Выборка, "ПрочиеРасходыНе", 	   ЭлементыСхемы.РасшифровкаПрочиеРасходыНе, 	 СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
		НастроитьРамку(Выборка, "ПрочиеРасходыУч", 	   ЭлементыСхемы.РасшифровкаПрочиеРасходыУч, 	 СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
		НастроитьРамку(Выборка, "ПрочиеРасходыНЕЕНВД", ЭлементыСхемы.РасшифровкаПрочиеРасходыНЕЕНВД, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
		НастроитьРамку(Выборка, "ПрочиеРасходыЕНВД",   ЭлементыСхемы.РасшифровкаПрочиеРасходыЕНВД, 	 СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
		НастроитьРамку(Выборка, "ПрочиеРасходы", 	   ЭлементыСхемы.РасшифровкаПрочиеРасходы, 		 СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
		НастроитьРамку(Выборка, "ПрочиеРасходыРаспр",  ЭлементыСхемы.РасшифровкаПрочиеРасходыРаспр,  СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
		НастроитьРамку(Выборка, "ПрочиеРасходыОС", 	   ЭлементыСхемы.РасшифровкаРасходыТовары, 		 СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
		НастроитьРамку(Выборка, "ПрочиеРасходыДр", 	   ЭлементыСхемы.РасшифровкаПрочиеРасходыДр, 	 СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
		
		РасшифровкаМакета.Вставить("РасшифровкаПрочиеРасходыЕНВД",   ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаПрочиеРасходыОтнесенныеНаЕНВД"));
		РасшифровкаМакета.Вставить("РасшифровкаПрочиеРасходыРаспр",  ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаПрочиеРасходыРаспределяемые"));
		РасшифровкаМакета.Вставить("РасшифровкаПрочиеРасходыНеЕНВД", ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаПрочиеРасходыНеЕНВД"));
		
	Иначе
		
		НастроитьРамку(Выборка, "ПрочиеРасходыНе", ЭлементыСхемы.РасшифровкаПрочиеРасходыНе, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
		НастроитьРамку(Выборка, "ПрочиеРасходыУч", ЭлементыСхемы.РасшифровкаПрочиеРасходыУч, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
		НастроитьРамку(Выборка, "ПрочиеРасходыОС", ЭлементыСхемы.РасшифровкаРасходыТовары, 	 СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
		НастроитьРамку(Выборка, "ПрочиеРасходыДр", ЭлементыСхемы.РасшифровкаПрочиеРасходыДр, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
		
	КонецЕсли;	
   
	РасшифровкаМакета.Вставить("РасшифровкаПрочиеРасходыНе", ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаПрочиеРасходыНеУчитываемыеВНУ"));
	РасшифровкаМакета.Вставить("РасшифровкаПрочиеРасходыУч", ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаПрочиеРасходыУчитываемыеВНУ"));
	РасшифровкаМакета.Вставить("РасшифровкаПрочиеРасходыДр", ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаДругиеПрочиеРасходы"));
	РасшифровкаМакета.Вставить("РасшифровкаПрочиеРасходы",   ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаПрочиеРасходы"));
	РасшифровкаМакета.Вставить("РасшифровкаРасходыТовары",   ПереходКСхеме(ПараметрыОтчета, 3, СтруктураВП));
	
	Если СтруктураВП.ПоказыватьЛегенду Тогда
		
		ВывестиЛегенду(ЭлементыСхемы);
		
	КонецЕсли;
	
	ЭлементыСхемы.НазваниеОрганизации.Наименование = ЗаголовокОтчета(ПараметрыОтчета);
	
	// Сохраняем историю
	СохранитьИсториюСхемы(КэшПараметровОтчета, ИмяМакета, РасшифровкаМакета, НастройкаРамок, ЭлементыСхемы);

КонецПроцедуры

Процедура СформироватьСтоимостьЗапасов(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета)
	
	СтруктураВП	= КэшПараметровОтчета.СтруктураВП;
	
	РасшифровкаМакета = Новый Структура;
	НастройкаРамок    = Новый Структура;
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("НачалоПериода", ПараметрыОтчета.НачалоПериода);
	Запрос.УстановитьПараметр("КонецПериода",  КонецДня(ПараметрыОтчета.КонецПериода));
	Запрос.УстановитьПараметр("Организация",   ПараметрыОтчета.ОрганизацияРасшифровки);
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ХозрасчетныйОстаткиИОбороты.Организация КАК Организация,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток КАК СтоимостьНачБУ,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНУНачальныйОстаток КАК СтоимостьНачНУ,
	|	ХозрасчетныйОстаткиИОбороты.СуммаПРНачальныйОстаток КАК СтоимостьНачПР,
	|	ХозрасчетныйОстаткиИОбороты.СуммаВРНачальныйОстаток КАК СтоимостьНачВР,
	|	0 КАК СтоимостьДтБУ,
	|	0 КАК СтоимостьДтНУ,
	|	0 КАК СтоимостьДтПР,
	|	0 КАК СтоимостьДтВР,
	|	0 КАК СтоимостьВыпускаБУ,
	|	0 КАК СтоимостьВыпускаНУ,
	|	0 КАК СтоимостьВыпускаПР,
	|	0 КАК СтоимостьВыпускаВР,
	|	0 КАК СтоимостьИзлишковБУ,
	|	0 КАК СтоимостьИзлишковНУ,
	|	0 КАК СтоимостьИзлишковПР,
	|	0 КАК СтоимостьИзлишковВР
	|ПОМЕСТИТЬ ВТХозрасчетный
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОСвОрганизации), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				ИЛИ Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости)),
	|			,
	|			Организация = &Организация) КАК ХозрасчетныйОстаткиИОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПоставщикамиИПодрядчиками), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПокупателямиИЗаказчиками), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоКраткосрочнымКредитамИЗаймам), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоДолгосрочнымКредитамИЗаймам), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПодотчетнымиЛицами_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоПрочимОперациям), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСРазнымиДебиторамиИКредиторами), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Касса), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетныеСчета), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВалютныеСчета))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПоставщикамиИПодрядчиками), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПокупателямиИЗаказчиками), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоКраткосрочнымКредитамИЗаймам), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоДолгосрочнымКредитамИЗаймам), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПодотчетнымиЛицами_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоПрочимОперациям), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСРазнымиДебиторамиИКредиторами), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Касса), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетныеСчета), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВалютныеСчета))
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПоставщикамиИПодрядчиками), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПокупателямиИЗаказчиками), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоКраткосрочнымКредитамИЗаймам), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоДолгосрочнымКредитамИЗаймам), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПодотчетнымиЛицами_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоПрочимОперациям), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСРазнымиДебиторамиИКредиторами), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Касса), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетныеСчета), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВалютныеСчета))
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПоставщикамиИПодрядчиками), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПокупателямиИЗаказчиками), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоКраткосрочнымКредитамИЗаймам), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоДолгосрочнымКредитамИЗаймам), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПодотчетнымиЛицами_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоПрочимОперациям), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСРазнымиДебиторамиИКредиторами), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Касса), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетныеСчета), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВалютныеСчета))
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыпускПродукции))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыпускПродукции))
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыпускПродукции))
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыпускПродукции))
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА (НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПоставщикамиИПодрядчиками), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПокупателямиИЗаказчиками), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоКраткосрочнымКредитамИЗаймам), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоДолгосрочнымКредитамИЗаймам), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПодотчетнымиЛицами_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоПрочимОперациям), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСРазнымиДебиторамиИКредиторами), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Касса), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетныеСчета), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВалютныеСчета)))
	|				И (НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыпускПродукции)))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА (НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПоставщикамиИПодрядчиками), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПокупателямиИЗаказчиками), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоКраткосрочнымКредитамИЗаймам), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоДолгосрочнымКредитамИЗаймам), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПодотчетнымиЛицами_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоПрочимОперациям), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСРазнымиДебиторамиИКредиторами), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Касса), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетныеСчета), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВалютныеСчета)))
	|				И (НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыпускПродукции)))
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА (НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПоставщикамиИПодрядчиками), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПокупателямиИЗаказчиками), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоКраткосрочнымКредитамИЗаймам), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоДолгосрочнымКредитамИЗаймам), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПодотчетнымиЛицами_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоПрочимОперациям), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСРазнымиДебиторамиИКредиторами), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Касса), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетныеСчета), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВалютныеСчета)))
	|				И (НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыпускПродукции)))
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА (НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПоставщикамиИПодрядчиками), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПокупателямиИЗаказчиками), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоКраткосрочнымКредитамИЗаймам), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоДолгосрочнымКредитамИЗаймам), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПодотчетнымиЛицами_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПерсоналомПоПрочимОперациям), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСРазнымиДебиторамиИКредиторами), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Касса), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетныеСчета), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВалютныеСчета)))
	|				И (НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыпускПродукции)))
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОСвОрганизации), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				ИЛИ Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости)),
	|			,
	|			Организация = &Организация,
	|			(НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОСвОрганизации), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))),
	|			) КАК ХозрасчетныйОбороты
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТХозрасчетный.Организация,
	|	СУММА(ВТХозрасчетный.СтоимостьДтБУ) КАК СтоимостьДтБУ,
	|	СУММА(ВТХозрасчетный.СтоимостьДтНУ) КАК СтоимостьДтНУ,
	|	СУММА(ВТХозрасчетный.СтоимостьДтПР) КАК СтоимостьДтПР,
	|	СУММА(ВТХозрасчетный.СтоимостьДтВР) КАК СтоимостьДтВР,
	|	СУММА(ВТХозрасчетный.СтоимостьВыпускаБУ) КАК СтоимостьВыпускаБУ,
	|	СУММА(ВТХозрасчетный.СтоимостьВыпускаНУ) КАК СтоимостьВыпускаНУ,
	|	СУММА(ВТХозрасчетный.СтоимостьВыпускаПР) КАК СтоимостьВыпускаПР,
	|	СУММА(ВТХозрасчетный.СтоимостьВыпускаВР) КАК СтоимостьВыпускаВР,
	|	СУММА(ВТХозрасчетный.СтоимостьИзлишковБУ) КАК СтоимостьИзлишковБУ,
	|	СУММА(ВТХозрасчетный.СтоимостьИзлишковНУ) КАК СтоимостьИзлишковНУ,
	|	СУММА(ВТХозрасчетный.СтоимостьИзлишковПР) КАК СтоимостьИзлишковПР,
	|	СУММА(ВТХозрасчетный.СтоимостьИзлишковВР) КАК СтоимостьИзлишковВР,
	|	СУММА(ВТХозрасчетный.СтоимостьНачБУ) КАК СтоимостьНачБУ,
	|	СУММА(ВТХозрасчетный.СтоимостьНачНУ) КАК СтоимостьНачНУ,
	|	СУММА(ВТХозрасчетный.СтоимостьНачПР) КАК СтоимостьНачПР,
	|	СУММА(ВТХозрасчетный.СтоимостьНачВР) КАК СтоимостьНачВР,
	|	СУММА(ВТХозрасчетный.СтоимостьВыпускаБУ + ВТХозрасчетный.СтоимостьИзлишковБУ + ВТХозрасчетный.СтоимостьДтБУ + ВТХозрасчетный.СтоимостьНачБУ) КАК СтоимостьБУ,
	|	СУММА(ВТХозрасчетный.СтоимостьВыпускаНУ + ВТХозрасчетный.СтоимостьИзлишковНУ + ВТХозрасчетный.СтоимостьДтНУ + ВТХозрасчетный.СтоимостьНачНУ) КАК СтоимостьНУ,
	|	СУММА(ВТХозрасчетный.СтоимостьВыпускаПР + ВТХозрасчетный.СтоимостьИзлишковПР + ВТХозрасчетный.СтоимостьДтПР + ВТХозрасчетный.СтоимостьНачПР) КАК СтоимостьПР,
	|	СУММА(ВТХозрасчетный.СтоимостьВыпускаВР + ВТХозрасчетный.СтоимостьИзлишковВР + ВТХозрасчетный.СтоимостьДтВР + ВТХозрасчетный.СтоимостьНачВР) КАК СтоимостьВР
	|ИЗ
	|	ВТХозрасчетный КАК ВТХозрасчетный
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТХозрасчетный.Организация";
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СписокОП = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьСписокОбособленныхПодразделений(ПараметрыОтчета.ОрганизацияРасшифровки);
		
		Запрос.УстановитьПараметр("Организация", СписокОП);
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "Организация = &Организация", "Организация В (&Организация)");
		
	КонецЕсли;
	
	Результат = Запрос.Выполнить();
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СформироватьТаблицуОрганизаций(ПараметрыОтчета, ДокументРезультат, Результат.Выгрузить(),
			"Стоимость", 9, "Активы", КэшПараметровОтчета);
		Возврат;
		
	Иначе	
		
		ИмяМакета     = "СтоимостьТоваров" + ПараметрыОтчета.СуффиксСхемы;
		ДокументСхемы = ПолучитьМакет(ИмяМакета);
		ЭлементыСхемы = ДокументСхемы.ЭлементыГрафическойСхемы;
		
	КонецЕсли;
	
	Выборка = Результат.Выбрать();
	Выборка.Следующий();
	
	// заполняем схему
	ЗаполнитьСхему(ЭлементыСхемы, Выборка, Результат.Колонки);
	
	НастроитьРамку(Выборка, "Стоимость",         ЭлементыСхемы.РасшифровкаРасходыТовары, 	 СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "СтоимостьДт",       ЭлементыСхемы.РасшифровкаСтоимостьДт, 		 СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "СтоимостьНач",      ЭлементыСхемы.РасшифровкаСтоимостьНач,      СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "СтоимостьВыпуска",  ЭлементыСхемы.РасшифровкаСтоимостьВыпуска,  СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "СтоимостьИзлишков", ЭлементыСхемы.РасшифровкаСтоимостьИзлишков, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	
	РасшифровкаМакета.Вставить("РасшифровкаСтоимостьДт",       ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаРасходыНаПриобретениеТоваровАмортизируемогоИмуществаРБП"));
	РасшифровкаМакета.Вставить("РасшифровкаСтоимостьНач",      ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаСтоимостьТоваровИАмортизацияНеСписаннаяВПрошлыхПериодах"));
	РасшифровкаМакета.Вставить("РасшифровкаСтоимостьВыпуска",  ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаСтоимостьВыпущеннойПродукции"));
	РасшифровкаМакета.Вставить("РасшифровкаСтоимостьИзлишков", ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаОприходованиеИзлишков"));
	РасшифровкаМакета.Вставить("РасшифровкаРасходыТовары", 	   ПереходКСхеме(ПараметрыОтчета, 3, СтруктураВП));
	
	Если СтруктураВП.ПоказыватьЛегенду Тогда
		
		ВывестиЛегенду(ЭлементыСхемы);
		
	КонецЕсли;
	
	ЭлементыСхемы.НазваниеОрганизации.Наименование 	= ЗаголовокОтчета(ПараметрыОтчета);
	
	// Сохраняем историю
	СохранитьИсториюСхемы(КэшПараметровОтчета, ИмяМакета, РасшифровкаМакета, НастройкаРамок, ЭлементыСхемы);

КонецПроцедуры

Процедура СформироватьРаспределяемыеРасходы(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета)
	
	СтруктураВП	= КэшПараметровОтчета.СтруктураВП;
	
	РасшифровкаМакета = Новый Структура;
	НастройкаРамок    = Новый Структура;
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("НачалоПериода", ПараметрыОтчета.НачалоПериода);
	Запрос.УстановитьПараметр("КонецПериода",  КонецДня(ПараметрыОтчета.КонецПериода));
	Запрос.УстановитьПараметр("Организация",   ПараметрыОтчета.ОрганизацияРасшифровки);

	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.НоменклатурныеГруппы) КАК Субконто1
	|ПОМЕСТИТЬ ВТНоменклатурныеГруппыЕНВД
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, , Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыручкаЕНВД)), ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы), Организация = &Организация, , ) КАК ХозрасчетныйОбороты
	|
	|СГРУППИРОВАТЬ ПО
	|	ХозрасчетныйОбороты.Субконто1
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Субконто1
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация КАК Организация,
	|	ВЫБОР
	|		КОГДА (НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.НоменклатурныеГруппы) В
	|					(ВЫБРАТЬ
	|						ВТНоменклатурныеГруппыЕНВД.Субконто1
	|					ИЗ
	|						ВТНоменклатурныеГруппыЕНВД КАК ВТНоменклатурныеГруппыЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт - ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК РаспределяемыеРасходы20БУ,
	|	ВЫБОР
	|		КОГДА (НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.НоменклатурныеГруппы) В
	|					(ВЫБРАТЬ
	|						ВТНоменклатурныеГруппыЕНВД.Субконто1
	|					ИЗ
	|						ВТНоменклатурныеГруппыЕНВД КАК ВТНоменклатурныеГруппыЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт - ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК РаспределяемыеРасходы20НУ,
	|	ВЫБОР
	|		КОГДА (НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.НоменклатурныеГруппы) В
	|					(ВЫБРАТЬ
	|						ВТНоменклатурныеГруппыЕНВД.Субконто1
	|					ИЗ
	|						ВТНоменклатурныеГруппыЕНВД КАК ВТНоменклатурныеГруппыЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт - ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК РаспределяемыеРасходы20ПР,
	|	ВЫБОР
	|		КОГДА (НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.НоменклатурныеГруппы) В
	|					(ВЫБРАТЬ
	|						ВТНоменклатурныеГруппыЕНВД.Субконто1
	|					ИЗ
	|						ВТНоменклатурныеГруппыЕНВД КАК ВТНоменклатурныеГруппыЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт - ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК РаспределяемыеРасходы20ВР,
	|	0 КАК РаспределяемыеРасходы90БУ,
	|	0 КАК РаспределяемыеРасходы90НУ,
	|	0 КАК РаспределяемыеРасходы90ПР,
	|	0 КАК РаспределяемыеРасходы90ВР,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.НоменклатурныеГруппы) В
	|				(ВЫБРАТЬ
	|					ВТНоменклатурныеГруппыЕНВД.Субконто1
	|				ИЗ
	|					ВТНоменклатурныеГруппыЕНВД КАК ВТНоменклатурныеГруппыЕНВД)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК РаспределяемыеРасходыЕНВДБУ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.НоменклатурныеГруппы) В
	|				(ВЫБРАТЬ
	|					ВТНоменклатурныеГруппыЕНВД.Субконто1
	|				ИЗ
	|					ВТНоменклатурныеГруппыЕНВД КАК ВТНоменклатурныеГруппыЕНВД)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК РаспределяемыеРасходыЕНВДНУ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.НоменклатурныеГруппы) В
	|				(ВЫБРАТЬ
	|					ВТНоменклатурныеГруппыЕНВД.Субконто1
	|				ИЗ
	|					ВТНоменклатурныеГруппыЕНВД КАК ВТНоменклатурныеГруппыЕНВД)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК РаспределяемыеРасходыЕНВДПР,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.НоменклатурныеГруппы) В
	|				(ВЫБРАТЬ
	|					ВТНоменклатурныеГруппыЕНВД.Субконто1
	|				ИЗ
	|					ВТНоменклатурныеГруппыЕНВД КАК ВТНоменклатурныеГруппыЕНВД)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК РаспределяемыеРасходыЕНВДВР
	|ПОМЕСТИТЬ ВТХозрасчетный
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|				И (НЕ ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения)),
	|			КорСЧет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы)) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыЕНВД))
	|				И (НЕ ХозрасчетныйОбороты.КорСубконто1 В
	|						(ВЫБРАТЬ
	|							ВТНоменклатурныеГруппыЕНВД.Субконто1
	|						ИЗ
	|							ВТНоменклатурныеГруппыЕНВД КАК ВТНоменклатурныеГруппыЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыЕНВД))
	|				И (НЕ ХозрасчетныйОбороты.КорСубконто1 В
	|						(ВЫБРАТЬ
	|							ВТНоменклатурныеГруппыЕНВД.Субконто1
	|						ИЗ
	|							ВТНоменклатурныеГруппыЕНВД КАК ВТНоменклатурныеГруппыЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыЕНВД))
	|				И (НЕ ХозрасчетныйОбороты.КорСубконто1 В
	|						(ВЫБРАТЬ
	|							ВТНоменклатурныеГруппыЕНВД.Субконто1
	|						ИЗ
	|							ВТНоменклатурныеГруппыЕНВД КАК ВТНоменклатурныеГруппыЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыЕНВД))
	|				И (НЕ ХозрасчетныйОбороты.КорСубконто1 В
	|						(ВЫБРАТЬ
	|							ВТНоменклатурныеГруппыЕНВД.Субконто1
	|						ИЗ
	|							ВТНоменклатурныеГруппыЕНВД КАК ВТНоменклатурныеГруппыЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|				И (НЕ ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения)),
	|			КорСЧет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуНеЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыНеЕНВД)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы)) КАК ХозрасчетныйОбороты
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТХозрасчетный.Организация,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходы20БУ + ВТХозрасчетный.РаспределяемыеРасходы90БУ + ВТХозрасчетный.РаспределяемыеРасходыЕНВДБУ) КАК РаспределяемыеРасходыБУ,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходы20НУ + ВТХозрасчетный.РаспределяемыеРасходы90НУ + ВТХозрасчетный.РаспределяемыеРасходыЕНВДНУ) КАК РаспределяемыеРасходыНУ,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходы20ПР + ВТХозрасчетный.РаспределяемыеРасходы90ПР + ВТХозрасчетный.РаспределяемыеРасходыЕНВДПР) КАК РаспределяемыеРасходыПР,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходы20ВР + ВТХозрасчетный.РаспределяемыеРасходы90ВР + ВТХозрасчетный.РаспределяемыеРасходыЕНВДВР) КАК РаспределяемыеРасходыВР,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходы20БУ) КАК РаспределяемыеРасходы20БУ,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходы20НУ) КАК РаспределяемыеРасходы20НУ,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходы20ПР) КАК РаспределяемыеРасходы20ПР,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходы20ВР) КАК РаспределяемыеРасходы20ВР,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходы90БУ) КАК РаспределяемыеРасходы90БУ,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходы90НУ) КАК РаспределяемыеРасходы90НУ,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходы90ПР) КАК РаспределяемыеРасходы90ПР,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходы90ВР) КАК РаспределяемыеРасходы90ВР,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходыЕНВДБУ) КАК РаспределяемыеРасходыЕНВДБУ,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходыЕНВДНУ) КАК РаспределяемыеРасходыЕНВДНУ,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходыЕНВДПР) КАК РаспределяемыеРасходыЕНВДПР,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходыЕНВДВР) КАК РаспределяемыеРасходыЕНВДВР,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходы20БУ + ВТХозрасчетный.РаспределяемыеРасходы90БУ) КАК РаспределяемыеРасходыНеЕНВДБУ,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходы20НУ + ВТХозрасчетный.РаспределяемыеРасходы90НУ) КАК РаспределяемыеРасходыНеЕНВДНУ,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходы20ПР + ВТХозрасчетный.РаспределяемыеРасходы90ПР) КАК РаспределяемыеРасходыНеЕНВДПР,
	|	СУММА(ВТХозрасчетный.РаспределяемыеРасходы20ВР + ВТХозрасчетный.РаспределяемыеРасходы90ВР) КАК РаспределяемыеРасходыНеЕНВДВР
	|ИЗ
	|	ВТХозрасчетный КАК ВТХозрасчетный
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТХозрасчетный.Организация";
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СписокОП = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьСписокОбособленныхПодразделений(ПараметрыОтчета.ОрганизацияРасшифровки);
		Запрос.УстановитьПараметр("Организация", СписокОП);
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "Организация = &Организация", "Организация В (&Организация)");
		
	КонецЕсли;
	
	Результат = Запрос.Выполнить();
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СформироватьТаблицуОрганизаций(ПараметрыОтчета, ДокументРезультат, Результат.Выгрузить(), 
			"РаспределяемыеРасходы", 8, "Распределяемые расходы", КэшПараметровОтчета);
		Возврат;
		
	Иначе	
		
		ИмяМакета     = "РасходыРаспределяемые" + ПараметрыОтчета.СуффиксСхемы;
		ДокументСхемы = ПолучитьМакет(ИмяМакета);
		ЭлементыСхемы = ДокументСхемы.ЭлементыГрафическойСхемы;
		
	КонецЕсли;
	
	Выборка = Результат.Выбрать();
	Выборка.Следующий();
	
	// заполняем схему
	ЗаполнитьСхему(ЭлементыСхемы, Выборка, Результат.Колонки);
	
	НастроитьРамку(Выборка, "РаспределяемыеРасходы20", 	   ЭлементыСхемы.РасшифровкаРаспределяемыеРасходы20, 	 СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);	
	НастроитьРамку(Выборка, "РаспределяемыеРасходы90", 	   ЭлементыСхемы.РасшифровкаРаспределяемыеРасходы90, 	 СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);	
	НастроитьРамку(Выборка, "РаспределяемыеРасходыНеЕНВД", ЭлементыСхемы.РасшифровкаРаспределяемыеРасходыНеЕНВД, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);	
	НастроитьРамку(Выборка, "РаспределяемыеРасходыЕНВД",   ЭлементыСхемы.РасшифровкаРаспределяемыеРасходыЕНВД, 	 СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "РаспределяемыеРасходы",	   ЭлементыСхемы.РасшифровкаРаспределяемыеРасходы, 		 СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	
	РасшифровкаМакета.Вставить("РасшифровкаРаспределяемыеРасходы20",     ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаОПРиОХРСписанныеНаПрямыеРаспределяемые"));
	РасшифровкаМакета.Вставить("РасшифровкаРаспределяемыеРасходы90",     ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаКосвенныеРаспределяемыеРасходыУчитываемыеВНУ"));
	РасшифровкаМакета.Вставить("РасшифровкаРаспределяемыеРасходыНеЕНВД", ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаКосвенныеРасходыНеЕНВД"));
	РасшифровкаМакета.Вставить("РасшифровкаРаспределяемыеРасходыЕНВД",   ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаКосвенныеРасходыЕНВД"));
	РасшифровкаМакета.Вставить("РасшифровкаРаспределяемыеРасходы",       ПереходКСхеме(ПараметрыОтчета, 10, СтруктураВП));
	
	Если СтруктураВП.ПоказыватьЛегенду Тогда
		
		ВывестиЛегенду(ЭлементыСхемы);
		
	КонецЕсли;
	
	ЭлементыСхемы.НазваниеОрганизации.Наименование = ЗаголовокОтчета(ПараметрыОтчета);
	
	// Сохраняем историю
	СохранитьИсториюСхемы(КэшПараметровОтчета, ИмяМакета, РасшифровкаМакета, НастройкаРамок, ЭлементыСхемы);
	
КонецПроцедуры

Процедура СформироватьРасходыПроизводства(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета)
	
	СтруктураВП = КэшПараметровОтчета.СтруктураВП;
	
	РасшифровкаМакета = Новый Структура;
	НастройкаРамок    = Новый Структура;
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("НачалоПериода", ПараметрыОтчета.НачалоПериода);
	Запрос.УстановитьПараметр("КонецПериода",  КонецДня(ПараметрыОтчета.КонецПериода));
	Запрос.УстановитьПараметр("Организация",   ПараметрыОтчета.ОрганизацияРасшифровки);
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.НоменклатурныеГруппы) КАК Субконто1
	|ПОМЕСТИТЬ ВТНоменклатурныеГруппыЕНВД
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, , Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыручкаЕНВД)), ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы), Организация = &Организация, , ) КАК ХозрасчетныйОбороты
	|
	|СГРУППИРОВАТЬ ПО
	|	ХозрасчетныйОбороты.Субконто1
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Субконто1
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация КАК Организация,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОСвОрганизации), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПрямыеРасходыВыпускБУ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОСвОрганизации), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПрямыеРасходыВыпускНУ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОСвОрганизации), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПрямыеРасходыВыпускПР,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОСвОрганизации), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПрямыеРасходыВыпускВР,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПрямыеРасходыУслугиБУ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПрямыеРасходыУслугиНУ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПрямыеРасходыУслугиПР,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПрямыеРасходыУслугиВР,
	|	0 КАК ОХРБУ,
	|	0 КАК ОХРНУ,
	|	0 КАК ОХРПР,
	|	0 КАК ОХРВР,
	|	0 КАК ОХРРаспрБУ,
	|	0 КАК ОХРРаспрНУ,
	|	0 КАК ОХРРаспрПР,
	|	0 КАК ОХРРаспрВР,
	|	0 КАК НЗПБУ,
	|	0 КАК НЗПНУ,
	|	0 КАК НЗППР,
	|	0 КАК НЗПВР
	|ПОМЕСТИТЬ ВТХозрасчетный
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|				ИЛИ Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыпускПродукции)),
	|			,
	|			Организация = &Организация,
	|			(НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))),
	|			) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОстатки.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОстатки.СуммаКонечныйОстаток,
	|	ХозрасчетныйОстатки.СуммаНУКонечныйОстаток,
	|	ХозрасчетныйОстатки.СуммаПРКонечныйОстаток,
	|	ХозрасчетныйОстатки.СуммаВРКонечныйОстаток
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы),
	|			Организация = &Организация
	|				И (НЕ ВЫРАЗИТЬ(Субконто1 КАК Справочник.НоменклатурныеГруппы) В
	|						(ВЫБРАТЬ
	|							ВТНоменклатурныеГруппыЕНВД.Субконто1
	|						ИЗ
	|							ВТНоменклатурныеГруппыЕНВД КАК ВТНоменклатурныеГруппыЕНВД))) КАК ХозрасчетныйОстатки
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт - ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт - ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт - ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт - ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт - ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт - ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт - ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт - ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат),
	|			Организация = &Организация
	|				И (НЕ ВЫРАЗИТЬ(КорСубконто1 КАК Справочник.НоменклатурныеГруппы) В
	|						(ВЫБРАТЬ
	|							ВТНоменклатурныеГруппыЕНВД.Субконто1
	|						ИЗ
	|							ВТНоменклатурныеГруппыЕНВД КАК ВТНоменклатурныеГруппыЕНВД))
	|				И (НЕ ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения)),
	|			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы)) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОстатки.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОстатки.СуммаКонечныйОстаток,
	|	ХозрасчетныйОстатки.СуммаНУКонечныйОстаток,
	|	ХозрасчетныйОстатки.СуммаПРКонечныйОстаток,
	|	ХозрасчетныйОстатки.СуммаВРКонечныйОстаток
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, , , Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПроизводствоИзДавальческогоСырья)), , Организация = &Организация) КАК ХозрасчетныйОстатки
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТХозрасчетный.Организация,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыВыпускБУ) КАК ПрямыеРасходыВыпускБУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыВыпускНУ) КАК ПрямыеРасходыВыпускНУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыВыпускПР) КАК ПрямыеРасходыВыпускПР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыВыпускВР) КАК ПрямыеРасходыВыпускВР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыУслугиБУ) КАК ПрямыеРасходыУслугиБУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыУслугиНУ) КАК ПрямыеРасходыУслугиНУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыУслугиПР) КАК ПрямыеРасходыУслугиПР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыУслугиВР) КАК ПрямыеРасходыУслугиВР,
	|	СУММА(ВТХозрасчетный.ОХРБУ) КАК ОХРБУ,
	|	СУММА(ВТХозрасчетный.ОХРНУ) КАК ОХРНУ,
	|	СУММА(ВТХозрасчетный.ОХРПР) КАК ОХРПР,
	|	СУММА(ВТХозрасчетный.ОХРВР) КАК ОХРВР,
	|	СУММА(ВТХозрасчетный.ОХРРаспрБУ) КАК ОХРРаспрБУ,
	|	СУММА(ВТХозрасчетный.ОХРРаспрНУ) КАК ОХРРаспрНУ,
	|	СУММА(ВТХозрасчетный.ОХРРаспрПР) КАК ОХРРаспрПР,
	|	СУММА(ВТХозрасчетный.ОХРРаспрВР) КАК ОХРРаспрВР,
	|	СУММА(ВТХозрасчетный.НЗПБУ) КАК НЗПБУ,
	|	СУММА(ВТХозрасчетный.НЗПНУ) КАК НЗПНУ,
	|	СУММА(ВТХозрасчетный.НЗППР) КАК НЗППР,
	|	СУММА(ВТХозрасчетный.НЗПВР) КАК НЗПВР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыВыпускБУ + ВТХозрасчетный.ПрямыеРасходыУслугиБУ + ВТХозрасчетный.НЗПБУ) КАК ПрямыеРасходыБУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыВыпускНУ + ВТХозрасчетный.ПрямыеРасходыУслугиНУ + ВТХозрасчетный.НЗПНУ) КАК ПрямыеРасходыНУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыВыпускПР + ВТХозрасчетный.ПрямыеРасходыУслугиПР + ВТХозрасчетный.НЗППР) КАК ПрямыеРасходыПР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыВыпускВР + ВТХозрасчетный.ПрямыеРасходыУслугиВР + ВТХозрасчетный.НЗПВР) КАК ПрямыеРасходыВР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыВыпускБУ + ВТХозрасчетный.ПрямыеРасходыУслугиБУ + ВТХозрасчетный.НЗПБУ - ВТХозрасчетный.ОХРБУ - ВТХозрасчетный.ОХРРаспрБУ) КАК ПроизводствоБУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыВыпускНУ + ВТХозрасчетный.ПрямыеРасходыУслугиНУ + ВТХозрасчетный.НЗПНУ - ВТХозрасчетный.ОХРНУ - ВТХозрасчетный.ОХРРаспрНУ) КАК ПроизводствоНУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыВыпускПР + ВТХозрасчетный.ПрямыеРасходыУслугиПР + ВТХозрасчетный.НЗППР - ВТХозрасчетный.ОХРПР - ВТХозрасчетный.ОХРРаспрПР) КАК ПроизводствоПР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыВыпускВР + ВТХозрасчетный.ПрямыеРасходыУслугиВР + ВТХозрасчетный.НЗПВР - ВТХозрасчетный.ОХРВР - ВТХозрасчетный.ОХРРаспрВР) КАК ПРоизводствоВР
	|ИЗ
	|	ВТХозрасчетный КАК ВТХозрасчетный
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТХозрасчетный.Организация";
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СписокОП = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьСписокОбособленныхПодразделений(ПараметрыОтчета.ОрганизацияРасшифровки);
		Запрос.УстановитьПараметр("Организация", СписокОП);
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "Организация = &Организация", "Организация В (&Организация)");
		
	КонецЕсли;
	
	Результат = Запрос.Выполнить();
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СформироватьТаблицуОрганизаций(ПараметрыОтчета, ДокументРезультат, Результат.Выгрузить(),
			"ПрямыеРасходы", 4, "Расходы производства", КэшПараметровОтчета);
		Возврат;
		
	Иначе
		
		ЭтоЕНВД       = УчетнаяПолитика.ПлательщикЕНВД(ПараметрыОтчета.ОрганизацияРасшифровки, ПараметрыОтчета.КонецПериода);
		ИмяМакета     = ?(ЭтоЕНВД, "РасходыПроизводстваЕНВД", "РасходыПроизводства") + ПараметрыОтчета.СуффиксСхемы;
		ДокументСхемы = ПолучитьМакет(ИмяМакета);
		ЭлементыСхемы = ДокументСхемы.ЭлементыГрафическойСхемы;
		
	КонецЕсли;
	
	Выборка = Результат.Выбрать();
	Выборка.Следующий();

	Если ЭтоЕНВД Тогда
		
		НастроитьРамку(Выборка, "ОХРРаспр", ЭлементыСхемы.РасшифровкаРаспределяемыеРасходы, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
		РасшифровкаМакета.Вставить("РасшифровкаРаспределяемыеРасходы", ПереходКСхеме(ПараметрыОтчета, 8, СтруктураВП))
		
	КонецЕсли;
	
	//заполняем схему
	ЗаполнитьСхему(ЭлементыСхемы, Выборка, Результат.Колонки);
	
	НастроитьРамку(Выборка, "ПрямыеРасходыУслуги", ЭлементыСхемы.ПрямыеРасходыУслуги,         СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);	
	НастроитьРамку(Выборка, "ПрямыеРасходыВыпуск", ЭлементыСхемы.РасшифровкаАктивы,           СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "НЗП",                 ЭлементыСхемы.РасшифровкаНЗП,              СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "Производство",        ЭлементыСхемы.РасшифровкаРасходыОбычные,   СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "ОХР",                 ЭлементыСхемы.РасшифровкаКосвенныеРасходы, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "ПрямыеРасходы",       ЭлементыСхемы.Расходы,                     СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);	
	
	РасшифровкаМакета.Вставить("РасшифровкаКосвенныеРасходы", ПереходКСхеме(ПараметрыОтчета, 6,  СтруктураВП));
	РасшифровкаМакета.Вставить("РасшифровкаРасходыОбычные",   ПереходКСхеме(ПараметрыОтчета, 10, СтруктураВП));
	РасшифровкаМакета.Вставить("ПрямыеРасходыУслуги", 	      ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаПрямыеРасходыПоРеализованнымУслугам"));
	РасшифровкаМакета.Вставить("РасшифровкаАктивы",           ПереходКСхеме(ПараметрыОтчета, 9,  СтруктураВП));
	РасшифровкаМакета.Вставить("РасшифровкаНЗП",              ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаНезавершенноеПроизводство"));
	
	Если СтруктураВП.ПоказыватьЛегенду Тогда
		
		ВывестиЛегенду(ЭлементыСхемы);
		
	КонецЕсли;
	
	ЭлементыСхемы.НазваниеОрганизации.Наименование = ЗаголовокОтчета(ПараметрыОтчета);
	
	// Сохраняем историю
	СохранитьИсториюСхемы(КэшПараметровОтчета, ИмяМакета, РасшифровкаМакета, НастройкаРамок, ЭлементыСхемы);
	
КонецПроцедуры

Процедура СформироватьРасходыПоТоварам(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета)
	
	СтруктураВП = КэшПараметровОтчета.СтруктураВП;
	
	РасшифровкаМакета = Новый Структура;
	НастройкаРамок    = Новый Структура;

	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("НачалоПериода", ПараметрыОтчета.НачалоПериода);
	Запрос.УстановитьПараметр("КонецПериода",  КонецДня(ПараметрыОтчета.КонецПериода));
	Запрос.УстановитьПараметр("Организация",   ПараметрыОтчета.ОрганизацияРасшифровки);
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ХозрасчетныйОстаткиИОбороты.Организация КАК Организация,
	|	ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстаток КАК АктивыКонБУ,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНУКонечныйОстаток КАК АктивыКонНУ,
	|	ХозрасчетныйОстаткиИОбороты.СуммаПРКонечныйОстаток КАК АктивыКонПР,
	|	ХозрасчетныйОстаткиИОбороты.СуммаВРКонечныйОстаток КАК АктивыКонВР,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотКт КАК АктивыКтБУ,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНУОборотКт КАК АктивыКтНУ,
	|	ХозрасчетныйОстаткиИОбороты.СуммаПРОборотКт КАК АктивыКтПР,
	|	ХозрасчетныйОстаткиИОбороты.СуммаВРОборотКт КАК АктивыКтВР,
	|	0 КАК ПрямыеРасходыТоварыБУ,
	|	0 КАК ПрямыеРасходыТоварыНУ,
	|	0 КАК ПрямыеРасходыТоварыПР,
	|	0 КАК ПрямыеРасходыТоварыВР,
	|	0 КАК ПрямыеРасходыТоварыЕНВДБУ,
	|	0 КАК ПрямыеРасходыТоварыЕНВДНУ,
	|	0 КАК ПрямыеРасходыТоварыЕНВДПР,
	|	0 КАК ПрямыеРасходыТоварыЕНВДВР,
	|	0 КАК ПрямыеРасходыОСБУ,
	|	0 КАК ПрямыеРасходыОСНУ,
	|	0 КАК ПрямыеРасходыОСПР,
	|	0 КАК ПрямыеРасходыОСВР,
	|	0 КАК ПрямыеРасходыТоварыНЕБУ,
	|	0 КАК ПрямыеРасходыТоварыНЕНУ,
	|	0 КАК ПрямыеРасходыТоварыНЕПР,
	|	0 КАК ПрямыеРасходыТоварыНЕВР,
	|	0 КАК ПрямыеРасходыДтБУ,
	|	0 КАК ПрямыеРасходыДтНУ,
	|	0 КАК ПрямыеРасходыДтПР,
	|	0 КАК ПрямыеРасходыДтВР
	|ПОМЕСТИТЬ ВТХозрасчетный
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				ИЛИ Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости)),
	|			,
	|			Организация = &Организация) КАК ХозрасчетныйОстаткиИОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ))
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ))
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ))
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|				И НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|				И НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ))
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|				И НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ))
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|				И НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ))
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				ИЛИ Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости)),
	|			,
	|			Организация = &Организация,
	|			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы))
	|				И НЕ КОрСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|				И НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу)),
	|			) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|				И ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|				И ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|				И ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|				И ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|				И ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|				И ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|				И ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|				И ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов В (ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОсновныхСредств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияНематериальныхАктивов), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравКромеПраваТребования), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияИмущественныхПравПоОбъектамОбслуживающихПроизводствИХозяйств), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияДоНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияПослеНаступленияСрокаПлатежа), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПраваТребованияКакОказанияФинансовыхУслуг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияПрочегоИмущества), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияЦенныхБумаг), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.РеализацияОбъектовСтроительства), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделок), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ОперацииСФинансовымиИнструментамиСрочныхСделокОР), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.СдачаИмуществаВАрендуИлиСубаренду), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ШтрафыПениНеустойкиКПолучениюУплате), ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрочиеВнереализационныеДоходыРасходы))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУКорОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРКорОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ПринятиеКналоговомуУчету
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.ПрочиеДоходыИРасходы).ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				ИЛИ Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости)),
	|			,
	|			Организация = &Организация,
	|			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы)) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|				И НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|				И НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|				И НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|				И НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|				И НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|				И НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|				И НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажНеЕНВД))
	|				И НЕ ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродажЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.КорСубконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Материалы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Полуфабрикаты), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыНаСкладах), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговле), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТараПодТоваромИПорожняя), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеИзделия), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТоварыВРозничнойТорговлеВПродажныхЦенахНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаАТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ТорговаяНаценкаНТТ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПокупныеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукцияОтгруженная), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеТоварыОтгруженные), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГотоваяПродукция), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыБудущихПериодов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоДобровольномуСтрахованиюРаботников), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПлатежиПоПрочимВидамСтрахования))
	|				ИЛИ Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереданныеОбъектыНедвижимости)),
	|			,
	|			Организация = &Организация,
	|			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат)) КАК ХозрасчетныйОбороты
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТХозрасчетный.Организация,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыБУ + ВТХозрасчетный.ПрямыеРасходыТоварыЕНВДБУ + ВТХозрасчетный.ПрямыеРасходыОСБУ + ВТХозрасчетный.ПрямыеРасходыТоварыНЕБУ + ВТХозрасчетный.АктивыКонБУ + ВТХозрасчетный.ПрямыеРасходыДтБУ) КАК АктивыБУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыНУ + ВТХозрасчетный.ПрямыеРасходыТоварыЕНВДНУ + ВТХозрасчетный.ПрямыеРасходыОСНУ + ВТХозрасчетный.ПрямыеРасходыТоварыНЕНУ + ВТХозрасчетный.АктивыКонНУ + ВТХозрасчетный.ПрямыеРасходыДтНУ) КАК АктивыНУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыПР + ВТХозрасчетный.ПрямыеРасходыТоварыЕНВДПР + ВТХозрасчетный.ПрямыеРасходыОСПР + ВТХозрасчетный.ПрямыеРасходыТоварыНЕПР + ВТХозрасчетный.АктивыКонПР + ВТХозрасчетный.ПрямыеРасходыДтПР) КАК АктивыПР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыВР + ВТХозрасчетный.ПрямыеРасходыТоварыЕНВДВР + ВТХозрасчетный.ПрямыеРасходыОСВР + ВТХозрасчетный.ПрямыеРасходыТоварыНЕВР + ВТХозрасчетный.АктивыКонВР + ВТХозрасчетный.ПрямыеРасходыДтВР) КАК АктивыВР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыБУ) КАК ПрямыеРасходыТоварыБУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыНУ) КАК ПрямыеРасходыТоварыНУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыПР) КАК ПрямыеРасходыТоварыПР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыВР) КАК ПрямыеРасходыТоварыВР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыЕНВДБУ) КАК ПрямыеРасходыТоварыЕНВДБУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыЕНВДНУ) КАК ПрямыеРасходыТоварыЕНВДНУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыЕНВДПР) КАК ПрямыеРасходыТоварыЕНВДПР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыЕНВДВР) КАК ПрямыеРасходыТоварыЕНВДВР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыОСБУ) КАК ПрямыеРасходыОСБУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыОСНУ) КАК ПрямыеРасходыОСНУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыОСПР) КАК ПрямыеРасходыОСПР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыОСВР) КАК ПрямыеРасходыОСВР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыНЕБУ) КАК ПрямыеРасходыТоварыНЕБУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыНЕНУ) КАК ПрямыеРасходыТоварыНЕНУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыНЕПР) КАК ПрямыеРасходыТоварыНЕПР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыТоварыНЕВР) КАК ПрямыеРасходыТоварыНЕВР,
	|	СУММА(ВТХозрасчетный.АктивыКонБУ) КАК АктивыКонБУ,
	|	СУММА(ВТХозрасчетный.АктивыКонНУ) КАК АктивыКонНУ,
	|	СУММА(ВТХозрасчетный.АктивыКонПР) КАК АктивыКонПР,
	|	СУММА(ВТХозрасчетный.АктивыКонВР) КАК АктивыКонВР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыДтБУ) КАК ПрямыеРасходыДтБУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыДтНУ) КАК ПрямыеРасходыДтНУ,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыДтПР) КАК ПрямыеРасходыДтПР,
	|	СУММА(ВТХозрасчетный.ПрямыеРасходыДтВР) КАК ПрямыеРасходыДтВР
	|ИЗ
	|	ВТХозрасчетный КАК ВТХозрасчетный
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТХозрасчетный.Организация";
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СписокОП = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьСписокОбособленныхПодразделений(ПараметрыОтчета.ОрганизацияРасшифровки);
		Запрос.УстановитьПараметр("Организация", СписокОП);
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "Организация = &Организация", "Организация В (&Организация)");
		
	КонецЕсли;
	
	Результат = Запрос.Выполнить();
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СформироватьТаблицуОрганизаций(ПараметрыОтчета, ДокументРезультат, Результат.Выгрузить(),
			"Активы", 3, "Стоимость активов", КэшПараметровОтчета);
		Возврат;
		
	Иначе
		
		ЭтоЕНВД       = УчетнаяПолитика.ПлательщикЕНВД(ПараметрыОтчета.ОрганизацияРасшифровки, ПараметрыОтчета.КонецПериода);
		ИмяМакета     = ?(ЭтоЕНВД, "СтоимостьСписанияТоваровЕНВД", "СтоимостьСписанияТоваров") + ПараметрыОтчета.СуффиксСхемы;
		ДокументСхемы = ПолучитьМакет(ИмяМакета);
		ЭлементыСхемы = ДокументСхемы.ЭлементыГрафическойСхемы;

	КонецЕсли;
	
	Выборка = Результат.Выбрать();
	Выборка.Следующий();

	Если ЭтоЕНВД Тогда
		
		НастроитьРамку(Выборка, "ПрямыеРасходыТоварыЕНВД", ЭлементыСхемы.РасшифровкаПрямыеРасходыТоварыЕНВД, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
		
	КонецЕсли;
	
	//заполняем схему
	ЗаполнитьСхему(ЭлементыСхемы, Выборка, Результат.Колонки);
	
	НастроитьРамку(Выборка, "ПрямыеРасходыТовары",   ЭлементыСхемы.РасшифровкаПрямыеРасходыТовары,   СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "ПрямыеРасходыОС",       ЭлементыСхемы.РасшифровкаПрямыеРасходыОС,       СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "ПрямыеРасходыДт",       ЭлементыСхемы.РасшифровкаПрямыеРасходыДт,       СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "Активы",                ЭлементыСхемы.РасшифровкаАктивы,                СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "ПрямыеРасходыТоварыНЕ", ЭлементыСхемы.РасшифровкаПрямыеРасходыТоварыНЕ, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "АктивыКон",             ЭлементыСхемы.РасшифровкаАктивыКон,             СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	
	РасшифровкаМакета.Вставить("РасшифровкаПрямыеРасходыОС",       ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаРасходыОтносящиесяКСтоимостиРеализованногоИмущества"));
	РасшифровкаМакета.Вставить("РасшифровкаПрямыеРасходыТовары",   ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаПрямыеРасходыПоРеализованнымТоварамУчНУ"));
	РасшифровкаМакета.Вставить("РасшифровкаАктивыКон",             ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаСтоимостьНеСписанныхТоваровРБПАмортизируемогоИмущества"));
	РасшифровкаМакета.Вставить("РасшифровкаПрямыеРасходыТоварыНЕ", ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаПрямыеРасходыПоРеализованнымТоварамНеУчНУ"));
	РасшифровкаМакета.Вставить("РасшифровкаПрямыеРасходыДт",       ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаАмортизацияРБПТоварыНеРеализация"));
	
	Если ЭтоЕНВД Тогда
		
		РасшифровкаМакета.Вставить("РасшифровкаПрямыеРасходыТоварыЕНВД", ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаПрямыеРасходыЕНВД"));
		
	КонецЕсли;
	
	РасшифровкаМакета.Вставить("РасшифровкаАктивы", ПереходКСхеме(ПараметрыОтчета, 9, СтруктураВП));
	
	Если СтруктураВП.ПоказыватьЛегенду Тогда
		
		ВывестиЛегенду(ЭлементыСхемы);
		
	КонецЕсли;
	
	ЭлементыСхемы.НазваниеОрганизации.Наименование = ЗаголовокОтчета(ПараметрыОтчета);
	
	// Сохраняем историю
	СохранитьИсториюСхемы(КэшПараметровОтчета, ИмяМакета, РасшифровкаМакета, НастройкаРамок, ЭлементыСхемы);
	
КонецПроцедуры

Процедура СформироватьТранспортныеРасходы(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета)
	
	СтруктураВП	= КэшПараметровОтчета.СтруктураВП;
	
	РасшифровкаМакета = Новый Структура;
	НастройкаРамок    = Новый Структура;
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("НачалоПериода", ПараметрыОтчета.НачалоПериода);
	Запрос.УстановитьПараметр("КонецПериода",  КонецДня(ПараметрыОтчета.КонецПериода));
	Запрос.УстановитьПараметр("Организация",   ПараметрыОтчета.ОрганизацияРасшифровки);
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ХозрасчетныйОстаткиИОбороты.Организация КАК Организация,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотДт + ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстатокДт КАК ТранспортныеРасходыБУ,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНУОборотДт + ХозрасчетныйОстаткиИОбороты.СуммаНУНачальныйОстатокДт КАК ТранспортныеРасходыНУ,
	|	ХозрасчетныйОстаткиИОбороты.СуммаПРОборотДт + ХозрасчетныйОстаткиИОбороты.СуммаПРНачальныйОстатокДт КАК ТранспортныеРасходыПР,
	|	ХозрасчетныйОстаткиИОбороты.СуммаВРОборотДт + ХозрасчетныйОстаткиИОбороты.СуммаВРНачальныйОстатокДт КАК ТранспортныеРасходыВР,
	|	0 КАК ТранспортныеРасходыСписБУ,
	|	0 КАК ТранспортныеРасходыСписНУ,
	|	0 КАК ТранспортныеРасходыСписПР,
	|	0 КАК ТранспортныеРасходыСписВР,
	|	ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстатокДт КАК ТранспортныеРасходыОстБУ,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНУКонечныйОстатокДт КАК ТранспортныеРасходыОстНУ,
	|	ХозрасчетныйОстаткиИОбороты.СуммаПРКонечныйОстатокДт КАК ТранспортныеРасходыОстПР,
	|	ХозрасчетныйОстаткиИОбороты.СуммаВРКонечныйОстатокДт КАК ТранспортныеРасходыОстВР
	|ПОМЕСТИТЬ ВТХозрасчетный
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ИздержкиОбращения)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы)) КАК ХозрасчетныйОстаткиИОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОбороты.СуммаОборотКт,
	|	ХозрасчетныйОбороты.СуммаНУОборотКт,
	|	ХозрасчетныйОбороты.СуммаПРОборотКт,
	|	ХозрасчетныйОбороты.СуммаВРОборотКт,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ИздержкиОбращения)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы),
	|			КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуНеЕНВД)),
	|			) КАК ХозрасчетныйОбороты
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТХозрасчетный.Организация,
	|	СУММА(ВТХозрасчетный.ТранспортныеРасходыБУ) КАК ТранспортныеРасходыБУ,
	|	СУММА(ВТХозрасчетный.ТранспортныеРасходыНУ) КАК ТранспортныеРасходыНУ,
	|	СУММА(ВТХозрасчетный.ТранспортныеРасходыПР) КАК ТранспортныеРасходыПР,
	|	СУММА(ВТХозрасчетный.ТранспортныеРасходыВР) КАК ТранспортныеРасходыВР,
	|	СУММА(ВТХозрасчетный.ТранспортныеРасходыСписБУ) КАК ТранспортныеРасходыСписБУ,
	|	СУММА(ВТХозрасчетный.ТранспортныеРасходыСписНУ) КАК ТранспортныеРасходыСписНУ,
	|	СУММА(ВТХозрасчетный.ТранспортныеРасходыСписПР) КАК ТранспортныеРасходыСписПР,
	|	СУММА(ВТХозрасчетный.ТранспортныеРасходыСписВР) КАК ТранспортныеРасходыСписВР,
	|	СУММА(ВТХозрасчетный.ТранспортныеРасходыОстБУ) КАК ТранспортныеРасходыОстБУ,
	|	СУММА(ВТХозрасчетный.ТранспортныеРасходыОстНУ) КАК ТранспортныеРасходыОстНУ,
	|	СУММА(ВТХозрасчетный.ТранспортныеРасходыОстПР) КАК ТранспортныеРасходыОстПР,
	|	СУММА(ВТХозрасчетный.ТранспортныеРасходыОстВР) КАК ТранспортныеРасходыОстВР
	|ИЗ
	|	ВТХозрасчетный КАК ВТХозрасчетный
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТХозрасчетный.Организация";
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СписокОП = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьСписокОбособленныхПодразделений(ПараметрыОтчета.ОрганизацияРасшифровки);
		Запрос.УстановитьПараметр("Организация", СписокОП);
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "Организация = &Организация", "Организация В (&Организация)");
		
	КонецЕсли;
	
	Результат = Запрос.Выполнить();
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СформироватьТаблицуОрганизаций(ПараметрыОтчета, ДокументРезультат, Результат.Выгрузить(),
			"ТранспортныеРасходы", 5, "Транспортные расходы", КэшПараметровОтчета);
		Возврат;
		
	Иначе	
		
		ИмяМакета     = "ТранспортныеРасходы" + ПараметрыОтчета.СуффиксСхемы;
		ДокументСхемы = ПолучитьМакет(ИмяМакета);
		ЭлементыСхемы = ДокументСхемы.ЭлементыГрафическойСхемы;
		
	КонецЕсли;
	
	Выборка = Результат.Выбрать();
	Выборка.Следующий();
	
	// заполняем схему
	ЗаполнитьСхему(ЭлементыСхемы, Выборка, Результат.Колонки);
	
	НастроитьРамку(Выборка, "ТранспортныеРасходыСпис", ЭлементыСхемы.РасшифровкаТранспортныеРасходыСпис, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "ТранспортныеРасходы", 	   ЭлементыСхемы.РасшифровкаРасходыОбычные,			 СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	НастроитьРамку(Выборка, "ТранспортныеРасходыОст",  ЭлементыСхемы.РасшифровкаТранспортныеРасходыОст,	 СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	
	РасшифровкаМакета.Вставить("РасшифровкаТранспортныеРасходыСпис", ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаТранспортныхРасходовУчитываемыхВНУ"));
	РасшифровкаМакета.Вставить("РасшифровкаТранспортныеРасходыОст",  ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаТранспортныхРасходовОтнесенныхНаОстаток"));
	РасшифровкаМакета.Вставить("РасшифровкаРасходыОбычные",          ПереходКСхеме(ПараметрыОтчета, 10, СтруктураВП));
	
	Если СтруктураВП.ПоказыватьЛегенду Тогда
		
		ВывестиЛегенду(ЭлементыСхемы);
		
	КонецЕсли;
	
	ЭлементыСхемы.НазваниеОрганизации.Наименование = ЗаголовокОтчета(ПараметрыОтчета);
	
	// Сохраняем историю
	СохранитьИсториюСхемы(КэшПараметровОтчета, ИмяМакета, РасшифровкаМакета, НастройкаРамок, ЭлементыСхемы);
	
КонецПроцедуры

Процедура СформироватьКосвенныеРасходы(ПараметрыОтчета, ДокументРезультат, ДокументСхемы, КэшПараметровОтчета)
	
	СтруктураВП	= КэшПараметровОтчета.СтруктураВП;
	
	РасшифровкаМакета = Новый Структура;
	НастройкаРамок    = Новый Структура;
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("НачалоПериода",       ПараметрыОтчета.НачалоПериода);
	Запрос.УстановитьПараметр("КонецПериода",        КонецДня(ПараметрыОтчета.КонецПериода));
	Запрос.УстановитьПараметр("НачалоГода",          ПараметрыОтчета.НачалоГода);
	Запрос.УстановитьПараметр("Организация",         ПараметрыОтчета.ОрганизацияРасшифровки);
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация КАК Организация,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуНеЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыНеЕНВД))
	|				И НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КосвенныеРасходыУчБУ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуНеЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыНеЕНВД))
	|				И НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КосвенныеРасходыУчНУ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуНеЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыНеЕНВД))
	|				И НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КосвенныеРасходыУчПР,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуНеЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыНеЕНВД))
	|				И НЕ ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КосвенныеРасходыУчВР,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуНеЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыНеЕНВД))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КосвенныеРасходыНеБУ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуНеЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыНеЕНВД))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КосвенныеРасходыНеНУ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуНеЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыНеЕНВД))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КосвенныеРасходыНеПР,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажуНеЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходыНеЕНВД))
	|				И ВЫРАЗИТЬ(ХозрасчетныйОбороты.Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.НеУчитываемыеВЦеляхНалогообложения)
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КосвенныеРасходыНеВР,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|				И ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу))
	|			ТОГДА ХозрасчетныйОбороты.СуммаОборотКт - ХозрасчетныйОбороты.СуммаОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КосвенныеРасходыСписБУ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|				И ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу))
	|			ТОГДА ХозрасчетныйОбороты.СуммаНУОборотКт - ХозрасчетныйОбороты.СуммаНУОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КосвенныеРасходыСписНУ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|				И ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу))
	|			ТОГДА ХозрасчетныйОбороты.СуммаПРОборотКт - ХозрасчетныйОбороты.СуммаПРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КосвенныеРасходыСписПР,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОбороты.КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство_), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства))
	|				И ХозрасчетныйОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу))
	|			ТОГДА ХозрасчетныйОбороты.СуммаВРОборотКт - ХозрасчетныйОбороты.СуммаВРОборотДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КосвенныеРасходыСписВР,
	|	0 КАК КосвенныеРасходыОстБУ,
	|	0 КАК КосвенныеРасходыОстНУ,
	|	0 КАК КосвенныеРасходыОстПР,
	|	0 КАК КосвенныеРасходыОстВР
	|ПОМЕСТИТЬ ВТХозрасчетный
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВспомогательныеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.БракВПроизводстве), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбслуживающиеПроизводства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|				И НЕ ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы),
	|			,
	|			) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОбороты.Организация,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОбороты.СуммаОборотДт - ХозрасчетныйОбороты.СуммаОборотКт,
	|	ХозрасчетныйОбороты.СуммаНУОборотДт - ХозрасчетныйОбороты.СуммаНУОборотКт,
	|	ХозрасчетныйОбороты.СуммаПРОборотДт - ХозрасчетныйОбороты.СуммаПРОборотКт,
	|	ХозрасчетныйОбороты.СуммаВРОборотДт - ХозрасчетныйОбороты.СуммаВРОборотКт
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоГода,
	|			&КонецПериода,
	|			,
	|			Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщепроизводственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаПродажу)),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат),
	|			Организация = &Организация
	|				И ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|				И НЕ ВЫРАЗИТЬ(Субконто1 КАК Справочник.СтатьиЗатрат).ВидРасходовНУ = ЗНАЧЕНИЕ(Перечисление.ВидыРасходовНУ.ТранспортныеРасходы),
	|			НЕ КорСчет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НераспределеннаяПрибыль)),
	|			) КАК ХозрасчетныйОбороты
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТХозрасчетный.Организация КАК Организация,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыУчБУ) КАК КосвенныеРасходыУчБУ,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыУчНУ) КАК КосвенныеРасходыУчНУ,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыУчПР) КАК КосвенныеРасходыУчПР,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыУчВР) КАК КосвенныеРасходыУчВР,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыНеБУ) КАК КосвенныеРасходыНеБУ,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыНеНУ) КАК КосвенныеРасходыНеНУ,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыНеПР) КАК КосвенныеРасходыНеПР,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыНеВР) КАК КосвенныеРасходыНеВР,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыСписБУ) КАК КосвенныеРасходыСписБУ,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыСписНУ) КАК КосвенныеРасходыСписНУ,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыСписПР) КАК КосвенныеРасходыСписПР,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыСписВР) КАК КосвенныеРасходыСписВР,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыОстБУ) КАК КосвенныеРасходыОстБУ,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыОстНУ) КАК КосвенныеРасходыОстНУ,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыОстПР) КАК КосвенныеРасходыОстПР,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыОстВР) КАК КосвенныеРасходыОстВР,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыУчБУ + ВТХозрасчетный.КосвенныеРасходыНеБУ + ВТХозрасчетный.КосвенныеРасходыСписБУ + ВТХозрасчетный.КосвенныеРасходыОстБУ) КАК КосвенныеРасходыБУ,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыУчНУ + ВТХозрасчетный.КосвенныеРасходыНеНУ + ВТХозрасчетный.КосвенныеРасходыСписНУ + ВТХозрасчетный.КосвенныеРасходыОстНУ) КАК КосвенныеРасходыНУ,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыУчПР + ВТХозрасчетный.КосвенныеРасходыНеПР + ВТХозрасчетный.КосвенныеРасходыСписПР + ВТХозрасчетный.КосвенныеРасходыОстПР) КАК КосвенныеРасходыПР,
	|	СУММА(ВТХозрасчетный.КосвенныеРасходыУчВР + ВТХозрасчетный.КосвенныеРасходыНеВР + ВТХозрасчетный.КосвенныеРасходыСписВР + ВТХозрасчетный.КосвенныеРасходыОстВР) КАК КосвенныеРасходыВР
	|ИЗ
	|	ВТХозрасчетный КАК ВТХозрасчетный
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТХозрасчетный.Организация";
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СписокОП = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьСписокОбособленныхПодразделений(ПараметрыОтчета.ОрганизацияРасшифровки);
		Запрос.УстановитьПараметр("Организация", СписокОП);
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "Организация = &Организация", "Организация В (&Организация)");
		
	КонецЕсли;
	
	Результат = Запрос.Выполнить();
	
	Если СтруктураВП.НомерТекущейСхемы > 20 Тогда
		
		СформироватьТаблицуОрганизаций(ПараметрыОтчета, ДокументРезультат, Результат.Выгрузить(),
			"КосвенныеРасходы", 6, "Косвенные расходы", КэшПараметровОтчета);
		Возврат;
		
	Иначе
		
		ИмяМакета     = "КосвенныеРасходы" + ПараметрыОтчета.СуффиксСхемы;
		ДокументСхемы = ПолучитьМакет(ИмяМакета);
		ЭлементыСхемы = ДокументСхемы.ЭлементыГрафическойСхемы;
		
	КонецЕсли;
	
	Выборка = Результат.Выбрать();
	Выборка.Следующий();
	
	//заполняем схему
	ЗаполнитьСхему(ЭлементыСхемы, Выборка, Результат.Колонки);
	
	НастроитьРамку(Выборка, "КосвенныеРасходыУч",	ЭлементыСхемы.РасшифровкаКосвенныеРасходыУч,   СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);	
	НастроитьРамку(Выборка, "КосвенныеРасходыНе",	ЭлементыСхемы.РасшифровкаКосвенныеРасходыНЕ,   СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);	
	НастроитьРамку(Выборка, "КосвенныеРасходыСпис",	ЭлементыСхемы.РасшифровкаКосвенныеРасходыСпис, СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);	
	НастроитьРамку(Выборка, "КосвенныеРасходыОст",	ЭлементыСхемы.РасшифровкаКосвенныеРасходыОст,  СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);	
	НастроитьРамку(Выборка, "КосвенныеРасходы",		ЭлементыСхемы.РасшифровкаРасходыОбычные,  	   СтруктураВП.ПоказыватьЛегенду, НастройкаРамок);
	
	РасшифровкаМакета.Вставить("РасшифровкаРасходыОбычные",       ПереходКСхеме(ПараметрыОтчета, 10, СтруктураВП));
	РасшифровкаМакета.Вставить("РасшифровкаКосвенныеРасходыУч",   ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаКосвенныеРасходыУчитываемыеВНУ"));
	РасшифровкаМакета.Вставить("РасшифровкаКосвенныеРасходыНе",   ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаКосвенныеРасходыНеУчитываемыеВНУ"));
	РасшифровкаМакета.Вставить("РасшифровкаКосвенныеРасходыСпис", ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаОПРиОХРСписанныеНаПрямые"));
	РасшифровкаМакета.Вставить("РасшифровкаКосвенныеРасходыОст",  ПереходКРасшифровкеСхемы(ПараметрыОтчета, "РасшифровкаКосвенныеРасходыНеВкл"));
	
	Если СтруктураВП.ПоказыватьЛегенду Тогда
		
		ВывестиЛегенду(ЭлементыСхемы);
		
	КонецЕсли;
	
	ЭлементыСхемы.НазваниеОрганизации.Наименование = ЗаголовокОтчета(ПараметрыОтчета);
	
	// Сохраняем историю
	СохранитьИсториюСхемы(КэшПараметровОтчета, ИмяМакета, РасшифровкаМакета, НастройкаРамок, ЭлементыСхемы);
	
КонецПроцедуры

Процедура СформироватьТаблицуОрганизаций(ПараметрыОтчета, ДокументРезультат, Результат, НазваниеПараметра, НомерСхемы, НазваниеОтчета, КэшПараметровОтчета)
	
	СтруктураВП = КэшПараметровОтчета.СтруктураВП;
	
	ДокументРезультат.Очистить();
	
	Макет      		 = ПолучитьМакет("СписокОрганизаций");
	ОбластьОтчета    = Макет.ПолучитьОбласть("Область");
	ЗаголовокОтчета  = Макет.ПолучитьОбласть("Заголовок");
	ПодвалОтчета     = Макет.ПолучитьОбласть("Подвал");
	
	
	ЗаголовокОтчета.Параметры.НазваниеОрганизации = ЗаголовокОтчета(ПараметрыОтчета);
	ЗаголовокОтчета.Параметры.НазваниеОтчета 	  = НазваниеОтчета;
	
	ДокументРезультат.Вывести(ЗаголовокОтчета);
	
	
	Для Каждого Выборка ИЗ Результат Цикл
		
		ОбластьОтчета.Параметры.Текст 	= Выборка.Организация;
		ОбластьОтчета.Параметры.СуммаБУ = Выборка[НазваниеПараметра + "БУ"];
		ОбластьОтчета.Параметры.СуммаНУ = Выборка[НазваниеПараметра + "НУ"];
		ОбластьОтчета.Параметры.СуммаПР = Выборка[НазваниеПараметра + "ПР"];
		ОбластьОтчета.Параметры.СуммаВР = Выборка[НазваниеПараметра + "ВР"];
		
		ОбластьОтчета.Параметры.Контроль 		 = ОбластьОтчета.Параметры.СуммаБУ - ОбластьОтчета.Параметры.СуммаНУ 
			- ОбластьОтчета.Параметры.СуммаПР - ОбластьОтчета.Параметры.СуммаВР;
		ОбластьОтчета.Параметры.СхемаРасшифровки = ПереходКСхеме(ПараметрыОтчета, НомерСхемы, СтруктураВП, Ложь, Выборка.Организация);
		
		ДокументРезультат.Вывести(ОбластьОтчета);
		
	КонецЦикла;
	
	ПодвалОтчета.Параметры.СуммаБУ = Результат.Итог(НазваниеПараметра + "БУ");
	ПодвалОтчета.Параметры.СуммаНУ = Результат.Итог(НазваниеПараметра + "НУ");
	ПодвалОтчета.Параметры.СуммаПР = Результат.Итог(НазваниеПараметра + "ПР");
	ПодвалОтчета.Параметры.СуммаВР = Результат.Итог(НазваниеПараметра + "ВР");
	
	ДокументРезультат.Вывести(ПодвалОтчета);
	ДокументРезультат.КлючПараметровПечати = "Анализ состояния налогового учета - " + НазваниеОтчета;
	
	ТабличныйДокумент = Новый ТабличныйДокумент;
	ТабличныйДокумент.Вывести(ДокументРезультат);
	
	КэшМакета 	= Новый Структура;
	КэшМакета.Вставить("РасшифровкаМакета", Неопределено);
	КэшМакета.Вставить("ЭтоСхема",          Ложь);
	КэшМакета.Вставить("Макет",	            ТабличныйДокумент);
	КэшМакетов 	= КэшПараметровОтчета.КэшМакетов;
	
	КэшМакетов.Вставить("Макет_" + СтруктураВП.НомерТекущейСхемы, КэшМакета);
	КэшПараметровОтчета.Вставить("КэшМакетов", КэшМакетов);
	
КонецПроцедуры


Функция ПереходКСхеме(ПараметрыОтчета, НомерСхемы, СтруктураВП, УчитыватьОП = Ложь, ОрганизацияОП = Неопределено)

	РасшифровкаТек = Новый Соответствие;
	РасшифровкаТек.Вставить("Организация", 		 ?(ОрганизацияОП = Неопределено, ПараметрыОтчета.ОрганизацияРасшифровки, ОрганизацияОП));
	РасшифровкаТек.Вставить("НомерТекущейСхемы", НомерСхемы + ?(ПараметрыОтчета.ВключатьОбособленныеПодразделения и УчитыватьОП, 20,0));
	РасшифровкаТек.Вставить("ВидРасшифровки", 	 "Схема");
	
	Возврат РасшифровкаТек;

КонецФункции

Функция ПереходКРасшифровкеСхемы(ПараметрыОтчета, ИдентификаторРасшифровки)
	
	РасшифровкаСхемы = Новый Соответствие;
 	РасшифровкаСхемы.Вставить("ВидРасшифровки",    "Расшифровка");
	РасшифровкаСхемы.Вставить("Организация", 	   ПараметрыОтчета.ОрганизацияРасшифровки);
	РасшифровкаСхемы.Вставить("НомерТекущейСхемы", ИдентификаторРасшифровки);
	
	Возврат РасшифровкаСхемы;
	
КонецФункции
	
Процедура СохранитьИсториюСхемы(КэшПараметровОтчета, ИмяМакета, РасшифровкаМакета, НастройкаРамок, ЭлементыСхемы)
	
	КэшМакета 	= Новый Структура;
	КэшМакета.Вставить("РасшифровкаМакета", РасшифровкаМакета);
	КэшМакета.Вставить("Макет",             ИмяМакета);
	КэшМакета.Вставить("ЭтоСхема",          Истина);
	КэшМакета.Вставить("НастройкаРамок",    НастройкаРамок);
	КэшМакета.Вставить("ОписаниеЗначений",  ОписатьЗначенияСхемы(ЭлементыСхемы));
	
	КэшПараметровОтчета.КэшМакетов.Вставить("Макет_" + КэшПараметровОтчета.СтруктураВП.НомерТекущейСхемы, КэшМакета);
	
КонецПроцедуры

Функция ЗаголовокОтчета(ПараметрыОтчета, Сноска = Ложь)
	
	ПредставлениеПериода = ПараметрыОтчета.ПредставлениеПериода;
	Если Сноска Тогда
		// Не все макеты поддерживают вывод сносок
		СправкиРасчеты.ДополнитьПериодОтчетаПримечанием(ПредставлениеПериода, ПараметрыОтчета);
	КонецЕсли;
	
	Возврат СправкиРасчетыКлиентСервер.ТекстЗаголовка(
		"",
		ПредставлениеПериода,
		ПараметрыОтчета.ПредставлениеОрганизации);
	
КонецФункции

Функция НастроитьРамку(Выборка, Сумма, РамкаЭлемент, ПоказыватьЛегенду, НастройкаРамок, ПоказыватьЗеленый = Ложь)
	
	СуммаБУ = ?(Выборка[Сумма + "БУ"] = Неопределено, 0, Окр(Выборка[Сумма + "БУ"], 2));
	СуммаНУ = ?(Выборка[Сумма + "НУ"] = Неопределено, 0, Окр(Выборка[Сумма + "НУ"], 2));
	СуммаПР = ?(Выборка[Сумма + "ПР"] = Неопределено, 0, Окр(Выборка[Сумма + "ПР"], 2));
	СуммаВР = ?(Выборка[Сумма + "ВР"] = Неопределено, 0, Окр(Выборка[Сумма + "ВР"], 2));
	
	СтроимПрямоугольник = Истина;
	Если (СуммаБУ - СуммаНУ - СуммаПР - СуммаВР < 10 И СуммаБУ - СуммаНУ - СуммаПР - СуммаВР > -10) 
		ИЛИ (Сумма = "Налог" И Выборка.НалогБУКор = 0 И СуммаНУ < 0) Тогда
		
		Если НЕ ПоказыватьЗеленый Тогда			
			СтроимПрямоугольник = Ложь;			
		Иначе			
			ЦветЛинии = WebЦвета.Зеленый;			
		КонецЕсли;		
	Иначе		
		ПоказыватьЛегенду = Истина;
		ЦветЛинии = WebЦвета.Красный;		
	КонецЕсли;
	
	Если СтроимПрямоугольник Тогда		
		РамкаЭлемент.ЦветРамки 	= ЦветЛинии;
		РамкаЭлемент.Фигура		= ФигурыГрафическойСхемы.Блок;
		НастройкаРамок.Вставить(РамкаЭлемент.Имя, ?(ЦветЛинии = WebЦвета.Красный, 1, 0));	
	КонецЕсли;
	
КонецФункции

Процедура ЗаполнитьСхему(ЭлементыСхемы, Выборка, Колонки)
	
	Для Каждого ЭлементВыборки Из Колонки Цикл		
		Для НомерЭлемента = 0 По ЭлементыСхемы.Количество() - 1 Цикл			
			Если ВРег(ЭлементыСхемы.Получить(НомерЭлемента).Имя) = ВРег(ЭлементВыборки.Имя) Тогда			
				ПоказательОтчета = Выборка[ЭлементВыборки.Имя];
				ЗначениеПоказателяОтчета = ?(ПоказательОтчета = Неопределено 
					ИЛИ Выборка[ЭлементВыборки.Имя] = 0, "",
					?(ТипЗнч(ПоказательОтчета) = Тип("Число"),
					Формат(ПоказательОтчета, "ЧЦ=20; ЧДЦ=0; ЧРГ=' '"), ПоказательОтчета));
				
				ЭлементыСхемы[ЭлементВыборки.Имя].Наименование = ЗначениеПоказателяОтчета;				
			КонецЕсли;			
		КонецЦикла;
	КонецЦикла;
	
КонецПроцедуры

Функция ЗначенияПолейСхемы(Источник, ПрефиксЭлементов)
	
	ВидыСумм = СтрРазделить("БУ,НУ,ПР,ВР", ",");
	
	ЗначенияПолей = Новый Структура;
	Для Каждого ВидСуммы Из ВидыСумм Цикл
		ИмяЭлемента = ПрефиксЭлементов + ВидСуммы;
		ЗначенияПолей.Вставить(ИмяЭлемента, 0);
	КонецЦикла;
	
	ЗаполнитьЗначенияСвойств(ЗначенияПолей, Источник);
	
	Возврат ЗначенияПолей;
	
КонецФункции

Процедура ЗаполнитьПоляСхемы(ЭлементыСхемы, Суммы)
	
	Для Каждого ОписаниеСуммы Из Суммы Цикл
		
		ЭлементыСхемы[ОписаниеСуммы.Ключ].Наименование = Формат(ОписаниеСуммы.Значение, "ЧЦ=20; ЧДЦ=0; ЧРГ=' '");
		
	КонецЦикла;
	
КонецПроцедуры

Функция ОписатьЗначенияСхемы(ЭлементыСхемы)
	
	СтруктураОписания = Новый Структура;
	
	Для НомерЭлемента = 0 По ЭлементыСхемы.Количество() - 1 Цикл		
		Если ЭлементыСхемы.Получить(НомерЭлемента).Наименование <> "" Тогда			
			ЗначениеПоказателяОтчета = ЭлементыСхемы.Получить(НомерЭлемента).Наименование;
			СтруктураОписания.Вставить(ЭлементыСхемы.Получить(НомерЭлемента).Имя,
				?(ЗначениеПоказателяОтчета = "0", "", ЗначениеПоказателяОтчета));			
		КонецЕсли;	
	КонецЦикла;
	
	Возврат СтруктураОписания;
	
КонецФункции

Функция ПрибыльУбытокВозвратыПрошлыхЛет(НачалоПериода, КонецПериода, Организация, ВсяОрганизация)
	
	ПрибыльУбыток = Новый Структура;
	ПрибыльУбыток.Вставить("Прибыль", 0);
	ПрибыльУбыток.Вставить("Убыток",  0);
	
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("НачалоПериода",  НачалоПериода);
	Запрос.УстановитьПараметр("КонецПериода",   КонецПериода);
	Запрос.УстановитьПараметр("ВсяОрганизация", ВсяОрганизация);
	УстановитьПараметрыСчетаВыручкиСебестоимости(Запрос, КонецПериода, Организация);
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ПрочиеДоходыИРасходы.Ссылка КАК Ссылка
	|ПОМЕСТИТЬ СтатьиПрибылиУбыткиПрошлыхЛет
	|ИЗ
	|	Справочник.ПрочиеДоходыИРасходы КАК ПрочиеДоходыИРасходы
	|ГДЕ
	|	ПрочиеДоходыИРасходы.ВидПрочихДоходовИРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыПрочихДоходовИРасходов.ПрибыльУбытокПрошлыхЛет)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ЕСТЬNULL(СУММА(Прибыли.СуммаНУОборотКт), 0) КАК Прибыль,
	|	0 КАК Убыток
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			СчетДт В (&СчетаСебестоимостьПродаж),
	|			,
	|			СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			Организация В (&ВсяОрганизация)
	|				И СубконтоКт1 В
	|					(ВЫБРАТЬ
	|						СтатьиПрибылиУбыткиПрошлыхЛет.Ссылка
	|					ИЗ
	|						СтатьиПрибылиУбыткиПрошлыхЛет)) КАК Прибыли
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	0,
	|	ЕСТЬNULL(СУММА(Убытки.СуммаНУОборотДт), 0)
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			СчетКт В (&СчетаВыручка),
	|			,
	|			Организация В (&ВсяОрганизация)
	|				И СубконтоДт1 В
	|					(ВЫБРАТЬ
	|						СтатьиПрибылиУбыткиПрошлыхЛет.Ссылка
	|					ИЗ
	|						СтатьиПрибылиУбыткиПрошлыхЛет)) КАК Убытки";
	
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		ПрибыльУбыток.Прибыль = ПрибыльУбыток.Прибыль + Выборка.Прибыль;
		ПрибыльУбыток.Убыток  = ПрибыльУбыток.Убыток  + Выборка.Убыток;
	КонецЦикла;
	
	Возврат ПрибыльУбыток;
	
КонецФункции

Функция ПараметрыЗапросаСчетаВыручкиСебестоимости(Период, Организация)
	
	ПараметрыЗапроса = Новый Структура;
	ПараметрыЗапроса.Вставить("СчетаВыручка",             Новый Массив);
	ПараметрыЗапроса.Вставить("СчетаСебестоимостьПродаж", Новый Массив);
	
	Счета = НалоговыйУчет.СчетаВыручкиСебестоимости(Период, Организация);
	
	Для Каждого ОписаниеСчета Из Счета.Выручка Цикл
		ПараметрыЗапроса.СчетаВыручка.Добавить(ОписаниеСчета.Ключ);
	КонецЦикла;
	
	Для Каждого ОписаниеСчета Из Счета.СебестоимостьПродаж Цикл
		ПараметрыЗапроса.СчетаСебестоимостьПродаж.Добавить(ОписаниеСчета.Ключ);
	КонецЦикла;
	
	Возврат ПараметрыЗапроса;
	
КонецФункции

Процедура УстановитьПараметрыСчетаВыручкиСебестоимости(Запрос, Период, Организация)
	
	ПараметрыЗапроса = ПараметрыЗапросаСчетаВыручкиСебестоимости(Период, Организация);
	
	Для Каждого ОписаниеПараметра Из ПараметрыЗапроса Цикл
		Запрос.УстановитьПараметр(ОписаниеПараметра.Ключ, ОписаниеПараметра.Значение);
	КонецЦикла;
	
КонецПроцедуры

Процедура УстановитьПараметрыРасшифровкиСчетаВыручкиСебестоимости(ПараметрыДанных, СхемаКомпоновкиДанных, Период, Организация)
	
	Если СхемаКомпоновкиДанных.Параметры.Найти("СчетаВыручка") = Неопределено
		И СхемаКомпоновкиДанных.Параметры.Найти("СчетаСебестоимостьПродаж") = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	ПараметрыЗапроса = ПараметрыЗапросаСчетаВыручкиСебестоимости(Период, Организация);
	
	Для Каждого ОписаниеПараметра Из ПараметрыЗапроса Цикл
		
		ПараметрКомпоновкиДанных = ПараметрыДанных.Элементы.Найти(ОписаниеПараметра.Ключ);
		
		Если ПараметрКомпоновкиДанных = Неопределено Тогда
			Продолжить;
		КонецЕсли;
		
		ЗначениеПараметра = Новый СписокЗначений;
		ЗначениеПараметра.ЗагрузитьЗначения(ОписаниеПараметра.Значение);
		ПараметрыДанных.УстановитьЗначениеПараметра(ОписаниеПараметра.Ключ, ЗначениеПараметра);
		
	КонецЦикла;
	
КонецПроцедуры

#КонецЕсли
