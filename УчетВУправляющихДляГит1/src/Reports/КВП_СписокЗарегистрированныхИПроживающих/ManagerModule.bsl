#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

////////////////////////////////////////////////////////////////////////////////
// ПРОГРАММНЫЙ ИНТЕРФЕЙС

#Область ПрограммныйИнтерфейс

// Функция возвращает параметры исполнения отчета.
Функция ПолучитьПараметрыИсполненияОтчета() Экспорт
	
	Возврат Новый Структура("ИспользоватьПередКомпоновкойМакета,
							|ИспользоватьПослеКомпоновкиМакета,
							|ИспользоватьПослеВыводаРезультата,
							|ИспользоватьДанныеРасшифровки,
							|ИспользоватьВнешниеНаборыДанных,
							|ИспользоватьПривилегированныйРежим,
							|ИспользоватьРасширенныеПараметрыРасшифровки",
							Истина, Истина, Истина, Истина, Истина, Ложь, Ложь);
	
КонецФункции

// Функция возвращает текст заголовка.
//
// Параметры:
//  ПараметрыОтчета    - Структура - содержит передаваемые параметры.
//  ОрганизацияВНачале - Булево    - признак, указывающий на то, что организация указывается в начале.
//
// Возвращаемое значение:
//  Строка - Текст заголовка.
//
Функция ПолучитьТекстЗаголовка(ПараметрыОтчета, ОрганизацияВНачале = Истина) Экспорт 
	
	Возврат "Список зарегистрированных и проживающих: " + ПараметрыОтчета.ПредставлениеВариантаОтчета;
	
КонецФункции

// Функция возвращает внешние наборы данных.
//
// Параметры:
//  ПараметрыОтчета - Структура - содержит передаваемые параметры.
//  МакетКомпоновки - Макет - макет компоновки.
// 
// Возвращаемое значение:
//  Стурктура - Внешние наборы данных.
//
Функция ПолучитьВнешниеНаборыДанных(ПараметрыОтчета, МакетКомпоновки) Экспорт
	
	ВнешниеНаборыДанных = Новый Структура("ТаблицаТелефоновЖильцов", Справочники.УПЖКХ_Жильцы.ПолучитьТаблицуТелефоновФизЛицЖильцов());
	
	Возврат ВнешниеНаборыДанных;
	
КонецФункции

// В процедуре можно доработать компоновщик перед выводом в отчет.
// Изменения сохранены не будут.
//
// Параметры:
//  ПараметрыОтчета     - Структура - содержит передаваемые параметры.
//  Схема               - Схема     - схема данных.
//  КомпоновщикНастроек - Структура - структура компоновщика настроек.
//
Процедура ПередКомпоновкойМакета(ПараметрыОтчета, Схема, КомпоновщикНастроек) Экспорт
	
	ИмяВариантаОтчета = ПараметрыОтчета.ИмяВариантаОтчета;
	
	// Заполнение параметра "Период".
	УПЖКХ_ТиповыеМетодыКлиентСервер.УстановитьПараметр(КомпоновщикНастроек, "Период", КонецДня(ПараметрыОтчета.КонецПериода));
	
	// Заполнение параметра "Начало периода".
	УПЖКХ_ТиповыеМетодыКлиентСервер.УстановитьПараметр(КомпоновщикНастроек, "НачалоПериода", НачалоДня(ПараметрыОтчета.НачалоПериода));
	
	// Заполнение параметра "Конец периода".
	УПЖКХ_ТиповыеМетодыКлиентСервер.УстановитьПараметр(КомпоновщикНастроек, "КонецПериода", КонецДня(ПараметрыОтчета.КонецПериода));
	
	// Заполнение параметра "Организация".
	УПЖКХ_ТиповыеМетодыКлиентСервер.УстановитьПараметр(КомпоновщикНастроек, "Организация", ПараметрыОтчета.Организация);
	
	// Установка отбора данных по организации.
	// Если организация не указана, то отчет формируется по всем лицевым счетам.
	Если ЗначениеЗаполнено(ПараметрыОтчета.Организация) Тогда
		УПЖКХ_ТиповыеМетодыКлиентСервер.ДобавитьОтбор(КомпоновщикНастроек.Настройки.Отбор, "Организация", ПараметрыОтчета.Организация, , , Ложь);
	КонецЕсли;
	
	Если ИмяВариантаОтчета = "ДанныеОРегистрацииПроживании"
	 ИЛИ ИмяВариантаОтчета = "СостояниеЖильцов" Тогда
		
		// Заполнение параметра "Упрощенный вариант учета собственников".
		УПЖКХ_ТиповыеМетодыКлиентСервер.УстановитьПараметр(КомпоновщикНастроек, "УпрощенныйВариантУчетаСобственников", ИспользуетсяУпрощенныйВариантУчетаСобственников());
		
		// Структура представления видов собственников.
		мСтруктураПредставленияОтветственногоСобственника = ПолучитьСтруктуруПредставленияОтветственногоСобственника();
		
		// Заполнение параметра "Частный собственник".
		УПЖКХ_ТиповыеМетодыКлиентСервер.УстановитьПараметр(КомпоновщикНастроек, "ЧастныйСобственник", мСтруктураПредставленияОтветственногоСобственника.ЧастныйСобственник);
		
		// Заполнение параметра "Муниципальный собственник".
		УПЖКХ_ТиповыеМетодыКлиентСервер.УстановитьПараметр(КомпоновщикНастроек, "МуниципальныйСобственник", мСтруктураПредставленияОтветственногоСобственника.МуниципальныйСобственник);
		
		// Заполнение параметра "Прочий собственник".
		УПЖКХ_ТиповыеМетодыКлиентСервер.УстановитьПараметр(КомпоновщикНастроек, "ПрочийСобственник", мСтруктураПредставленияОтветственногоСобственника.ПрочийСобственник);
		
		Схема.НаборыДанных.Проживающие.Запрос = ПолучитьТекстЗапроса(?(ИмяВариантаОтчета = "СостояниеЖильцов", 3, 1), ПараметрыОтчета);
		
	ИначеЕсли ИмяВариантаОтчета = "ЗарегистрированныеПрибышиеЗаПериод" Тогда
		
		Схема.НаборыДанных.Проживающие.Запрос = ПолучитьТекстЗапроса(2, ПараметрыОтчета);
		
	ИначеЕсли ИмяВариантаОтчета = "ПаспортныеДанные" Тогда
		
		Схема.НаборыДанных.Проживающие.Запрос = ПолучитьТекстЗапроса(4, ПараметрыОтчета);
		
	КонецЕсли;
	
	ДобавитьПоляВНаборКомпоновки(ПараметрыОтчета, Схема);
	
	УПЖКХ_ТиповыеМетодыВызовСервера.ДобавитьДополнительныеПоля(ПараметрыОтчета, КомпоновщикНастроек);
	
КонецПроцедуры

// Возникает после компоновки макета.
//
// Параметры:
//  ПараметрыОтчета - Структура - содержит передаваемые параметры.
//  МакетКомпоновки - Макет - макет компоновки.
//
Процедура ПослеКомпоновкиМакета(ПараметрыОтчета, МакетКомпоновки) Экспорт
	
КонецПроцедуры

// Возникает после вывода результата.
//
// Параметры:
//  ПараметрыОтчета - Структура         - содержит передаваемые параметры.
//  Результат       - ТабличныйДокумент - содержит таблицу результатов.
//
Процедура ПослеВыводаРезультата(ПараметрыОтчета, Результат) Экспорт
	
	УПЖКХ_ТиповыеМетодыВызовСервера.ОбработкаРезультатаОтчета(ПараметрыОтчета.ИдентификаторОтчета, Результат);
	
КонецПроцедуры

// Вызывает настройку вариантов отчета.
//
// Параметры:
//  Настройки      - Структура - содержит настройки варианта отчета.
//  ОписаниеОтчета - Структура - содержит описание варианта отчета.
//
Процедура НастроитьВариантыОтчета(Настройки, ОписаниеОтчета) Экспорт
	
КонецПроцедуры

// Процедура используется подсистемой варианты отчетов
//
// Параметры:
//  Настройки      - Структура - содержит настройки варианта отчета.
//
Процедура НастройкиОтчета(Настройки) Экспорт
	
	Схема = ПолучитьМакет("ОсновнаяСхемаКомпоновкиДанных");
	Для Каждого Вариант из Схема.ВариантыНастроек Цикл
		Настройки.ОписаниеВариантов.Вставить(Вариант.Имя,Вариант.Представление);
	КонецЦикла;
	
КонецПроцедуры

// Заполняет параметры расшифровки отчета.
//
// Параметры:
//  Адрес                - Строка    - адрес жильца.
//  Расшифровка          - Строка    - расшифровка данных.
//  ПараметрыРасшифровки - Структура - параметры расшифровки данных.
//
Процедура ЗаполнитьПараметрыРасшифровкиОтчета(Адрес, Расшифровка, ПараметрыРасшифровки) Экспорт
	
	
КонецПроцедуры

#КонецОбласти

////////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

#Область СлужебныеПроцедурыИФункции

// Функция возвращает текст запроса.
Функция ПолучитьТекстЗапроса(Вариант, Параметры) Экспорт
	
	// В первом подзапросе получим таблицу соответствия лицевых счетов и организаций,
	// которая нужна для отбора данных по организации, указанной пользователем.
	// При этом получаются организации, закрепленные на здания на конец периода,
	// и принятые на обслуживание в течение периода формирования отчета.
	ТекстЗапроса =
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	УПЖКХ_СведенияОбОбслуживающихЗданияОрганизацияхСрезПоследних.Здание,
	|	УПЖКХ_СведенияОбОбслуживающихЗданияОрганизацияхСрезПоследних.Организация
	|ПОМЕСТИТЬ врСоответствиеЗданийИОбслуживающихОрганизаций
	|ИЗ
	|	РегистрСведений.УПЖКХ_СведенияОбОбслуживающихЗданияОрганизациях.СрезПоследних(&Период, ) КАК УПЖКХ_СведенияОбОбслуживающихЗданияОрганизацияхСрезПоследних
	|ГДЕ
	|	УПЖКХ_СведенияОбОбслуживающихЗданияОрганизацияхСрезПоследних.НаходитсяНаОбслуживании
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	УПЖКХ_СведенияОбОбслуживающихЗданияОрганизациях.Здание,
	|	УПЖКХ_СведенияОбОбслуживающихЗданияОрганизациях.Организация
	|ИЗ
	|	РегистрСведений.УПЖКХ_СведенияОбОбслуживающихЗданияОрганизациях КАК УПЖКХ_СведенияОбОбслуживающихЗданияОрганизациях
	|ГДЕ
	|	УПЖКХ_СведенияОбОбслуживающихЗданияОрганизациях.НаходитсяНаОбслуживании
	|	И УПЖКХ_СведенияОбОбслуживающихЗданияОрганизациях.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	врСоответствиеЗданийИОбслуживающихОрганизаций.Здание,
	|	МАКСИМУМ(врСоответствиеЗданийИОбслуживающихОрганизаций.Организация) КАК Организация
	|ПОМЕСТИТЬ врОбслуживающиеОрганизации
	|ИЗ
	|	врСоответствиеЗданийИОбслуживающихОрганизаций КАК врСоответствиеЗданийИОбслуживающихОрганизаций
	|
	|СГРУППИРОВАТЬ ПО
	|	врСоответствиеЗданийИОбслуживающихОрганизаций.Здание";
	
	// Добавление разделителя между подзапросами.
	ТекстЗапроса = ТекстЗапроса +
	"
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|";
	
	// Определим основную часть запроса в зависимости от варианта отчета.
	Если Вариант = 1 Тогда
		
		ТекстЗапроса = ТекстЗапроса +
		"УНИЧТОЖИТЬ врСоответствиеЗданийИОбслуживающихОрганизаций
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	КВП_СведенияОПроживающихНаДату.Жилец КАК Проживающий,
		|	КВП_СведенияОПроживающихНаДату.Жилец.ФизЛицо КАК ФизЛицо,
		|	КВП_СведенияОПроживающихНаДату.ЛицевойСчет КАК ЛицевойСчет,
		|	КВП_СведенияОПроживающихНаДату.ЛицевойСчет.Адрес.Владелец КАК Здание,
		|	КВП_СведенияОПроживающихНаДату.ЛицевойСчет.Адрес КАК Квартира,
		|	КВП_СведенияОПроживающихНаДату.ДатаИзменения КАК ДатаИзменения
		|ПОМЕСТИТЬ втПроживающихНаДату
		|ИЗ
		|	РегистрСведений.УПЖКХ_СведенияОПроживающих.СрезПоследних(
		|			&Период,
		|			Проживает
		|				И ДатаИзменения <= &Период) КАК КВП_СведенияОПроживающихНаДату
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	КВП_СведенияОПроживающихНаДатуБезОтбора.Жилец КАК Проживающий,
		|	КВП_СведенияОПроживающихНаДатуБезОтбора.Жилец.ФизЛицо КАК ФизЛицо,
		|	КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет КАК ЛицевойСчет,
		|	КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет.Адрес.Владелец КАК Здание,
		|	КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет.Адрес КАК Квартира,
		|	КВП_СведенияОПроживающихНаДатуБезОтбора.ДатаИзменения КАК ДатаИзменения
		|ПОМЕСТИТЬ втПроживающихБезОтбора
		|ИЗ
		|	РегистрСведений.УПЖКХ_СведенияОПроживающих.СрезПоследних(&Период, НЕ Проживает) КАК КВП_СведенияОПроживающихНаДатуБезОтбора
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ЕСТЬNULL(втПроживающихНаДату.Проживающий, втПроживающихБезОтбора.Проживающий) КАК Проживающий,
		|	ЕСТЬNULL(втПроживающихНаДату.ФизЛицо, втПроживающихБезОтбора.ФизЛицо) КАК ФизЛицо,
		|	ЕСТЬNULL(втПроживающихНаДату.ЛицевойСчет, втПроживающихБезОтбора.ЛицевойСчет) КАК ЛицевойСчет,
		|	ЕСТЬNULL(втПроживающихНаДату.Здание, втПроживающихБезОтбора.Здание) КАК Здание,
		|	ЕСТЬNULL(втПроживающихНаДату.Квартира, втПроживающихБезОтбора.Квартира) КАК Квартира,
		|	втПроживающихНаДату.ДатаИзменения КАК ДатаПрибытия,
		|	ВЫБОР
		|		КОГДА втПроживающихНаДату.ДатаИзменения < втПроживающихБезОтбора.ДатаИзменения
		|			ТОГДА втПроживающихБезОтбора.ДатаИзменения
		|	КОНЕЦ КАК ДатаВыбытия,
		|	ИСТИНА КАК Проживает
		|ПОМЕСТИТЬ втПроживающих
		|ИЗ
		|	втПроживающихНаДату КАК втПроживающихНаДату
		|		ЛЕВОЕ СОЕДИНЕНИЕ втПроживающихБезОтбора КАК втПроживающихБезОтбора
		|		ПО втПроживающихНаДату.Проживающий = втПроживающихБезОтбора.Проживающий
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ втПроживающихНаДату
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ втПроживающихБезОтбора
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	УПЖКХ_СобственностьНаПомещенияСрезПоследних.Помещение КАК Помещение,
		|	УПЖКХ_СобственностьНаПомещенияСрезПоследних.ВидСобственности КАК ВидСобственности,
		|	УПЖКХ_СобственностьНаПомещенияСрезПоследних.ПодвидЧастнойСобственности КАК ПодвидЧастнойСобственности
		|ПОМЕСТИТЬ втСобственностьНаПомещения
		|ИЗ
		|	РегистрСведений.УПЖКХ_СобственностьНаПомещения.СрезПоследних(&Период, ) КАК УПЖКХ_СобственностьНаПомещенияСрезПоследних
		|ГДЕ
		|	УПЖКХ_СобственностьНаПомещенияСрезПоследних.Действует
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.Помещение КАК Помещение,
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.Собственник КАК Собственник,
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.ДоляСобственникаЧислитель КАК ДоляСобственникаЧислитель,
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.ДоляСобственникаЗнаменатель КАК ДоляСобственникаЗнаменатель
		|ПОМЕСТИТЬ врТаблицаСобственников
		|ИЗ
		|	РегистрСведений.УПЖКХ_СобственникиПомещений.СрезПоследних(&Период, ) КАК УПЖКХ_СобственникиПомещенийСрезПоследних
		|ГДЕ
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.Действует
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	врТаблицаСобственников.Помещение КАК Помещение,
		|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ врТаблицаСобственников.Собственник) КАК КолвоСобственников
		|ПОМЕСТИТЬ втКолвоСобственников
		|ИЗ
		|	врТаблицаСобственников КАК врТаблицаСобственников
		|
		|СГРУППИРОВАТЬ ПО
		|	врТаблицаСобственников.Помещение
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	втСобственностьНаПомещения.Помещение КАК Помещение,
		|	врТаблицаСобственников.Собственник КАК Собственник,
		|	ВЫБОР
		|		КОГДА втСобственностьНаПомещения.ВидСобственности = ЗНАЧЕНИЕ(Перечисление.УПЖКХ_ВидыСобственности.Частная)
		|			ТОГДА ВЫБОР
		|					КОГДА втСобственностьНаПомещения.ПодвидЧастнойСобственности = ЗНАЧЕНИЕ(Перечисление.УПЖКХ_ВидыЧастнойСобственности.Индивидуальная)
		|						ТОГДА 1
		|					КОГДА втСобственностьНаПомещения.ПодвидЧастнойСобственности = ЗНАЧЕНИЕ(Перечисление.УПЖКХ_ВидыЧастнойСобственности.Совместная)
		|						ТОГДА ВЫБОР
		|								КОГДА ЕСТЬNULL(втКолвоСобственников.КолвоСобственников, 0) = 0
		|									ТОГДА 0
		|								ИНАЧЕ 1 / втКолвоСобственников.КолвоСобственников
		|							КОНЕЦ
		|					ИНАЧЕ ВЫБОР
		|							КОГДА врТаблицаСобственников.ДоляСобственникаЗнаменатель = 0
		|								ТОГДА 0
		|							ИНАЧЕ врТаблицаСобственников.ДоляСобственникаЧислитель / врТаблицаСобственников.ДоляСобственникаЗнаменатель
		|						КОНЕЦ
		|				КОНЕЦ
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ДоляСобственности
		|ПОМЕСТИТЬ втДолиСобственности
		|ИЗ
		|	втСобственностьНаПомещения КАК втСобственностьНаПомещения
		|		ЛЕВОЕ СОЕДИНЕНИЕ врТаблицаСобственников КАК врТаблицаСобственников
		|		ПО втСобственностьНаПомещения.Помещение = врТаблицаСобственников.Помещение
		|		ЛЕВОЕ СОЕДИНЕНИЕ втКолвоСобственников КАК втКолвоСобственников
		|		ПО втСобственностьНаПомещения.Помещение = втКолвоСобственников.Помещение
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ втСобственностьНаПомещения
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ врТаблицаСобственников
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ втКолвоСобственников
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	КВП_СведенияОПроживающихНаДату.Жилец КАК Проживающий,
		|	КВП_СведенияОПроживающихНаДату.Жилец.ФизЛицо КАК ФизЛицо,
		|	КВП_СведенияОПроживающихНаДату.ЛицевойСчет КАК ЛицевойСчет,
		|	КВП_СведенияОПроживающихНаДату.ЛицевойСчет.Адрес.Владелец КАК Здание,
		|	КВП_СведенияОПроживающихНаДату.ЛицевойСчет.Адрес КАК Квартира,
		|	КВП_СведенияОПроживающихНаДату.ДатаИзменения КАК ДатаИзменения,
		|	КВП_СведенияОПроживающихНаДату.ВременнаяРегистрация КАК ВременнаяРегистрация
		|ПОМЕСТИТЬ втЗарегистрированныхНаДату
		|ИЗ
		|	РегистрСведений.УПЖКХ_СведенияОЗарегистрированных.СрезПоследних(
		|			&Период,
		|			Зарегистрирован
		|				И ДатаИзменения <= &Период) КАК КВП_СведенияОПроживающихНаДату
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	КВП_СведенияОПроживающихНаДатуБезОтбора.Жилец КАК Проживающий,
		|	КВП_СведенияОПроживающихНаДатуБезОтбора.Жилец.ФизЛицо КАК ФизЛицо,
		|	КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет КАК ЛицевойСчет,
		|	КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет.Адрес.Владелец КАК Здание,
		|	КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет.Адрес КАК Квартира,
		|	КВП_СведенияОПроживающихНаДатуБезОтбора.ДатаИзменения КАК ДатаИзменения
		|ПОМЕСТИТЬ втЗарегистрированныхБезОтбора
		|ИЗ
		|	РегистрСведений.УПЖКХ_СведенияОЗарегистрированных.СрезПоследних(&Период, НЕ Зарегистрирован) КАК КВП_СведенияОПроживающихНаДатуБезОтбора
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ЕСТЬNULL(втЗарегистрированныхНаДату.Проживающий, втЗарегистрированныхБезОтбора.Проживающий) КАК Проживающий,
		|	ЕСТЬNULL(втЗарегистрированныхНаДату.ФизЛицо, втЗарегистрированныхБезОтбора.ФизЛицо) КАК ФизЛицо,
		|	ЕСТЬNULL(втЗарегистрированныхНаДату.ЛицевойСчет, втЗарегистрированныхБезОтбора.ЛицевойСчет) КАК ЛицевойСчет,
		|	ЕСТЬNULL(втЗарегистрированныхНаДату.Здание, втЗарегистрированныхБезОтбора.Здание) КАК Здание,
		|	ЕСТЬNULL(втЗарегистрированныхНаДату.Квартира, втЗарегистрированныхБезОтбора.Квартира) КАК Квартира,
		|	втЗарегистрированныхНаДату.ДатаИзменения КАК ДатаРегистрации,
		|	ВЫБОР
		|		КОГДА втЗарегистрированныхНаДату.ДатаИзменения < втЗарегистрированныхБезОтбора.ДатаИзменения
		|			ТОГДА втЗарегистрированныхБезОтбора.ДатаИзменения
		|	КОНЕЦ КАК ДатаСнятияСРегистрации,
		|	втЗарегистрированныхНаДату.ВременнаяРегистрация КАК ВременнаяРегистрация,
		|	ИСТИНА КАК Зарегистрирован
		|ПОМЕСТИТЬ втЗарегистрированных
		|ИЗ
		|	втЗарегистрированныхНаДату КАК втЗарегистрированныхНаДату
		|		ЛЕВОЕ СОЕДИНЕНИЕ втЗарегистрированныхБезОтбора КАК втЗарегистрированныхБезОтбора
		|		ПО втЗарегистрированныхНаДату.Проживающий = втЗарегистрированныхБезОтбора.Проживающий
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ втЗарегистрированныхНаДату
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ втЗарегистрированныхБезОтбора
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ЕСТЬNULL(Проживающие.Проживающий, Зарегистрированные.Проживающий) КАК Проживающий,
		|	ЕСТЬNULL(Проживающие.ФизЛицо, Зарегистрированные.ФизЛицо) КАК ФизЛицо,
		|	ЕСТЬNULL(Проживающие.ЛицевойСчет, Зарегистрированные.ЛицевойСчет) КАК ЛицевойСчет,
		|	ЕСТЬNULL(Проживающие.Здание, Зарегистрированные.Здание) КАК Здание,
		|	ЕСТЬNULL(Проживающие.Квартира, Зарегистрированные.Квартира) КАК Помещение,
		|	Зарегистрированные.ДатаРегистрации КАК ДатаРегистрации,
		|	Зарегистрированные.ДатаСнятияСРегистрации КАК ДатаСнятияСРегистрации,
		|	Зарегистрированные.ВременнаяРегистрация КАК ВременнаяРегистрация,
		|	Проживающие.ДатаПрибытия КАК ДатаПрибытия,
		|	Проживающие.ДатаВыбытия КАК ДатаВыбытия,
		|	ЕСТЬNULL(Зарегистрированные.Зарегистрирован, ЛОЖЬ) КАК Зарегистрирован,
		|	ЕСТЬNULL(Проживающие.Проживает, ЛОЖЬ) КАК Проживает
		|ПОМЕСТИТЬ втИтоговыеДанныеБезСобственников
		|ИЗ
		|	втПроживающих КАК Проживающие
		|		ПОЛНОЕ СОЕДИНЕНИЕ втЗарегистрированных КАК Зарегистрированные
		|		ПО Проживающие.Проживающий = Зарегистрированные.Проживающий
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ втПроживающих
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ втЗарегистрированных
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	втИтоговыеДанныеБезСобственников.Проживающий КАК Проживающий,
		|	втИтоговыеДанныеБезСобственников.ЛицевойСчет КАК ЛицевойСчет,
		|	втИтоговыеДанныеБезСобственников.Здание КАК Здание,
		|	втИтоговыеДанныеБезСобственников.Помещение КАК Помещение,
		|	втИтоговыеДанныеБезСобственников.ДатаРегистрации КАК ДатаРегистрации,
		|	втИтоговыеДанныеБезСобственников.ДатаСнятияСРегистрации КАК ДатаСнятияСРегистрации,
		|	втИтоговыеДанныеБезСобственников.ВременнаяРегистрация КАК ВременнаяРегистрация,
		|	втИтоговыеДанныеБезСобственников.ДатаПрибытия КАК ДатаПрибытия,
		|	втИтоговыеДанныеБезСобственников.ДатаВыбытия КАК ДатаВыбытия,
		|	ВЫБОР
		|		КОГДА втДолиСобственности.Собственник ЕСТЬ NULL
		|			ТОГДА ЛОЖЬ
		|		ИНАЧЕ ИСТИНА
		|	КОНЕЦ КАК ЯвляетсяСобственником,
		|	ВЫБОР
		|		КОГДА втДолиСобственности.Собственник ЕСТЬ NULL
		|			ТОГДА 0
		|		ИНАЧЕ втДолиСобственности.ДоляСобственности
		|	КОНЕЦ КАК ДоляСобственности,
		|	втИтоговыеДанныеБезСобственников.Зарегистрирован КАК Зарегистрирован,
		|	втИтоговыеДанныеБезСобственников.Проживает КАК Проживает
		|ПОМЕСТИТЬ втИтоговыеДанные
		|ИЗ
		|	втИтоговыеДанныеБезСобственников КАК втИтоговыеДанныеБезСобственников
		|		ЛЕВОЕ СОЕДИНЕНИЕ втДолиСобственности КАК втДолиСобственности
		|		ПО втИтоговыеДанныеБезСобственников.Помещение = втДолиСобственности.Помещение
		|			И втИтоговыеДанныеБезСобственников.ФизЛицо = втДолиСобственности.Собственник
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ втДолиСобственности
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	втИтоговыеДанные.Проживающий КАК Проживающий,
		|	втИтоговыеДанные.ЛицевойСчет КАК ЛицевойСчет,
		|	втИтоговыеДанные.Здание КАК Здание,
		|	втИтоговыеДанные.Помещение КАК Помещение,
		|	ЕСТЬNULL(врОбслуживающиеОрганизации.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
		|	втИтоговыеДанные.ДатаРегистрации КАК ДатаРегистрации,
		|	втИтоговыеДанные.ДатаСнятияСРегистрации КАК ДатаСнятияСРегистрации,
		|	втИтоговыеДанные.ВременнаяРегистрация КАК ВременнаяРегистрация,
		|	втИтоговыеДанные.ДатаПрибытия КАК ДатаПрибытия,
		|	втИтоговыеДанные.ДатаВыбытия КАК ДатаВыбытия,
		|	втИтоговыеДанные.ЯвляетсяСобственником КАК ЯвляетсяСобственником,
		|	втИтоговыеДанные.ДоляСобственности КАК ДоляСобственности,
		|	втИтоговыеДанные.Зарегистрирован КАК Зарегистрирован,
		|	втИтоговыеДанные.Проживает КАК Проживает
		|ИЗ
		|	втИтоговыеДанные КАК втИтоговыеДанные
		|		ЛЕВОЕ СОЕДИНЕНИЕ врОбслуживающиеОрганизации КАК врОбслуживающиеОрганизации
		|		ПО втИтоговыеДанные.Здание = врОбслуживающиеОрганизации.Здание";
		
	ИначеЕсли Вариант = 2 Тогда
		
		ТекстЗапроса = ТекстЗапроса +
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.Жилец, КВП_СведенияОПроживающихНаДатуБезОтбора.Жилец) КАК Проживающий,
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.Жилец.ФизЛицо, КВП_СведенияОПроживающихНаДатуБезОтбора.Жилец.ФизЛицо) КАК ФизЛицо,
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.ЛицевойСчет, КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет) КАК ЛицевойСчет,
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.ЛицевойСчет.Адрес.Владелец, КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет.Адрес.Владелец) КАК Здание,
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.ЛицевойСчет.Адрес, КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет.Адрес) КАК Квартира,
		|	КВП_СведенияОПроживающихНаДату.ДатаИзменения КАК ДатаПрибытия,
		|	ВЫБОР
		|		КОГДА КВП_СведенияОПроживающихНаДату.ДатаИзменения < КВП_СведенияОПроживающихНаДатуБезОтбора.ДатаИзменения
		|			ТОГДА КВП_СведенияОПроживающихНаДатуБезОтбора.ДатаИзменения
		|	КОНЕЦ КАК ДатаВыбытия,
		|	ИСТИНА КАК Проживает
		|ПОМЕСТИТЬ втПроживающих
		|ИЗ
		|	РегистрСведений.УПЖКХ_СведенияОПроживающих.СрезПоследних(
		|			&Период,
		|			Проживает
		|				И ДатаИзменения <= &КонецПериода) КАК КВП_СведенияОПроживающихНаДату
		|		ПОЛНОЕ СОЕДИНЕНИЕ РегистрСведений.УПЖКХ_СведенияОПроживающих.СрезПоследних(&Период, НЕ Проживает) КАК КВП_СведенияОПроживающихНаДатуБезОтбора
		|		ПО (КВП_СведенияОПроживающихНаДатуБезОтбора.Жилец = КВП_СведенияОПроживающихНаДату.Жилец)
		|ГДЕ
		|	(КВП_СведенияОПроживающихНаДату.ДатаИзменения >= &НачалоПериода
		|			ИЛИ КВП_СведенияОПроживающихНаДатуБезОтбора.ДатаИзменения >= &НачалоПериода
		|				И КВП_СведенияОПроживающихНаДатуБезОтбора.ДатаИзменения <= &КонецПериода)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	УПЖКХ_СобственностьНаПомещенияСрезПоследних.Помещение КАК Помещение,
		|	УПЖКХ_СобственностьНаПомещенияСрезПоследних.ВидСобственности КАК ВидСобственности,
		|	УПЖКХ_СобственностьНаПомещенияСрезПоследних.ПодвидЧастнойСобственности КАК ПодвидЧастнойСобственности
		|ПОМЕСТИТЬ втСобственностьНаПомещения
		|ИЗ
		|	РегистрСведений.УПЖКХ_СобственностьНаПомещения.СрезПоследних(&КонецПериода, ) КАК УПЖКХ_СобственностьНаПомещенияСрезПоследних
		|ГДЕ
		|	УПЖКХ_СобственностьНаПомещенияСрезПоследних.Действует
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.Помещение КАК Помещение,
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.Собственник КАК Собственник,
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.ДоляСобственникаЧислитель КАК ДоляСобственникаЧислитель,
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.ДоляСобственникаЗнаменатель КАК ДоляСобственникаЗнаменатель
		|ПОМЕСТИТЬ врТаблицаСобственников
		|ИЗ
		|	РегистрСведений.УПЖКХ_СобственникиПомещений.СрезПоследних(&КонецПериода, ) КАК УПЖКХ_СобственникиПомещенийСрезПоследних
		|ГДЕ
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.Действует
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	врТаблицаСобственников.Помещение КАК Помещение,
		|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ врТаблицаСобственников.Собственник) КАК КолвоСобственников
		|ПОМЕСТИТЬ втКолвоСобственников
		|ИЗ
		|	врТаблицаСобственников КАК врТаблицаСобственников
		|
		|СГРУППИРОВАТЬ ПО
		|	врТаблицаСобственников.Помещение
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	втСобственностьНаПомещения.Помещение КАК Помещение,
		|	врТаблицаСобственников.Собственник КАК Собственник,
		|	ВЫБОР
		|		КОГДА втСобственностьНаПомещения.ВидСобственности = ЗНАЧЕНИЕ(Перечисление.УПЖКХ_ВидыСобственности.Частная)
		|			ТОГДА ВЫБОР
		|					КОГДА втСобственностьНаПомещения.ПодвидЧастнойСобственности = ЗНАЧЕНИЕ(Перечисление.УПЖКХ_ВидыЧастнойСобственности.Индивидуальная)
		|						ТОГДА 1
		|					КОГДА втСобственностьНаПомещения.ПодвидЧастнойСобственности = ЗНАЧЕНИЕ(Перечисление.УПЖКХ_ВидыЧастнойСобственности.Совместная)
		|						ТОГДА ВЫБОР
		|								КОГДА ЕСТЬNULL(втКолвоСобственников.КолвоСобственников, 0) = 0
		|									ТОГДА 0
		|								ИНАЧЕ 1 / втКолвоСобственников.КолвоСобственников
		|							КОНЕЦ
		|					ИНАЧЕ ВЫБОР
		|							КОГДА врТаблицаСобственников.ДоляСобственникаЗнаменатель = 0
		|								ТОГДА 0
		|							ИНАЧЕ врТаблицаСобственников.ДоляСобственникаЧислитель / врТаблицаСобственников.ДоляСобственникаЗнаменатель
		|						КОНЕЦ
		|				КОНЕЦ
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ДоляСобственности
		|ПОМЕСТИТЬ втДолиСобственности
		|ИЗ
		|	втСобственностьНаПомещения КАК втСобственностьНаПомещения
		|		ЛЕВОЕ СОЕДИНЕНИЕ врТаблицаСобственников КАК врТаблицаСобственников
		|		ПО втСобственностьНаПомещения.Помещение = врТаблицаСобственников.Помещение
		|		ЛЕВОЕ СОЕДИНЕНИЕ втКолвоСобственников КАК втКолвоСобственников
		|		ПО втСобственностьНаПомещения.Помещение = втКолвоСобственников.Помещение
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.Жилец, КВП_СведенияОПроживающихНаДатуБезОтбора.Жилец) КАК Проживающий,
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.Жилец.ФизЛицо, КВП_СведенияОПроживающихНаДатуБезОтбора.Жилец.ФизЛицо) КАК ФизЛицо,
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.ЛицевойСчет, КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет) КАК ЛицевойСчет,
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.ЛицевойСчет.Адрес.Владелец, КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет.Адрес.Владелец) КАК Здание,
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.ЛицевойСчет.Адрес, КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет.Адрес) КАК Квартира,
		|	КВП_СведенияОПроживающихНаДату.ДатаИзменения КАК ДатаРегистрации,
		|	ВЫБОР
		|		КОГДА КВП_СведенияОПроживающихНаДату.ДатаИзменения < КВП_СведенияОПроживающихНаДатуБезОтбора.ДатаИзменения
		|			ТОГДА КВП_СведенияОПроживающихНаДатуБезОтбора.ДатаИзменения
		|	КОНЕЦ КАК ДатаСнятияСРегистрации,
		|	КВП_СведенияОПроживающихНаДату.ВременнаяРегистрация КАК ВременнаяРегистрация,
		|	ИСТИНА КАК Зарегистрирован
		|ПОМЕСТИТЬ втЗарегистрированных
		|ИЗ
		|	РегистрСведений.УПЖКХ_СведенияОЗарегистрированных.СрезПоследних(
		|			&Период,
		|			Зарегистрирован
		|				И ДатаИзменения <= &КонецПериода) КАК КВП_СведенияОПроживающихНаДату
		|		ПОЛНОЕ СОЕДИНЕНИЕ РегистрСведений.УПЖКХ_СведенияОЗарегистрированных.СрезПоследних(&Период, НЕ Зарегистрирован) КАК КВП_СведенияОПроживающихНаДатуБезОтбора
		|		ПО (КВП_СведенияОПроживающихНаДатуБезОтбора.Жилец = КВП_СведенияОПроживающихНаДату.Жилец)
		|ГДЕ
		|	(КВП_СведенияОПроживающихНаДату.ДатаИзменения >= &НачалоПериода
		|			ИЛИ КВП_СведенияОПроживающихНаДатуБезОтбора.ДатаИзменения >= &НачалоПериода
		|				И КВП_СведенияОПроживающихНаДатуБезОтбора.ДатаИзменения <= &КонецПериода)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ЕСТЬNULL(Проживающие.Проживающий, Зарегистрированные.Проживающий) КАК Проживающий,
		|	ЕСТЬNULL(Проживающие.ФизЛицо, Зарегистрированные.ФизЛицо) КАК ФизЛицо,
		|	ЕСТЬNULL(Проживающие.ЛицевойСчет, Зарегистрированные.ЛицевойСчет) КАК ЛицевойСчет,
		|	ЕСТЬNULL(Проживающие.Здание, Зарегистрированные.Здание) КАК Здание,
		|	ЕСТЬNULL(Проживающие.Квартира, Зарегистрированные.Квартира) КАК Помещение,
		|	Зарегистрированные.ДатаРегистрации КАК ДатаРегистрации,
		|	Зарегистрированные.ДатаСнятияСРегистрации КАК ДатаСнятияСРегистрации,
		|	Зарегистрированные.ВременнаяРегистрация КАК ВременнаяРегистрация,
		|	Проживающие.ДатаПрибытия КАК ДатаПрибытия,
		|	Проживающие.ДатаВыбытия КАК ДатаВыбытия,
		|	ЕСТЬNULL(Зарегистрированные.Зарегистрирован, ЛОЖЬ) КАК Зарегистрирован,
		|	ЕСТЬNULL(Проживающие.Проживает, ЛОЖЬ) КАК Проживает
		|ПОМЕСТИТЬ втИтоговыеДанныеБезСобственников
		|ИЗ
		|	втПроживающих КАК Проживающие
		|		ПОЛНОЕ СОЕДИНЕНИЕ втЗарегистрированных КАК Зарегистрированные
		|		ПО Проживающие.Проживающий = Зарегистрированные.Проживающий
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	втИтоговыеДанныеБезСобственников.Проживающий КАК Проживающий,
		|	ЕСТЬNULL(врОбслуживающиеОрганизации.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
		|	ВЫБОР
		|		КОГДА Собственники.Собственник ЕСТЬ NULL
		|			ТОГДА ЛОЖЬ
		|		ИНАЧЕ ИСТИНА
		|	КОНЕЦ КАК ЯвляетсяСобственником,
		|	ВЫБОР
		|		КОГДА Собственники.Собственник ЕСТЬ NULL
		|			ТОГДА 0
		|		ИНАЧЕ Собственники.ДоляСобственности
		|	КОНЕЦ КАК ДоляСобственности,
		|	втИтоговыеДанныеБезСобственников.Зарегистрирован КАК Зарегистрирован,
		|	втИтоговыеДанныеБезСобственников.Проживает КАК Проживает,
		|	втИтоговыеДанныеБезСобственников.ЛицевойСчет КАК ЛицевойСчет,
		|	втИтоговыеДанныеБезСобственников.Здание КАК Здание,
		|	втИтоговыеДанныеБезСобственников.Помещение КАК Помещение,
		|	втИтоговыеДанныеБезСобственников.ДатаРегистрации КАК ДатаРегистрации,
		|	втИтоговыеДанныеБезСобственников.ДатаСнятияСРегистрации КАК ДатаСнятияСРегистрации,
		|	втИтоговыеДанныеБезСобственников.ВременнаяРегистрация КАК ВременнаяРегистрация,
		|	втИтоговыеДанныеБезСобственников.ДатаПрибытия КАК ДатаПрибытия,
		|	втИтоговыеДанныеБезСобственников.ДатаВыбытия КАК ДатаВыбытия
		|ИЗ
		|	втИтоговыеДанныеБезСобственников КАК втИтоговыеДанныеБезСобственников
		|		ЛЕВОЕ СОЕДИНЕНИЕ втДолиСобственности КАК Собственники
		|		ПО втИтоговыеДанныеБезСобственников.Помещение = Собственники.Помещение
		|			И втИтоговыеДанныеБезСобственников.ФизЛицо = Собственники.Собственник
		|		ЛЕВОЕ СОЕДИНЕНИЕ врОбслуживающиеОрганизации КАК врОбслуживающиеОрганизации
		|		ПО втИтоговыеДанныеБезСобственников.Здание = врОбслуживающиеОрганизации.Здание";
		
	ИначеЕсли Вариант = 3 Тогда
		
		ТекстЗапроса = ТекстЗапроса +
		"ВЫБРАТЬ
		|	КВП_ЛицевыеСчетаСрезПоследних.ЛицевойСчет КАК ЛицевойСчет
		|ПОМЕСТИТЬ втДействующиеЛС
		|ИЗ
		|	РегистрСведений.КВП_ЛицевыеСчета.СрезПоследних(&Период, ) КАК КВП_ЛицевыеСчетаСрезПоследних
		|ГДЕ
		|	КВП_ЛицевыеСчетаСрезПоследних.Действует
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	УПЖКХ_Жильцы.Ссылка КАК Жилец,
		|	УПЖКХ_Жильцы.ФизЛицо КАК ФизЛицо,
		|	УПЖКХ_Жильцы.Владелец КАК ЛицевойСчет,
		|	УПЖКХ_Жильцы.Владелец.Адрес КАК Помещение,
		|	УПЖКХ_Жильцы.Владелец.Адрес.Владелец КАК Здание,
		|	ЕСТЬNULL(Зарегистрированные.Зарегистрирован, ЛОЖЬ) КАК Зарегистрирован,
		|	Зарегистрированные.ДатаИзменения КАК ДатаРегистрации,
		|	ЕСТЬNULL(Проживающие.Проживает, ЛОЖЬ) КАК Проживает,
		|	Проживающие.ДатаИзменения КАК ДатаЗаселения
		|ПОМЕСТИТЬ врТаблЖильцов
		|ИЗ
		|	Справочник.УПЖКХ_Жильцы КАК УПЖКХ_Жильцы
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УПЖКХ_СведенияОЗарегистрированных.СрезПоследних(&Период, ДатаИзменения <= &Период) КАК Зарегистрированные
		|		ПО (Зарегистрированные.Жилец = УПЖКХ_Жильцы.Ссылка)
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УПЖКХ_СведенияОПроживающих.СрезПоследних(&Период, ДатаИзменения <= &Период) КАК Проживающие
		|		ПО (Проживающие.Жилец = УПЖКХ_Жильцы.Ссылка)
		|ГДЕ
		|	НЕ УПЖКХ_Жильцы.ПометкаУдаления
		|	И УПЖКХ_Жильцы.Владелец В
		|			(ВЫБРАТЬ
		|				втДействующиеЛС.ЛицевойСчет
		|			ИЗ
		|				втДействующиеЛС)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ОтветственныеСобственники.ЛицевойСчет КАК ЛицевойСчет,
		|	ОтветственныеСобственники.ОтветственныйВладелец КАК ОтветственныйВладелец
		|ПОМЕСТИТЬ врТаблицаОтвСобственников
		|ИЗ
		|	РегистрСведений.УПЖКХ_ОтветственныйСобственникНанимательЛицевогоСчета.СрезПоследних(&Период, ) КАК ОтветственныеСобственники
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	УПЖКХ_СобственностьНаПомещенияСрезПоследних.Помещение КАК Помещение,
		|	УПЖКХ_СобственностьНаПомещенияСрезПоследних.ВидСобственности КАК ВидСобственности,
		|	УПЖКХ_СобственностьНаПомещенияСрезПоследних.ПодвидЧастнойСобственности КАК ПодвидЧастнойСобственности
		|ПОМЕСТИТЬ втСобственностьНаПомещения
		|ИЗ
		|	РегистрСведений.УПЖКХ_СобственностьНаПомещения.СрезПоследних(&Период, ) КАК УПЖКХ_СобственностьНаПомещенияСрезПоследних
		|ГДЕ
		|	УПЖКХ_СобственностьНаПомещенияСрезПоследних.Действует
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.Помещение КАК Помещение,
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.Собственник КАК Собственник,
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.ДоляСобственникаЧислитель КАК ДоляСобственникаЧислитель,
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.ДоляСобственникаЗнаменатель,
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.НомерДокумента КАК РегистрацияПраваСобственностиНомерДокумента,
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.ДатаДокумента КАК РегистрацияПраваСобственностиДата
		|ПОМЕСТИТЬ врТаблицаСобственников
		|ИЗ
		|	РегистрСведений.УПЖКХ_СобственникиПомещений.СрезПоследних(&Период, ) КАК УПЖКХ_СобственникиПомещенийСрезПоследних
		|ГДЕ
		|	УПЖКХ_СобственникиПомещенийСрезПоследних.Действует
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	врТаблицаСобственников.Помещение КАК Помещение,
		|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ врТаблицаСобственников.Собственник) КАК КолвоСобственников
		|ПОМЕСТИТЬ втКолвоСобственников
		|ИЗ
		|	врТаблицаСобственников КАК врТаблицаСобственников
		|
		|СГРУППИРОВАТЬ ПО
		|	врТаблицаСобственников.Помещение
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	втСобственностьНаПомещения.Помещение КАК Помещение,
		|	врТаблицаСобственников.Собственник КАК Собственник,
		|	ВЫБОР
		|		КОГДА втСобственностьНаПомещения.ВидСобственности = ЗНАЧЕНИЕ(Перечисление.УПЖКХ_ВидыСобственности.Частная)
		|			ТОГДА ВЫБОР
		|					КОГДА втСобственностьНаПомещения.ПодвидЧастнойСобственности = ЗНАЧЕНИЕ(Перечисление.УПЖКХ_ВидыЧастнойСобственности.Индивидуальная)
		|						ТОГДА 1
		|					КОГДА втСобственностьНаПомещения.ПодвидЧастнойСобственности = ЗНАЧЕНИЕ(Перечисление.УПЖКХ_ВидыЧастнойСобственности.Совместная)
		|						ТОГДА ВЫБОР
		|								КОГДА ЕСТЬNULL(втКолвоСобственников.КолвоСобственников, 0) = 0
		|									ТОГДА 0
		|								ИНАЧЕ 1 / втКолвоСобственников.КолвоСобственников
		|							КОНЕЦ
		|					ИНАЧЕ ВЫБОР
		|							КОГДА врТаблицаСобственников.ДоляСобственникаЗнаменатель = 0
		|								ТОГДА 0
		|							ИНАЧЕ врТаблицаСобственников.ДоляСобственникаЧислитель / врТаблицаСобственников.ДоляСобственникаЗнаменатель
		|						КОНЕЦ
		|				КОНЕЦ
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ДоляСобственности,
		|	врТаблицаСобственников.РегистрацияПраваСобственностиНомерДокумента,
		|	врТаблицаСобственников.РегистрацияПраваСобственностиДата
		|ПОМЕСТИТЬ втДолиСобственности
		|ИЗ
		|	втСобственностьНаПомещения КАК втСобственностьНаПомещения
		|		ЛЕВОЕ СОЕДИНЕНИЕ врТаблицаСобственников КАК врТаблицаСобственников
		|		ПО втСобственностьНаПомещения.Помещение = врТаблицаСобственников.Помещение
		|		ЛЕВОЕ СОЕДИНЕНИЕ втКолвоСобственников КАК втКолвоСобственников
		|		ПО втСобственностьНаПомещения.Помещение = втКолвоСобственников.Помещение
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	УПЖКХ_Жильцы.Здание КАК Здание,
		|	УПЖКХ_Жильцы.ЛицевойСчет КАК ЛицевойСчет,
		|	УПЖКХ_Жильцы.Помещение КАК Помещение,
		|	ЕСТЬNULL(врОбслуживающиеОрганизации.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
		|	УПЖКХ_Жильцы.Жилец КАК Проживающий,
		|	УПЖКХ_Жильцы.Жилец.ФизЛицо КАК ФизЛицо,
		|	УПЖКХ_Жильцы.Жилец.ФизЛицо.Пол КАК Пол,
		|	УПЖКХ_Жильцы.Жилец.ФизЛицо.ДатаРождения КАК ДатаРождения,
		|	УПЖКХ_Жильцы.Жилец.ФизЛицо.СтраховойНомерПФР КАК СтраховойНомерПФР,
		|	УПЖКХ_Жильцы.Жилец.ПенсионноеУдостоверениеДата КАК ПенсионноеУдостоверениеДата,
		|	УПЖКХ_Жильцы.Жилец.ПенсионноеУдостоверениеНомер КАК ПенсионноеУдостоверениеНомер,
		|	УПЖКХ_Жильцы.Жилец.ПенсионноеУдостоверениеСерия КАК ПенсионноеУдостоверениеСерия,
		|	УПЖКХ_Жильцы.Жилец.ПенсионноеУдостоверениеКемВыдано КАК ПенсионноеУдостоверениеКемВыдано,
		|	ВЫБОР
		|		КОГДА ОтветственныеСобственники.ОтветственныйВладелец ЕСТЬ NULL
		|			ТОГДА ТаблицаРодства.СтепеньРодства
		|		ИНАЧЕ ВЫБОР
		|				КОГДА НЕ &УпрощенныйВариантУчетаСобственников
		|					ТОГДА ВЫБОР
		|							КОГДА УПЖКХ_СобственностьНаПомещенияСрезПоследних.ВидСобственности = ЗНАЧЕНИЕ(Перечисление.УПЖКХ_ВидыСобственности.Частная)
		|								ТОГДА ВЫРАЗИТЬ(&ЧастныйСобственник КАК СТРОКА(100))
		|							ИНАЧЕ ВЫРАЗИТЬ(&МуниципальныйСобственник КАК СТРОКА(100))
		|						КОНЕЦ
		|				ИНАЧЕ ВЫРАЗИТЬ(&ПрочийСобственник КАК СТРОКА(100))
		|			КОНЕЦ
		|	КОНЕЦ КАК СтепеньРодства,
		|	ВЫБОР
		|		КОГДА Собственники.Собственник ЕСТЬ NULL
		|			ТОГДА ЛОЖЬ
		|		ИНАЧЕ ИСТИНА
		|	КОНЕЦ КАК ЯвляетсяСобственником,
		|	ВЫБОР
		|		КОГДА Собственники.Собственник ЕСТЬ NULL
		|			ТОГДА 0
		|		ИНАЧЕ Собственники.ДоляСобственности
		|	КОНЕЦ КАК ДоляСобственности,
		|	ОтветственныеСобственники.ОтветственныйВладелец КАК ОтветственныйВладелец,
		|	ТаблицаРодства.ФизическоеЛицоСвязанное КАК ФизическоеЛицоСвязанное,
		|	УПЖКХ_Жильцы.Зарегистрирован КАК Зарегистрирован,
		|	ВЫБОР
		|		КОГДА УПЖКХ_Жильцы.Зарегистрирован
		|			ТОГДА УПЖКХ_Жильцы.ДатаРегистрации
		|		ИНАЧЕ ДОБАВИТЬКДАТЕ(УПЖКХ_Жильцы.ДатаРегистрации, ДЕНЬ, -1)
		|	КОНЕЦ КАК ДатаРегистрации,
		|	УПЖКХ_Жильцы.Проживает КАК Проживает,
		|	ВЫБОР
		|		КОГДА УПЖКХ_Жильцы.Зарегистрирован
		|			ТОГДА УПЖКХ_Жильцы.ДатаЗаселения
		|		ИНАЧЕ ДОБАВИТЬКДАТЕ(УПЖКХ_Жильцы.ДатаЗаселения, ДЕНЬ, -1)
		|	КОНЕЦ КАК ДатаЗаселения,
		|	ЕСТЬNULL(Собственники.РегистрацияПраваСобственностиНомерДокумента, """") КАК РегистрацияПраваСобственностиНомерДокумента,
		|	Собственники.РегистрацияПраваСобственностиДата КАК РегистрацияПраваСобственностиДата
		|ИЗ
		|	врТаблЖильцов КАК УПЖКХ_Жильцы
		|		ЛЕВОЕ СОЕДИНЕНИЕ врТаблицаОтвСобственников КАК ОтветственныеСобственники
		|		ПО УПЖКХ_Жильцы.ЛицевойСчет = ОтветственныеСобственники.ЛицевойСчет
		|			И УПЖКХ_Жильцы.Жилец = ОтветственныеСобственники.ОтветственныйВладелец
		|		ЛЕВОЕ СОЕДИНЕНИЕ втДолиСобственности КАК Собственники
		|		ПО УПЖКХ_Жильцы.ЛицевойСчет.Адрес = Собственники.Помещение
		|			И УПЖКХ_Жильцы.Жилец.ФизЛицо = Собственники.Собственник
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УПЖКХ_СобственностьНаПомещения.СрезПоследних(&Период, ) КАК УПЖКХ_СобственностьНаПомещенияСрезПоследних
		|		ПО (УПЖКХ_СобственностьНаПомещенияСрезПоследних.Помещение = УПЖКХ_Жильцы.ЛицевойСчет.Адрес)
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|			ОтветственныеСобственники.ЛицевойСчет КАК ЛицевойСчет,
		|			УПЖКХ_СтепеньРодстваФизЛицСрезПоследних.ФизическоеЛицоСвязанное КАК ФизическоеЛицоСвязанное,
		|			УПЖКХ_СтепеньРодстваФизЛицСрезПоследних.СтепеньРодства КАК СтепеньРодства
		|		ИЗ
		|			врТаблицаОтвСобственников КАК ОтветственныеСобственники
		|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.УПЖКХ_СтепеньРодстваФизЛиц.СрезПоследних(&Период, ) КАК УПЖКХ_СтепеньРодстваФизЛицСрезПоследних
		|				ПО (УПЖКХ_СтепеньРодстваФизЛицСрезПоследних.ФизическоеЛицоОсновное = ОтветственныеСобственники.ОтветственныйВладелец.ФизЛицо)) КАК ТаблицаРодства
		|		ПО УПЖКХ_Жильцы.ЛицевойСчет = ТаблицаРодства.ЛицевойСчет
		|			И УПЖКХ_Жильцы.Жилец.ФизЛицо = ТаблицаРодства.ФизическоеЛицоСвязанное
		|		ЛЕВОЕ СОЕДИНЕНИЕ врОбслуживающиеОрганизации КАК врОбслуживающиеОрганизации
		|		ПО УПЖКХ_Жильцы.Здание = врОбслуживающиеОрганизации.Здание";
		
	ИначеЕсли Вариант = 4 Тогда
		
		ТекстЗапроса = ТекстЗапроса +
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.Жилец, КВП_СведенияОПроживающихНаДатуБезОтбора.Жилец) КАК Проживающий,
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.Жилец.ФизЛицо, КВП_СведенияОПроживающихНаДатуБезОтбора.Жилец.ФизЛицо) КАК ФизЛицо,
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.ЛицевойСчет, КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет) КАК ЛицевойСчет,
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.ЛицевойСчет.Адрес.Владелец, КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет.Адрес.Владелец) КАК Здание,
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.ЛицевойСчет.Адрес, КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет.Адрес) КАК Квартира,
		|	ИСТИНА КАК Проживает,
		|	КВП_СведенияОПроживающихНаДату.ДатаИзменения КАК ДатаЗаселения
		|ПОМЕСТИТЬ втПроживающих
		|ИЗ
		|	РегистрСведений.УПЖКХ_СведенияОПроживающих.СрезПоследних(
		|			&Период,
		|			Проживает
		|				И ДатаИзменения <= &Период) КАК КВП_СведенияОПроживающихНаДату
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УПЖКХ_СведенияОПроживающих.СрезПоследних(&Период, НЕ Проживает) КАК КВП_СведенияОПроживающихНаДатуБезОтбора
		|		ПО (КВП_СведенияОПроживающихНаДатуБезОтбора.Жилец = КВП_СведенияОПроживающихНаДату.Жилец)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.Жилец, КВП_СведенияОПроживающихНаДатуБезОтбора.Жилец) КАК Проживающий,
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.Жилец.ФизЛицо, КВП_СведенияОПроживающихНаДатуБезОтбора.Жилец.ФизЛицо) КАК ФизЛицо,
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.ЛицевойСчет, КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет) КАК ЛицевойСчет,
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.ЛицевойСчет.Адрес.Владелец, КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет.Адрес.Владелец) КАК Здание,
		|	ЕСТЬNULL(КВП_СведенияОПроживающихНаДату.ЛицевойСчет.Адрес, КВП_СведенияОПроживающихНаДатуБезОтбора.ЛицевойСчет.Адрес) КАК Квартира,
		|	ИСТИНА КАК Зарегистрирован,
		|	КВП_СведенияОПроживающихНаДату.ДатаИзменения КАК ДатаРегистрации
		|ПОМЕСТИТЬ втЗарегистрированных
		|ИЗ
		|	РегистрСведений.УПЖКХ_СведенияОЗарегистрированных.СрезПоследних(
		|			&Период,
		|			Зарегистрирован
		|				И ДатаИзменения <= &Период) КАК КВП_СведенияОПроживающихНаДату
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УПЖКХ_СведенияОЗарегистрированных.СрезПоследних(&Период, НЕ Зарегистрирован) КАК КВП_СведенияОПроживающихНаДатуБезОтбора
		|		ПО (КВП_СведенияОПроживающихНаДатуБезОтбора.Жилец = КВП_СведенияОПроживающихНаДату.Жилец)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ЕСТЬNULL(Проживающие.Проживающий, Зарегистрированные.Проживающий) КАК Проживающий,
		|	ЕСТЬNULL(Проживающие.ФизЛицо, Зарегистрированные.ФизЛицо) КАК ФизЛицо,
		|	ЕСТЬNULL(Проживающие.ЛицевойСчет, Зарегистрированные.ЛицевойСчет) КАК ЛицевойСчет,
		|	ЕСТЬNULL(Проживающие.Здание, Зарегистрированные.Здание) КАК Здание,
		|	ЕСТЬNULL(Проживающие.Квартира, Зарегистрированные.Квартира) КАК Помещение,
		|	ЕСТЬNULL(Зарегистрированные.Зарегистрирован, ЛОЖЬ) КАК Зарегистрирован,
		|	ЕСТЬNULL(Проживающие.Проживает, ЛОЖЬ) КАК Проживает,
		|	Зарегистрированные.ДатаРегистрации КАК ДатаРегистрации,
		|	Проживающие.ДатаЗаселения КАК ДатаЗаселения
		|ПОМЕСТИТЬ втИтоговыеДанныеБезСобственников
		|ИЗ
		|	втПроживающих КАК Проживающие
		|		ПОЛНОЕ СОЕДИНЕНИЕ втЗарегистрированных КАК Зарегистрированные
		|		ПО Проживающие.Проживающий = Зарегистрированные.Проживающий
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	УПЖКХ_СобственностьНаПомещенияСрезПоследних.Помещение КАК Помещение,
		|	УПЖКХ_СобственностьНаПомещенияСрезПоследних.ВидСобственности КАК ВидСобственности
		|ПОМЕСТИТЬ втСобственностьНаПомещения
		|ИЗ
		|	РегистрСведений.УПЖКХ_СобственностьНаПомещения.СрезПоследних(
		|			&Период,
		|			Помещение В
		|				(ВЫБРАТЬ
		|					втИтоговыеДанныеБезСобственников.Помещение КАК Помещение
		|				ИЗ
		|					втИтоговыеДанныеБезСобственников КАК втИтоговыеДанныеБезСобственников)) КАК УПЖКХ_СобственностьНаПомещенияСрезПоследних
		|ГДЕ
		|	УПЖКХ_СобственностьНаПомещенияСрезПоследних.Действует
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	втИтоговыеДанныеБезСобственников.Проживающий КАК Проживающий,
		|	втИтоговыеДанныеБезСобственников.ЛицевойСчет КАК ЛицевойСчет,
		|	втИтоговыеДанныеБезСобственников.Здание КАК Здание,
		|	втИтоговыеДанныеБезСобственников.Помещение КАК Помещение,
		|	ЕСТЬNULL(врОбслуживающиеОрганизации.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
		|	втИтоговыеДанныеБезСобственников.ФизЛицо КАК ФизЛицо,
		|	втИтоговыеДанныеБезСобственников.Зарегистрирован КАК Зарегистрирован,
		|	втИтоговыеДанныеБезСобственников.Проживает КАК Проживает,
		|	ЕСТЬNULL(втСобственностьНаПомещения.ВидСобственности, ЗНАЧЕНИЕ(Перечисление.УПЖКХ_ВидыСобственности.ПустаяСсылка)) КАК ВидСобственности,
		|	втИтоговыеДанныеБезСобственников.ДатаРегистрации КАК ДатаРегистрации,
		|	втИтоговыеДанныеБезСобственников.ДатаЗаселения КАК ДатаЗаселения
		|ПОМЕСТИТЬ втСведенияБезПаспДанных
		|ИЗ
		|	втИтоговыеДанныеБезСобственников КАК втИтоговыеДанныеБезСобственников
		|		ЛЕВОЕ СОЕДИНЕНИЕ врОбслуживающиеОрганизации КАК врОбслуживающиеОрганизации
		|		ПО втИтоговыеДанныеБезСобственников.Здание = врОбслуживающиеОрганизации.Здание
		|		ЛЕВОЕ СОЕДИНЕНИЕ втСобственностьНаПомещения КАК втСобственностьНаПомещения
		|		ПО втИтоговыеДанныеБезСобственников.Помещение = втСобственностьНаПомещения.Помещение
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДокументыФизическихЛицСрезПоследних.Физлицо КАК Физлицо,
		|	ДокументыФизическихЛицСрезПоследних.ВидДокумента КАК ВидДокумента,
		|	ДокументыФизическихЛицСрезПоследних.Серия КАК Серия,
		|	ДокументыФизическихЛицСрезПоследних.Номер КАК Номер,
		|	ДокументыФизическихЛицСрезПоследних.КемВыдан КАК КемВыдан,
		|	ДокументыФизическихЛицСрезПоследних.ДатаВыдачи КАК ДатаВыдачи,
		|	ДокументыФизическихЛицСрезПоследних.КодПодразделения КАК КодПодразделения
		|ПОМЕСТИТЬ втДокументыФЛ
		|ИЗ
		|	РегистрСведений.ДокументыФизическихЛиц.СрезПоследних(
		|			&Период,
		|			Физлицо В
		|				(ВЫБРАТЬ
		|					втСведенияБезПаспДанных.Проживающий.ФизЛицо КАК ПроживающийФизЛицо
		|				ИЗ
		|					втСведенияБезПаспДанных КАК втСведенияБезПаспДанных)) КАК ДокументыФизическихЛицСрезПоследних
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	втСведенияБезПаспДанных.Организация КАК Организация,
		|	втСведенияБезПаспДанных.Проживающий КАК Проживающий,
		|	втДокументыФЛ.ВидДокумента КАК ВидДокумента,
		|	втДокументыФЛ.Серия КАК Серия,
		|	втДокументыФЛ.Номер КАК Номер,
		|	втДокументыФЛ.КемВыдан КАК КемВыдан,
		|	втДокументыФЛ.ДатаВыдачи КАК ДатаВыдачи,
		|	втДокументыФЛ.КодПодразделения КАК КодПодразделения,
		|	втСведенияБезПаспДанных.Здание КАК Здание,
		|	втСведенияБезПаспДанных.Помещение КАК Помещение,
		|	втСведенияБезПаспДанных.ЛицевойСчет КАК ЛицевойСчет,
		|	втСведенияБезПаспДанных.Зарегистрирован КАК Зарегистрирован,
		|	втСведенияБезПаспДанных.Проживает КАК Проживает,
		|	втСведенияБезПаспДанных.ВидСобственности КАК ВидСобственности,
		|	втСведенияБезПаспДанных.ДатаРегистрации КАК ДатаРегистрации,
		|	втСведенияБезПаспДанных.ДатаЗаселения КАК ДатаЗаселения
		|ИЗ
		|	втДокументыФЛ КАК втДокументыФЛ
		|		ЛЕВОЕ СОЕДИНЕНИЕ втСведенияБезПаспДанных КАК втСведенияБезПаспДанных
		|		ПО втДокументыФЛ.Физлицо = втСведенияБезПаспДанных.ФизЛицо";
	
	КонецЕсли;
	
	Возврат ТекстЗапроса;
	
КонецФункции

// Процедура добавляет поля для возможности их отображения.
Процедура ДобавитьПоляВНаборКомпоновки(ПараметрыОтчета, Схема) Экспорт

	Набор = Схема.НаборыДанных.Найти("Проживающие");
	
	Если Набор = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
КонецПроцедуры // ДобавитьПоляВНаборКомпоновки()

#КонецОбласти

#КонецЕсли