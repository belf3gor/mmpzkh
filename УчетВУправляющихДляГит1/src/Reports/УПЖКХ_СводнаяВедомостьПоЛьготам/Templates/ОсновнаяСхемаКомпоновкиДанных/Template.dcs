<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetQuery">
		<name>Льготы</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВидНачисления</dataPath>
			<field>ВидНачисления</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Договор</dataPath>
			<field>Договор</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ИсточникОплаты</dataPath>
			<field>ИсточникОплаты</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЛицевойСчет</dataPath>
			<field>ЛицевойСчет</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЛьготнаяКатегория</dataPath>
			<field>ЛьготнаяКатегория</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>МесяцНачисления</dataPath>
			<field>МесяцНачисления</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Организация</dataPath>
			<field>Организация</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Проживающий</dataPath>
			<field>Проживающий</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Услуга</dataPath>
			<field>Услуга</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Льготник</dataPath>
			<field>Льготник</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Адрес</dataPath>
			<field>Адрес</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Здание</dataPath>
			<field>Здание</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНачислений</dataPath>
			<field>СуммаНачислений</field>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=2</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЖилаяПлощадь</dataPath>
			<field>ЖилаяПлощадь</field>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=2</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОбщаяПлощадь</dataPath>
			<field>ОбщаяПлощадь</field>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=2</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаЛьгот</dataPath>
			<field>СуммаЛьгот</field>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=2</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоЛьготников</dataPath>
			<field>КоличествоЛьготников</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Кол-во льготников</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СоставнаяУслуга</dataPath>
			<field>СоставнаяУслуга</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Тариф</dataPath>
			<field>Тариф</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>МесяцРассрочки</dataPath>
			<field>МесяцРассрочки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЛьготнаяКатегорияУсловие</dataPath>
			<field>ЛьготнаяКатегорияУсловие</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Льготная категория</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВидТарифа</dataPath>
			<field>ВидТарифа</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>РазделУчета</dataPath>
			<field>РазделУчета</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Количество</dataPath>
			<field>Количество</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>УслугаОснование</dataPath>
			<field>УслугаОснование</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>УровеньРаспределения</dataPath>
			<field>УровеньРаспределения</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОснованиеКорректировки</dataPath>
			<field>ОснованиеКорректировки</field>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Льготы.Организация,
	Льготы.ЛицевойСчет,
	Льготы.Услуга,
	Льготы.ЛьготнаяКатегория КАК ЛьготнаяКатегория,
	СУММА(Льготы.СуммаЛьготы) КАК СуммаЛьготы
ПОМЕСТИТЬ Льготы
{ВЫБРАТЬ
	ЛьготнаяКатегория.* КАК ЛьготнаяКатегорияУсловие}
ИЗ
	(ВЫБРАТЬ
		КВП_НачисленныеЛьготыОбороты.Организация КАК Организация,
		КВП_НачисленныеЛьготыОбороты.ЛицевойСчет КАК ЛицевойСчет,
		КВП_НачисленныеЛьготыОбороты.Услуга КАК Услуга,
		КВП_НачисленныеЛьготыОбороты.ЛьготнаяКатегория КАК ЛьготнаяКатегория,
		КВП_НачисленныеЛьготыОбороты.СуммаНачисленияОборот КАК СуммаЛьготы
	ИЗ
		РегистрНакопления.КВП_НачисленныеЛьготы.Обороты({(&amp;НачалоПериода)}, {(КОНЕЦПЕРИОДА(&amp;КонецПериода, ДЕНЬ))}, , ) КАК КВП_НачисленныеЛьготыОбороты) КАК Льготы
{ГДЕ
	Льготы.ЛьготнаяКатегория.* КАК ЛьготнаяКатегорияУсловие}

СГРУППИРОВАТЬ ПО
	Льготы.ЛьготнаяКатегория,
	Льготы.ЛицевойСчет,
	Льготы.Организация,
	Льготы.Услуга
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	УПЖКХ_НачисленияОбороты.Организация,
	УПЖКХ_НачисленияОбороты.ЛицевойСчет,
	УПЖКХ_НачисленияОбороты.Услуга,
	СУММА(УПЖКХ_НачисленияОбороты.СуммаНачисленияОборот) КАК СуммаНачислений
ПОМЕСТИТЬ Начисления
ИЗ
	РегистрНакопления.УПЖКХ_Начисления.Обороты(
			,
			,
			,
			(Организация, ЛицевойСчет, Услуга) В
					(ВЫБРАТЬ РАЗЛИЧНЫЕ
						Льготы.Организация,
						Льготы.ЛицевойСчет,
						Льготы.Услуга
					ИЗ
						Льготы)
				И НЕ РазделУчета В (ЗНАЧЕНИЕ(Перечисление.УПЖКХ_РазделыУчета.Пени), ЗНАЧЕНИЕ(Перечисление.УПЖКХ_РазделыУчета.Льготы))
				И НЕ ВидНачисления В (ЗНАЧЕНИЕ(Перечисление.УПЖКХ_ВидыНачислений.Оплата), ЗНАЧЕНИЕ(Перечисление.УПЖКХ_ВидыНачислений.ЗачетДолговИПереплат))) КАК УПЖКХ_НачисленияОбороты

СГРУППИРОВАТЬ ПО
	УПЖКХ_НачисленияОбороты.Организация,
	УПЖКХ_НачисленияОбороты.ЛицевойСчет,
	УПЖКХ_НачисленияОбороты.Услуга
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Льготы.Организация,
	Льготы.ЛицевойСчет,
	Льготы.Услуга,
	Льготы.ЛьготнаяКатегория,
	СУММА(ЕСТЬNULL(Льготы.СуммаЛьготы, 0)) КАК СуммаЛьготы,
	СУММА(ЕСТЬNULL(Начисления.СуммаНачислений, 0)) КАК СуммаНачислений
ПОМЕСТИТЬ ЛьготыНачисления
ИЗ
	Льготы КАК Льготы
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Начисления КАК Начисления
		ПО Льготы.Организация = Начисления.Организация
			И Льготы.ЛицевойСчет = Начисления.ЛицевойСчет
			И Льготы.Услуга = Начисления.Услуга

СГРУППИРОВАТЬ ПО
	Льготы.Организация,
	Льготы.ЛицевойСчет,
	Льготы.Услуга,
	Льготы.ЛьготнаяКатегория
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ Льготы
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ Начисления
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КВП_НазначенныеЛьготыСрезПоследних.Проживающий.Владелец КАК ЛицевойСчет,
	КВП_НазначенныеЛьготыСрезПоследних.Проживающий КАК Льготник,
	КВП_НазначенныеЛьготыСрезПоследних.ЛьготнаяКатегория КАК ЛьготнаяКатегория
ПОМЕСТИТЬ Льготники
{ВЫБРАТЬ
	ЛьготнаяКатегория.* КАК ЛьготнаяКатегорияУсловие}
ИЗ
	РегистрСведений.КВП_НазначенныеЛьготы.СрезПоследних(
			{(&amp;НачалоПериода)},
			Проживающий.Владелец В
					(ВЫБРАТЬ
						ЛьготыНачисления.ЛицевойСчет
					ИЗ
						ЛьготыНачисления)
				И ДатаИзменения &lt;= &amp;НачалоПериода) КАК КВП_НазначенныеЛьготыСрезПоследних
ГДЕ
	КВП_НазначенныеЛьготыСрезПоследних.Действие
{ГДЕ
	КВП_НазначенныеЛьготыСрезПоследних.ЛьготнаяКатегория.* КАК ЛьготнаяКатегорияУсловие}

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	КВП_НазначенныеЛьготы.Проживающий.Владелец,
	КВП_НазначенныеЛьготы.Проживающий,
	КВП_НазначенныеЛьготы.ЛьготнаяКатегория
ИЗ
	РегистрСведений.КВП_НазначенныеЛьготы КАК КВП_НазначенныеЛьготы
ГДЕ
	КВП_НазначенныеЛьготы.Проживающий.Владелец В
			(ВЫБРАТЬ
				ЛьготыНачисления.ЛицевойСчет
			ИЗ
				ЛьготыНачисления)
	И КВП_НазначенныеЛьготы.Действие
	И (&amp;НачалоПериода = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ КВП_НазначенныеЛьготы.ДатаИзменения &gt;= &amp;НачалоПериода)
	И (&amp;КонецПериода = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ КВП_НазначенныеЛьготы.ДатаИзменения &lt;= &amp;КонецПериода)
{ГДЕ
	КВП_НазначенныеЛьготы.ЛьготнаяКатегория.* КАК ЛьготнаяКатегорияУсловие}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЛьготыНачисления.Организация,
	ЛьготыНачисления.ЛицевойСчет,
	ЛьготыНачисления.Услуга,
	ЛьготыНачисления.ЛьготнаяКатегория,
	СУММА(ЛьготыНачисления.СуммаЛьготы) КАК СуммаЛьготы,
	СУММА(ЛьготыНачисления.СуммаНачислений) КАК СуммаНачислений,
	Льготники.Льготник
ПОМЕСТИТЬ ЛьготыНачисленияЛьготники
ИЗ
	ЛьготыНачисления КАК ЛьготыНачисления
		ЛЕВОЕ СОЕДИНЕНИЕ Льготники КАК Льготники
		ПО ЛьготыНачисления.ЛицевойСчет = Льготники.ЛицевойСчет
			И ЛьготыНачисления.ЛьготнаяКатегория = Льготники.ЛьготнаяКатегория

СГРУППИРОВАТЬ ПО
	ЛьготыНачисления.Организация,
	ЛьготыНачисления.ЛицевойСчет,
	ЛьготыНачисления.Услуга,
	ЛьготыНачисления.ЛьготнаяКатегория,
	Льготники.Льготник
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ЛьготыНачисления
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ Льготники
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЛьготыНачисленияЛьготники.ЛицевойСчет,
	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ЛьготыНачисленияЛьготники.Льготник) КАК КоличествоЛьготников
ПОМЕСТИТЬ ЛьготникиПоЛицевымСчетам
ИЗ
	ЛьготыНачисленияЛьготники КАК ЛьготыНачисленияЛьготники

СГРУППИРОВАТЬ ПО
	ЛьготыНачисленияЛьготники.ЛицевойСчет
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЛьготыНачисленияЛьготники.ЛицевойСчет,
	ЛьготыНачисленияЛьготники.ЛьготнаяКатегория,
	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ЛьготыНачисленияЛьготники.Льготник) КАК КоличествоЛьготников
ПОМЕСТИТЬ ЛьготникиПоКатегориям
ИЗ
	ЛьготыНачисленияЛьготники КАК ЛьготыНачисленияЛьготники

СГРУППИРОВАТЬ ПО
	ЛьготыНачисленияЛьготники.ЛьготнаяКатегория,
	ЛьготыНачисленияЛьготники.ЛицевойСчет
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЛьготыНачисленияЛьготники.ЛицевойСчет,
	ЛьготыНачисленияЛьготники.Услуга,
	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ЛьготыНачисленияЛьготники.ЛьготнаяКатегория) КАК КоличествоЛьготныхКатегорий
ПОМЕСТИТЬ ЛьготныеКатегорииПоУслугам
ИЗ
	ЛьготыНачисленияЛьготники КАК ЛьготыНачисленияЛьготники

СГРУППИРОВАТЬ ПО
	ЛьготыНачисленияЛьготники.ЛицевойСчет,
	ЛьготыНачисленияЛьготники.Услуга
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЛьготыНачисленияЛьготники.ЛицевойСчет,
	ЛьготыНачисленияЛьготники.ЛьготнаяКатегория,
	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ЛьготыНачисленияЛьготники.Услуга) КАК КоличествоУслуг
ПОМЕСТИТЬ УслугиПоЛьготнымКатегориям
ИЗ
	ЛьготыНачисленияЛьготники КАК ЛьготыНачисленияЛьготники

СГРУППИРОВАТЬ ПО
	ЛьготыНачисленияЛьготники.ЛицевойСчет,
	ЛьготыНачисленияЛьготники.ЛьготнаяКатегория
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КВП_РазмерыДолейЛицевыхСчетовСрезПоследних.ЛицевойСчет,
	ВЫБОР
		КОГДА КВП_РазмерыДолейЛицевыхСчетовСрезПоследних.ДоляЗнаменатель = 0
			ТОГДА 0
		ИНАЧЕ КВП_РазмерыДолейЛицевыхСчетовСрезПоследних.ДоляЧислитель / КВП_РазмерыДолейЛицевыхСчетовСрезПоследних.ДоляЗнаменатель
	КОНЕЦ * ЕСТЬNULL(КВП_ПлощадьПомещенияЖилая.Площадь, 0) КАК ЖилаяПлощадь,
	ВЫБОР
		КОГДА КВП_РазмерыДолейЛицевыхСчетовСрезПоследних.ДоляЗнаменатель = 0
			ТОГДА 0
		ИНАЧЕ КВП_РазмерыДолейЛицевыхСчетовСрезПоследних.ДоляЧислитель / КВП_РазмерыДолейЛицевыхСчетовСрезПоследних.ДоляЗнаменатель
	КОНЕЦ * ЕСТЬNULL(КВП_ПлощадьПомещенияОбщая.Площадь, 0) КАК ОбщаяПлощадь
ПОМЕСТИТЬ ПлощадиПомещений
ИЗ
	РегистрСведений.КВП_РазмерыДолейЛицевыхСчетов.СрезПоследних(
			{(КОНЕЦПЕРИОДА(&amp;КонецПериода, ДЕНЬ))},
			ЛицевойСчет В
				(ВЫБРАТЬ
					ЛьготыНачисленияЛьготники.ЛицевойСчет
				ИЗ
					ЛьготыНачисленияЛьготники)) КАК КВП_РазмерыДолейЛицевыхСчетовСрезПоследних
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КВП_ПлощадьПомещения.СрезПоследних({(КОНЕЦПЕРИОДА(&amp;КонецПериода, ДЕНЬ))}, ВидПлощади = ЗНАЧЕНИЕ(Справочник.УПЖКХ_ВидыПлощадей.ЖилаяПлощадь)) КАК КВП_ПлощадьПомещенияЖилая
		ПО КВП_РазмерыДолейЛицевыхСчетовСрезПоследних.Объект = КВП_ПлощадьПомещенияЖилая.Объект
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КВП_ПлощадьПомещения.СрезПоследних({(КОНЕЦПЕРИОДА(&amp;КонецПериода, ДЕНЬ))}, ВидПлощади = ЗНАЧЕНИЕ(Справочник.УПЖКХ_ВидыПлощадей.ОбщаяПлощадь)) КАК КВП_ПлощадьПомещенияОбщая
		ПО КВП_РазмерыДолейЛицевыхСчетовСрезПоследних.Объект = КВП_ПлощадьПомещенияОбщая.Объект
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЛьготыНачисленияЛьготники.Организация,
	ЛьготыНачисленияЛьготники.ЛицевойСчет.Адрес.Владелец КАК Здание,
	ЛьготыНачисленияЛьготники.ЛицевойСчет.Адрес КАК Адрес,
	ЛьготыНачисленияЛьготники.ЛицевойСчет,
	ЛьготыНачисленияЛьготники.Услуга,
	ЛьготыНачисленияЛьготники.ЛьготнаяКатегория,
	ЛьготыНачисленияЛьготники.Льготник,
	СУММА(ВЫБОР
			КОГДА ЕСТЬNULL(ЛьготникиПоКатегориям.КоличествоЛьготников, 0) &gt; 0
					И ЕСТЬNULL(ЛьготныеКатегорииПоУслугам.КоличествоЛьготныхКатегорий, 0) &gt; 0
				ТОГДА ЛьготыНачисленияЛьготники.СуммаНачислений / (ЛьготникиПоКатегориям.КоличествоЛьготников * ЛьготныеКатегорииПоУслугам.КоличествоЛьготныхКатегорий)
			ИНАЧЕ 0
		КОНЕЦ) КАК СуммаНачислений,
	СУММА(ВЫБОР
			КОГДА ЕСТЬNULL(ЛьготникиПоКатегориям.КоличествоЛьготников, 0) &gt; 0
				ТОГДА ЛьготыНачисленияЛьготники.СуммаЛьготы / ЛьготникиПоКатегориям.КоличествоЛьготников
			ИНАЧЕ 0
		КОНЕЦ) КАК СуммаЛьгот,
	СУММА(ВЫБОР
			КОГДА ЕСТЬNULL(ЛьготникиПоЛицевымСчетам.КоличествоЛьготников, 0) &gt; 0
					И ЕСТЬNULL(УслугиПоЛьготнымКатегориям.КоличествоУслуг, 0) &gt; 0
				ТОГДА ПлощадиПомещений.ОбщаяПлощадь / (ЛьготникиПоЛицевымСчетам.КоличествоЛьготников * УслугиПоЛьготнымКатегориям.КоличествоУслуг)
			ИНАЧЕ 0
		КОНЕЦ) КАК ОбщаяПлощадь,
	СУММА(ВЫБОР
			КОГДА ЕСТЬNULL(ЛьготникиПоЛицевымСчетам.КоличествоЛьготников, 0) &gt; 0
					И ЕСТЬNULL(УслугиПоЛьготнымКатегориям.КоличествоУслуг, 0) &gt; 0
				ТОГДА ПлощадиПомещений.ЖилаяПлощадь / (ЛьготникиПоЛицевымСчетам.КоличествоЛьготников * УслугиПоЛьготнымКатегориям.КоличествоУслуг)
			ИНАЧЕ 0
		КОНЕЦ) КАК ЖилаяПлощадь,
	ЛьготыНачисленияЛьготники.Льготник КАК КоличествоЛьготников
ИЗ
	ЛьготыНачисленияЛьготники КАК ЛьготыНачисленияЛьготники
		ЛЕВОЕ СОЕДИНЕНИЕ ЛьготникиПоКатегориям КАК ЛьготникиПоКатегориям
		ПО ЛьготыНачисленияЛьготники.ЛьготнаяКатегория = ЛьготникиПоКатегориям.ЛьготнаяКатегория
			И ЛьготыНачисленияЛьготники.ЛицевойСчет = ЛьготникиПоКатегориям.ЛицевойСчет
		ЛЕВОЕ СОЕДИНЕНИЕ ЛьготныеКатегорииПоУслугам КАК ЛьготныеКатегорииПоУслугам
		ПО ЛьготыНачисленияЛьготники.ЛицевойСчет = ЛьготныеКатегорииПоУслугам.ЛицевойСчет
			И ЛьготыНачисленияЛьготники.Услуга = ЛьготныеКатегорииПоУслугам.Услуга
		ЛЕВОЕ СОЕДИНЕНИЕ ЛьготникиПоЛицевымСчетам КАК ЛьготникиПоЛицевымСчетам
		ПО ЛьготыНачисленияЛьготники.ЛицевойСчет = ЛьготникиПоЛицевымСчетам.ЛицевойСчет
		ЛЕВОЕ СОЕДИНЕНИЕ УслугиПоЛьготнымКатегориям КАК УслугиПоЛьготнымКатегориям
		ПО ЛьготыНачисленияЛьготники.ЛицевойСчет = УслугиПоЛьготнымКатегориям.ЛицевойСчет
			И ЛьготыНачисленияЛьготники.ЛьготнаяКатегория = УслугиПоЛьготнымКатегориям.ЛьготнаяКатегория
		ЛЕВОЕ СОЕДИНЕНИЕ ПлощадиПомещений КАК ПлощадиПомещений
		ПО ЛьготыНачисленияЛьготники.ЛицевойСчет = ПлощадиПомещений.ЛицевойСчет

СГРУППИРОВАТЬ ПО
	ЛьготыНачисленияЛьготники.Льготник,
	ЛьготыНачисленияЛьготники.Организация,
	ЛьготыНачисленияЛьготники.ЛицевойСчет,
	ЛьготыНачисленияЛьготники.Услуга,
	ЛьготыНачисленияЛьготники.ЛьготнаяКатегория,
	ЛьготыНачисленияЛьготники.ЛицевойСчет.Адрес.Владелец,
	ЛьготыНачисленияЛьготники.ЛицевойСчет.Адрес,
	ЛьготыНачисленияЛьготники.Льготник</query>
	</dataSet>
	<dataSet xsi:type="DataSetQuery">
		<name>Жильцы</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоЗарегистрированных</dataPath>
			<field>КоличествоЗарегистрированных</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Кол-во зарегистрированных</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоПроживающих</dataPath>
			<field>КоличествоПроживающих</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Кол-во проживающих</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">12</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЛицевойСчет</dataPath>
			<field>ЛицевойСчет</field>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КВП_ЛицевыеСчетаСрезПоследних.ЛицевойСчет
ПОМЕСТИТЬ втЛС
ИЗ
	РегистрСведений.КВП_ЛицевыеСчета.СрезПоследних({(&amp;КонецПериода)}, ЛицевойСчет = &amp;ЛицевойСчет) КАК КВП_ЛицевыеСчетаСрезПоследних
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КВП_УчетКоличестваЖильцовПоЛицевымСчетамСрезПоследних.ЛицевойСчет,
	КВП_УчетКоличестваЖильцовПоЛицевымСчетамСрезПоследних.КоличествоПроживающих,
	КВП_УчетКоличестваЖильцовПоЛицевымСчетамСрезПоследних.КоличествоЗарегистрированных
ПОМЕСТИТЬ втУчетКоличестваЖильцов
ИЗ
	РегистрСведений.КВП_УчетКоличестваЖильцовПоЛицевымСчетам.СрезПоследних({(&amp;КонецПериода)}, ЛицевойСчет = &amp;ЛицевойСчет) КАК КВП_УчетКоличестваЖильцовПоЛицевымСчетамСрезПоследних
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	втЛС.ЛицевойСчет,
	ЕСТЬNULL(втУчетКоличестваЖильцов.КоличествоПроживающих, 0) КАК КоличествоПроживающих,
	ЕСТЬNULL(втУчетКоличестваЖильцов.КоличествоЗарегистрированных, 0) КАК КоличествоЗарегистрированных
ИЗ
	втЛС КАК втЛС
		ЛЕВОЕ СОЕДИНЕНИЕ втУчетКоличестваЖильцов КАК втУчетКоличестваЖильцов
		ПО втЛС.ЛицевойСчет = втУчетКоличестваЖильцов.ЛицевойСчет</query>
	</dataSet>
	<dataSetLink>
		<sourceDataSet>Льготы</sourceDataSet>
		<destinationDataSet>Жильцы</destinationDataSet>
		<sourceExpression>ЛицевойСчет</sourceExpression>
		<destinationExpression>ЛицевойСчет</destinationExpression>
		<parameter>ЛицевойСчет</parameter>
		<parameterListAllowed>false</parameterListAllowed>
	</dataSetLink>
	<totalField>
		<dataPath>СуммаНачислений</dataPath>
		<expression>Сумма(СуммаНачислений)</expression>
	</totalField>
	<totalField>
		<dataPath>СуммаЛьгот</dataPath>
		<expression>Сумма(СуммаЛьгот)</expression>
	</totalField>
	<totalField>
		<dataPath>ОбщаяПлощадь</dataPath>
		<expression>Сумма(ОбщаяПлощадь)</expression>
	</totalField>
	<totalField>
		<dataPath>ЖилаяПлощадь</dataPath>
		<expression>Сумма(ЖилаяПлощадь)</expression>
	</totalField>
	<totalField>
		<dataPath>КоличествоЛьготников</dataPath>
		<expression>Количество(Различные КоличествоЛьготников)</expression>
	</totalField>
	<totalField>
		<dataPath>КоличествоЗарегистрированных</dataPath>
		<expression>Сумма(КоличествоЗарегистрированных)</expression>
	</totalField>
	<totalField>
		<dataPath>КоличествоПроживающих</dataPath>
		<expression>Сумма(КоличествоПроживающих)</expression>
	</totalField>
	<parameter>
		<name>КонецПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Конец периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>НачалоПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Начало периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>ЛицевойСчет</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Лицевой счет</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.КВП_ЛицевыеСчета</v8:Type>
		</valueType>
		<value xsi:type="dcscor:DesignTimeValue">Справочник.КВП_ЛицевыеСчета.ПустаяСсылка</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
			<dcsset:selection>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Организация</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Адрес</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Здание</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ЛицевойСчет</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ЛьготнаяКатегория</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Услуга</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Льготник</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>СуммаЛьгот</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>СуммаНачислений</dcsset:field>
				</dcsset:item>
			</dcsset:selection>
			<dcsset:dataParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>ЛицевойСчет</dcscor:parameter>
					<dcscor:value xsi:type="dcscor:DesignTimeValue">Справочник.УПЖКХ_Помещения.ПустаяСсылка</dcscor:value>
				</dcscor:item>
			</dcsset:dataParameters>
			<dcsset:order>
				<dcsset:item xsi:type="dcsset:OrderItemField">
					<dcsset:field>Льготник</dcsset:field>
					<dcsset:orderType>Asc</dcsset:orderType>
				</dcsset:item>
			</dcsset:order>
			<dcsset:outputParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>РасположениеИтогов</dcscor:parameter>
					<dcscor:value xsi:type="dcscor:DataCompositionTotalPlacement">BeginAndEnd</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>ГоризонтальноеРасположениеОбщихИтогов</dcscor:parameter>
					<dcscor:value xsi:type="dcscor:DataCompositionTotalPlacement">End</dcscor:value>
				</dcscor:item>
			</dcsset:outputParameters>
			<dcsset:item xsi:type="dcsset:StructureItemTable">
				<dcsset:column>
					<dcsset:order>
						<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
					</dcsset:order>
					<dcsset:selection>
						<dcsset:item xsi:type="dcsset:SelectedItemField">
							<dcsset:field>КоличествоПроживающих</dcsset:field>
						</dcsset:item>
						<dcsset:item xsi:type="dcsset:SelectedItemField">
							<dcsset:field>КоличествоЗарегистрированных</dcsset:field>
						</dcsset:item>
						<dcsset:item xsi:type="dcsset:SelectedItemField">
							<dcsset:field>КоличествоЛьготников</dcsset:field>
						</dcsset:item>
						<dcsset:item xsi:type="dcsset:SelectedItemField">
							<dcsset:field>ОбщаяПлощадь</dcsset:field>
						</dcsset:item>
						<dcsset:item xsi:type="dcsset:SelectedItemField">
							<dcsset:field>ЖилаяПлощадь</dcsset:field>
						</dcsset:item>
					</dcsset:selection>
				</dcsset:column>
				<dcsset:column>
					<dcsset:groupItems>
						<dcsset:item xsi:type="dcsset:GroupItemField">
							<dcsset:field>Услуга</dcsset:field>
							<dcsset:groupType>Items</dcsset:groupType>
							<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
							<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
							<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
						</dcsset:item>
					</dcsset:groupItems>
					<dcsset:order>
						<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
					</dcsset:order>
					<dcsset:selection>
						<dcsset:item xsi:type="dcsset:SelectedItemField">
							<dcsset:field>Услуга</dcsset:field>
						</dcsset:item>
						<dcsset:item xsi:type="dcsset:SelectedItemField">
							<dcsset:field>СуммаНачислений</dcsset:field>
						</dcsset:item>
						<dcsset:item xsi:type="dcsset:SelectedItemField">
							<dcsset:field>СуммаЛьгот</dcsset:field>
						</dcsset:item>
					</dcsset:selection>
					<dcsset:outputParameters>
						<dcscor:item xsi:type="dcsset:SettingsParameterValue">
							<dcscor:parameter>РасположениеРесурсов</dcscor:parameter>
							<dcscor:value xsi:type="dcsset:DataCompositionResourcesPlacement">Horizontally</dcscor:value>
						</dcscor:item>
					</dcsset:outputParameters>
				</dcsset:column>
				<dcsset:row>
					<dcsset:groupItems>
						<dcsset:item xsi:type="dcsset:GroupItemField">
							<dcsset:field>Здание</dcsset:field>
							<dcsset:groupType>Hierarchy</dcsset:groupType>
							<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
							<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
							<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
						</dcsset:item>
					</dcsset:groupItems>
					<dcsset:order>
						<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
					</dcsset:order>
					<dcsset:selection>
						<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
					</dcsset:selection>
					<dcsset:item>
						<dcsset:groupItems>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>Адрес</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
						</dcsset:groupItems>
						<dcsset:order>
							<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
						</dcsset:order>
						<dcsset:selection>
							<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
						</dcsset:selection>
						<dcsset:item>
							<dcsset:groupItems>
								<dcsset:item xsi:type="dcsset:GroupItemField">
									<dcsset:field>ЛицевойСчет</dcsset:field>
									<dcsset:groupType>Items</dcsset:groupType>
									<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
									<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
									<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
								</dcsset:item>
							</dcsset:groupItems>
							<dcsset:order>
								<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
							</dcsset:order>
							<dcsset:selection>
								<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
							</dcsset:selection>
							<dcsset:item>
								<dcsset:groupItems>
									<dcsset:item xsi:type="dcsset:GroupItemField">
										<dcsset:field>ЛьготнаяКатегория</dcsset:field>
										<dcsset:groupType>Items</dcsset:groupType>
										<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
										<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
										<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
									</dcsset:item>
								</dcsset:groupItems>
								<dcsset:order>
									<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
								</dcsset:order>
								<dcsset:selection>
									<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
								</dcsset:selection>
								<dcsset:item>
									<dcsset:groupItems>
										<dcsset:item xsi:type="dcsset:GroupItemField">
											<dcsset:field>Льготник</dcsset:field>
											<dcsset:groupType>Items</dcsset:groupType>
											<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
											<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
											<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
										</dcsset:item>
									</dcsset:groupItems>
									<dcsset:order>
										<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
									</dcsset:order>
									<dcsset:selection>
										<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
									</dcsset:selection>
								</dcsset:item>
							</dcsset:item>
						</dcsset:item>
					</dcsset:item>
				</dcsset:row>
				<dcsset:selection>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>Здание</dcsset:field>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>Адрес</dcsset:field>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>ЛицевойСчет</dcsset:field>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>ЛьготнаяКатегория</dcsset:field>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>Льготник</dcsset:field>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>Услуга</dcsset:field>
					</dcsset:item>
				</dcsset:selection>
			</dcsset:item>
		</dcsset:settings>
	</settingsVariant>
</DataCompositionSchema>