
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныеПроцедурыИФункции

// Процедура формирует отчет.
Процедура СформироватьОтчет(ПараметрыОтчета, АдресХранилища) Экспорт
	
	Если ПараметрыОтчета.Организация.Пустая() Тогда
		УПЖКХ_ТиповыеМетодыКлиентСервер.СообщитьОбОшибке("Поле организации обязательно для заполнения!");
		Возврат;
	КонецЕсли;
	
	ЗаполнитьДокумент(ПараметрыОтчета, АдресХранилища);
	
КонецПроцедуры

// Заполняет табличный документ по данным
// в указанной структуре параметров.
Процедура ЗаполнитьДокумент(ПараметрыОтчета, АдресХранилища)
	
	ДокументРезультат = Новый ТабличныйДокумент;
	Макет = Отчеты.КВП_ФормыТСЖ.ПолучитьМакет(ПараметрыОтчета.НомерФормы);
	
	ОбластьТитульный = Макет.ПолучитьОбласть("Шапка");
	ОбластьТитульный.Параметры.Организация  = ПараметрыОтчета.Организация.НаименованиеПолное;
	ДокументРезультат.Вывести(ОбластьТитульный);
	
	ДокументРезультат.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	ДокументРезультат.АвтоМасштаб = Истина;
	ПоместитьВоВременноеХранилище(ДокументРезультат, АдресХранилища);
Конецпроцедуры  //ЗаполнитьДокумент_ЗаявлениеОВыходе()

#КонецОбласти

#КонецЕсли